
<html>
    <head>
        <title>Coverage Report</title>
        <meta charset="utf-8">
        
        <style type="text/css">
            body {
                background-color: #fff;
                font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            }
            table {
                margin-left: 10px;
                border-collapse: collapse;
            }
            td { 
                background-color: #fff; 
                padding: 2px;
            }
            table.overview td {
                padding-right: 20px;
            }
            td.percent, td.linecount { text-align: right; }
            div.package, #totalcov { 
                color: #fff;
                background-color: #375eab; 
                font-size: 16px;
                font-weight: bold;
                padding: 10px;
                border-radius: 5px 5px 5px 5px;
            }
            div.package, #totalcov { 
                float: right; 
                right: 10px;
            }
            #totalcov { 
                top: 10px;
                position: relative;
                background-color: #fff;
                color: #000;
                border: 1px solid #375eab;
                clear: both;
            }
            #summaryWrapper {
                position: fixed;
                top: 10px;
                float: right;
                right: 10px;

            }
            span.packageTotal {
                float: right;
                color: #000;
            }
            #doctitle { 
                background-color: #fff; 
                font-size: 24px;
                margin-top: 20px;
                margin-left: 10px;
                color: #375eab;
                font-weight: bold;
            }
            #about {
                margin-left: 18px;
                font-size: 10px;
            }
            table tr:last-child td {
                font-weight: bold;
            }
            .functitle, .funcname { 
                text-align: center; 
                font-size: 20px; 
                font-weight: bold; 
                color: #375eab; 
            }
            .funcname {
                text-align: left;
                margin-top: 20px;
                margin-left: 10px;
                margin-bottom: 20px;
                padding: 2px 5px 5px;
                background-color: #e0ebf5;
            }
            table.listing {
                margin-left: 10px;
            }
            table.listing td {
                padding: 0px;
                font-size: 12px;
                background-color: #eee; 
                vertical-align: top;
                padding-left: 10px;
                border-bottom: 1px solid #fff;
            }
            table.listing td:first-child {
                text-align: right;
                font-weight: bold;
                vertical-align: center;
            }
            table.listing tr.miss td {
                background-color: #FFBBB8;
            }
            table.listing tr:last-child td {
                font-weight: normal;
                color: #000;
            }
            table.listing tr:last-child td:first-child {
                font-weight: bold;
            }
            .info {
                margin-left: 10px;
            }
            .info code {
            }
            pre { margin: 1px; }
            pre.cmd { 
                background-color: #e9e9e9;
                border-radius: 5px 5px 5px 5px;
                padding: 10px;
                margin: 20px;
                line-height: 18px;
                font-size: 14px;
            }
            a { 
                text-decoration: none; 
                color: #375eab;
            }
            a:hover { text-decoration: underline; }
            p { margin-left: 10px; }
        </style>
        
    </head>
    <body>
        <div id="doctitle">Coverage Report</div>
    <div id="about">Generated on 03 Aug 22 16:00 -0700 with <a href="https://github.com/matm/gocov-html">gocov-html</a></div><div class="funcname">Report Overview</div><table class="overview">
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress">github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress</a></code></td><td class="percent"><code>13.99%</code></td><td class="linecount"><code>20/143</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/functional_tests"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/functional_tests">github.com/Azure/application-gateway-kubernetes-ingress/functional_tests</a></code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>28/28</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests">github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests</a></code></td><td class="percent"><code>78.38%</code></td><td class="linecount"><code>58/74</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations">github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations</a></code></td><td class="percent"><code>80.65%</code></td><td class="linecount"><code>50/62</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw">github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw</a></code></td><td class="percent"><code>76.48%</code></td><td class="linecount"><code>1099/1437</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure">github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure</a></code></td><td class="percent"><code>29.41%</code></td><td class="linecount"><code>75/255</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield">github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield</a></code></td><td class="percent"><code>69.40%</code></td><td class="linecount"><code>415/598</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller">github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller</a></code></td><td class="percent"><code>42.74%</code></td><td class="linecount"><code>159/372</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment">github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment</a></code></td><td class="percent"><code>59.18%</code></td><td class="linecount"><code>29/49</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext">github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext</a></code></td><td class="percent"><code>45.20%</code></td><td class="linecount"><code>278/615</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert">github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert</a></code></td><td class="percent"><code>50.39%</code></td><td class="linecount"><code>65/129</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests">github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests</a></code></td><td class="percent"><code>60.00%</code></td><td class="linecount"><code>42/70</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures">github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures</a></code></td><td class="percent"><code>95.92%</code></td><td class="linecount"><code>47/49</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils">github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils</a></code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>68/85</code></td></tr>
<tr id="s_pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker"><td><code><a href="#pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker">github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker</a></code></td><td class="percent"><code>72.41%</code></td><td class="linecount"><code>21/29</code></td></tr>
<tr><td><code>Report Total</code></td><td class="percent"><code>61.43%</code></td><td class="linecount"><code>2454/3995</code></td></tr>
</table>
<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress <span class="packageTotal">13.99%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_getNamespacesToWatch"><td><code><a href="#fn_getNamespacesToWatch">getNamespacesToWatch(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>10/10</code></td></tr>
<tr id="s_fn_getVerbosity"><td><code><a href="#fn_getVerbosity">getVerbosity(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_validateNamespaces"><td><code><a href="#fn_validateNamespaces">validateNamespaces(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code></td><td class="percent"><code>44.44%</code></td><td class="linecount"><code>4/9</code></td></tr>
<tr id="s_fn_main"><td><code><a href="#fn_main">main(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress/main.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/97</code></td></tr>
<tr id="s_fn_getEventRecorder"><td><code><a href="#fn_getEventRecorder">getEventRecorder(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_getKubeClientConfig"><td><code><a href="#fn_getKubeClientConfig">getKubeClientConfig(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/9</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress</code></td><td class="percent"><code>13.99%</code></td><td class="linecount"><code>20/143</code></td></tr>
</table>

<div class="funcname" id="fn_getNamespacesToWatch">func getNamespacesToWatch</div><div class="info"><a href="#s_fn_getNamespacesToWatch">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code>:</p></div><table class="listing">
<tr><td>48</td><td><code><pre>func getNamespacesToWatch(namespaceEnvVar string) []string {</pre></code></td></tr><tr><td>49</td><td><code><pre>        // Returning an empty array effectively switches Ingress Controller</pre></code></td></tr><tr><td>50</td><td><code><pre>        // in a mode of observing all accessible namespaces.</pre></code></td></tr><tr><td>51</td><td><code><pre>        if namespaceEnvVar == &#34;&#34; {</pre></code></td></tr><tr><td>52</td><td><code><pre>                return []string{}</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr><td>55</td><td><code><pre>        // Namespaces (DNS-1123 label) can have lower case alphanumeric characters or &#39;-&#39;</pre></code></td></tr><tr><td>56</td><td><code><pre>        // Commas are safe to use as a separator</pre></code></td></tr><tr><td>57</td><td><code><pre>        if strings.Contains(namespaceEnvVar, &#34;,&#34;) {</pre></code></td></tr><tr><td>58</td><td><code><pre>                var namespaces []string</pre></code></td></tr><tr><td>59</td><td><code><pre>                for _, ns := range strings.Split(namespaceEnvVar, &#34;,&#34;) {</pre></code></td></tr><tr><td>60</td><td><code><pre>                        if len(ns) &gt; 0 {</pre></code></td></tr><tr><td>61</td><td><code><pre>                                namespaces = append(namespaces, strings.TrimSpace(ns))</pre></code></td></tr><tr><td>62</td><td><code><pre>                        }</pre></code></td></tr><tr><td>63</td><td><code><pre>                }</pre></code></td></tr><tr><td>64</td><td><code><pre>                sort.Strings(namespaces)</pre></code></td></tr><tr><td>65</td><td><code><pre>                return namespaces</pre></code></td></tr><tr><td>66</td><td><code><pre>        }</pre></code></td></tr><tr><td>67</td><td><code><pre>        return []string{namespaceEnvVar}</pre></code></td></tr><tr><td>68</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getVerbosity">func getVerbosity</div><div class="info"><a href="#s_fn_getVerbosity">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code>:</p></div><table class="listing">
<tr><td>108</td><td><code><pre>func getVerbosity(flagVerbosity int, envVerbosity string) int {</pre></code></td></tr><tr><td>109</td><td><code><pre>        envVerbosityInt, err := strconv.Atoi(envVerbosity)</pre></code></td></tr><tr><td>110</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>111</td><td><code><pre>                klog.Infof(&#34;Using verbosity level %d from CLI flag %s&#34;, flagVerbosity, verbosityFlag)</pre></code></td></tr><tr><td>112</td><td><code><pre>                return flagVerbosity</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre>        klog.Infof(&#34;Using verbosity level %d from environment variable %s&#34;, envVerbosityInt, environment.VerbosityLevelVarName)</pre></code></td></tr><tr><td>115</td><td><code><pre>        return envVerbosityInt</pre></code></td></tr><tr><td>116</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_validateNamespaces">func validateNamespaces</div><div class="info"><a href="#s_fn_validateNamespaces">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code>:</p></div><table class="listing">
<tr><td>30</td><td><code><pre>func validateNamespaces(namespaces []string, kubeClient *kubernetes.Clientset) error {</pre></code></td></tr><tr><td>31</td><td><code><pre>        var nonExistent []string</pre></code></td></tr><tr><td>32</td><td><code><pre>        for _, ns := range namespaces {</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                if _, err := kubeClient.CoreV1().Namespaces().Get(context.TODO(), ns, metav1.GetOptions{}); err != nil {</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                        nonExistent = append(nonExistent, ns)</pre></code></td></tr><tr><td>35</td><td><code><pre>                }</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr><tr><td>37</td><td><code><pre>        if len(nonExistent) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                err := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>39</td><td><code><pre>                        controllererrors.ErrorNoSuchNamespace,</pre></code></td></tr><tr><td>40</td><td><code><pre>                        &#34;error creating informers; Namespaces do not exist or Ingress Controller has no access to: %v&#34;, strings.Join(nonExistent, &#34;,&#34;),</pre></code></td></tr><tr><td>41</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                klog.Errorf(err.Error())</pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>                return err</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>46</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_main">func main</div><div class="info"><a href="#s_fn_main">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/cmd/appgw-ingress/main.go</code>:</p></div><table class="listing">
<tr><td>63</td><td><code><pre>func main() {</pre></code></td></tr><tr><td>64</td><td><code><pre>        // Log output is buffered... Calling Flush before exiting guarantees all log output is written.</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>        klog.InitFlags(nil)</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>        defer klog.Flush()</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>        if err := flags.Parse(os.Args); err != nil {</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                klog.Fatal(&#34;Error parsing command line arguments:&#34;, err)</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr><td>70</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>71</td><td><code><pre>        env := environment.GetEnv()</pre></code></td></tr><tr class="miss"><td>72</td><td><code><pre>        verbosity = to.IntPtr(getVerbosity(*verbosity, env.VerbosityLevel))</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>        if *versionInfo {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                version.PrintVersionAndExit()</pre></code></td></tr><tr><td>75</td><td><code><pre>        }</pre></code></td></tr><tr><td>76</td><td><code><pre></pre></code></td></tr><tr><td>77</td><td><code><pre>        // get the details from Cloud Provider Config</pre></code></td></tr><tr><td>78</td><td><code><pre>        // Reference: https://github.com/kubernetes-sigs/cloud-provider-azure/blob/master/docs/cloud-provider-config.md#cloud-provider-config</pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>        cpConfig, err := azure.NewCloudProviderConfig(env.CloudProviderConfigLocation)</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>                klog.Infof(&#34;Unable to load cloud provider config &#39;%s&#39;. Error: %s&#34;, env.CloudProviderConfigLocation, err.Error())</pre></code></td></tr><tr><td>82</td><td><code><pre>        }</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>        env.Consolidate(cpConfig)</pre></code></td></tr><tr><td>85</td><td><code><pre></pre></code></td></tr><tr><td>86</td><td><code><pre>        // Workaround for &#34;ERROR: logging before flag.Parse&#34;</pre></code></td></tr><tr><td>87</td><td><code><pre>        // See: https://github.com/kubernetes/kubernetes/issues/17162#issuecomment-225596212</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>        _ = flag.CommandLine.Parse([]string{})</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>        _ = flag.Lookup(&#34;logtostderr&#34;).Value.Set(&#34;true&#34;)</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>        _ = flag.Set(&#34;v&#34;, strconv.Itoa(*verbosity))</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>        apiConfig := getKubeClientConfig()</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>        kubeClient := kubernetes.NewForConfigOrDie(apiConfig)</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>        k8scontext.IsNetworkingV1PackageSupported = k8scontext.SupportsNetworkingPackage(kubeClient)</pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>        k8scontext.IsInMultiClusterMode = env.MultiClusterMode</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>        crdClient := versioned.NewForConfigOrDie(apiConfig)</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>        istioCrdClient := istio.NewForConfigOrDie(apiConfig)</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>        multiClusterCrdClient := multicluster.NewForConfigOrDie(apiConfig)</pre></code></td></tr><tr class="miss"><td>99</td><td><code><pre>        recorder := getEventRecorder(kubeClient, env.IngressClassControllerName)</pre></code></td></tr><tr class="miss"><td>100</td><td><code><pre>        namespaces := getNamespacesToWatch(env.WatchNamespace)</pre></code></td></tr><tr class="miss"><td>101</td><td><code><pre>        metricStore := metricstore.NewMetricStore(env)</pre></code></td></tr><tr class="miss"><td>102</td><td><code><pre>        metricStore.Start()</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        k8sContext := k8scontext.NewContext(kubeClient, crdClient, multiClusterCrdClient, istioCrdClient, namespaces, *resyncPeriod, metricStore, env)</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>        agicPod := k8sContext.GetAGICPod(env)</pre></code></td></tr><tr><td>105</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>        if err := environment.ValidateEnv(env); err != nil {</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>                errorLine := fmt.Sprint(&#34;Error while initializing values from environment. Please check helm configuration for missing values: &#34;, err)</pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>                if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                        recorder.Event(agicPod, v1.EventTypeWarning, events.ReasonValidatonError, errorLine)</pre></code></td></tr><tr><td>110</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                klog.Fatal(errorLine)</pre></code></td></tr><tr><td>112</td><td><code><pre>        }</pre></code></td></tr><tr><td>113</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>        uniqueUserAgentSuffix := utils.RandStringRunes(10)</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>        if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>                uniqueUserAgentSuffix = agicPod.Name</pre></code></td></tr><tr><td>117</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>118</td><td><code><pre>        klog.Infof(&#34;Using User Agent Suffix=&#39;%s&#39; when communicating with ARM&#34;, uniqueUserAgentSuffix)</pre></code></td></tr><tr><td>119</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>120</td><td><code><pre>        azClient := azure.NewAzClient(azure.SubscriptionID(env.SubscriptionID), azure.ResourceGroup(env.ResourceGroupName), azure.ResourceName(env.AppGwName), uniqueUserAgentSuffix, env.ClientID)</pre></code></td></tr><tr class="miss"><td>121</td><td><code><pre>        appGwIdentifier := appgw.Identifier{</pre></code></td></tr><tr><td>122</td><td><code><pre>                SubscriptionID: env.SubscriptionID,</pre></code></td></tr><tr><td>123</td><td><code><pre>                ResourceGroup:  env.ResourceGroupName,</pre></code></td></tr><tr><td>124</td><td><code><pre>                AppGwName:      env.AppGwName,</pre></code></td></tr><tr><td>125</td><td><code><pre>        }</pre></code></td></tr><tr><td>126</td><td><code><pre></pre></code></td></tr><tr><td>127</td><td><code><pre>        // create a new agic controller</pre></code></td></tr><tr class="miss"><td>128</td><td><code><pre>        appGwIngressController := controller.NewAppGwIngressController(azClient, appGwIdentifier, k8sContext, recorder, metricStore, agicPod, env.HostedOnUnderlay)</pre></code></td></tr><tr><td>129</td><td><code><pre></pre></code></td></tr><tr><td>130</td><td><code><pre>        // initialize the http server and start it</pre></code></td></tr><tr class="miss"><td>131</td><td><code><pre>        httpServer := httpserver.NewHTTPServer(</pre></code></td></tr><tr><td>132</td><td><code><pre>                appGwIngressController,</pre></code></td></tr><tr><td>133</td><td><code><pre>                metricStore,</pre></code></td></tr><tr><td>134</td><td><code><pre>                env.HTTPServicePort)</pre></code></td></tr><tr class="miss"><td>135</td><td><code><pre>        httpServer.Start()</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>137</td><td><code><pre>        klog.V(3).Infof(&#34;Application Gateway Details: Subscription=\&#34;%s\&#34; Resource Group=\&#34;%s\&#34; Name=\&#34;%s\&#34;&#34;, env.SubscriptionID, env.ResourceGroupName, env.AppGwName)</pre></code></td></tr><tr><td>138</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>139</td><td><code><pre>        var authorizer autorest.Authorizer</pre></code></td></tr><tr class="miss"><td>140</td><td><code><pre>        if authorizer, err = azure.GetAuthorizerWithRetry(env.AuthLocation, env.UseManagedIdentityForPod, cpConfig, maxRetryCount, retryPause); err != nil {</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>                errorLine := fmt.Sprint(&#34;Failed obtaining authentication token for Azure Resource Manager: &#34;, err)</pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>                if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                        recorder.Event(agicPod, v1.EventTypeWarning, events.ReasonARMAuthFailure, errorLine)</pre></code></td></tr><tr><td>144</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>145</td><td><code><pre>                klog.Fatal(errorLine)</pre></code></td></tr><tr><td>146</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>147</td><td><code><pre>                azClient.SetAuthorizer(authorizer)</pre></code></td></tr><tr><td>148</td><td><code><pre>        }</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>        // Check if Application Gateway exists/have get access</pre></code></td></tr><tr><td>151</td><td><code><pre>        // If AGIC&#39;s service principal or managed identity doesn&#39;t have read access to the Application Gateway&#39;s resource group,</pre></code></td></tr><tr><td>152</td><td><code><pre>        // then AGIC can&#39;t read it&#39;s role assignments to look for the needed permission.</pre></code></td></tr><tr><td>153</td><td><code><pre>        // Instead we perform a simple GET request to check both that the Application Gateway exists as well as implicitly make sure that AGIC has read access to it.</pre></code></td></tr><tr class="miss"><td>154</td><td><code><pre>        err = azClient.WaitForGetAccessOnGateway(maxRetryCount)</pre></code></td></tr><tr class="miss"><td>155</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>156</td><td><code><pre>                if controllererrors.IsErrorCode(err, controllererrors.ErrorApplicationGatewayNotFound) &amp;&amp; env.EnableDeployAppGateway {</pre></code></td></tr><tr class="miss"><td>157</td><td><code><pre>                        if env.AppGwSubnetID != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>158</td><td><code><pre>                                err = azClient.DeployGatewayWithSubnet(env.AppGwSubnetID, env.AppGwSkuName)</pre></code></td></tr><tr class="miss"><td>159</td><td><code><pre>                        } else if cpConfig != nil {</pre></code></td></tr><tr class="miss"><td>160</td><td><code><pre>                                err = azClient.DeployGatewayWithVnet(azure.ResourceGroup(cpConfig.VNetResourceGroup), azure.ResourceName(cpConfig.VNetName), azure.ResourceName(env.AppGwSubnetName), env.AppGwSubnetPrefix, env.AppGwSkuName)</pre></code></td></tr><tr><td>161</td><td><code><pre>                        }</pre></code></td></tr><tr><td>162</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>163</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>164</td><td><code><pre>                                errorLine := fmt.Sprint(&#34;Failed in deploying Application Gateway&#34;, err)</pre></code></td></tr><tr class="miss"><td>165</td><td><code><pre>                                if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>166</td><td><code><pre>                                        recorder.Event(agicPod, v1.EventTypeWarning, events.ReasonFailedDeployingAppGw, errorLine)</pre></code></td></tr><tr><td>167</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>168</td><td><code><pre>                                klog.Fatal(errorLine)</pre></code></td></tr><tr><td>169</td><td><code><pre>                        }</pre></code></td></tr><tr><td>170</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>171</td><td><code><pre>                        errorLine := fmt.Sprint(&#34;Failed getting Application Gateway: &#34;, err)</pre></code></td></tr><tr class="miss"><td>172</td><td><code><pre>                        if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>173</td><td><code><pre>                                recorder.Event(agicPod, v1.EventTypeWarning, events.ReasonARMAuthFailure, errorLine)</pre></code></td></tr><tr><td>174</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>175</td><td><code><pre>                        klog.Fatal(errorLine)</pre></code></td></tr><tr><td>176</td><td><code><pre>                }</pre></code></td></tr><tr><td>177</td><td><code><pre>        }</pre></code></td></tr><tr><td>178</td><td><code><pre></pre></code></td></tr><tr><td>179</td><td><code><pre>        // namespace validations</pre></code></td></tr><tr class="miss"><td>180</td><td><code><pre>        if err := validateNamespaces(namespaces, kubeClient); err != nil {</pre></code></td></tr><tr class="miss"><td>181</td><td><code><pre>                klog.Fatal(err) // side-effect: will panic on non-existent namespace</pre></code></td></tr><tr><td>182</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>183</td><td><code><pre>        if len(namespaces) == 0 {</pre></code></td></tr><tr class="miss"><td>184</td><td><code><pre>                klog.Info(&#34;Ingress Controller will observe all namespaces.&#34;)</pre></code></td></tr><tr><td>185</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>186</td><td><code><pre>                klog.Info(&#34;Ingress Controller will observe the following namespaces:&#34;, strings.Join(namespaces, &#34;,&#34;))</pre></code></td></tr><tr><td>187</td><td><code><pre>        }</pre></code></td></tr><tr><td>188</td><td><code><pre></pre></code></td></tr><tr><td>189</td><td><code><pre>        // fatal config validations</pre></code></td></tr><tr class="miss"><td>190</td><td><code><pre>        appGw, _ := azClient.GetGateway()</pre></code></td></tr><tr class="miss"><td>191</td><td><code><pre>        if err := appgw.FatalValidateOnExistingConfig(recorder, appGw.ApplicationGatewayPropertiesFormat, env); err != nil {</pre></code></td></tr><tr class="miss"><td>192</td><td><code><pre>                klog.Fatal(&#34;Got a fatal validation error on existing Application Gateway config. Please update Application Gateway or the controller&#39;s helm config. Error:&#34;, err)</pre></code></td></tr><tr><td>193</td><td><code><pre>        }</pre></code></td></tr><tr><td>194</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>195</td><td><code><pre>        if _, exists := allowedSkus[appGw.Sku.Tier]; !exists {</pre></code></td></tr><tr class="miss"><td>196</td><td><code><pre>                errorLine := fmt.Sprintf(&#34;App Gateway SKU Tier %s is not supported by AGIC version %s; (v0.10.0 supports App Gwy v1)&#34;, appGw.Sku.Tier, appgw.GetVersion())</pre></code></td></tr><tr class="miss"><td>197</td><td><code><pre>                if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>198</td><td><code><pre>                        recorder.Event(agicPod, v1.EventTypeWarning, events.UnsupportedAppGatewaySKUTier, errorLine)</pre></code></td></tr><tr><td>199</td><td><code><pre>                }</pre></code></td></tr><tr><td>200</td><td><code><pre>                // Slow down the cycling of the AGIC pod.</pre></code></td></tr><tr class="miss"><td>201</td><td><code><pre>                time.Sleep(5 * time.Second)</pre></code></td></tr><tr class="miss"><td>202</td><td><code><pre>                klog.Fatal(errorLine)</pre></code></td></tr><tr><td>203</td><td><code><pre>        }</pre></code></td></tr><tr><td>204</td><td><code><pre></pre></code></td></tr><tr><td>205</td><td><code><pre>        // associate route table to application gateway subnet</pre></code></td></tr><tr class="miss"><td>206</td><td><code><pre>        if cpConfig != nil &amp;&amp; cpConfig.RouteTableName != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>207</td><td><code><pre>                subnetID := *(*appGw.GatewayIPConfigurations)[0].Subnet.ID</pre></code></td></tr><tr class="miss"><td>208</td><td><code><pre>                routeTableID := azure.RouteTableID(azure.SubscriptionID(cpConfig.SubscriptionID), azure.ResourceGroup(cpConfig.RouteTableResourceGroup), azure.ResourceName(cpConfig.RouteTableName))</pre></code></td></tr><tr><td>209</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>210</td><td><code><pre>                err = azClient.ApplyRouteTable(subnetID, routeTableID)</pre></code></td></tr><tr class="miss"><td>211</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>212</td><td><code><pre>                        klog.V(5).Infof(&#34;Unable to associate Application Gateway subnet &#39;%s&#39; with route table &#39;%s&#39; due to error (this is relevant for AKS clusters using &#39;Kubenet&#39; network plugin): [%+v]&#34;,</pre></code></td></tr><tr><td>213</td><td><code><pre>                                subnetID,</pre></code></td></tr><tr><td>214</td><td><code><pre>                                routeTableID,</pre></code></td></tr><tr><td>215</td><td><code><pre>                                err)</pre></code></td></tr><tr><td>216</td><td><code><pre>                }</pre></code></td></tr><tr><td>217</td><td><code><pre>        }</pre></code></td></tr><tr><td>218</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>219</td><td><code><pre>        if err := appGwIngressController.Start(env); err != nil {</pre></code></td></tr><tr class="miss"><td>220</td><td><code><pre>                errorLine := fmt.Sprint(&#34;Could not start AGIC: &#34;, err)</pre></code></td></tr><tr class="miss"><td>221</td><td><code><pre>                if agicPod != nil {</pre></code></td></tr><tr class="miss"><td>222</td><td><code><pre>                        recorder.Event(agicPod, v1.EventTypeWarning, events.ReasonARMAuthFailure, errorLine)</pre></code></td></tr><tr><td>223</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>224</td><td><code><pre>                klog.Fatal(errorLine)</pre></code></td></tr><tr><td>225</td><td><code><pre>        }</pre></code></td></tr><tr><td>226</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>227</td><td><code><pre>        sigChan := make(chan os.Signal, 1)</pre></code></td></tr><tr class="miss"><td>228</td><td><code><pre>        signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM)</pre></code></td></tr><tr class="miss"><td>229</td><td><code><pre>        &lt;-sigChan</pre></code></td></tr><tr><td>230</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>231</td><td><code><pre>        appGwIngressController.Stop()</pre></code></td></tr><tr class="miss"><td>232</td><td><code><pre>        httpServer.Stop()</pre></code></td></tr><tr class="miss"><td>233</td><td><code><pre>        klog.Info(&#34;Goodbye!&#34;)</pre></code></td></tr><tr><td>234</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getEventRecorder">func getEventRecorder</div><div class="info"><a href="#s_fn_getEventRecorder">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code>:</p></div><table class="listing">
<tr><td>88</td><td><code><pre>func getEventRecorder(kubeClient kubernetes.Interface, ingressClassControllerName string) record.EventRecorder {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>        eventBroadcaster := record.NewBroadcaster()</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>        eventBroadcaster.StartLogging(klog.V(5).Infof)</pre></code></td></tr><tr class="miss"><td>91</td><td><code><pre>        sink := &amp;typedcorev1.EventSinkImpl{Interface: kubeClient.CoreV1().Events(&#34;&#34;)}</pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>        eventBroadcaster.StartRecordingToSink(sink)</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>        hostname, err := os.Hostname()</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>                klog.Error(&#34;Could not obtain host name from the operating system&#34;, err)</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>                hostname = &#34;unknown-hostname&#34;</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>        source := v1.EventSource{</pre></code></td></tr><tr><td>99</td><td><code><pre>                Component: ingressClassControllerName,</pre></code></td></tr><tr><td>100</td><td><code><pre>                Host:      hostname,</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        s := scheme.Scheme</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>        agiccrdscheme.AddToScheme(s)</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>        return eventBroadcaster.NewRecorder(scheme.Scheme, source)</pre></code></td></tr><tr><td>106</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getKubeClientConfig">func getKubeClientConfig</div><div class="info"><a href="#s_fn_getKubeClientConfig">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/cmd/appgw-ingress/utils.go</code>:</p></div><table class="listing">
<tr><td>70</td><td><code><pre>func getKubeClientConfig() *rest.Config {</pre></code></td></tr><tr class="miss"><td>71</td><td><code><pre>        if *inCluster {</pre></code></td></tr><tr class="miss"><td>72</td><td><code><pre>                config, err := rest.InClusterConfig()</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                        klog.Fatal(&#34;Error creating in-cluster client configuration:&#34;, err)</pre></code></td></tr><tr><td>75</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>                return config</pre></code></td></tr><tr><td>77</td><td><code><pre>        }</pre></code></td></tr><tr><td>78</td><td><code><pre></pre></code></td></tr><tr><td>79</td><td><code><pre>        // use the current context in kubeconfig</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>        config, err := clientcmd.BuildConfigFromFlags(&#34;&#34;, *kubeConfigFile)</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>                klog.Fatal(&#34;error creating client configuration:&#34;, err)</pre></code></td></tr><tr><td>83</td><td><code><pre>        }</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>        return config</pre></code></td></tr><tr><td>86</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/cmd/appgw-ingress DONE:13.99
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/functional_tests" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/functional_tests <span class="packageTotal">100.00%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/functional_tests</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/functional_tests | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_check"><td><code><a href="#fn_check">check(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/functional_tests/helpers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>28/28</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/functional_tests</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>28/28</code></td></tr>
</table>

<div class="funcname" id="fn_check">func check</div><div class="info"><a href="#s_fn_check">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/functional_tests/helpers.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func check(cbCtx *appgw.ConfigBuilderContext, expectedFilename string, stopChan chan struct{}, ctxt *k8scontext.Context, configBuilder appgw.ConfigBuilder) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        // Start the informers. This will sync the cache with the latest ingress.</pre></code></td></tr><tr><td>23</td><td><code><pre>        err := ctxt.Run(stopChan, true, environment.GetFakeEnv())</pre></code></td></tr><tr><td>24</td><td><code><pre>        gomega.Expect(err).ToNot(gomega.HaveOccurred())</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr><td>26</td><td><code><pre>        appGW, err := configBuilder.Build(cbCtx)</pre></code></td></tr><tr><td>27</td><td><code><pre>        gomega.Expect(err).ToNot(gomega.HaveOccurred())</pre></code></td></tr><tr><td>28</td><td><code><pre></pre></code></td></tr><tr><td>29</td><td><code><pre>        if appGW.SslCertificates != nil {</pre></code></td></tr><tr><td>30</td><td><code><pre>                for idx := range *appGW.SslCertificates {</pre></code></td></tr><tr><td>31</td><td><code><pre>                        if (*appGW.SslCertificates)[idx].Data != nil {</pre></code></td></tr><tr><td>32</td><td><code><pre>                                *(*appGW.SslCertificates)[idx].Data = &#34;xx&#34;</pre></code></td></tr><tr><td>33</td><td><code><pre>                        }</pre></code></td></tr><tr><td>34</td><td><code><pre>                }</pre></code></td></tr><tr><td>35</td><td><code><pre>        }</pre></code></td></tr><tr><td>36</td><td><code><pre></pre></code></td></tr><tr><td>37</td><td><code><pre>        jsonBlob, err := appGW.MarshalJSON()</pre></code></td></tr><tr><td>38</td><td><code><pre>        gomega.Expect(err).ToNot(gomega.HaveOccurred())</pre></code></td></tr><tr><td>39</td><td><code><pre></pre></code></td></tr><tr><td>40</td><td><code><pre>        var into map[string]interface{}</pre></code></td></tr><tr><td>41</td><td><code><pre>        err = json.Unmarshal(jsonBlob, &amp;into)</pre></code></td></tr><tr><td>42</td><td><code><pre>        gomega.Expect(err).ToNot(gomega.HaveOccurred())</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr><td>44</td><td><code><pre>        jsonBlob, err = json.MarshalIndent(into, &#34;&#34;, &#34;    &#34;)</pre></code></td></tr><tr><td>45</td><td><code><pre>        gomega.Expect(err).ToNot(gomega.HaveOccurred())</pre></code></td></tr><tr><td>46</td><td><code><pre></pre></code></td></tr><tr><td>47</td><td><code><pre>        actualJSONTxt := string(jsonBlob)</pre></code></td></tr><tr><td>48</td><td><code><pre></pre></code></td></tr><tr><td>49</td><td><code><pre>        // Repair tests</pre></code></td></tr><tr><td>50</td><td><code><pre>        // ioutil.WriteFile(expectedFilename, []byte(actualJSONTxt), 0644)</pre></code></td></tr><tr><td>51</td><td><code><pre></pre></code></td></tr><tr><td>52</td><td><code><pre>        expectedBytes, err := ioutil.ReadFile(expectedFilename)</pre></code></td></tr><tr><td>53</td><td><code><pre>        expectedJSON := strings.Trim(string(expectedBytes), &#34;\n&#34;)</pre></code></td></tr><tr><td>54</td><td><code><pre>        gomega.Expect(err).ToNot(gomega.HaveOccurred())</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>        linesAct := strings.Split(actualJSONTxt, &#34;\n&#34;)</pre></code></td></tr><tr><td>57</td><td><code><pre>        linesExp := strings.Split(expectedJSON, &#34;\n&#34;)</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>        msg := fmt.Sprintf(&#34;Line counts are different: %d vs %d\nActual:\n%s\nExpected:\n%s\nfile: %s&#34;, len(linesAct), len(linesExp), actualJSONTxt, expectedJSON, expectedFilename)</pre></code></td></tr><tr><td>60</td><td><code><pre>        gomega.Expect(len(linesAct)).To(gomega.Equal(len(linesExp)), msg)</pre></code></td></tr><tr><td>61</td><td><code><pre></pre></code></td></tr><tr><td>62</td><td><code><pre>        for idx, line := range linesAct {</pre></code></td></tr><tr><td>63</td><td><code><pre>                curatedLineAct := strings.Trim(line, &#34; &#34;)</pre></code></td></tr><tr><td>64</td><td><code><pre>                curatedLineExp := strings.Trim(linesExp[idx], &#34; &#34;)</pre></code></td></tr><tr><td>65</td><td><code><pre>                msg := fmt.Sprintf(&#34;Lines at index %d are different:\n%s\nvs expectedJSON:\n%s\nActual JSON:\n%s\nfrom file %s&#34;, idx, curatedLineAct, curatedLineExp, actualJSONTxt, expectedFilename)</pre></code></td></tr><tr><td>66</td><td><code><pre>                gomega.Expect(curatedLineAct).To(gomega.Equal(curatedLineExp), msg)</pre></code></td></tr><tr><td>67</td><td><code><pre>        }</pre></code></td></tr><tr><td>68</td><td><code><pre></pre></code></td></tr><tr><td>69</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/functional_tests DONE:100.00
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests <span class="packageTotal">78.38%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_StripNonDeterministic"><td><code><a href="#fn_StripNonDeterministic">StripNonDeterministic(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_@141:3"><td><code><a href="#fn_@141:3">@141:3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>87.50%</code></td><td class="linecount"><code>14/16</code></td></tr>
<tr id="s_fn_@101:28"><td><code><a href="#fn_@101:28">@101:28(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>84.21%</code></td><td class="linecount"><code>16/19</code></td></tr>
<tr id="s_fn_RenderChart"><td><code><a href="#fn_RenderChart">RenderChart(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>8/10</code></td></tr>
<tr id="s_fn_LoadSnapshot"><td><code><a href="#fn_LoadSnapshot">LoadSnapshot(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>4/5</code></td></tr>
<tr id="s_fn_CaptureSnapshot"><td><code><a href="#fn_CaptureSnapshot">CaptureSnapshot(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>71.43%</code></td><td class="linecount"><code>5/7</code></td></tr>
<tr id="s_fn_Snapshot.Diff"><td><code><a href="#fn_Snapshot.Diff">Snapshot.Diff(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>8/12</code></td></tr>
<tr id="s_fn_@81:8"><td><code><a href="#fn_@81:8">@81:8(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>2/3</code></td></tr>
<tr id="s_fn_HelmError.Error"><td><code><a href="#fn_HelmError.Error">HelmError.Error(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests</code></td><td class="percent"><code>78.38%</code></td><td class="linecount"><code>58/74</code></td></tr>
</table>

<div class="funcname" id="fn_StripNonDeterministic">func StripNonDeterministic</div><div class="info"><a href="#s_fn_StripNonDeterministic">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>139</td><td><code><pre>func StripNonDeterministic(path string) error {</pre></code></td></tr><tr><td>140</td><td><code><pre>        return filepath.Walk(path,</pre></code></td></tr><tr><td>141</td><td><code><pre>                func(path string, info os.FileInfo, err error) error {</pre></code></td></tr><tr><td>142</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr><td>143</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>144</td><td><code><pre>                        }</pre></code></td></tr><tr><td>145</td><td><code><pre>                        if info.IsDir() || !strings.HasSuffix(info.Name(), &#34;.yaml&#34;) {</pre></code></td></tr><tr><td>146</td><td><code><pre>                                return nil</pre></code></td></tr><tr><td>147</td><td><code><pre>                        }</pre></code></td></tr><tr><td>148</td><td><code><pre></pre></code></td></tr><tr><td>149</td><td><code><pre>                        file, err := os.Open(path)</pre></code></td></tr><tr><td>150</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr><td>151</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>152</td><td><code><pre>                        }</pre></code></td></tr><tr><td>153</td><td><code><pre>                        defer file.Close()</pre></code></td></tr><tr><td>154</td><td><code><pre></pre></code></td></tr><tr><td>155</td><td><code><pre>                        lines := []string{}</pre></code></td></tr><tr><td>156</td><td><code><pre>                        scanner := bufio.NewScanner(file)</pre></code></td></tr><tr><td>157</td><td><code><pre>                        for scanner.Scan() {</pre></code></td></tr><tr><td>158</td><td><code><pre>                                text := scanner.Text()</pre></code></td></tr><tr><td>159</td><td><code><pre>                                if strings.Contains(text, &#34;checksum/&#34;) ||</pre></code></td></tr><tr><td>160</td><td><code><pre>                                        strings.Contains(text, &#34;aks.microsoft.com/release-time&#34;) {</pre></code></td></tr><tr><td>161</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>162</td><td><code><pre>                                }</pre></code></td></tr><tr><td>163</td><td><code><pre>                                lines = append(lines, text)</pre></code></td></tr><tr><td>164</td><td><code><pre>                        }</pre></code></td></tr><tr><td>165</td><td><code><pre></pre></code></td></tr><tr><td>166</td><td><code><pre>                        return ioutil.WriteFile(path, []byte(strings.Join(lines, &#34;\n&#34;)), 0644)</pre></code></td></tr><tr><td>167</td><td><code><pre>                })</pre></code></td></tr><tr><td>168</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@141:3">func @141:3</div><div class="info"><a href="#s_fn_@141:3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>141</td><td><code><pre>func(path string, info os.FileInfo, err error) error {</pre></code></td></tr><tr><td>142</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>144</td><td><code><pre>                        }</pre></code></td></tr><tr><td>145</td><td><code><pre>                        if info.IsDir() || !strings.HasSuffix(info.Name(), &#34;.yaml&#34;) {</pre></code></td></tr><tr><td>146</td><td><code><pre>                                return nil</pre></code></td></tr><tr><td>147</td><td><code><pre>                        }</pre></code></td></tr><tr><td>148</td><td><code><pre></pre></code></td></tr><tr><td>149</td><td><code><pre>                        file, err := os.Open(path)</pre></code></td></tr><tr><td>150</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>151</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>152</td><td><code><pre>                        }</pre></code></td></tr><tr><td>153</td><td><code><pre>                        defer file.Close()</pre></code></td></tr><tr><td>154</td><td><code><pre></pre></code></td></tr><tr><td>155</td><td><code><pre>                        lines := []string{}</pre></code></td></tr><tr><td>156</td><td><code><pre>                        scanner := bufio.NewScanner(file)</pre></code></td></tr><tr><td>157</td><td><code><pre>                        for scanner.Scan() {</pre></code></td></tr><tr><td>158</td><td><code><pre>                                text := scanner.Text()</pre></code></td></tr><tr><td>159</td><td><code><pre>                                if strings.Contains(text, &#34;checksum/&#34;) ||</pre></code></td></tr><tr><td>160</td><td><code><pre>                                        strings.Contains(text, &#34;aks.microsoft.com/release-time&#34;) {</pre></code></td></tr><tr><td>161</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>162</td><td><code><pre>                                }</pre></code></td></tr><tr><td>163</td><td><code><pre>                                lines = append(lines, text)</pre></code></td></tr><tr><td>164</td><td><code><pre>                        }</pre></code></td></tr><tr><td>165</td><td><code><pre></pre></code></td></tr><tr><td>166</td><td><code><pre>                        return ioutil.WriteFile(path, []byte(strings.Join(lines, &#34;\n&#34;)), 0644)</pre></code></td></tr><tr><td>167</td><td><code><pre>                }</pre></code></td></tr></table>

<div class="funcname" id="fn_@101:28">func @101:28</div><div class="info"><a href="#s_fn_@101:28">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>101</td><td><code><pre>func(path string, info os.FileInfo, err error) error {</pre></code></td></tr><tr><td>102</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>                        return err</pre></code></td></tr><tr><td>104</td><td><code><pre>                }</pre></code></td></tr><tr><td>105</td><td><code><pre>                if info.IsDir() {</pre></code></td></tr><tr><td>106</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>107</td><td><code><pre>                }</pre></code></td></tr><tr><td>108</td><td><code><pre></pre></code></td></tr><tr><td>109</td><td><code><pre>                file, err := os.Open(path)</pre></code></td></tr><tr><td>110</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                        return fmt.Errorf(&#34;opening file %q: %v&#34;, path, err)</pre></code></td></tr><tr><td>112</td><td><code><pre>                }</pre></code></td></tr><tr><td>113</td><td><code><pre>                defer file.Close()</pre></code></td></tr><tr><td>114</td><td><code><pre>                shortPath := strings.TrimPrefix(path, dir+&#34;/&#34;)</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>                dec := yaml.NewDecoder(file)</pre></code></td></tr><tr><td>117</td><td><code><pre>                for {</pre></code></td></tr><tr><td>118</td><td><code><pre>                        obj := map[interface{}]interface{}{}</pre></code></td></tr><tr><td>119</td><td><code><pre>                        err = dec.Decode(&amp;obj)</pre></code></td></tr><tr><td>120</td><td><code><pre>                        if err == io.EOF {</pre></code></td></tr><tr><td>121</td><td><code><pre>                                break</pre></code></td></tr><tr><td>122</td><td><code><pre>                        }</pre></code></td></tr><tr><td>123</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>124</td><td><code><pre>                                return fmt.Errorf(&#34;parsing file %q: %v&#34;, shortPath, err)</pre></code></td></tr><tr><td>125</td><td><code><pre>                        }</pre></code></td></tr><tr><td>126</td><td><code><pre>                        s.files[shortPath] = append(s.files[shortPath], obj)</pre></code></td></tr><tr><td>127</td><td><code><pre>                }</pre></code></td></tr><tr><td>128</td><td><code><pre></pre></code></td></tr><tr><td>129</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>130</td><td><code><pre>        }</pre></code></td></tr></table>

<div class="funcname" id="fn_RenderChart">func RenderChart</div><div class="info"><a href="#s_fn_RenderChart">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func RenderChart(chart, values, dir string) error {</pre></code></td></tr><tr><td>54</td><td><code><pre>        err := os.MkdirAll(dir, 0755)</pre></code></td></tr><tr><td>55</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                return fmt.Errorf(&#34;unable to create output dir %q: %v&#34;, dir, err)</pre></code></td></tr><tr><td>57</td><td><code><pre>        }</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>        helmCmdFile := os.Getenv(&#34;HELM_CMD&#34;)</pre></code></td></tr><tr><td>60</td><td><code><pre>        if helmCmdFile == &#34;&#34; {</pre></code></td></tr><tr><td>61</td><td><code><pre>                helmCmdFile = &#34;helm&#34;</pre></code></td></tr><tr><td>62</td><td><code><pre>        }</pre></code></td></tr><tr><td>63</td><td><code><pre>        out, err := exec.Command(helmCmdFile, &#34;template&#34;, &#34;..&#34;, &#34;--output-dir&#34;, dir, &#34;--values&#34;, values).CombinedOutput()</pre></code></td></tr><tr><td>64</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>                return &amp;HelmError{</pre></code></td></tr><tr><td>66</td><td><code><pre>                        RawOutput:    out,</pre></code></td></tr><tr><td>67</td><td><code><pre>                        CommandError: err,</pre></code></td></tr><tr><td>68</td><td><code><pre>                }</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr><td>70</td><td><code><pre></pre></code></td></tr><tr><td>71</td><td><code><pre>        return StripNonDeterministic(dir)</pre></code></td></tr><tr><td>72</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LoadSnapshot">func LoadSnapshot</div><div class="info"><a href="#s_fn_LoadSnapshot">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>97</td><td><code><pre>func LoadSnapshot(dir string) (*Snapshot, error) {</pre></code></td></tr><tr><td>98</td><td><code><pre>        s := &amp;Snapshot{</pre></code></td></tr><tr><td>99</td><td><code><pre>                files: map[string][]map[interface{}]interface{}{},</pre></code></td></tr><tr><td>100</td><td><code><pre>        }</pre></code></td></tr><tr><td>101</td><td><code><pre>        err := filepath.Walk(dir, func(path string, info os.FileInfo, err error) error {</pre></code></td></tr><tr><td>102</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr><td>103</td><td><code><pre>                        return err</pre></code></td></tr><tr><td>104</td><td><code><pre>                }</pre></code></td></tr><tr><td>105</td><td><code><pre>                if info.IsDir() {</pre></code></td></tr><tr><td>106</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>107</td><td><code><pre>                }</pre></code></td></tr><tr><td>108</td><td><code><pre></pre></code></td></tr><tr><td>109</td><td><code><pre>                file, err := os.Open(path)</pre></code></td></tr><tr><td>110</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr><td>111</td><td><code><pre>                        return fmt.Errorf(&#34;opening file %q: %v&#34;, path, err)</pre></code></td></tr><tr><td>112</td><td><code><pre>                }</pre></code></td></tr><tr><td>113</td><td><code><pre>                defer file.Close()</pre></code></td></tr><tr><td>114</td><td><code><pre>                shortPath := strings.TrimPrefix(path, dir+&#34;/&#34;)</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>                dec := yaml.NewDecoder(file)</pre></code></td></tr><tr><td>117</td><td><code><pre>                for {</pre></code></td></tr><tr><td>118</td><td><code><pre>                        obj := map[interface{}]interface{}{}</pre></code></td></tr><tr><td>119</td><td><code><pre>                        err = dec.Decode(&amp;obj)</pre></code></td></tr><tr><td>120</td><td><code><pre>                        if err == io.EOF {</pre></code></td></tr><tr><td>121</td><td><code><pre>                                break</pre></code></td></tr><tr><td>122</td><td><code><pre>                        }</pre></code></td></tr><tr><td>123</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr><td>124</td><td><code><pre>                                return fmt.Errorf(&#34;parsing file %q: %v&#34;, shortPath, err)</pre></code></td></tr><tr><td>125</td><td><code><pre>                        }</pre></code></td></tr><tr><td>126</td><td><code><pre>                        s.files[shortPath] = append(s.files[shortPath], obj)</pre></code></td></tr><tr><td>127</td><td><code><pre>                }</pre></code></td></tr><tr><td>128</td><td><code><pre></pre></code></td></tr><tr><td>129</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>130</td><td><code><pre>        })</pre></code></td></tr><tr><td>131</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>132</td><td><code><pre>                return nil, fmt.Errorf(&#34;walking rendered chart: %v&#34;, err)</pre></code></td></tr><tr><td>133</td><td><code><pre>        }</pre></code></td></tr><tr><td>134</td><td><code><pre></pre></code></td></tr><tr><td>135</td><td><code><pre>        return s, nil</pre></code></td></tr><tr><td>136</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_CaptureSnapshot">func CaptureSnapshot</div><div class="info"><a href="#s_fn_CaptureSnapshot">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>75</td><td><code><pre>func CaptureSnapshot(chart, values string) (*Snapshot, error) {</pre></code></td></tr><tr><td>76</td><td><code><pre>        dir, err := ioutil.TempDir(&#34;&#34;, &#34;&#34;)</pre></code></td></tr><tr><td>77</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>                return nil, fmt.Errorf(&#34;creating tempdir: %v&#34;, err)</pre></code></td></tr><tr><td>79</td><td><code><pre>        }</pre></code></td></tr><tr><td>80</td><td><code><pre></pre></code></td></tr><tr><td>81</td><td><code><pre>        defer func() {</pre></code></td></tr><tr><td>82</td><td><code><pre>                err := os.RemoveAll(dir)</pre></code></td></tr><tr><td>83</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr><td>84</td><td><code><pre>                        panic(fmt.Errorf(&#34;unable to clean up tempdir for chart %q with values %q: %v&#34;, chart, values, err))</pre></code></td></tr><tr><td>85</td><td><code><pre>                }</pre></code></td></tr><tr><td>86</td><td><code><pre>        }()</pre></code></td></tr><tr><td>87</td><td><code><pre></pre></code></td></tr><tr><td>88</td><td><code><pre>        if err := RenderChart(chart, values, dir); err != nil {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>90</td><td><code><pre>        }</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr><td>92</td><td><code><pre>        return LoadSnapshot(dir)</pre></code></td></tr><tr><td>93</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Snapshot.Diff">func Snapshot.Diff</div><div class="info"><a href="#s_fn_Snapshot.Diff">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>29</td><td><code><pre>func (s *Snapshot) Diff(t *testing.T, expected *Snapshot) {</pre></code></td></tr><tr><td>30</td><td><code><pre>        for file, parsedFile := range s.files {</pre></code></td></tr><tr><td>31</td><td><code><pre>                parsedExpFile, ok := expected.files[file]</pre></code></td></tr><tr><td>32</td><td><code><pre>                if !ok {</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                        t.Errorf(&#34;missing manifest: %s&#34;, file)</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>35</td><td><code><pre>                }</pre></code></td></tr><tr><td>36</td><td><code><pre></pre></code></td></tr><tr><td>37</td><td><code><pre>                diff := pretty.Compare(parsedFile, parsedExpFile)</pre></code></td></tr><tr><td>38</td><td><code><pre>                if len(diff) == 0 {</pre></code></td></tr><tr><td>39</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>40</td><td><code><pre>                }</pre></code></td></tr><tr><td>41</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                t.Errorf(&#34;file %q doesn&#39;t match expectation\n%s&#34;, file, diff)</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr><td>45</td><td><code><pre>        for expFile := range expected.files {</pre></code></td></tr><tr><td>46</td><td><code><pre>                if _, ok := s.files[expFile]; !ok {</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                        t.Errorf(&#34;expected snapshot has file missing in actual: %s&#34;, expFile)</pre></code></td></tr><tr><td>48</td><td><code><pre>                }</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@81:8">func @81:8</div><div class="info"><a href="#s_fn_@81:8">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>81</td><td><code><pre>func() {</pre></code></td></tr><tr><td>82</td><td><code><pre>                err := os.RemoveAll(dir)</pre></code></td></tr><tr><td>83</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>                        panic(fmt.Errorf(&#34;unable to clean up tempdir for chart %q with values %q: %v&#34;, chart, values, err))</pre></code></td></tr><tr><td>85</td><td><code><pre>                }</pre></code></td></tr><tr><td>86</td><td><code><pre>        }</pre></code></td></tr></table>

<div class="funcname" id="fn_HelmError.Error">func HelmError.Error</div><div class="info"><a href="#s_fn_HelmError.Error">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/helm/ingress-azure/tests/snapshots.go</code>:</p></div><table class="listing">
<tr><td>177</td><td><code><pre>func (h *HelmError) Error() string {</pre></code></td></tr><tr class="miss"><td>178</td><td><code><pre>        return fmt.Sprintf(&#34;Helm CLI error: %q - raw output:\n%s&#34;, h.CommandError.Error(), h.RawOutput)</pre></code></td></tr><tr><td>179</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/helm/ingress-azure/tests DONE:78.38
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations <span class="packageTotal">80.65%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_GetHostNameExtensions"><td><code><a href="#fn_GetHostNameExtensions">GetHostNameExtensions(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>9/9</code></td></tr>
<tr id="s_fn_HealthProbeStatusCodes"><td><code><a href="#fn_HealthProbeStatusCodes">HealthProbeStatusCodes(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_parseBool"><td><code><a href="#fn_parseBool">parseBool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_parseInt32"><td><code><a href="#fn_parseInt32">parseInt32(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_parseString"><td><code><a href="#fn_parseString">parseString(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_RequestTimeout"><td><code><a href="#fn_RequestTimeout">RequestTimeout(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_HealthProbePort"><td><code><a href="#fn_HealthProbePort">HealthProbePort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_HealthProbePath"><td><code><a href="#fn_HealthProbePath">HealthProbePath(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_HealthProbeHostName"><td><code><a href="#fn_HealthProbeHostName">HealthProbeHostName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_HealthProbeInterval"><td><code><a href="#fn_HealthProbeInterval">HealthProbeInterval(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_HealthProbeTimeout"><td><code><a href="#fn_HealthProbeTimeout">HealthProbeTimeout(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_HealthProbeUnhealthyThreshold"><td><code><a href="#fn_HealthProbeUnhealthyThreshold">HealthProbeUnhealthyThreshold(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetAppGwSslCertificate"><td><code><a href="#fn_GetAppGwSslCertificate">GetAppGwSslCertificate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetAppGwTrustedRootCertificate"><td><code><a href="#fn_GetAppGwTrustedRootCertificate">GetAppGwTrustedRootCertificate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetAppGwSslProfile"><td><code><a href="#fn_GetAppGwSslProfile">GetAppGwSslProfile(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_BackendHostName"><td><code><a href="#fn_BackendHostName">BackendHostName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_IsConnectionDraining"><td><code><a href="#fn_IsConnectionDraining">IsConnectionDraining(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_ConnectionDrainingTimeout"><td><code><a href="#fn_ConnectionDrainingTimeout">ConnectionDrainingTimeout(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_IsCookieBasedAffinity"><td><code><a href="#fn_IsCookieBasedAffinity">IsCookieBasedAffinity(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_IsCookieBasedAffinityDistinctName"><td><code><a href="#fn_IsCookieBasedAffinityDistinctName">IsCookieBasedAffinityDistinctName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_UsePrivateIP"><td><code><a href="#fn_UsePrivateIP">UsePrivateIP(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_OverrideFrontendPort"><td><code><a href="#fn_OverrideFrontendPort">OverrideFrontendPort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_BackendPathPrefix"><td><code><a href="#fn_BackendPathPrefix">BackendPathPrefix(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_IsSslRedirect"><td><code><a href="#fn_IsSslRedirect">IsSslRedirect(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_RewriteRuleSetCustomResource"><td><code><a href="#fn_RewriteRuleSetCustomResource">RewriteRuleSetCustomResource(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_RewriteRuleSet"><td><code><a href="#fn_RewriteRuleSet">RewriteRuleSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_BackendProtocol"><td><code><a href="#fn_BackendProtocol">BackendProtocol(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_IstioGatewayIngressClass"><td><code><a href="#fn_IstioGatewayIngressClass">IstioGatewayIngressClass(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_WAFPolicy"><td><code><a href="#fn_WAFPolicy">WAFPolicy(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_IngressClass"><td><code><a href="#fn_IngressClass">IngressClass(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations</code></td><td class="percent"><code>80.65%</code></td><td class="linecount"><code>50/62</code></td></tr>
</table>

<div class="funcname" id="fn_GetHostNameExtensions">func GetHostNameExtensions</div><div class="info"><a href="#s_fn_GetHostNameExtensions">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>274</td><td><code><pre>func GetHostNameExtensions(ing *networking.Ingress) ([]string, error) {</pre></code></td></tr><tr><td>275</td><td><code><pre>        val, err := parseString(ing, HostNameExtensionKey)</pre></code></td></tr><tr><td>276</td><td><code><pre>        if err == nil {</pre></code></td></tr><tr><td>277</td><td><code><pre>                var hostnames []string</pre></code></td></tr><tr><td>278</td><td><code><pre>                for _, hostname := range strings.Split(val, &#34;,&#34;) {</pre></code></td></tr><tr><td>279</td><td><code><pre>                        trimmed := strings.TrimSpace(hostname)</pre></code></td></tr><tr><td>280</td><td><code><pre>                        if len(trimmed) &gt; 0 {</pre></code></td></tr><tr><td>281</td><td><code><pre>                                hostnames = append(hostnames, trimmed)</pre></code></td></tr><tr><td>282</td><td><code><pre>                        }</pre></code></td></tr><tr><td>283</td><td><code><pre>                }</pre></code></td></tr><tr><td>284</td><td><code><pre></pre></code></td></tr><tr><td>285</td><td><code><pre>                return hostnames, nil</pre></code></td></tr><tr><td>286</td><td><code><pre>        }</pre></code></td></tr><tr><td>287</td><td><code><pre></pre></code></td></tr><tr><td>288</td><td><code><pre>        return nil, err</pre></code></td></tr><tr><td>289</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbeStatusCodes">func HealthProbeStatusCodes</div><div class="info"><a href="#s_fn_HealthProbeStatusCodes">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>179</td><td><code><pre>func HealthProbeStatusCodes(ing *networking.Ingress) ([]string, error) {</pre></code></td></tr><tr><td>180</td><td><code><pre>        value, err := parseString(ing, HealthProbeStatusCodesKey)</pre></code></td></tr><tr><td>181</td><td><code><pre>        if value != &#34;&#34; {</pre></code></td></tr><tr><td>182</td><td><code><pre>                codesArray := strings.Split(value, &#34;,&#34;)</pre></code></td></tr><tr><td>183</td><td><code><pre>                for index, element := range codesArray {</pre></code></td></tr><tr><td>184</td><td><code><pre>                        codesArray[index] = strings.TrimSpace(element)</pre></code></td></tr><tr><td>185</td><td><code><pre>                }</pre></code></td></tr><tr><td>186</td><td><code><pre>                return codesArray, err</pre></code></td></tr><tr><td>187</td><td><code><pre>        }</pre></code></td></tr><tr><td>188</td><td><code><pre></pre></code></td></tr><tr><td>189</td><td><code><pre>        return nil, err</pre></code></td></tr><tr><td>190</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_parseBool">func parseBool</div><div class="info"><a href="#s_fn_parseBool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>306</td><td><code><pre>func parseBool(ing *networking.Ingress, name string) (bool, error) {</pre></code></td></tr><tr><td>307</td><td><code><pre>        if val, ok := ing.Annotations[name]; ok {</pre></code></td></tr><tr><td>308</td><td><code><pre>                if boolVal, err := strconv.ParseBool(val); err == nil {</pre></code></td></tr><tr><td>309</td><td><code><pre>                        return boolVal, nil</pre></code></td></tr><tr><td>310</td><td><code><pre>                }</pre></code></td></tr><tr><td>311</td><td><code><pre>                return false, controllererrors.NewErrorf(controllererrors.ErrorInvalidContent,</pre></code></td></tr><tr><td>312</td><td><code><pre>                        &#34;annotation %v does not contain a valid value (%v)&#34;, name, val,</pre></code></td></tr><tr><td>313</td><td><code><pre>                )</pre></code></td></tr><tr><td>314</td><td><code><pre>        }</pre></code></td></tr><tr><td>315</td><td><code><pre>        return false, controllererrors.NewErrorf(</pre></code></td></tr><tr><td>316</td><td><code><pre>                controllererrors.ErrorMissingAnnotation,</pre></code></td></tr><tr><td>317</td><td><code><pre>                &#34;%s is not set in Ingress %s/%s&#34;, name, ing.Namespace, ing.Name,</pre></code></td></tr><tr><td>318</td><td><code><pre>        )</pre></code></td></tr><tr><td>319</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_parseInt32">func parseInt32</div><div class="info"><a href="#s_fn_parseInt32">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>331</td><td><code><pre>func parseInt32(ing *networking.Ingress, name string) (int32, error) {</pre></code></td></tr><tr><td>332</td><td><code><pre>        if val, ok := ing.Annotations[name]; ok {</pre></code></td></tr><tr><td>333</td><td><code><pre>                if intVal, err := strconv.Atoi(val); err == nil {</pre></code></td></tr><tr><td>334</td><td><code><pre>                        return int32(intVal), nil</pre></code></td></tr><tr><td>335</td><td><code><pre>                }</pre></code></td></tr><tr><td>336</td><td><code><pre>                return 0, controllererrors.NewErrorf(controllererrors.ErrorInvalidContent,</pre></code></td></tr><tr><td>337</td><td><code><pre>                        &#34;annotation %v does not contain a valid value (%v)&#34;, name, val,</pre></code></td></tr><tr><td>338</td><td><code><pre>                )</pre></code></td></tr><tr><td>339</td><td><code><pre>        }</pre></code></td></tr><tr><td>340</td><td><code><pre></pre></code></td></tr><tr><td>341</td><td><code><pre>        return 0, controllererrors.NewErrorf(</pre></code></td></tr><tr><td>342</td><td><code><pre>                controllererrors.ErrorMissingAnnotation,</pre></code></td></tr><tr><td>343</td><td><code><pre>                &#34;%s is not set in Ingress %s/%s&#34;, name, ing.Namespace, ing.Name,</pre></code></td></tr><tr><td>344</td><td><code><pre>        )</pre></code></td></tr><tr><td>345</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_parseString">func parseString</div><div class="info"><a href="#s_fn_parseString">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>321</td><td><code><pre>func parseString(ing *networking.Ingress, name string) (string, error) {</pre></code></td></tr><tr><td>322</td><td><code><pre>        if val, ok := ing.Annotations[name]; ok {</pre></code></td></tr><tr><td>323</td><td><code><pre>                return val, nil</pre></code></td></tr><tr><td>324</td><td><code><pre>        }</pre></code></td></tr><tr><td>325</td><td><code><pre>        return &#34;&#34;, controllererrors.NewErrorf(</pre></code></td></tr><tr><td>326</td><td><code><pre>                controllererrors.ErrorMissingAnnotation,</pre></code></td></tr><tr><td>327</td><td><code><pre>                &#34;%s is not set in Ingress %s/%s&#34;, name, ing.Namespace, ing.Name,</pre></code></td></tr><tr><td>328</td><td><code><pre>        )</pre></code></td></tr><tr><td>329</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_RequestTimeout">func RequestTimeout</div><div class="info"><a href="#s_fn_RequestTimeout">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>223</td><td><code><pre>func RequestTimeout(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>224</td><td><code><pre>        return parseInt32(ing, RequestTimeoutKey)</pre></code></td></tr><tr><td>225</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbePort">func HealthProbePort</div><div class="info"><a href="#s_fn_HealthProbePort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>169</td><td><code><pre>func HealthProbePort(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>170</td><td><code><pre>        return parseInt32(ing, HealthProbePortKey)</pre></code></td></tr><tr><td>171</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbePath">func HealthProbePath</div><div class="info"><a href="#s_fn_HealthProbePath">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>174</td><td><code><pre>func HealthProbePath(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>175</td><td><code><pre>        return parseString(ing, HealthProbePathKey)</pre></code></td></tr><tr><td>176</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbeHostName">func HealthProbeHostName</div><div class="info"><a href="#s_fn_HealthProbeHostName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>164</td><td><code><pre>func HealthProbeHostName(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>165</td><td><code><pre>        return parseString(ing, HealthProbeHostKey)</pre></code></td></tr><tr><td>166</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbeInterval">func HealthProbeInterval</div><div class="info"><a href="#s_fn_HealthProbeInterval">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>193</td><td><code><pre>func HealthProbeInterval(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>194</td><td><code><pre>        return parseInt32(ing, HealthProbeIntervalKey)</pre></code></td></tr><tr><td>195</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbeTimeout">func HealthProbeTimeout</div><div class="info"><a href="#s_fn_HealthProbeTimeout">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>198</td><td><code><pre>func HealthProbeTimeout(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>199</td><td><code><pre>        return parseInt32(ing, HealthProbeTimeoutKey)</pre></code></td></tr><tr><td>200</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_HealthProbeUnhealthyThreshold">func HealthProbeUnhealthyThreshold</div><div class="info"><a href="#s_fn_HealthProbeUnhealthyThreshold">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>203</td><td><code><pre>func HealthProbeUnhealthyThreshold(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>204</td><td><code><pre>        return parseInt32(ing, HealthProbeUnhealthyThresholdKey)</pre></code></td></tr><tr><td>205</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAppGwSslCertificate">func GetAppGwSslCertificate</div><div class="info"><a href="#s_fn_GetAppGwSslCertificate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>208</td><td><code><pre>func GetAppGwSslCertificate(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>209</td><td><code><pre>        return parseString(ing, AppGwSslCertificate)</pre></code></td></tr><tr><td>210</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAppGwTrustedRootCertificate">func GetAppGwTrustedRootCertificate</div><div class="info"><a href="#s_fn_GetAppGwTrustedRootCertificate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>213</td><td><code><pre>func GetAppGwTrustedRootCertificate(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>214</td><td><code><pre>        return parseString(ing, AppGwTrustedRootCertificate)</pre></code></td></tr><tr><td>215</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAppGwSslProfile">func GetAppGwSslProfile</div><div class="info"><a href="#s_fn_GetAppGwSslProfile">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>218</td><td><code><pre>func GetAppGwSslProfile(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>219</td><td><code><pre>        return parseString(ing, AppGwSslProfile)</pre></code></td></tr><tr><td>220</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_BackendHostName">func BackendHostName</div><div class="info"><a href="#s_fn_BackendHostName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>159</td><td><code><pre>func BackendHostName(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>160</td><td><code><pre>        return parseString(ing, BackendHostNameKey)</pre></code></td></tr><tr><td>161</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IsConnectionDraining">func IsConnectionDraining</div><div class="info"><a href="#s_fn_IsConnectionDraining">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>228</td><td><code><pre>func IsConnectionDraining(ing *networking.Ingress) (bool, error) {</pre></code></td></tr><tr><td>229</td><td><code><pre>        return parseBool(ing, ConnectionDrainingKey)</pre></code></td></tr><tr><td>230</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ConnectionDrainingTimeout">func ConnectionDrainingTimeout</div><div class="info"><a href="#s_fn_ConnectionDrainingTimeout">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>233</td><td><code><pre>func ConnectionDrainingTimeout(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>234</td><td><code><pre>        return parseInt32(ing, ConnectionDrainingTimeoutKey)</pre></code></td></tr><tr><td>235</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IsCookieBasedAffinity">func IsCookieBasedAffinity</div><div class="info"><a href="#s_fn_IsCookieBasedAffinity">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>238</td><td><code><pre>func IsCookieBasedAffinity(ing *networking.Ingress) (bool, error) {</pre></code></td></tr><tr><td>239</td><td><code><pre>        return parseBool(ing, CookieBasedAffinityKey)</pre></code></td></tr><tr><td>240</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IsCookieBasedAffinityDistinctName">func IsCookieBasedAffinityDistinctName</div><div class="info"><a href="#s_fn_IsCookieBasedAffinityDistinctName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>243</td><td><code><pre>func IsCookieBasedAffinityDistinctName(ing *networking.Ingress) (bool, error) {</pre></code></td></tr><tr><td>244</td><td><code><pre>        return parseBool(ing, CookieBasedAffinityDistinctNameKey)</pre></code></td></tr><tr><td>245</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_UsePrivateIP">func UsePrivateIP</div><div class="info"><a href="#s_fn_UsePrivateIP">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>248</td><td><code><pre>func UsePrivateIP(ing *networking.Ingress) (bool, error) {</pre></code></td></tr><tr><td>249</td><td><code><pre>        return parseBool(ing, UsePrivateIPKey)</pre></code></td></tr><tr><td>250</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_OverrideFrontendPort">func OverrideFrontendPort</div><div class="info"><a href="#s_fn_OverrideFrontendPort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>253</td><td><code><pre>func OverrideFrontendPort(ing *networking.Ingress) (int32, error) {</pre></code></td></tr><tr><td>254</td><td><code><pre>        return parseInt32(ing, OverrideFrontendPortKey)</pre></code></td></tr><tr><td>255</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_BackendPathPrefix">func BackendPathPrefix</div><div class="info"><a href="#s_fn_BackendPathPrefix">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>154</td><td><code><pre>func BackendPathPrefix(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>155</td><td><code><pre>        return parseString(ing, BackendPathPrefixKey)</pre></code></td></tr><tr><td>156</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IsSslRedirect">func IsSslRedirect</div><div class="info"><a href="#s_fn_IsSslRedirect">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>149</td><td><code><pre>func IsSslRedirect(ing *networking.Ingress) (bool, error) {</pre></code></td></tr><tr><td>150</td><td><code><pre>        return parseBool(ing, SslRedirectKey)</pre></code></td></tr><tr><td>151</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_RewriteRuleSetCustomResource">func RewriteRuleSetCustomResource</div><div class="info"><a href="#s_fn_RewriteRuleSetCustomResource">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>302</td><td><code><pre>func RewriteRuleSetCustomResource(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>303</td><td><code><pre>        return parseString(ing, RewriteRuleSetCustomResourceKey)</pre></code></td></tr><tr><td>304</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_RewriteRuleSet">func RewriteRuleSet</div><div class="info"><a href="#s_fn_RewriteRuleSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>297</td><td><code><pre>func RewriteRuleSet(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr><td>298</td><td><code><pre>        return parseString(ing, RewriteRuleSetKey)</pre></code></td></tr><tr><td>299</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_BackendProtocol">func BackendProtocol</div><div class="info"><a href="#s_fn_BackendProtocol">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>258</td><td><code><pre>func BackendProtocol(ing *networking.Ingress) (ProtocolEnum, error) {</pre></code></td></tr><tr class="miss"><td>259</td><td><code><pre>        protocol, err := parseString(ing, BackendProtocolKey)</pre></code></td></tr><tr class="miss"><td>260</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>261</td><td><code><pre>                return HTTP, err</pre></code></td></tr><tr><td>262</td><td><code><pre>        }</pre></code></td></tr><tr><td>263</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>264</td><td><code><pre>        if protocolEnum, ok := ProtocolEnumLookup[strings.ToLower(protocol)]; ok {</pre></code></td></tr><tr class="miss"><td>265</td><td><code><pre>                return protocolEnum, nil</pre></code></td></tr><tr><td>266</td><td><code><pre>        }</pre></code></td></tr><tr><td>267</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>268</td><td><code><pre>        return HTTP, controllererrors.NewErrorf(controllererrors.ErrorInvalidContent,</pre></code></td></tr><tr><td>269</td><td><code><pre>                &#34;annotation %v does not contain a valid value (%v)&#34;, BackendProtocolKey, protocol,</pre></code></td></tr><tr><td>270</td><td><code><pre>        )</pre></code></td></tr><tr><td>271</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IstioGatewayIngressClass">func IstioGatewayIngressClass</div><div class="info"><a href="#s_fn_IstioGatewayIngressClass">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>136</td><td><code><pre>func IstioGatewayIngressClass(gateway *v1alpha3.Gateway) (string, error) {</pre></code></td></tr><tr class="miss"><td>137</td><td><code><pre>        val, ok := gateway.Annotations[IstioGatewayKey]</pre></code></td></tr><tr class="miss"><td>138</td><td><code><pre>        if ok {</pre></code></td></tr><tr class="miss"><td>139</td><td><code><pre>                return val, nil</pre></code></td></tr><tr><td>140</td><td><code><pre>        }</pre></code></td></tr><tr><td>141</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>        return &#34;&#34;, controllererrors.NewErrorf(</pre></code></td></tr><tr><td>143</td><td><code><pre>                controllererrors.ErrorMissingAnnotation,</pre></code></td></tr><tr><td>144</td><td><code><pre>                &#34;%s is not set in Ingress %s/%s&#34;, IstioGatewayKey, gateway.Namespace, gateway.Name,</pre></code></td></tr><tr><td>145</td><td><code><pre>        )</pre></code></td></tr><tr><td>146</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_WAFPolicy">func WAFPolicy</div><div class="info"><a href="#s_fn_WAFPolicy">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>292</td><td><code><pre>func WAFPolicy(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr class="miss"><td>293</td><td><code><pre>        return parseString(ing, FirewallPolicy)</pre></code></td></tr><tr><td>294</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IngressClass">func IngressClass</div><div class="info"><a href="#s_fn_IngressClass">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/annotations/ingress_annotations.go</code>:</p></div><table class="listing">
<tr><td>131</td><td><code><pre>func IngressClass(ing *networking.Ingress) (string, error) {</pre></code></td></tr><tr class="miss"><td>132</td><td><code><pre>        return parseString(ing, IngressClassKey)</pre></code></td></tr><tr><td>133</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/annotations DONE:80.65
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw <span class="packageTotal">76.48%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_appGwConfigBuilder.processIngressRuleWithTLS"><td><code><a href="#fn_appGwConfigBuilder.processIngressRuleWithTLS">appGwConfigBuilder.processIngressRuleWithTLS(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>35/35</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.mergePathMap"><td><code><a href="#fn_appGwConfigBuilder.mergePathMap">appGwConfigBuilder.mergePathMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>28/28</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getBackendsAndSettingsMap"><td><code><a href="#fn_appGwConfigBuilder.getBackendsAndSettingsMap">appGwConfigBuilder.getBackendsAndSettingsMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>24/24</code></td></tr>
<tr id="s_fn_generateListenerID"><td><code><a href="#fn_generateListenerID">generateListenerID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>20/20</code></td></tr>
<tr id="s_fn_getAddressesForSubset"><td><code><a href="#fn_getAddressesForSubset">getAddressesForSubset(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>18/18</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getBackendAddressPool"><td><code><a href="#fn_appGwConfigBuilder.getBackendAddressPool">appGwConfigBuilder.getBackendAddressPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>15/15</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getPathMap"><td><code><a href="#fn_appGwConfigBuilder.getPathMap">appGwConfigBuilder.getPathMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>14/14</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newListener"><td><code><a href="#fn_appGwConfigBuilder.newListener">appGwConfigBuilder.newListener(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>12/12</code></td></tr>
<tr id="s_fn_newSecretStoreFixture"><td><code><a href="#fn_newSecretStoreFixture">newSecretStoreFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>9/9</code></td></tr>
<tr id="s_fn_formatPropName"><td><code><a href="#fn_formatPropName">formatPropName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>9/9</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newBackendPoolMap"><td><code><a href="#fn_appGwConfigBuilder.newBackendPoolMap">appGwConfigBuilder.newBackendPoolMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>9/9</code></td></tr>
<tr id="s_fn_defaultProbe"><td><code><a href="#fn_defaultProbe">defaultProbe(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_removeAGICGeneratedRewriteRuleSets"><td><code><a href="#fn_removeAGICGeneratedRewriteRuleSets">removeAGICGeneratedRewriteRuleSets(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_newCertsFixture"><td><code><a href="#fn_newCertsFixture">newCertsFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_preparePathFromPathType"><td><code><a href="#fn_preparePathFromPathType">preparePathFromPathType(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.RewriteRuleSets"><td><code><a href="#fn_appGwConfigBuilder.RewriteRuleSets">appGwConfigBuilder.RewriteRuleSets(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.makeRewrite"><td><code><a href="#fn_appGwConfigBuilder.makeRewrite">appGwConfigBuilder.makeRewrite(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.BackendAddressPools"><td><code><a href="#fn_appGwConfigBuilder.BackendAddressPools">appGwConfigBuilder.BackendAddressPools(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_newServiceSet"><td><code><a href="#fn_newServiceSet">newServiceSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_getBackendAddressMapKeys"><td><code><a href="#fn_getBackendAddressMapKeys">getBackendAddressMapKeys(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_getUniqueTCPPorts"><td><code><a href="#fn_getUniqueTCPPorts">getUniqueTCPPorts(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_listenerIdentifier.getHostNames"><td><code><a href="#fn_listenerIdentifier.getHostNames">listenerIdentifier.getHostNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.applyToListener"><td><code><a href="#fn_appGwConfigBuilder.applyToListener">appGwConfigBuilder.applyToListener(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_listenerIdentifier.getHostNameForProbes"><td><code><a href="#fn_listenerIdentifier.getHostNameForProbes">listenerIdentifier.getHostNameForProbes(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.groupRedirectsByID"><td><code><a href="#fn_appGwConfigBuilder.groupRedirectsByID">appGwConfigBuilder.groupRedirectsByID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_makeConditions"><td><code><a href="#fn_makeConditions">makeConditions(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_makeHeaderConfigs"><td><code><a href="#fn_makeHeaderConfigs">makeHeaderConfigs(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_ConfigBuilderContext.InIngressList"><td><code><a href="#fn_ConfigBuilderContext.InIngressList">ConfigBuilderContext.InIngressList(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/types.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_LookupListenerByID"><td><code><a href="#fn_LookupListenerByID">LookupListenerByID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.Listeners"><td><code><a href="#fn_appGwConfigBuilder.Listeners">appGwConfigBuilder.Listeners(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/http_listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_listenerIdentifier.setHostNames"><td><code><a href="#fn_listenerIdentifier.setHostNames">listenerIdentifier.setHostNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_IsPrivateIPConfiguration"><td><code><a href="#fn_IsPrivateIPConfiguration">IsPrivateIPConfiguration(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_ipconfigurations.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_secretIdentifier.secretFullName"><td><code><a href="#fn_secretIdentifier.secretFullName">secretIdentifier.secretFullName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_serviceBackendPortToStr"><td><code><a href="#fn_serviceBackendPortToStr">serviceBackendPortToStr(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/helper.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_keyFunc"><td><code><a href="#fn_keyFunc">keyFunc(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getSslRedirectConfigResourceReference"><td><code><a href="#fn_appGwConfigBuilder.getSslRedirectConfigResourceReference">appGwConfigBuilder.getSslRedirectConfigResourceReference(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_defaultBackendHTTPSettings"><td><code><a href="#fn_defaultBackendHTTPSettings">defaultBackendHTTPSettings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_newConfigBuilderFixture"><td><code><a href="#fn_newConfigBuilderFixture">newConfigBuilderFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_newTestListenerID"><td><code><a href="#fn_newTestListenerID">newTestListenerID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newSSLRedirectConfig"><td><code><a href="#fn_appGwConfigBuilder.newSSLRedirectConfig">appGwConfigBuilder.newSSLRedirectConfig(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_Identifier.pathRuleID"><td><code><a href="#fn_Identifier.pathRuleID">Identifier.pathRuleID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_NewAppGwyConfigFixture"><td><code><a href="#fn_NewAppGwyConfigFixture">NewAppGwyConfigFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_Identifier.gatewayResourceID"><td><code><a href="#fn_Identifier.gatewayResourceID">Identifier.gatewayResourceID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newCert"><td><code><a href="#fn_appGwConfigBuilder.newCert">appGwConfigBuilder.newCert(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_generateFrontendPortName"><td><code><a href="#fn_generateFrontendPortName">generateFrontendPortName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.resourceID"><td><code><a href="#fn_Identifier.resourceID">Identifier.resourceID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_defaultBackendAddressPool"><td><code><a href="#fn_defaultBackendAddressPool">defaultBackendAddressPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.AddressPoolID"><td><code><a href="#fn_Identifier.AddressPoolID">Identifier.AddressPoolID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_serviceIdentifier.serviceFullName"><td><code><a href="#fn_serviceIdentifier.serviceFullName">serviceIdentifier.serviceFullName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.frontendPortID"><td><code><a href="#fn_Identifier.frontendPortID">Identifier.frontendPortID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.sslCertificateID"><td><code><a href="#fn_Identifier.sslCertificateID">Identifier.sslCertificateID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_defaultFrontendListenerIdentifier"><td><code><a href="#fn_defaultFrontendListenerIdentifier">defaultFrontendListenerIdentifier(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.trustedRootCertificateID"><td><code><a href="#fn_Identifier.trustedRootCertificateID">Identifier.trustedRootCertificateID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_isPathCatchAll"><td><code><a href="#fn_isPathCatchAll">isPathCatchAll(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.urlPathMapID"><td><code><a href="#fn_Identifier.urlPathMapID">Identifier.urlPathMapID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetVersion"><td><code><a href="#fn_GetVersion">GetVersion(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.listenerID"><td><code><a href="#fn_Identifier.listenerID">Identifier.listenerID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.redirectConfigurationID"><td><code><a href="#fn_Identifier.redirectConfigurationID">Identifier.redirectConfigurationID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.probeID"><td><code><a href="#fn_Identifier.probeID">Identifier.probeID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_defaultProbeName"><td><code><a href="#fn_defaultProbeName">defaultProbeName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generatePathRuleName"><td><code><a href="#fn_generatePathRuleName">generatePathRuleName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateSSLRedirectConfigurationName"><td><code><a href="#fn_generateSSLRedirectConfigurationName">generateSSLRedirectConfigurationName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.requestRoutingRuleID"><td><code><a href="#fn_Identifier.requestRoutingRuleID">Identifier.requestRoutingRuleID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.rewriteRuleSetID"><td><code><a href="#fn_Identifier.rewriteRuleSetID">Identifier.rewriteRuleSetID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_resourceRef"><td><code><a href="#fn_resourceRef">resourceRef(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateRequestRoutingRuleName"><td><code><a href="#fn_generateRequestRoutingRuleName">generateRequestRoutingRuleName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateBackendID"><td><code><a href="#fn_generateBackendID">generateBackendID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_makeActionSet"><td><code><a href="#fn_makeActionSet">makeActionSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateURLPathMapName"><td><code><a href="#fn_generateURLPathMapName">generateURLPathMapName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewConfigBuilder"><td><code><a href="#fn_NewConfigBuilder">NewConfigBuilder(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_makeURLConfig"><td><code><a href="#fn_makeURLConfig">makeURLConfig(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateListenerName"><td><code><a href="#fn_generateListenerName">generateListenerName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_serviceIdentifier.serviceKey"><td><code><a href="#fn_serviceIdentifier.serviceKey">serviceIdentifier.serviceKey(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_secretIdentifier.secretKey"><td><code><a href="#fn_secretIdentifier.secretKey">secretIdentifier.secretKey(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newPool"><td><code><a href="#fn_appGwConfigBuilder.newPool">appGwConfigBuilder.newPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_getResourceKey"><td><code><a href="#fn_getResourceKey">getResourceKey(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateHTTPSettingsName"><td><code><a href="#fn_generateHTTPSettingsName">generateHTTPSettingsName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateProbeName"><td><code><a href="#fn_generateProbeName">generateProbeName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_generateAddressPoolName"><td><code><a href="#fn_generateAddressPoolName">generateAddressPoolName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Identifier.HTTPSettingsID"><td><code><a href="#fn_Identifier.HTTPSettingsID">Identifier.HTTPSettingsID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getDefaultFromRule"><td><code><a href="#fn_appGwConfigBuilder.getDefaultFromRule">appGwConfigBuilder.getDefaultFromRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>97.44%</code></td><td class="linecount"><code>38/39</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.generateHealthProbe"><td><code><a href="#fn_appGwConfigBuilder.generateHealthProbe">appGwConfigBuilder.generateHealthProbe(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code></td><td class="percent"><code>96.00%</code></td><td class="linecount"><code>72/75</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newProbesMap"><td><code><a href="#fn_appGwConfigBuilder.newProbesMap">appGwConfigBuilder.newProbesMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code></td><td class="percent"><code>95.45%</code></td><td class="linecount"><code>21/22</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getPathRules"><td><code><a href="#fn_appGwConfigBuilder.getPathRules">appGwConfigBuilder.getPathRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>94.44%</code></td><td class="linecount"><code>51/54</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getListenersFromIngress"><td><code><a href="#fn_appGwConfigBuilder.getListenersFromIngress">appGwConfigBuilder.getListenersFromIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code></td><td class="percent"><code>94.44%</code></td><td class="linecount"><code>17/18</code></td></tr>
<tr id="s_fn_validateFrontendIPConfiguration"><td><code><a href="#fn_validateFrontendIPConfiguration">validateFrontendIPConfiguration(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code></td><td class="percent"><code>93.75%</code></td><td class="linecount"><code>15/16</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.resolveBackendPort"><td><code><a href="#fn_appGwConfigBuilder.resolveBackendPort">appGwConfigBuilder.resolveBackendPort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code></td><td class="percent"><code>93.48%</code></td><td class="linecount"><code>43/46</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getProbeForServiceContainer"><td><code><a href="#fn_appGwConfigBuilder.getProbeForServiceContainer">appGwConfigBuilder.getProbeForServiceContainer(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code></td><td class="percent"><code>93.33%</code></td><td class="linecount"><code>28/30</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newHostToSecretMap"><td><code><a href="#fn_appGwConfigBuilder.newHostToSecretMap">appGwConfigBuilder.newHostToSecretMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code></td><td class="percent"><code>93.33%</code></td><td class="linecount"><code>14/15</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getSslCertificates"><td><code><a href="#fn_appGwConfigBuilder.getSslCertificates">appGwConfigBuilder.getSslCertificates(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code></td><td class="percent"><code>92.86%</code></td><td class="linecount"><code>13/14</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newBackendIdsFiltered"><td><code><a href="#fn_appGwConfigBuilder.newBackendIdsFiltered">appGwConfigBuilder.newBackendIdsFiltered(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code></td><td class="percent"><code>92.31%</code></td><td class="linecount"><code>24/26</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getRules"><td><code><a href="#fn_appGwConfigBuilder.getRules">appGwConfigBuilder.getRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>91.18%</code></td><td class="linecount"><code>31/34</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.assignPriorityWhereMissing"><td><code><a href="#fn_appGwConfigBuilder.assignPriorityWhereMissing">appGwConfigBuilder.assignPriorityWhereMissing(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>90.00%</code></td><td class="linecount"><code>18/20</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getSecretToCertificateMap"><td><code><a href="#fn_appGwConfigBuilder.getSecretToCertificateMap">appGwConfigBuilder.getSecretToCertificateMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code></td><td class="percent"><code>90.00%</code></td><td class="linecount"><code>9/10</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.groupListenersByListenerIdentifier"><td><code><a href="#fn_appGwConfigBuilder.groupListenersByListenerIdentifier">appGwConfigBuilder.groupListenersByListenerIdentifier(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code></td><td class="percent"><code>88.24%</code></td><td class="linecount"><code>15/17</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getAGICRewriteRuleSets"><td><code><a href="#fn_appGwConfigBuilder.getAGICRewriteRuleSets">appGwConfigBuilder.getAGICRewriteRuleSets(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code></td><td class="percent"><code>87.50%</code></td><td class="linecount"><code>14/16</code></td></tr>
<tr id="s_fn_printPathRule"><td><code><a href="#fn_printPathRule">printPathRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>87.50%</code></td><td class="linecount"><code>7/8</code></td></tr>
<tr id="s_fn_findNextFreePriority"><td><code><a href="#fn_findNextFreePriority">findNextFreePriority(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>85.71%</code></td><td class="linecount"><code>6/7</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.noRulesIngress"><td><code><a href="#fn_appGwConfigBuilder.noRulesIngress">appGwConfigBuilder.noRulesIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>84.62%</code></td><td class="linecount"><code>11/13</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getListenerConfigs"><td><code><a href="#fn_appGwConfigBuilder.getListenerConfigs">appGwConfigBuilder.getListenerConfigs(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code></td><td class="percent"><code>84.21%</code></td><td class="linecount"><code>16/19</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.addTags"><td><code><a href="#fn_appGwConfigBuilder.addTags">appGwConfigBuilder.addTags(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>83.33%</code></td><td class="linecount"><code>5/6</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getCertificate"><td><code><a href="#fn_appGwConfigBuilder.getCertificate">appGwConfigBuilder.getCertificate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code></td><td class="percent"><code>81.82%</code></td><td class="linecount"><code>9/11</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.generateHTTPSettings"><td><code><a href="#fn_appGwConfigBuilder.generateHTTPSettings">appGwConfigBuilder.generateHTTPSettings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code></td><td class="percent"><code>81.67%</code></td><td class="linecount"><code>49/60</code></td></tr>
<tr id="s_fn_IsMutliSiteListener"><td><code><a href="#fn_IsMutliSiteListener">IsMutliSiteListener(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>4/5</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getListeners"><td><code><a href="#fn_appGwConfigBuilder.getListeners">appGwConfigBuilder.getListeners(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code></td><td class="percent"><code>77.08%</code></td><td class="linecount"><code>37/48</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.resolvePortName"><td><code><a href="#fn_appGwConfigBuilder.resolvePortName">appGwConfigBuilder.resolvePortName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>9/12</code></td></tr>
<tr id="s_fn_LookupIPConfigurationByType"><td><code><a href="#fn_LookupIPConfigurationByType">LookupIPConfigurationByType(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_ipconfigurations.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_LookupIPConfigurationByID"><td><code><a href="#fn_LookupIPConfigurationByID">LookupIPConfigurationByID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_ipconfigurations.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getRedirectConfigurations"><td><code><a href="#fn_appGwConfigBuilder.getRedirectConfigurations">appGwConfigBuilder.getRedirectConfigurations(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code></td><td class="percent"><code>73.91%</code></td><td class="linecount"><code>17/23</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getPathMaps"><td><code><a href="#fn_appGwConfigBuilder.getPathMaps">appGwConfigBuilder.getPathMaps(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>18/27</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.HealthProbesCollection"><td><code><a href="#fn_appGwConfigBuilder.HealthProbesCollection">appGwConfigBuilder.HealthProbesCollection(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>8/12</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.newIstioBackendPoolMap"><td><code><a href="#fn_appGwConfigBuilder.newIstioBackendPoolMap">appGwConfigBuilder.newIstioBackendPoolMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_pools.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>6/9</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getPools"><td><code><a href="#fn_appGwConfigBuilder.getPools">appGwConfigBuilder.getPools(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code></td><td class="percent"><code>60.71%</code></td><td class="linecount"><code>17/28</code></td></tr>
<tr id="s_fn_validateURLPathMaps"><td><code><a href="#fn_validateURLPathMaps">validateURLPathMaps(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code></td><td class="percent"><code>54.55%</code></td><td class="linecount"><code>12/22</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.RequestRoutingRules"><td><code><a href="#fn_appGwConfigBuilder.RequestRoutingRules">appGwConfigBuilder.RequestRoutingRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code></td><td class="percent"><code>52.94%</code></td><td class="linecount"><code>9/17</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.BackendHTTPSettingsCollection"><td><code><a href="#fn_appGwConfigBuilder.BackendHTTPSettingsCollection">appGwConfigBuilder.BackendHTTPSettingsCollection(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code></td><td class="percent"><code>46.67%</code></td><td class="linecount"><code>7/15</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.Build"><td><code><a href="#fn_appGwConfigBuilder.Build">appGwConfigBuilder.Build(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>43.75%</code></td><td class="linecount"><code>14/32</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.resolveIstioPortName"><td><code><a href="#fn_appGwConfigBuilder.resolveIstioPortName">appGwConfigBuilder.resolveIstioPortName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_config.go</code></td><td class="percent"><code>41.67%</code></td><td class="linecount"><code>5/12</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getIstioPathMaps"><td><code><a href="#fn_appGwConfigBuilder.getIstioPathMaps">appGwConfigBuilder.getIstioPathMaps(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_routing_rules.go</code></td><td class="percent"><code>40.62%</code></td><td class="linecount"><code>13/32</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getListenerConfigsFromIstio"><td><code><a href="#fn_appGwConfigBuilder.getListenerConfigsFromIstio">appGwConfigBuilder.getListenerConfigsFromIstio(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_listeners.go</code></td><td class="percent"><code>38.89%</code></td><td class="linecount"><code>7/18</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getIstioBackendAddressPool"><td><code><a href="#fn_appGwConfigBuilder.getIstioBackendAddressPool">appGwConfigBuilder.getIstioBackendAddressPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_pools.go</code></td><td class="percent"><code>26.32%</code></td><td class="linecount"><code>5/19</code></td></tr>
<tr id="s_fn_istioMatchDestinationIds"><td><code><a href="#fn_istioMatchDestinationIds">istioMatchDestinationIds(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_settings.go</code></td><td class="percent"><code>23.53%</code></td><td class="linecount"><code>4/17</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getIstioDestinationsAndSettingsMap"><td><code><a href="#fn_appGwConfigBuilder.getIstioDestinationsAndSettingsMap">appGwConfigBuilder.getIstioDestinationsAndSettingsMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_settings.go</code></td><td class="percent"><code>19.05%</code></td><td class="linecount"><code>12/63</code></td></tr>
<tr id="s_fn_validateServiceDefinition"><td><code><a href="#fn_validateServiceDefinition">validateServiceDefinition(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/19</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.getIstioListenersPorts"><td><code><a href="#fn_appGwConfigBuilder.getIstioListenersPorts">appGwConfigBuilder.getIstioListenersPorts(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners_istio.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/18</code></td></tr>
<tr id="s_fn_FatalValidateOnExistingConfig"><td><code><a href="#fn_FatalValidateOnExistingConfig">FatalValidateOnExistingConfig(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/8</code></td></tr>
<tr id="s_fn_printEndpoints"><td><code><a href="#fn_printEndpoints">printEndpoints(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder_debug.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/8</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.generateIstioHTTPSettings"><td><code><a href="#fn_appGwConfigBuilder.generateIstioHTTPSettings">appGwConfigBuilder.generateIstioHTTPSettings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_settings.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.runValidationFunctions"><td><code><a href="#fn_appGwConfigBuilder.runValidationFunctions">appGwConfigBuilder.runValidationFunctions(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_newURLPathMap"><td><code><a href="#fn_newURLPathMap">newURLPathMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.PreBuildValidate"><td><code><a href="#fn_appGwConfigBuilder.PreBuildValidate">appGwConfigBuilder.PreBuildValidate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_Identifier.subnetID"><td><code><a href="#fn_Identifier.subnetID">Identifier.subnetID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_appGwConfigBuilder.PostBuildValidate"><td><code><a href="#fn_appGwConfigBuilder.PostBuildValidate">appGwConfigBuilder.PostBuildValidate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_Identifier.wafPolicyID"><td><code><a href="#fn_Identifier.wafPolicyID">Identifier.wafPolicyID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_Identifier.sslProfileID"><td><code><a href="#fn_Identifier.sslProfileID">Identifier.sslProfileID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_Identifier.frontendIPID"><td><code><a href="#fn_Identifier.frontendIPID">Identifier.frontendIPID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_generateIstioMatchID"><td><code><a href="#fn_generateIstioMatchID">generateIstioMatchID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_config.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_generateIstioDestinationID"><td><code><a href="#fn_generateIstioDestinationID">generateIstioDestinationID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/istio_config.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_Identifier.publicIPID"><td><code><a href="#fn_Identifier.publicIPID">Identifier.publicIPID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_serviceIdentifier.serviceFullNameHash"><td><code><a href="#fn_serviceIdentifier.serviceFullNameHash">serviceIdentifier.serviceFullNameHash(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw</code></td><td class="percent"><code>76.48%</code></td><td class="linecount"><code>1099/1437</code></td></tr>
</table>

<div class="funcname" id="fn_appGwConfigBuilder.processIngressRuleWithTLS">func appGwConfigBuilder.processIngressRuleWithTLS</div><div class="info"><a href="#s_fn_appGwConfigBuilder.processIngressRuleWithTLS">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code>:</p></div><table class="listing">
<tr><td>62</td><td><code><pre>func (c *appGwConfigBuilder) processIngressRuleWithTLS(rule *networking.IngressRule, ingress *networking.Ingress, env environment.EnvVariables) (map[Port]interface{}, map[listenerIdentifier]listenerAzConfig) {</pre></code></td></tr><tr><td>63</td><td><code><pre>        frontendPorts := make(map[Port]interface{})</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr><td>65</td><td><code><pre>        // certificate from ingress TLS spec</pre></code></td></tr><tr><td>66</td><td><code><pre>        ingressHostNamesecretIDMap := c.newHostToSecretMap(ingress)</pre></code></td></tr><tr><td>67</td><td><code><pre></pre></code></td></tr><tr><td>68</td><td><code><pre>        listeners := make(map[listenerIdentifier]listenerAzConfig)</pre></code></td></tr><tr><td>69</td><td><code><pre></pre></code></td></tr><tr><td>70</td><td><code><pre>        // Override the defaults 80,443 ports use for the listener</pre></code></td></tr><tr><td>71</td><td><code><pre>        overrideFrontendPortFromAnnotation, _ := annotations.OverrideFrontendPort(ingress)</pre></code></td></tr><tr><td>72</td><td><code><pre>        overrideFrontendPortForIngress := Port(overrideFrontendPortFromAnnotation)</pre></code></td></tr><tr><td>73</td><td><code><pre></pre></code></td></tr><tr><td>74</td><td><code><pre>        // Private IP is used when either annotation use-private-ip or USE_PRIVATE_IP env variable is true.</pre></code></td></tr><tr><td>75</td><td><code><pre>        usePrivateIPFromAnnotation, _ := annotations.UsePrivateIP(ingress)</pre></code></td></tr><tr><td>76</td><td><code><pre>        usePrivateIPForIngress := usePrivateIPFromAnnotation || env.UsePrivateIP</pre></code></td></tr><tr><td>77</td><td><code><pre></pre></code></td></tr><tr><td>78</td><td><code><pre>        appgwCertName, _ := annotations.GetAppGwSslCertificate(ingress)</pre></code></td></tr><tr><td>79</td><td><code><pre>        if len(appgwCertName) &gt; 0 {</pre></code></td></tr><tr><td>80</td><td><code><pre>                // logging to see the namespace of the ingress annotated with appgw-ssl-certificate</pre></code></td></tr><tr><td>81</td><td><code><pre>                klog.V(5).Infof(&#34;Found annotation appgw-ssl-certificate: %s in ingress %s/%s&#34;, appgwCertName, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr><td>82</td><td><code><pre>        }</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr><td>84</td><td><code><pre>        appgwProfileName, _ := annotations.GetAppGwSslProfile(ingress)</pre></code></td></tr><tr><td>85</td><td><code><pre>        if len(appgwProfileName) &gt; 0 {</pre></code></td></tr><tr><td>86</td><td><code><pre>                // logging to see the namespace of the ingress annotated with appgw-ssl-certificate</pre></code></td></tr><tr><td>87</td><td><code><pre>                klog.V(5).Infof(&#34;Found annotation appgw-ssl-profile: %s in ingress %s/%s&#34;, appgwProfileName, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr><td>88</td><td><code><pre>        }</pre></code></td></tr><tr><td>89</td><td><code><pre></pre></code></td></tr><tr><td>90</td><td><code><pre>        cert, secID := c.getCertificate(ingress, rule.Host, ingressHostNamesecretIDMap)</pre></code></td></tr><tr><td>91</td><td><code><pre>        hasTLS := (cert != nil || len(appgwCertName) &gt; 0)</pre></code></td></tr><tr><td>92</td><td><code><pre></pre></code></td></tr><tr><td>93</td><td><code><pre>        sslRedirect, _ := annotations.IsSslRedirect(ingress)</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr><td>95</td><td><code><pre>        // If a certificate is available we enable only HTTPS; unless ingress is annotated with ssl-redirect - then</pre></code></td></tr><tr><td>96</td><td><code><pre>        // we enable HTTPS as well as HTTP, and redirect HTTP to HTTPS;</pre></code></td></tr><tr><td>97</td><td><code><pre>        if hasTLS {</pre></code></td></tr><tr><td>98</td><td><code><pre>                listenerID := generateListenerID(ingress, rule, n.ApplicationGatewayProtocolHTTPS, &amp;overrideFrontendPortForIngress, usePrivateIPForIngress)</pre></code></td></tr><tr><td>99</td><td><code><pre>                frontendPorts[Port(listenerID.FrontendPort)] = nil</pre></code></td></tr><tr><td>100</td><td><code><pre>                // Only associate the Listener with a Redirect if redirect is enabled</pre></code></td></tr><tr><td>101</td><td><code><pre>                redirect := &#34;&#34;</pre></code></td></tr><tr><td>102</td><td><code><pre>                if sslRedirect {</pre></code></td></tr><tr><td>103</td><td><code><pre>                        redirect = generateSSLRedirectConfigurationName(listenerID)</pre></code></td></tr><tr><td>104</td><td><code><pre>                }</pre></code></td></tr><tr><td>105</td><td><code><pre></pre></code></td></tr><tr><td>106</td><td><code><pre>                azConf := listenerAzConfig{</pre></code></td></tr><tr><td>107</td><td><code><pre>                        Protocol:                     n.ApplicationGatewayProtocolHTTPS,</pre></code></td></tr><tr><td>108</td><td><code><pre>                        SslRedirectConfigurationName: redirect,</pre></code></td></tr><tr><td>109</td><td><code><pre>                }</pre></code></td></tr><tr><td>110</td><td><code><pre>                // appgw-ssl-certificate annotation will be ignored if TLS spec found</pre></code></td></tr><tr><td>111</td><td><code><pre>                if cert != nil {</pre></code></td></tr><tr><td>112</td><td><code><pre>                        azConf.Secret = *secID</pre></code></td></tr><tr><td>113</td><td><code><pre></pre></code></td></tr><tr><td>114</td><td><code><pre>                } else if len(appgwCertName) &gt; 0 {</pre></code></td></tr><tr><td>115</td><td><code><pre>                        // the cert annotated can be referred across namespace,</pre></code></td></tr><tr><td>116</td><td><code><pre>                        // set namespace to &#34;&#34; to ignore namespace</pre></code></td></tr><tr><td>117</td><td><code><pre>                        azConf.Secret = secretIdentifier{</pre></code></td></tr><tr><td>118</td><td><code><pre>                                Name:      appgwCertName,</pre></code></td></tr><tr><td>119</td><td><code><pre>                                Namespace: &#34;&#34;,</pre></code></td></tr><tr><td>120</td><td><code><pre>                        }</pre></code></td></tr><tr><td>121</td><td><code><pre>                }</pre></code></td></tr><tr><td>122</td><td><code><pre>                if len(appgwProfileName) &gt; 0 {</pre></code></td></tr><tr><td>123</td><td><code><pre>                        azConf.SslProfile = appgwProfileName</pre></code></td></tr><tr><td>124</td><td><code><pre>                }</pre></code></td></tr><tr><td>125</td><td><code><pre></pre></code></td></tr><tr><td>126</td><td><code><pre>                listeners[listenerID] = azConf</pre></code></td></tr><tr><td>127</td><td><code><pre>        }</pre></code></td></tr><tr><td>128</td><td><code><pre>        // Enable HTTP only if HTTPS is not configured OR if ingress annotated with &#39;ssl-redirect&#39;</pre></code></td></tr><tr><td>129</td><td><code><pre>        if sslRedirect || !hasTLS {</pre></code></td></tr><tr><td>130</td><td><code><pre>                listenerID := generateListenerID(ingress, rule, n.ApplicationGatewayProtocolHTTP, &amp;overrideFrontendPortForIngress, usePrivateIPForIngress)</pre></code></td></tr><tr><td>131</td><td><code><pre>                frontendPorts[Port(listenerID.FrontendPort)] = nil</pre></code></td></tr><tr><td>132</td><td><code><pre>                listeners[listenerID] = listenerAzConfig{</pre></code></td></tr><tr><td>133</td><td><code><pre>                        Protocol: n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>134</td><td><code><pre>                }</pre></code></td></tr><tr><td>135</td><td><code><pre>        }</pre></code></td></tr><tr><td>136</td><td><code><pre>        return frontendPorts, listeners</pre></code></td></tr><tr><td>137</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.mergePathMap">func appGwConfigBuilder.mergePathMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.mergePathMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>413</td><td><code><pre>func (c *appGwConfigBuilder) mergePathMap(existingPathMap *n.ApplicationGatewayURLPathMap, pathMapToMerge *n.ApplicationGatewayURLPathMap, cbCtx *ConfigBuilderContext) *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>414</td><td><code><pre>        if pathMapToMerge.DefaultBackendAddressPool != nil &amp;&amp; *pathMapToMerge.DefaultBackendAddressPool.ID != *cbCtx.DefaultAddressPoolID {</pre></code></td></tr><tr><td>415</td><td><code><pre>                existingPathMap.DefaultBackendAddressPool = pathMapToMerge.DefaultBackendAddressPool</pre></code></td></tr><tr><td>416</td><td><code><pre>        }</pre></code></td></tr><tr><td>417</td><td><code><pre>        if pathMapToMerge.DefaultBackendHTTPSettings != nil &amp;&amp; *pathMapToMerge.DefaultBackendHTTPSettings.ID != *cbCtx.DefaultHTTPSettingsID {</pre></code></td></tr><tr><td>418</td><td><code><pre>                existingPathMap.DefaultBackendHTTPSettings = pathMapToMerge.DefaultBackendHTTPSettings</pre></code></td></tr><tr><td>419</td><td><code><pre>        }</pre></code></td></tr><tr><td>420</td><td><code><pre>        if pathMapToMerge.DefaultRedirectConfiguration != nil {</pre></code></td></tr><tr><td>421</td><td><code><pre>                existingPathMap.DefaultRedirectConfiguration = pathMapToMerge.DefaultRedirectConfiguration</pre></code></td></tr><tr><td>422</td><td><code><pre>                existingPathMap.DefaultBackendAddressPool = nil</pre></code></td></tr><tr><td>423</td><td><code><pre>                existingPathMap.DefaultBackendHTTPSettings = nil</pre></code></td></tr><tr><td>424</td><td><code><pre>        }</pre></code></td></tr><tr><td>425</td><td><code><pre>        if pathMapToMerge.DefaultRewriteRuleSet != nil {</pre></code></td></tr><tr><td>426</td><td><code><pre>                existingPathMap.DefaultRewriteRuleSet = pathMapToMerge.DefaultRewriteRuleSet</pre></code></td></tr><tr><td>427</td><td><code><pre>        }</pre></code></td></tr><tr><td>428</td><td><code><pre></pre></code></td></tr><tr><td>429</td><td><code><pre>        if pathMapToMerge.PathRules == nil || len(*pathMapToMerge.PathRules) == 0 {</pre></code></td></tr><tr><td>430</td><td><code><pre>                return existingPathMap</pre></code></td></tr><tr><td>431</td><td><code><pre>        }</pre></code></td></tr><tr><td>432</td><td><code><pre></pre></code></td></tr><tr><td>433</td><td><code><pre>        var mergedPathRules, allPathRules []n.ApplicationGatewayPathRule</pre></code></td></tr><tr><td>434</td><td><code><pre>        if existingPathMap.PathRules == nil {</pre></code></td></tr><tr><td>435</td><td><code><pre>                allPathRules = *pathMapToMerge.PathRules</pre></code></td></tr><tr><td>436</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>437</td><td><code><pre>                allPathRules = append(*existingPathMap.PathRules, *pathMapToMerge.PathRules...)</pre></code></td></tr><tr><td>438</td><td><code><pre>        }</pre></code></td></tr><tr><td>439</td><td><code><pre></pre></code></td></tr><tr><td>440</td><td><code><pre>        // we want to ensure that there are only unique paths in the url path map</pre></code></td></tr><tr><td>441</td><td><code><pre>        pathMap := make(map[string]n.ApplicationGatewayPathRule)</pre></code></td></tr><tr><td>442</td><td><code><pre>        for _, pathRule := range allPathRules {</pre></code></td></tr><tr><td>443</td><td><code><pre>                addRuleToMergeList := true</pre></code></td></tr><tr><td>444</td><td><code><pre>                for _, path := range *pathRule.Paths {</pre></code></td></tr><tr><td>445</td><td><code><pre>                        if _, exists := pathMap[path]; exists {</pre></code></td></tr><tr><td>446</td><td><code><pre>                                klog.Errorf(&#34;A path-rule with path &#39;%s&#39; already exists&#39;. Existing path rule {%s} and new path rule {%s}.&#34;, path, printPathRule(pathMap[path]), printPathRule(pathRule))</pre></code></td></tr><tr><td>447</td><td><code><pre>                                addRuleToMergeList = false</pre></code></td></tr><tr><td>448</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>449</td><td><code><pre>                                pathMap[path] = pathRule</pre></code></td></tr><tr><td>450</td><td><code><pre>                        }</pre></code></td></tr><tr><td>451</td><td><code><pre>                }</pre></code></td></tr><tr><td>452</td><td><code><pre>                if addRuleToMergeList {</pre></code></td></tr><tr><td>453</td><td><code><pre>                        mergedPathRules = append(mergedPathRules, pathRule)</pre></code></td></tr><tr><td>454</td><td><code><pre>                }</pre></code></td></tr><tr><td>455</td><td><code><pre>        }</pre></code></td></tr><tr><td>456</td><td><code><pre></pre></code></td></tr><tr><td>457</td><td><code><pre>        existingPathMap.PathRules = &amp;mergedPathRules</pre></code></td></tr><tr><td>458</td><td><code><pre></pre></code></td></tr><tr><td>459</td><td><code><pre>        return existingPathMap</pre></code></td></tr><tr><td>460</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getBackendsAndSettingsMap">func appGwConfigBuilder.getBackendsAndSettingsMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getBackendsAndSettingsMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code>:</p></div><table class="listing">
<tr><td>71</td><td><code><pre>func (c *appGwConfigBuilder) getBackendsAndSettingsMap(cbCtx *ConfigBuilderContext) ([]n.ApplicationGatewayBackendHTTPSettings, map[backendIdentifier]*n.ApplicationGatewayBackendHTTPSettings, map[backendIdentifier]serviceBackendPortPair, error) {</pre></code></td></tr><tr><td>72</td><td><code><pre>        if c.mem.settings != nil &amp;&amp; c.mem.settingsByBackend != nil &amp;&amp; c.mem.serviceBackendPairsByBackend != nil {</pre></code></td></tr><tr><td>73</td><td><code><pre>                return *c.mem.settings, *c.mem.settingsByBackend, *c.mem.serviceBackendPairsByBackend, nil</pre></code></td></tr><tr><td>74</td><td><code><pre>        }</pre></code></td></tr><tr><td>75</td><td><code><pre></pre></code></td></tr><tr><td>76</td><td><code><pre>        defaultHTTPSetting := defaultBackendHTTPSettings(c.appGwIdentifier, n.ApplicationGatewayProtocolHTTP)</pre></code></td></tr><tr><td>77</td><td><code><pre>        serviceBackendPairMap := make(map[backendIdentifier]serviceBackendPortPair)</pre></code></td></tr><tr><td>78</td><td><code><pre>        backendHTTPSettingsMap := make(map[backendIdentifier]*n.ApplicationGatewayBackendHTTPSettings)</pre></code></td></tr><tr><td>79</td><td><code><pre>        httpSettingsCollection := make(map[string]n.ApplicationGatewayBackendHTTPSettings)</pre></code></td></tr><tr><td>80</td><td><code><pre>        httpSettingsCollection[*defaultHTTPSetting.Name] = defaultHTTPSetting</pre></code></td></tr><tr><td>81</td><td><code><pre>        for backendID := range c.newBackendIdsFiltered(cbCtx) {</pre></code></td></tr><tr><td>82</td><td><code><pre>                backendPort, err := c.resolveBackendPort(backendID)</pre></code></td></tr><tr><td>83</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr><td>84</td><td><code><pre>                        c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonPortResolutionError, err.Error())</pre></code></td></tr><tr><td>85</td><td><code><pre>                        klog.Error(err.Error())</pre></code></td></tr><tr><td>86</td><td><code><pre>                }</pre></code></td></tr><tr><td>87</td><td><code><pre></pre></code></td></tr><tr><td>88</td><td><code><pre>                httpSettings := c.generateHTTPSettings(backendID, backendPort, cbCtx)</pre></code></td></tr><tr><td>89</td><td><code><pre>                klog.Infof(&#34;Created backend http settings %s for ingress %s/%s and service %s&#34;, *httpSettings.Name, backendID.Ingress.Namespace, backendID.Ingress.Name, backendID.serviceKey())</pre></code></td></tr><tr><td>90</td><td><code><pre></pre></code></td></tr><tr><td>91</td><td><code><pre>                // TODO(aksgupta): Only backend port is used in the output; remove service port.</pre></code></td></tr><tr><td>92</td><td><code><pre>                serviceBackendPairMap[backendID] = serviceBackendPortPair{</pre></code></td></tr><tr><td>93</td><td><code><pre>                        ServicePort: backendPort,</pre></code></td></tr><tr><td>94</td><td><code><pre>                        BackendPort: backendPort,</pre></code></td></tr><tr><td>95</td><td><code><pre>                }</pre></code></td></tr><tr><td>96</td><td><code><pre></pre></code></td></tr><tr><td>97</td><td><code><pre>                httpSettingsCollection[*httpSettings.Name] = httpSettings</pre></code></td></tr><tr><td>98</td><td><code><pre>                backendHTTPSettingsMap[backendID] = &amp;httpSettings</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        httpSettings := make([]n.ApplicationGatewayBackendHTTPSettings, 0, len(httpSettingsCollection))</pre></code></td></tr><tr><td>102</td><td><code><pre>        for _, backend := range httpSettingsCollection {</pre></code></td></tr><tr><td>103</td><td><code><pre>                httpSettings = append(httpSettings, backend)</pre></code></td></tr><tr><td>104</td><td><code><pre>        }</pre></code></td></tr><tr><td>105</td><td><code><pre></pre></code></td></tr><tr><td>106</td><td><code><pre>        c.mem.settings = &amp;httpSettings</pre></code></td></tr><tr><td>107</td><td><code><pre>        c.mem.settingsByBackend = &amp;backendHTTPSettingsMap</pre></code></td></tr><tr><td>108</td><td><code><pre>        c.mem.serviceBackendPairsByBackend = &amp;serviceBackendPairMap</pre></code></td></tr><tr><td>109</td><td><code><pre>        return httpSettings, backendHTTPSettingsMap, serviceBackendPairMap, nil</pre></code></td></tr><tr><td>110</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateListenerID">func generateListenerID</div><div class="info"><a href="#s_fn_generateListenerID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>226</td><td><code><pre>func generateListenerID(ingress *networking.Ingress, rule *networking.IngressRule, protocol n.ApplicationGatewayProtocol, overridePort *Port, usePrivateIP bool) listenerIdentifier {</pre></code></td></tr><tr><td>227</td><td><code><pre>        frontendPort := Port(80)</pre></code></td></tr><tr><td>228</td><td><code><pre>        if protocol == n.ApplicationGatewayProtocolHTTPS {</pre></code></td></tr><tr><td>229</td><td><code><pre>                frontendPort = Port(443)</pre></code></td></tr><tr><td>230</td><td><code><pre>        }</pre></code></td></tr><tr><td>231</td><td><code><pre>        if overridePort != nil {</pre></code></td></tr><tr><td>232</td><td><code><pre>                if *overridePort &gt; 0 &amp;&amp; *overridePort &lt; 65000 {</pre></code></td></tr><tr><td>233</td><td><code><pre>                        frontendPort = *overridePort</pre></code></td></tr><tr><td>234</td><td><code><pre>                        klog.V(5).Infof(&#34;Using custom port specified in the override annotation: %d&#34;, *overridePort)</pre></code></td></tr><tr><td>235</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>236</td><td><code><pre>                        klog.V(5).Infof(&#34;Derived listener port from ingress: %d&#34;, frontendPort)</pre></code></td></tr><tr><td>237</td><td><code><pre>                }</pre></code></td></tr><tr><td>238</td><td><code><pre></pre></code></td></tr><tr><td>239</td><td><code><pre>        }</pre></code></td></tr><tr><td>240</td><td><code><pre></pre></code></td></tr><tr><td>241</td><td><code><pre>        listenerID := listenerIdentifier{</pre></code></td></tr><tr><td>242</td><td><code><pre>                FrontendPort: frontendPort,</pre></code></td></tr><tr><td>243</td><td><code><pre>                UsePrivateIP: usePrivateIP,</pre></code></td></tr><tr><td>244</td><td><code><pre>        }</pre></code></td></tr><tr><td>245</td><td><code><pre></pre></code></td></tr><tr><td>246</td><td><code><pre>        var hostNames []string</pre></code></td></tr><tr><td>247</td><td><code><pre>        if rule != nil &amp;&amp; rule.Host != &#34;&#34; {</pre></code></td></tr><tr><td>248</td><td><code><pre>                hostNames = append(hostNames, rule.Host)</pre></code></td></tr><tr><td>249</td><td><code><pre>        }</pre></code></td></tr><tr><td>250</td><td><code><pre></pre></code></td></tr><tr><td>251</td><td><code><pre>        extendedHostNames, err := annotations.GetHostNameExtensions(ingress)</pre></code></td></tr><tr><td>252</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>253</td><td><code><pre>                klog.V(5).Infof(&#34;Error while parsing hostname extension: %s&#34;, err)</pre></code></td></tr><tr><td>254</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>255</td><td><code><pre>                if extendedHostNames != nil {</pre></code></td></tr><tr><td>256</td><td><code><pre>                        hostNames = append(hostNames, extendedHostNames...)</pre></code></td></tr><tr><td>257</td><td><code><pre>                }</pre></code></td></tr><tr><td>258</td><td><code><pre>        }</pre></code></td></tr><tr><td>259</td><td><code><pre></pre></code></td></tr><tr><td>260</td><td><code><pre>        hostNames = utils.RemoveDuplicateStrings(hostNames)</pre></code></td></tr><tr><td>261</td><td><code><pre>        listenerID.setHostNames(hostNames)</pre></code></td></tr><tr><td>262</td><td><code><pre>        return listenerID</pre></code></td></tr><tr><td>263</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getAddressesForSubset">func getAddressesForSubset</div><div class="info"><a href="#s_fn_getAddressesForSubset">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>145</td><td><code><pre>func getAddressesForSubset(subset v1.EndpointSubset) *[]n.ApplicationGatewayBackendAddress {</pre></code></td></tr><tr><td>146</td><td><code><pre>        // We make separate maps for IP and FQDN to ensure uniqueness within the 2 groups</pre></code></td></tr><tr><td>147</td><td><code><pre>        // We cannot use ApplicationGatewayBackendAddress as it contains pointer to strings and the same IP string</pre></code></td></tr><tr><td>148</td><td><code><pre>        // at a different address would be 2 unique keys.</pre></code></td></tr><tr><td>149</td><td><code><pre>        addrSet := make(map[n.ApplicationGatewayBackendAddress]interface{})</pre></code></td></tr><tr><td>150</td><td><code><pre>        ips := make(map[string]interface{})</pre></code></td></tr><tr><td>151</td><td><code><pre>        fqdns := make(map[string]interface{})</pre></code></td></tr><tr><td>152</td><td><code><pre>        for _, address := range subset.Addresses {</pre></code></td></tr><tr><td>153</td><td><code><pre>                // prefer IP address</pre></code></td></tr><tr><td>154</td><td><code><pre>                if len(address.IP) != 0 {</pre></code></td></tr><tr><td>155</td><td><code><pre>                        // address specified by ip</pre></code></td></tr><tr><td>156</td><td><code><pre>                        ips[address.IP] = nil</pre></code></td></tr><tr><td>157</td><td><code><pre>                } else if len(address.Hostname) != 0 {</pre></code></td></tr><tr><td>158</td><td><code><pre>                        // address specified by hostname</pre></code></td></tr><tr><td>159</td><td><code><pre>                        fqdns[address.Hostname] = nil</pre></code></td></tr><tr><td>160</td><td><code><pre>                }</pre></code></td></tr><tr><td>161</td><td><code><pre>        }</pre></code></td></tr><tr><td>162</td><td><code><pre></pre></code></td></tr><tr><td>163</td><td><code><pre>        for _, address := range subset.NotReadyAddresses {</pre></code></td></tr><tr><td>164</td><td><code><pre>                // prefer IP address</pre></code></td></tr><tr><td>165</td><td><code><pre>                if len(address.IP) != 0 {</pre></code></td></tr><tr><td>166</td><td><code><pre>                        // address specified by ip</pre></code></td></tr><tr><td>167</td><td><code><pre>                        ips[address.IP] = nil</pre></code></td></tr><tr><td>168</td><td><code><pre>                } else if len(address.Hostname) != 0 {</pre></code></td></tr><tr><td>169</td><td><code><pre>                        // address specified by hostname</pre></code></td></tr><tr><td>170</td><td><code><pre>                        fqdns[address.Hostname] = nil</pre></code></td></tr><tr><td>171</td><td><code><pre>                }</pre></code></td></tr><tr><td>172</td><td><code><pre>        }</pre></code></td></tr><tr><td>173</td><td><code><pre></pre></code></td></tr><tr><td>174</td><td><code><pre>        for ip := range ips {</pre></code></td></tr><tr><td>175</td><td><code><pre>                addrSet[n.ApplicationGatewayBackendAddress{IPAddress: to.StringPtr(ip)}] = nil</pre></code></td></tr><tr><td>176</td><td><code><pre>        }</pre></code></td></tr><tr><td>177</td><td><code><pre>        for fqdn := range fqdns {</pre></code></td></tr><tr><td>178</td><td><code><pre>                addrSet[n.ApplicationGatewayBackendAddress{Fqdn: to.StringPtr(fqdn)}] = nil</pre></code></td></tr><tr><td>179</td><td><code><pre>        }</pre></code></td></tr><tr><td>180</td><td><code><pre>        return getBackendAddressMapKeys(&amp;addrSet)</pre></code></td></tr><tr><td>181</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getBackendAddressPool">func appGwConfigBuilder.getBackendAddressPool</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getBackendAddressPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>99</td><td><code><pre>func (c *appGwConfigBuilder) getBackendAddressPool(backendID backendIdentifier, serviceBackendPair serviceBackendPortPair, addressPools map[string]*n.ApplicationGatewayBackendAddressPool) *n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>100</td><td><code><pre>        endpoints, err := c.k8sContext.GetEndpointsByService(backendID.serviceKey())</pre></code></td></tr><tr><td>101</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>102</td><td><code><pre>                klog.Errorf(err.Error())</pre></code></td></tr><tr><td>103</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonEndpointsEmpty, err.Error())</pre></code></td></tr><tr><td>104</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr><td>106</td><td><code><pre></pre></code></td></tr><tr><td>107</td><td><code><pre>        for _, subset := range endpoints.Subsets {</pre></code></td></tr><tr><td>108</td><td><code><pre>                if _, portExists := getUniqueTCPPorts(subset)[serviceBackendPair.BackendPort]; portExists {</pre></code></td></tr><tr><td>109</td><td><code><pre>                        poolName := generateAddressPoolName(backendID.serviceFullName(), serviceBackendPortToStr(backendID.Backend.Service.Port), serviceBackendPair.BackendPort)</pre></code></td></tr><tr><td>110</td><td><code><pre>                        // The same service might be referenced in multiple ingress resources, this might result in multiple `serviceBackendPairMap` having the same service key but different</pre></code></td></tr><tr><td>111</td><td><code><pre>                        // ingress resource. Thus, while generating the backend address pool, we should make sure that we are generating unique backend address pools.</pre></code></td></tr><tr><td>112</td><td><code><pre>                        if pool, ok := addressPools[poolName]; ok {</pre></code></td></tr><tr><td>113</td><td><code><pre>                                return pool</pre></code></td></tr><tr><td>114</td><td><code><pre>                        }</pre></code></td></tr><tr><td>115</td><td><code><pre>                        return c.newPool(poolName, subset)</pre></code></td></tr><tr><td>116</td><td><code><pre>                }</pre></code></td></tr><tr><td>117</td><td><code><pre>                logLine := fmt.Sprintf(&#34;Backend target port %d does not have matching endpoint port&#34;, serviceBackendPair.BackendPort)</pre></code></td></tr><tr><td>118</td><td><code><pre>                klog.Error(logLine)</pre></code></td></tr><tr><td>119</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonBackendPortTargetMatch, logLine)</pre></code></td></tr><tr><td>120</td><td><code><pre>        }</pre></code></td></tr><tr><td>121</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>122</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getPathMap">func appGwConfigBuilder.getPathMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getPathMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>230</td><td><code><pre>func (c *appGwConfigBuilder) getPathMap(cbCtx *ConfigBuilderContext, listenerID listenerIdentifier, listenerAzConfig listenerAzConfig, ingress *networking.Ingress, rule *networking.IngressRule, ruleIdx int) *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>231</td><td><code><pre>        // initialize a path map for this listener if doesn&#39;t exists</pre></code></td></tr><tr><td>232</td><td><code><pre>        pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr><td>233</td><td><code><pre>        pathMap := n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>234</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>235</td><td><code><pre>                Name: to.StringPtr(pathMapName),</pre></code></td></tr><tr><td>236</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.urlPathMapID(pathMapName)),</pre></code></td></tr><tr><td>237</td><td><code><pre>                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{},</pre></code></td></tr><tr><td>238</td><td><code><pre>        }</pre></code></td></tr><tr><td>239</td><td><code><pre></pre></code></td></tr><tr><td>240</td><td><code><pre>        // get defaults provided by the rules if any</pre></code></td></tr><tr><td>241</td><td><code><pre>        defaultAddressPoolID, defaultHTTPSettingsID, defaultRedirectConfigurationID, defaultRewriteRuleSetID := c.getDefaultFromRule(cbCtx, listenerID, listenerAzConfig, ingress, rule)</pre></code></td></tr><tr><td>242</td><td><code><pre>        if defaultRedirectConfigurationID != nil {</pre></code></td></tr><tr><td>243</td><td><code><pre>                pathMap.DefaultRedirectConfiguration = resourceRef(*defaultRedirectConfigurationID)</pre></code></td></tr><tr><td>244</td><td><code><pre>                pathMap.DefaultBackendAddressPool = nil</pre></code></td></tr><tr><td>245</td><td><code><pre>                pathMap.DefaultBackendHTTPSettings = nil</pre></code></td></tr><tr><td>246</td><td><code><pre>        } else if defaultAddressPoolID != nil &amp;&amp; defaultHTTPSettingsID != nil {</pre></code></td></tr><tr><td>247</td><td><code><pre>                pathMap.DefaultBackendAddressPool = resourceRef(*defaultAddressPoolID)</pre></code></td></tr><tr><td>248</td><td><code><pre>                pathMap.DefaultBackendHTTPSettings = resourceRef(*defaultHTTPSettingsID)</pre></code></td></tr><tr><td>249</td><td><code><pre>        }</pre></code></td></tr><tr><td>250</td><td><code><pre>        if defaultRewriteRuleSetID != nil {</pre></code></td></tr><tr><td>251</td><td><code><pre>                pathMap.DefaultRewriteRuleSet = resourceRef(*defaultRewriteRuleSetID)</pre></code></td></tr><tr><td>252</td><td><code><pre>        }</pre></code></td></tr><tr><td>253</td><td><code><pre></pre></code></td></tr><tr><td>254</td><td><code><pre>        pathMap.PathRules = c.getPathRules(cbCtx, listenerID, listenerAzConfig, ingress, rule, ruleIdx)</pre></code></td></tr><tr><td>255</td><td><code><pre></pre></code></td></tr><tr><td>256</td><td><code><pre>        return &amp;pathMap</pre></code></td></tr><tr><td>257</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newListener">func appGwConfigBuilder.newListener</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newListener">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code>:</p></div><table class="listing">
<tr><td>154</td><td><code><pre>func (c *appGwConfigBuilder) newListener(cbCtx *ConfigBuilderContext, listenerID listenerIdentifier, protocol n.ApplicationGatewayProtocol, portsByNumber map[Port]n.ApplicationGatewayFrontendPort) (*n.ApplicationGatewayHTTPListener, *n.ApplicationGatewayFrontendPort, error) {</pre></code></td></tr><tr><td>155</td><td><code><pre>        frontIPConfiguration := *LookupIPConfigurationByType(c.appGw.FrontendIPConfigurations, listenerID.UsePrivateIP)</pre></code></td></tr><tr><td>156</td><td><code><pre>        portNumber := listenerID.FrontendPort</pre></code></td></tr><tr><td>157</td><td><code><pre>        var frontendPort n.ApplicationGatewayFrontendPort</pre></code></td></tr><tr><td>158</td><td><code><pre>        var exists bool</pre></code></td></tr><tr><td>159</td><td><code><pre>        if frontendPort, exists = portsByNumber[portNumber]; !exists {</pre></code></td></tr><tr><td>160</td><td><code><pre>                portName := generateFrontendPortName(listenerID.FrontendPort)</pre></code></td></tr><tr><td>161</td><td><code><pre>                frontendPort = n.ApplicationGatewayFrontendPort{</pre></code></td></tr><tr><td>162</td><td><code><pre>                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>163</td><td><code><pre>                        Name: &amp;portName,</pre></code></td></tr><tr><td>164</td><td><code><pre>                        ID:   to.StringPtr(c.appGwIdentifier.frontendPortID(portName)),</pre></code></td></tr><tr><td>165</td><td><code><pre>                        ApplicationGatewayFrontendPortPropertiesFormat: &amp;n.ApplicationGatewayFrontendPortPropertiesFormat{</pre></code></td></tr><tr><td>166</td><td><code><pre>                                Port: to.Int32Ptr(int32(portNumber)),</pre></code></td></tr><tr><td>167</td><td><code><pre>                        },</pre></code></td></tr><tr><td>168</td><td><code><pre>                }</pre></code></td></tr><tr><td>169</td><td><code><pre>        }</pre></code></td></tr><tr><td>170</td><td><code><pre></pre></code></td></tr><tr><td>171</td><td><code><pre>        listenerName := generateListenerName(listenerID)</pre></code></td></tr><tr><td>172</td><td><code><pre>        listener := n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>173</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>174</td><td><code><pre>                Name: to.StringPtr(listenerName),</pre></code></td></tr><tr><td>175</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.listenerID(listenerName)),</pre></code></td></tr><tr><td>176</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>177</td><td><code><pre>                        // TODO: expose this to external configuration</pre></code></td></tr><tr><td>178</td><td><code><pre>                        FrontendIPConfiguration: resourceRef(*frontIPConfiguration.ID),</pre></code></td></tr><tr><td>179</td><td><code><pre>                        FrontendPort:            resourceRef(*frontendPort.ID),</pre></code></td></tr><tr><td>180</td><td><code><pre>                        Protocol:                protocol,</pre></code></td></tr><tr><td>181</td><td><code><pre>                        HostName:                nil,</pre></code></td></tr><tr><td>182</td><td><code><pre>                        HostNames:               &amp;[]string{},</pre></code></td></tr><tr><td>183</td><td><code><pre></pre></code></td></tr><tr><td>184</td><td><code><pre>                        // setting to default</pre></code></td></tr><tr><td>185</td><td><code><pre>                        RequireServerNameIndication: to.BoolPtr(false),</pre></code></td></tr><tr><td>186</td><td><code><pre>                },</pre></code></td></tr><tr><td>187</td><td><code><pre>        }</pre></code></td></tr><tr><td>188</td><td><code><pre></pre></code></td></tr><tr><td>189</td><td><code><pre>        // Use only the &#39;HostNames&#39; field as application gateway allows either &#39;HostName&#39; or &#39;HostNames&#39;</pre></code></td></tr><tr><td>190</td><td><code><pre>        if hostNames := listenerID.getHostNames(); len(hostNames) != 0 {</pre></code></td></tr><tr><td>191</td><td><code><pre>                listener.HostNames = &amp;hostNames</pre></code></td></tr><tr><td>192</td><td><code><pre>        }</pre></code></td></tr><tr><td>193</td><td><code><pre></pre></code></td></tr><tr><td>194</td><td><code><pre>        return &amp;listener, &amp;frontendPort, nil</pre></code></td></tr><tr><td>195</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_newSecretStoreFixture">func newSecretStoreFixture</div><div class="info"><a href="#s_fn_newSecretStoreFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>60</td><td><code><pre>func newSecretStoreFixture(toAdd *map[string]interface{}) k8scontext.SecretsKeeper {</pre></code></td></tr><tr><td>61</td><td><code><pre>        c := cache.NewThreadSafeStore(cache.Indexers{}, cache.Indices{})</pre></code></td></tr><tr><td>62</td><td><code><pre>        ingressKey := getResourceKey(tests.Namespace, tests.Name)</pre></code></td></tr><tr><td>63</td><td><code><pre>        c.Add(ingressKey, tests.Host)</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr><td>65</td><td><code><pre>        key := tests.Namespace + &#34;/&#34; + tests.NameOfSecret</pre></code></td></tr><tr><td>66</td><td><code><pre>        c.Add(key, []byte(&#34;xyz&#34;))</pre></code></td></tr><tr><td>67</td><td><code><pre></pre></code></td></tr><tr><td>68</td><td><code><pre>        if toAdd != nil {</pre></code></td></tr><tr><td>69</td><td><code><pre>                for k, v := range *toAdd {</pre></code></td></tr><tr><td>70</td><td><code><pre>                        c.Add(k, v)</pre></code></td></tr><tr><td>71</td><td><code><pre>                }</pre></code></td></tr><tr><td>72</td><td><code><pre>        }</pre></code></td></tr><tr><td>73</td><td><code><pre></pre></code></td></tr><tr><td>74</td><td><code><pre>        return &amp;k8scontext.SecretsStore{</pre></code></td></tr><tr><td>75</td><td><code><pre>                Cache: c,</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_formatPropName">func formatPropName</div><div class="info"><a href="#s_fn_formatPropName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>92</td><td><code><pre>func formatPropName(val string) string {</pre></code></td></tr><tr><td>93</td><td><code><pre>        // App Gateway property name cannot be longer than 80 characters</pre></code></td></tr><tr><td>94</td><td><code><pre>        maxLen := 80</pre></code></td></tr><tr><td>95</td><td><code><pre>        if len(val) &lt;= maxLen {</pre></code></td></tr><tr><td>96</td><td><code><pre>                return val</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr><td>98</td><td><code><pre>        hash := fmt.Sprintf(&#34;%x&#34;, md5.Sum([]byte(val)))</pre></code></td></tr><tr><td>99</td><td><code><pre>        separator := &#34;-&#34;</pre></code></td></tr><tr><td>100</td><td><code><pre>        prefix := val[0 : maxLen-len(hash)-len(separator)]</pre></code></td></tr><tr><td>101</td><td><code><pre>        finalVal := fmt.Sprintf(&#34;%s%s%s&#34;, prefix, separator, hash)</pre></code></td></tr><tr><td>102</td><td><code><pre>        klog.V(3).Infof(&#34;Prop name %s with length %d is longer than %d characters; Transformed to %s&#34;, val, len(val), maxLen, finalVal)</pre></code></td></tr><tr><td>103</td><td><code><pre>        return finalVal</pre></code></td></tr><tr><td>104</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newBackendPoolMap">func appGwConfigBuilder.newBackendPoolMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newBackendPoolMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>83</td><td><code><pre>func (c *appGwConfigBuilder) newBackendPoolMap(cbCtx *ConfigBuilderContext) map[backendIdentifier]*n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>84</td><td><code><pre>        defaultPool := defaultBackendAddressPool(c.appGwIdentifier)</pre></code></td></tr><tr><td>85</td><td><code><pre>        addressPools := map[string]*n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>86</td><td><code><pre>                *defaultPool.Name: &amp;defaultPool,</pre></code></td></tr><tr><td>87</td><td><code><pre>        }</pre></code></td></tr><tr><td>88</td><td><code><pre>        backendPoolMap := make(map[backendIdentifier]*n.ApplicationGatewayBackendAddressPool)</pre></code></td></tr><tr><td>89</td><td><code><pre>        _, _, serviceBackendPairMap, _ := c.getBackendsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>90</td><td><code><pre>        for backendID, serviceBackendPair := range serviceBackendPairMap {</pre></code></td></tr><tr><td>91</td><td><code><pre>                backendPoolMap[backendID] = &amp;defaultPool</pre></code></td></tr><tr><td>92</td><td><code><pre>                if pool := c.getBackendAddressPool(backendID, serviceBackendPair, addressPools); pool != nil {</pre></code></td></tr><tr><td>93</td><td><code><pre>                        backendPoolMap[backendID] = pool</pre></code></td></tr><tr><td>94</td><td><code><pre>                }</pre></code></td></tr><tr><td>95</td><td><code><pre>        }</pre></code></td></tr><tr><td>96</td><td><code><pre>        return backendPoolMap</pre></code></td></tr><tr><td>97</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_defaultProbe">func defaultProbe</div><div class="info"><a href="#s_fn_defaultProbe">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>199</td><td><code><pre>func defaultProbe(appGWIdentifier Identifier, protocol n.ApplicationGatewayProtocol) n.ApplicationGatewayProbe {</pre></code></td></tr><tr><td>200</td><td><code><pre>        defProbeName := defaultProbeName(protocol)</pre></code></td></tr><tr><td>201</td><td><code><pre>        defHost := &#34;localhost&#34;</pre></code></td></tr><tr><td>202</td><td><code><pre>        defPath := &#34;/&#34;</pre></code></td></tr><tr><td>203</td><td><code><pre>        defInterval := int32(30)</pre></code></td></tr><tr><td>204</td><td><code><pre>        defTimeout := int32(30)</pre></code></td></tr><tr><td>205</td><td><code><pre>        defUnHealthyCount := int32(3)</pre></code></td></tr><tr><td>206</td><td><code><pre>        return n.ApplicationGatewayProbe{</pre></code></td></tr><tr><td>207</td><td><code><pre>                Name: to.StringPtr(defProbeName),</pre></code></td></tr><tr><td>208</td><td><code><pre>                ID:   to.StringPtr(appGWIdentifier.probeID(defProbeName)),</pre></code></td></tr><tr><td>209</td><td><code><pre>                ApplicationGatewayProbePropertiesFormat: &amp;n.ApplicationGatewayProbePropertiesFormat{</pre></code></td></tr><tr><td>210</td><td><code><pre>                        Protocol:           protocol,</pre></code></td></tr><tr><td>211</td><td><code><pre>                        Host:               &amp;defHost,</pre></code></td></tr><tr><td>212</td><td><code><pre>                        Path:               &amp;defPath,</pre></code></td></tr><tr><td>213</td><td><code><pre>                        Interval:           &amp;defInterval,</pre></code></td></tr><tr><td>214</td><td><code><pre>                        Timeout:            &amp;defTimeout,</pre></code></td></tr><tr><td>215</td><td><code><pre>                        UnhealthyThreshold: &amp;defUnHealthyCount,</pre></code></td></tr><tr><td>216</td><td><code><pre></pre></code></td></tr><tr><td>217</td><td><code><pre>                        // setting to defaults</pre></code></td></tr><tr><td>218</td><td><code><pre>                        Match:                               &amp;n.ApplicationGatewayProbeHealthResponseMatch{},</pre></code></td></tr><tr><td>219</td><td><code><pre>                        PickHostNameFromBackendHTTPSettings: to.BoolPtr(false),</pre></code></td></tr><tr><td>220</td><td><code><pre>                        MinServers:                          to.Int32Ptr(0),</pre></code></td></tr><tr><td>221</td><td><code><pre>                },</pre></code></td></tr><tr><td>222</td><td><code><pre>        }</pre></code></td></tr><tr><td>223</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_removeAGICGeneratedRewriteRuleSets">func removeAGICGeneratedRewriteRuleSets</div><div class="info"><a href="#s_fn_removeAGICGeneratedRewriteRuleSets">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func removeAGICGeneratedRewriteRuleSets(currentRewriteRuleSets *[]n.ApplicationGatewayRewriteRuleSet) []n.ApplicationGatewayRewriteRuleSet {</pre></code></td></tr><tr><td>35</td><td><code><pre></pre></code></td></tr><tr><td>36</td><td><code><pre>        if len(*currentRewriteRuleSets) == 0 {</pre></code></td></tr><tr><td>37</td><td><code><pre>                return *currentRewriteRuleSets</pre></code></td></tr><tr><td>38</td><td><code><pre>        }</pre></code></td></tr><tr><td>39</td><td><code><pre></pre></code></td></tr><tr><td>40</td><td><code><pre>        var appGwRewriteRuleSets []n.ApplicationGatewayRewriteRuleSet</pre></code></td></tr><tr><td>41</td><td><code><pre></pre></code></td></tr><tr><td>42</td><td><code><pre>        for _, rrs := range *currentRewriteRuleSets {</pre></code></td></tr><tr><td>43</td><td><code><pre>                if rewriteRuleSetName := *(rrs.Name); !(strings.HasPrefix(rewriteRuleSetName, &#34;crd-&#34;)) {</pre></code></td></tr><tr><td>44</td><td><code><pre>                        appGwRewriteRuleSets = append(appGwRewriteRuleSets, rrs)</pre></code></td></tr><tr><td>45</td><td><code><pre>                }</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>        return appGwRewriteRuleSets</pre></code></td></tr><tr><td>49</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_newCertsFixture">func newCertsFixture</div><div class="info"><a href="#s_fn_newCertsFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>113</td><td><code><pre>func newCertsFixture() map[string]interface{} {</pre></code></td></tr><tr><td>114</td><td><code><pre>        toAdd := make(map[string]interface{})</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>        secretsIdent := secretIdentifier{</pre></code></td></tr><tr><td>117</td><td><code><pre>                Namespace: tests.Namespace,</pre></code></td></tr><tr><td>118</td><td><code><pre>                Name:      tests.Name,</pre></code></td></tr><tr><td>119</td><td><code><pre>        }</pre></code></td></tr><tr><td>120</td><td><code><pre></pre></code></td></tr><tr><td>121</td><td><code><pre>        toAdd[tests.Host] = secretsIdent</pre></code></td></tr><tr><td>122</td><td><code><pre>        toAdd[tests.OtherHost] = secretsIdent</pre></code></td></tr><tr><td>123</td><td><code><pre>        // Wild card</pre></code></td></tr><tr><td>124</td><td><code><pre>        toAdd[&#34;&#34;] = secretsIdent</pre></code></td></tr><tr><td>125</td><td><code><pre></pre></code></td></tr><tr><td>126</td><td><code><pre>        return toAdd</pre></code></td></tr><tr><td>127</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_preparePathFromPathType">func preparePathFromPathType</div><div class="info"><a href="#s_fn_preparePathFromPathType">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>483</td><td><code><pre>func preparePathFromPathType(path string, pathType *networking.PathType) string {</pre></code></td></tr><tr><td>484</td><td><code><pre>        if pathType != nil {</pre></code></td></tr><tr><td>485</td><td><code><pre>                if *pathType == networking.PathTypeExact {</pre></code></td></tr><tr><td>486</td><td><code><pre>                        return strings.TrimSuffix(path, &#34;*&#34;)</pre></code></td></tr><tr><td>487</td><td><code><pre>                }</pre></code></td></tr><tr><td>488</td><td><code><pre></pre></code></td></tr><tr><td>489</td><td><code><pre>                if *pathType == networking.PathTypePrefix &amp;&amp; !strings.HasSuffix(path, &#34;*&#34;) {</pre></code></td></tr><tr><td>490</td><td><code><pre>                        return path + &#34;*&#34;</pre></code></td></tr><tr><td>491</td><td><code><pre>                }</pre></code></td></tr><tr><td>492</td><td><code><pre>        }</pre></code></td></tr><tr><td>493</td><td><code><pre>        return path</pre></code></td></tr><tr><td>494</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.RewriteRuleSets">func appGwConfigBuilder.RewriteRuleSets</div><div class="info"><a href="#s_fn_appGwConfigBuilder.RewriteRuleSets">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>20</td><td><code><pre>func (c *appGwConfigBuilder) RewriteRuleSets(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>21</td><td><code><pre></pre></code></td></tr><tr><td>22</td><td><code><pre>        if c.appGw.RewriteRuleSets == nil {</pre></code></td></tr><tr><td>23</td><td><code><pre>                c.appGw.RewriteRuleSets = &amp;[]n.ApplicationGatewayRewriteRuleSet{}</pre></code></td></tr><tr><td>24</td><td><code><pre>        }</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr><td>26</td><td><code><pre>        rewriteRuleSets := removeAGICGeneratedRewriteRuleSets(c.appGw.RewriteRuleSets)</pre></code></td></tr><tr><td>27</td><td><code><pre>        rewriteRuleSets = append(rewriteRuleSets, c.getAGICRewriteRuleSets(cbCtx)...)</pre></code></td></tr><tr><td>28</td><td><code><pre></pre></code></td></tr><tr><td>29</td><td><code><pre>        c.appGw.RewriteRuleSets = &amp;rewriteRuleSets</pre></code></td></tr><tr><td>30</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>31</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.makeRewrite">func appGwConfigBuilder.makeRewrite</div><div class="info"><a href="#s_fn_appGwConfigBuilder.makeRewrite">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>97</td><td><code><pre>func (c appGwConfigBuilder) makeRewrite(namespace string, rewriteRuleSetCRName string, rewrite *v1beta1.AzureApplicationGatewayRewrite) n.ApplicationGatewayRewriteRuleSet {</pre></code></td></tr><tr><td>98</td><td><code><pre></pre></code></td></tr><tr><td>99</td><td><code><pre>        // prefix AGIC built rewriteRuleSets by crd- to help differentiate from user created rewrite rule sets</pre></code></td></tr><tr><td>100</td><td><code><pre>        rewriteRuleSetCRName = fmt.Sprintf(&#34;crd-%s-%s&#34;, namespace, rewriteRuleSetCRName)</pre></code></td></tr><tr><td>101</td><td><code><pre></pre></code></td></tr><tr><td>102</td><td><code><pre>        appGwRewriteRules := []n.ApplicationGatewayRewriteRule{}</pre></code></td></tr><tr><td>103</td><td><code><pre></pre></code></td></tr><tr><td>104</td><td><code><pre>        for _, rr := range rewrite.Spec.RewriteRules {</pre></code></td></tr><tr><td>105</td><td><code><pre></pre></code></td></tr><tr><td>106</td><td><code><pre>                appGwNewRewriteRule := n.ApplicationGatewayRewriteRule{</pre></code></td></tr><tr><td>107</td><td><code><pre>                        Name:         to.StringPtr(rr.Name),</pre></code></td></tr><tr><td>108</td><td><code><pre>                        RuleSequence: to.Int32Ptr(int32(rr.RuleSequence)),</pre></code></td></tr><tr><td>109</td><td><code><pre>                        Conditions:   makeConditions(rr.Conditions),</pre></code></td></tr><tr><td>110</td><td><code><pre>                        ActionSet:    makeActionSet(rr.Actions),</pre></code></td></tr><tr><td>111</td><td><code><pre>                }</pre></code></td></tr><tr><td>112</td><td><code><pre></pre></code></td></tr><tr><td>113</td><td><code><pre>                appGwRewriteRules = append(appGwRewriteRules, appGwNewRewriteRule)</pre></code></td></tr><tr><td>114</td><td><code><pre>        }</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>        return n.ApplicationGatewayRewriteRuleSet{</pre></code></td></tr><tr><td>117</td><td><code><pre>                Name: to.StringPtr(rewriteRuleSetCRName),</pre></code></td></tr><tr><td>118</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.rewriteRuleSetID(rewriteRuleSetCRName)),</pre></code></td></tr><tr><td>119</td><td><code><pre></pre></code></td></tr><tr><td>120</td><td><code><pre>                ApplicationGatewayRewriteRuleSetPropertiesFormat: &amp;n.ApplicationGatewayRewriteRuleSetPropertiesFormat{</pre></code></td></tr><tr><td>121</td><td><code><pre>                        RewriteRules: &amp;appGwRewriteRules,</pre></code></td></tr><tr><td>122</td><td><code><pre>                },</pre></code></td></tr><tr><td>123</td><td><code><pre>        }</pre></code></td></tr><tr><td>124</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.BackendAddressPools">func appGwConfigBuilder.BackendAddressPools</div><div class="info"><a href="#s_fn_appGwConfigBuilder.BackendAddressPools">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func (c *appGwConfigBuilder) BackendAddressPools(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>22</td><td><code><pre>        pools := c.getPools(cbCtx)</pre></code></td></tr><tr><td>23</td><td><code><pre>        if pools != nil {</pre></code></td></tr><tr><td>24</td><td><code><pre>                sort.Sort(sorter.ByBackendPoolName(pools))</pre></code></td></tr><tr><td>25</td><td><code><pre>        }</pre></code></td></tr><tr><td>26</td><td><code><pre>        c.appGw.BackendAddressPools = &amp;pools</pre></code></td></tr><tr><td>27</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>28</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_newServiceSet">func newServiceSet</div><div class="info"><a href="#s_fn_newServiceSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code>:</p></div><table class="listing">
<tr><td>62</td><td><code><pre>func newServiceSet(services *[]*v1.Service) map[string]*v1.Service {</pre></code></td></tr><tr><td>63</td><td><code><pre>        servicesSet := make(map[string]*v1.Service)</pre></code></td></tr><tr><td>64</td><td><code><pre>        for _, service := range *services {</pre></code></td></tr><tr><td>65</td><td><code><pre>                serviceKey := fmt.Sprintf(&#34;%s/%s&#34;, service.Namespace, service.Name)</pre></code></td></tr><tr><td>66</td><td><code><pre>                servicesSet[serviceKey] = service</pre></code></td></tr><tr><td>67</td><td><code><pre>        }</pre></code></td></tr><tr><td>68</td><td><code><pre>        return servicesSet</pre></code></td></tr><tr><td>69</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getBackendAddressMapKeys">func getBackendAddressMapKeys</div><div class="info"><a href="#s_fn_getBackendAddressMapKeys">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>183</td><td><code><pre>func getBackendAddressMapKeys(m *map[n.ApplicationGatewayBackendAddress]interface{}) *[]n.ApplicationGatewayBackendAddress {</pre></code></td></tr><tr><td>184</td><td><code><pre>        var addresses []n.ApplicationGatewayBackendAddress</pre></code></td></tr><tr><td>185</td><td><code><pre>        for addr := range *m {</pre></code></td></tr><tr><td>186</td><td><code><pre>                addresses = append(addresses, addr)</pre></code></td></tr><tr><td>187</td><td><code><pre>        }</pre></code></td></tr><tr><td>188</td><td><code><pre>        sort.Sort(sorter.ByIPFQDN(addresses))</pre></code></td></tr><tr><td>189</td><td><code><pre>        return &amp;addresses</pre></code></td></tr><tr><td>190</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getUniqueTCPPorts">func getUniqueTCPPorts</div><div class="info"><a href="#s_fn_getUniqueTCPPorts">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>124</td><td><code><pre>func getUniqueTCPPorts(subset v1.EndpointSubset) map[Port]interface{} {</pre></code></td></tr><tr><td>125</td><td><code><pre>        ports := make(map[Port]interface{})</pre></code></td></tr><tr><td>126</td><td><code><pre>        for _, endpointsPort := range subset.Ports {</pre></code></td></tr><tr><td>127</td><td><code><pre>                if endpointsPort.Protocol == v1.ProtocolTCP {</pre></code></td></tr><tr><td>128</td><td><code><pre>                        ports[Port(endpointsPort.Port)] = nil</pre></code></td></tr><tr><td>129</td><td><code><pre>                }</pre></code></td></tr><tr><td>130</td><td><code><pre>        }</pre></code></td></tr><tr><td>131</td><td><code><pre>        return ports</pre></code></td></tr><tr><td>132</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_listenerIdentifier.getHostNames">func listenerIdentifier.getHostNames</div><div class="info"><a href="#s_fn_listenerIdentifier.getHostNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>250</td><td><code><pre>func (listenerID *listenerIdentifier) getHostNames() []string {</pre></code></td></tr><tr><td>251</td><td><code><pre>        var hostNames []string</pre></code></td></tr><tr><td>252</td><td><code><pre></pre></code></td></tr><tr><td>253</td><td><code><pre>        for i := 0; i &lt; len(listenerID.HostNames); i++ {</pre></code></td></tr><tr><td>254</td><td><code><pre>                if listenerID.HostNames[i] != &#34;&#34; {</pre></code></td></tr><tr><td>255</td><td><code><pre>                        hostNames = append(hostNames, listenerID.HostNames[i])</pre></code></td></tr><tr><td>256</td><td><code><pre>                }</pre></code></td></tr><tr><td>257</td><td><code><pre>        }</pre></code></td></tr><tr><td>258</td><td><code><pre></pre></code></td></tr><tr><td>259</td><td><code><pre>        return hostNames</pre></code></td></tr><tr><td>260</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.applyToListener">func appGwConfigBuilder.applyToListener</div><div class="info"><a href="#s_fn_appGwConfigBuilder.applyToListener">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code>:</p></div><table class="listing">
<tr><td>51</td><td><code><pre>func (c *appGwConfigBuilder) applyToListener(rule *networking.IngressRule) bool {</pre></code></td></tr><tr><td>52</td><td><code><pre>        for pathIdx := range rule.HTTP.Paths {</pre></code></td></tr><tr><td>53</td><td><code><pre>                path := &amp;rule.HTTP.Paths[pathIdx]</pre></code></td></tr><tr><td>54</td><td><code><pre>                // if there is path that is /, /* , empty string, then apply the waf policy to the listener.</pre></code></td></tr><tr><td>55</td><td><code><pre>                if isPathCatchAll(path.Path, path.PathType) {</pre></code></td></tr><tr><td>56</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>57</td><td><code><pre>                }</pre></code></td></tr><tr><td>58</td><td><code><pre>        }</pre></code></td></tr><tr><td>59</td><td><code><pre>        return false</pre></code></td></tr><tr><td>60</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_listenerIdentifier.getHostNameForProbes">func listenerIdentifier.getHostNameForProbes</div><div class="info"><a href="#s_fn_listenerIdentifier.getHostNameForProbes">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>263</td><td><code><pre>func (listenerID *listenerIdentifier) getHostNameForProbes() *string {</pre></code></td></tr><tr><td>264</td><td><code><pre>        hostNames := listenerID.getHostNames()</pre></code></td></tr><tr><td>265</td><td><code><pre>        for _, hostName := range hostNames {</pre></code></td></tr><tr><td>266</td><td><code><pre>                if !strings.ContainsAny(hostName, WildcardSpecialCharacters) {</pre></code></td></tr><tr><td>267</td><td><code><pre>                        return to.StringPtr(hostName)</pre></code></td></tr><tr><td>268</td><td><code><pre>                }</pre></code></td></tr><tr><td>269</td><td><code><pre>        }</pre></code></td></tr><tr><td>270</td><td><code><pre></pre></code></td></tr><tr><td>271</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>272</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.groupRedirectsByID">func appGwConfigBuilder.groupRedirectsByID</div><div class="info"><a href="#s_fn_appGwConfigBuilder.groupRedirectsByID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code>:</p></div><table class="listing">
<tr><td>91</td><td><code><pre>func (c *appGwConfigBuilder) groupRedirectsByID(redirects *[]n.ApplicationGatewayRedirectConfiguration) *map[string]interface{} {</pre></code></td></tr><tr><td>92</td><td><code><pre>        redirectsSet := make(map[string]interface{})</pre></code></td></tr><tr><td>93</td><td><code><pre>        for _, redirect := range *redirects {</pre></code></td></tr><tr><td>94</td><td><code><pre>                redirectsSet[*redirect.ID] = nil</pre></code></td></tr><tr><td>95</td><td><code><pre>        }</pre></code></td></tr><tr><td>96</td><td><code><pre>        return &amp;redirectsSet</pre></code></td></tr><tr><td>97</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_makeConditions">func makeConditions</div><div class="info"><a href="#s_fn_makeConditions">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>127</td><td><code><pre>func makeConditions(apiConditions []v1beta1.Condition) *[]n.ApplicationGatewayRewriteRuleCondition {</pre></code></td></tr><tr><td>128</td><td><code><pre></pre></code></td></tr><tr><td>129</td><td><code><pre>        appGwConditions := []n.ApplicationGatewayRewriteRuleCondition{}</pre></code></td></tr><tr><td>130</td><td><code><pre></pre></code></td></tr><tr><td>131</td><td><code><pre>        for _, c := range apiConditions {</pre></code></td></tr><tr><td>132</td><td><code><pre></pre></code></td></tr><tr><td>133</td><td><code><pre>                appGwConditions = append(appGwConditions, n.ApplicationGatewayRewriteRuleCondition{</pre></code></td></tr><tr><td>134</td><td><code><pre>                        IgnoreCase: to.BoolPtr(c.IgnoreCase),</pre></code></td></tr><tr><td>135</td><td><code><pre>                        Negate:     to.BoolPtr(c.Negate),</pre></code></td></tr><tr><td>136</td><td><code><pre>                        Variable:   to.StringPtr(c.Variable),</pre></code></td></tr><tr><td>137</td><td><code><pre>                        Pattern:    to.StringPtr(c.Pattern),</pre></code></td></tr><tr><td>138</td><td><code><pre>                })</pre></code></td></tr><tr><td>139</td><td><code><pre></pre></code></td></tr><tr><td>140</td><td><code><pre>        }</pre></code></td></tr><tr><td>141</td><td><code><pre></pre></code></td></tr><tr><td>142</td><td><code><pre>        return &amp;appGwConditions</pre></code></td></tr><tr><td>143</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_makeHeaderConfigs">func makeHeaderConfigs</div><div class="info"><a href="#s_fn_makeHeaderConfigs">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>157</td><td><code><pre>func makeHeaderConfigs(apiHeaderConfigs []v1beta1.HeaderConfiguration) *[]n.ApplicationGatewayHeaderConfiguration {</pre></code></td></tr><tr><td>158</td><td><code><pre></pre></code></td></tr><tr><td>159</td><td><code><pre>        appGwHeaderConfig := []n.ApplicationGatewayHeaderConfiguration{}</pre></code></td></tr><tr><td>160</td><td><code><pre></pre></code></td></tr><tr><td>161</td><td><code><pre>        for _, hc := range apiHeaderConfigs {</pre></code></td></tr><tr><td>162</td><td><code><pre></pre></code></td></tr><tr><td>163</td><td><code><pre>                appGwHeaderConfig = append(appGwHeaderConfig, n.ApplicationGatewayHeaderConfiguration{</pre></code></td></tr><tr><td>164</td><td><code><pre>                        HeaderName:  to.StringPtr(hc.HeaderName),</pre></code></td></tr><tr><td>165</td><td><code><pre>                        HeaderValue: to.StringPtr(hc.HeaderValue),</pre></code></td></tr><tr><td>166</td><td><code><pre>                })</pre></code></td></tr><tr><td>167</td><td><code><pre></pre></code></td></tr><tr><td>168</td><td><code><pre>        }</pre></code></td></tr><tr><td>169</td><td><code><pre></pre></code></td></tr><tr><td>170</td><td><code><pre>        return &amp;appGwHeaderConfig</pre></code></td></tr><tr><td>171</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ConfigBuilderContext.InIngressList">func ConfigBuilderContext.InIngressList</div><div class="info"><a href="#s_fn_ConfigBuilderContext.InIngressList">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/types.go</code>:</p></div><table class="listing">
<tr><td>36</td><td><code><pre>func (cbCtx *ConfigBuilderContext) InIngressList(ingress *networking.Ingress) bool {</pre></code></td></tr><tr><td>37</td><td><code><pre>        for _, prunedIngress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>38</td><td><code><pre>                if ingress.Name == prunedIngress.Name &amp;&amp; ingress.Namespace == prunedIngress.Namespace {</pre></code></td></tr><tr><td>39</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>40</td><td><code><pre>                }</pre></code></td></tr><tr><td>41</td><td><code><pre>        }</pre></code></td></tr><tr><td>42</td><td><code><pre>        return false</pre></code></td></tr><tr><td>43</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LookupListenerByID">func LookupListenerByID</div><div class="info"><a href="#s_fn_LookupListenerByID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code>:</p></div><table class="listing">
<tr><td>231</td><td><code><pre>func LookupListenerByID(listeners *[]n.ApplicationGatewayHTTPListener, ID *string) *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>232</td><td><code><pre>        for _, listener := range *listeners {</pre></code></td></tr><tr><td>233</td><td><code><pre>                if *listener.ID == *ID {</pre></code></td></tr><tr><td>234</td><td><code><pre>                        return &amp;listener</pre></code></td></tr><tr><td>235</td><td><code><pre>                }</pre></code></td></tr><tr><td>236</td><td><code><pre>        }</pre></code></td></tr><tr><td>237</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>238</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.Listeners">func appGwConfigBuilder.Listeners</div><div class="info"><a href="#s_fn_appGwConfigBuilder.Listeners">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/http_listeners.go</code>:</p></div><table class="listing">
<tr><td>8</td><td><code><pre>func (c *appGwConfigBuilder) Listeners(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>9</td><td><code><pre></pre></code></td></tr><tr><td>10</td><td><code><pre>        c.appGw.SslCertificates = c.getSslCertificates(cbCtx)</pre></code></td></tr><tr><td>11</td><td><code><pre>        c.appGw.HTTPListeners, c.appGw.FrontendPorts = c.getListeners(cbCtx)</pre></code></td></tr><tr><td>12</td><td><code><pre></pre></code></td></tr><tr><td>13</td><td><code><pre>        // App Gateway Rules can be configured to redirect HTTP traffic to HTTPS URLs.</pre></code></td></tr><tr><td>14</td><td><code><pre>        // In this step here we create the redirection configurations. These configs are attached to request routing rules</pre></code></td></tr><tr><td>15</td><td><code><pre>        // in the RequestRoutingRules step, which must be executed after Listeners.</pre></code></td></tr><tr><td>16</td><td><code><pre>        c.appGw.RedirectConfigurations = c.getRedirectConfigurations(cbCtx)</pre></code></td></tr><tr><td>17</td><td><code><pre></pre></code></td></tr><tr><td>18</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>19</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_listenerIdentifier.setHostNames">func listenerIdentifier.setHostNames</div><div class="info"><a href="#s_fn_listenerIdentifier.setHostNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>242</td><td><code><pre>func (listenerID *listenerIdentifier) setHostNames(hostNames []string) {</pre></code></td></tr><tr><td>243</td><td><code><pre>        hostnameCount := int(math.Min(float64(len(hostNames)), float64(MaxAllowedHostNames)))</pre></code></td></tr><tr><td>244</td><td><code><pre>        for i := 0; i &lt; hostnameCount; i++ {</pre></code></td></tr><tr><td>245</td><td><code><pre>                listenerID.HostNames[i] = hostNames[i]</pre></code></td></tr><tr><td>246</td><td><code><pre>        }</pre></code></td></tr><tr><td>247</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IsPrivateIPConfiguration">func IsPrivateIPConfiguration</div><div class="info"><a href="#s_fn_IsPrivateIPConfiguration">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_ipconfigurations.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func IsPrivateIPConfiguration(frontendIPConfiguration *n.ApplicationGatewayFrontendIPConfiguration) bool {</pre></code></td></tr><tr><td>32</td><td><code><pre>        if frontendIPConfiguration.ApplicationGatewayFrontendIPConfigurationPropertiesFormat != nil &amp;&amp; frontendIPConfiguration.PrivateIPAddress != nil {</pre></code></td></tr><tr><td>33</td><td><code><pre>                return true</pre></code></td></tr><tr><td>34</td><td><code><pre>        }</pre></code></td></tr><tr><td>35</td><td><code><pre>        return false</pre></code></td></tr><tr><td>36</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_secretIdentifier.secretFullName">func secretIdentifier.secretFullName</div><div class="info"><a href="#s_fn_secretIdentifier.secretFullName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>122</td><td><code><pre>func (s secretIdentifier) secretFullName() string {</pre></code></td></tr><tr><td>123</td><td><code><pre>        // in case of referring ssl certificate from agic annotation</pre></code></td></tr><tr><td>124</td><td><code><pre>        if len(s.Namespace) == 0 {</pre></code></td></tr><tr><td>125</td><td><code><pre>                return s.Name</pre></code></td></tr><tr><td>126</td><td><code><pre>        }</pre></code></td></tr><tr><td>127</td><td><code><pre>        return fmt.Sprintf(&#34;%v%v-%v-%v&#34;, agPrefix, prefixSslCertificate, s.Namespace, s.Name)</pre></code></td></tr><tr><td>128</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_serviceBackendPortToStr">func serviceBackendPortToStr</div><div class="info"><a href="#s_fn_serviceBackendPortToStr">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/helper.go</code>:</p></div><table class="listing">
<tr><td>14</td><td><code><pre>func serviceBackendPortToStr(port networkingv1.ServiceBackendPort) string {</pre></code></td></tr><tr><td>15</td><td><code><pre>        if port.Name != &#34;&#34; {</pre></code></td></tr><tr><td>16</td><td><code><pre>                return fmt.Sprintf(port.Name)</pre></code></td></tr><tr><td>17</td><td><code><pre>        }</pre></code></td></tr><tr><td>18</td><td><code><pre>        return fmt.Sprintf(&#34;%d&#34;, port.Number)</pre></code></td></tr><tr><td>19</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_keyFunc">func keyFunc</div><div class="info"><a href="#s_fn_keyFunc">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>79</td><td><code><pre>func keyFunc(obj interface{}) (string, error) {</pre></code></td></tr><tr><td>80</td><td><code><pre>        namespace := reflect.ValueOf(obj).Elem().FieldByName(&#34;ObjectMeta&#34;).FieldByName(&#34;Namespace&#34;).String()</pre></code></td></tr><tr><td>81</td><td><code><pre>        name := reflect.ValueOf(obj).Elem().FieldByName(&#34;ObjectMeta&#34;).FieldByName(&#34;Name&#34;).String()</pre></code></td></tr><tr><td>82</td><td><code><pre></pre></code></td></tr><tr><td>83</td><td><code><pre>        return fmt.Sprintf(&#34;%s/%s&#34;, namespace, name), nil</pre></code></td></tr><tr><td>84</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getSslRedirectConfigResourceReference">func appGwConfigBuilder.getSslRedirectConfigResourceReference</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getSslRedirectConfigResourceReference">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code>:</p></div><table class="listing">
<tr><td>99</td><td><code><pre>func (c *appGwConfigBuilder) getSslRedirectConfigResourceReference(targetListener listenerIdentifier) *n.SubResource {</pre></code></td></tr><tr><td>100</td><td><code><pre>        configName := generateSSLRedirectConfigurationName(targetListener)</pre></code></td></tr><tr><td>101</td><td><code><pre>        sslRedirectConfigID := c.appGwIdentifier.redirectConfigurationID(configName)</pre></code></td></tr><tr><td>102</td><td><code><pre>        return resourceRef(sslRedirectConfigID)</pre></code></td></tr><tr><td>103</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_defaultBackendHTTPSettings">func defaultBackendHTTPSettings</div><div class="info"><a href="#s_fn_defaultBackendHTTPSettings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>180</td><td><code><pre>func defaultBackendHTTPSettings(appGWIdentifier Identifier, protocol n.ApplicationGatewayProtocol) n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr><td>181</td><td><code><pre>        defHTTPSettingsName := DefaultBackendHTTPSettingsName</pre></code></td></tr><tr><td>182</td><td><code><pre>        defHTTPSettingsPort := int32(80)</pre></code></td></tr><tr><td>183</td><td><code><pre>        return n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>184</td><td><code><pre>                Name: &amp;defHTTPSettingsName,</pre></code></td></tr><tr><td>185</td><td><code><pre>                ID:   to.StringPtr(appGWIdentifier.HTTPSettingsID(defHTTPSettingsName)),</pre></code></td></tr><tr><td>186</td><td><code><pre>                ApplicationGatewayBackendHTTPSettingsPropertiesFormat: &amp;n.ApplicationGatewayBackendHTTPSettingsPropertiesFormat{</pre></code></td></tr><tr><td>187</td><td><code><pre>                        Protocol: protocol,</pre></code></td></tr><tr><td>188</td><td><code><pre>                        Port:     &amp;defHTTPSettingsPort,</pre></code></td></tr><tr><td>189</td><td><code><pre>                        Probe:    resourceRef(appGWIdentifier.probeID(defaultProbeName(protocol))),</pre></code></td></tr><tr><td>190</td><td><code><pre></pre></code></td></tr><tr><td>191</td><td><code><pre>                        // setting to default</pre></code></td></tr><tr><td>192</td><td><code><pre>                        PickHostNameFromBackendAddress: to.BoolPtr(false),</pre></code></td></tr><tr><td>193</td><td><code><pre>                        CookieBasedAffinity:            n.ApplicationGatewayCookieBasedAffinityDisabled,</pre></code></td></tr><tr><td>194</td><td><code><pre>                        RequestTimeout:                 to.Int32Ptr(30),</pre></code></td></tr><tr><td>195</td><td><code><pre>                },</pre></code></td></tr><tr><td>196</td><td><code><pre>        }</pre></code></td></tr><tr><td>197</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_newConfigBuilderFixture">func newConfigBuilderFixture</div><div class="info"><a href="#s_fn_newConfigBuilderFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>86</td><td><code><pre>func newConfigBuilderFixture(certs *map[string]interface{}) appGwConfigBuilder {</pre></code></td></tr><tr><td>87</td><td><code><pre>        appGwConfig := NewAppGwyConfigFixture()</pre></code></td></tr><tr><td>88</td><td><code><pre>        cb := appGwConfigBuilder{</pre></code></td></tr><tr><td>89</td><td><code><pre>                appGwIdentifier: Identifier{</pre></code></td></tr><tr><td>90</td><td><code><pre>                        SubscriptionID: tests.Subscription,</pre></code></td></tr><tr><td>91</td><td><code><pre>                        ResourceGroup:  tests.ResourceGroup,</pre></code></td></tr><tr><td>92</td><td><code><pre>                        AppGwName:      tests.AppGwName,</pre></code></td></tr><tr><td>93</td><td><code><pre>                },</pre></code></td></tr><tr><td>94</td><td><code><pre>                appGw: n.ApplicationGateway{ApplicationGatewayPropertiesFormat: appGwConfig},</pre></code></td></tr><tr><td>95</td><td><code><pre>                k8sContext: &amp;k8scontext.Context{</pre></code></td></tr><tr><td>96</td><td><code><pre>                        Caches: &amp;k8scontext.CacheCollection{</pre></code></td></tr><tr><td>97</td><td><code><pre>                                AzureApplicationGatewayRewrite: cache.NewStore(keyFunc),</pre></code></td></tr><tr><td>98</td><td><code><pre>                                Endpoints:                      cache.NewStore(keyFunc),</pre></code></td></tr><tr><td>99</td><td><code><pre>                                Secret:                         cache.NewStore(keyFunc),</pre></code></td></tr><tr><td>100</td><td><code><pre>                                Service:                        cache.NewStore(keyFunc),</pre></code></td></tr><tr><td>101</td><td><code><pre>                                Pods:                           cache.NewStore(keyFunc),</pre></code></td></tr><tr><td>102</td><td><code><pre>                                Ingress:                        cache.NewStore(keyFunc),</pre></code></td></tr><tr><td>103</td><td><code><pre>                        },</pre></code></td></tr><tr><td>104</td><td><code><pre>                        CertificateSecretStore: newSecretStoreFixture(certs),</pre></code></td></tr><tr><td>105</td><td><code><pre>                        MetricStore:            metricstore.NewFakeMetricStore(),</pre></code></td></tr><tr><td>106</td><td><code><pre>                },</pre></code></td></tr><tr><td>107</td><td><code><pre>                recorder: record.NewFakeRecorder(100),</pre></code></td></tr><tr><td>108</td><td><code><pre>        }</pre></code></td></tr><tr><td>109</td><td><code><pre></pre></code></td></tr><tr><td>110</td><td><code><pre>        return cb</pre></code></td></tr><tr><td>111</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_newTestListenerID">func newTestListenerID</div><div class="info"><a href="#s_fn_newTestListenerID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>161</td><td><code><pre>func newTestListenerID(port Port, hostNames []string, usePrivateIP bool) (listenerIdentifier, string) {</pre></code></td></tr><tr><td>162</td><td><code><pre>        listener := listenerIdentifier{</pre></code></td></tr><tr><td>163</td><td><code><pre>                FrontendPort: port,</pre></code></td></tr><tr><td>164</td><td><code><pre>                UsePrivateIP: usePrivateIP,</pre></code></td></tr><tr><td>165</td><td><code><pre>        }</pre></code></td></tr><tr><td>166</td><td><code><pre>        listener.setHostNames(hostNames)</pre></code></td></tr><tr><td>167</td><td><code><pre>        return listener, generateListenerName(listener)</pre></code></td></tr><tr><td>168</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newSSLRedirectConfig">func appGwConfigBuilder.newSSLRedirectConfig</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newSSLRedirectConfig">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code>:</p></div><table class="listing">
<tr><td>67</td><td><code><pre>func (c *appGwConfigBuilder) newSSLRedirectConfig(listenerConfig listenerAzConfig, targetListener *n.SubResource) n.ApplicationGatewayRedirectConfiguration {</pre></code></td></tr><tr><td>68</td><td><code><pre>        props := n.ApplicationGatewayRedirectConfigurationPropertiesFormat{</pre></code></td></tr><tr><td>69</td><td><code><pre>                // RedirectType could be one of: 301/Permanent, 302/Found, 303/See Other, 307/Temporary</pre></code></td></tr><tr><td>70</td><td><code><pre>                RedirectType: n.ApplicationGatewayRedirectTypePermanent,</pre></code></td></tr><tr><td>71</td><td><code><pre></pre></code></td></tr><tr><td>72</td><td><code><pre>                // To what listener we are redirecting.</pre></code></td></tr><tr><td>73</td><td><code><pre>                TargetListener: targetListener,</pre></code></td></tr><tr><td>74</td><td><code><pre></pre></code></td></tr><tr><td>75</td><td><code><pre>                // Include the path in the redirected URL.</pre></code></td></tr><tr><td>76</td><td><code><pre>                IncludePath: to.BoolPtr(true),</pre></code></td></tr><tr><td>77</td><td><code><pre></pre></code></td></tr><tr><td>78</td><td><code><pre>                // Include the query string in the redirected URL.</pre></code></td></tr><tr><td>79</td><td><code><pre>                IncludeQueryString: to.BoolPtr(true),</pre></code></td></tr><tr><td>80</td><td><code><pre>        }</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>        // To create a new redirect we need a</pre></code></td></tr><tr><td>83</td><td><code><pre>        return n.ApplicationGatewayRedirectConfiguration{</pre></code></td></tr><tr><td>84</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>85</td><td><code><pre>                Name: &amp;listenerConfig.SslRedirectConfigurationName,</pre></code></td></tr><tr><td>86</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.redirectConfigurationID(listenerConfig.SslRedirectConfigurationName)),</pre></code></td></tr><tr><td>87</td><td><code><pre>                ApplicationGatewayRedirectConfigurationPropertiesFormat: &amp;props,</pre></code></td></tr><tr><td>88</td><td><code><pre>        }</pre></code></td></tr><tr><td>89</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.pathRuleID">func Identifier.pathRuleID</div><div class="info"><a href="#s_fn_Identifier.pathRuleID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>66</td><td><code><pre>func (agw Identifier) pathRuleID(pathMapName string, pathRuleName string) string {</pre></code></td></tr><tr><td>67</td><td><code><pre>        pathRuleSuffix := fmt.Sprintf(&#34;%s/pathRules/%s&#34;, pathMapName, pathRuleName)</pre></code></td></tr><tr><td>68</td><td><code><pre>        return agw.urlPathMapID(pathRuleSuffix)</pre></code></td></tr><tr><td>69</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewAppGwyConfigFixture">func NewAppGwyConfigFixture</div><div class="info"><a href="#s_fn_NewAppGwyConfigFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>23</td><td><code><pre>func NewAppGwyConfigFixture() *n.ApplicationGatewayPropertiesFormat {</pre></code></td></tr><tr><td>24</td><td><code><pre>        feIPConfigs := []n.ApplicationGatewayFrontendIPConfiguration{</pre></code></td></tr><tr><td>25</td><td><code><pre>                {</pre></code></td></tr><tr><td>26</td><td><code><pre>                        // Public IP</pre></code></td></tr><tr><td>27</td><td><code><pre>                        Name: to.StringPtr(&#34;xx3&#34;),</pre></code></td></tr><tr><td>28</td><td><code><pre>                        Etag: to.StringPtr(&#34;xx2&#34;),</pre></code></td></tr><tr><td>29</td><td><code><pre>                        Type: to.StringPtr(&#34;xx1&#34;),</pre></code></td></tr><tr><td>30</td><td><code><pre>                        ID:   to.StringPtr(tests.PublicIPID),</pre></code></td></tr><tr><td>31</td><td><code><pre>                        ApplicationGatewayFrontendIPConfigurationPropertiesFormat: &amp;n.ApplicationGatewayFrontendIPConfigurationPropertiesFormat{</pre></code></td></tr><tr><td>32</td><td><code><pre>                                PrivateIPAddress: nil,</pre></code></td></tr><tr><td>33</td><td><code><pre>                                PublicIPAddress: &amp;n.SubResource{</pre></code></td></tr><tr><td>34</td><td><code><pre>                                        ID: to.StringPtr(&#34;xyz&#34;),</pre></code></td></tr><tr><td>35</td><td><code><pre>                                },</pre></code></td></tr><tr><td>36</td><td><code><pre>                        },</pre></code></td></tr><tr><td>37</td><td><code><pre>                },</pre></code></td></tr><tr><td>38</td><td><code><pre>                {</pre></code></td></tr><tr><td>39</td><td><code><pre>                        // Private IP</pre></code></td></tr><tr><td>40</td><td><code><pre>                        Name: to.StringPtr(&#34;yy3&#34;),</pre></code></td></tr><tr><td>41</td><td><code><pre>                        Etag: to.StringPtr(&#34;yy2&#34;),</pre></code></td></tr><tr><td>42</td><td><code><pre>                        Type: to.StringPtr(&#34;yy1&#34;),</pre></code></td></tr><tr><td>43</td><td><code><pre>                        ID:   to.StringPtr(tests.PrivateIPID),</pre></code></td></tr><tr><td>44</td><td><code><pre>                        ApplicationGatewayFrontendIPConfigurationPropertiesFormat: &amp;n.ApplicationGatewayFrontendIPConfigurationPropertiesFormat{</pre></code></td></tr><tr><td>45</td><td><code><pre>                                PrivateIPAddress: to.StringPtr(&#34;abc&#34;),</pre></code></td></tr><tr><td>46</td><td><code><pre>                                PublicIPAddress:  nil,</pre></code></td></tr><tr><td>47</td><td><code><pre>                        },</pre></code></td></tr><tr><td>48</td><td><code><pre>                },</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre>        return &amp;n.ApplicationGatewayPropertiesFormat{</pre></code></td></tr><tr><td>51</td><td><code><pre>                FrontendIPConfigurations: &amp;feIPConfigs,</pre></code></td></tr><tr><td>52</td><td><code><pre>                Sku: &amp;n.ApplicationGatewaySku{</pre></code></td></tr><tr><td>53</td><td><code><pre>                        Name:     n.ApplicationGatewaySkuNameStandardV2,</pre></code></td></tr><tr><td>54</td><td><code><pre>                        Tier:     n.ApplicationGatewayTierStandardV2,</pre></code></td></tr><tr><td>55</td><td><code><pre>                        Capacity: to.Int32Ptr(3),</pre></code></td></tr><tr><td>56</td><td><code><pre>                },</pre></code></td></tr><tr><td>57</td><td><code><pre>        }</pre></code></td></tr><tr><td>58</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.gatewayResourceID">func Identifier.gatewayResourceID</div><div class="info"><a href="#s_fn_Identifier.gatewayResourceID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>27</td><td><code><pre>func (agw Identifier) gatewayResourceID(subResourceKind string, resourceName string) string {</pre></code></td></tr><tr><td>28</td><td><code><pre>        resourcePath := fmt.Sprintf(&#34;%s/%s/%s&#34;, agw.AppGwName, subResourceKind, resourceName)</pre></code></td></tr><tr><td>29</td><td><code><pre>        return agw.resourceID(&#34;Microsoft.Network&#34;, &#34;applicationGateways&#34;, resourcePath)</pre></code></td></tr><tr><td>30</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newCert">func appGwConfigBuilder.newCert</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newCert">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code>:</p></div><table class="listing">
<tr><td>134</td><td><code><pre>func (c *appGwConfigBuilder) newCert(secretID secretIdentifier, cert *string) n.ApplicationGatewaySslCertificate {</pre></code></td></tr><tr><td>135</td><td><code><pre>        sslCertName := secretID.secretFullName()</pre></code></td></tr><tr><td>136</td><td><code><pre>        return n.ApplicationGatewaySslCertificate{</pre></code></td></tr><tr><td>137</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>138</td><td><code><pre>                Name: to.StringPtr(sslCertName),</pre></code></td></tr><tr><td>139</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.sslCertificateID(sslCertName)),</pre></code></td></tr><tr><td>140</td><td><code><pre>                ApplicationGatewaySslCertificatePropertiesFormat: &amp;n.ApplicationGatewaySslCertificatePropertiesFormat{</pre></code></td></tr><tr><td>141</td><td><code><pre>                        Data:     cert,</pre></code></td></tr><tr><td>142</td><td><code><pre>                        Password: to.StringPtr(&#34;msazure&#34;),</pre></code></td></tr><tr><td>143</td><td><code><pre>                },</pre></code></td></tr><tr><td>144</td><td><code><pre>        }</pre></code></td></tr><tr><td>145</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateFrontendPortName">func generateFrontendPortName</div><div class="info"><a href="#s_fn_generateFrontendPortName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>146</td><td><code><pre>func generateFrontendPortName(port Port) string {</pre></code></td></tr><tr><td>147</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%v&#34;, agPrefix, prefixPort, port))</pre></code></td></tr><tr><td>148</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.resourceID">func Identifier.resourceID</div><div class="info"><a href="#s_fn_Identifier.resourceID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>22</td><td><code><pre>func (agw Identifier) resourceID(provider string, resourceKind string, resourcePath string) string {</pre></code></td></tr><tr><td>23</td><td><code><pre>        return fmt.Sprintf(&#34;/subscriptions/%s/resourceGroups/%s/providers/%s/%s/%s&#34;,</pre></code></td></tr><tr><td>24</td><td><code><pre>                agw.SubscriptionID, agw.ResourceGroup, provider, resourceKind, resourcePath)</pre></code></td></tr><tr><td>25</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_defaultBackendAddressPool">func defaultBackendAddressPool</div><div class="info"><a href="#s_fn_defaultBackendAddressPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>225</td><td><code><pre>func defaultBackendAddressPool(appGWIdentifier Identifier) n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>226</td><td><code><pre>        return n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>227</td><td><code><pre>                Name: &amp;DefaultBackendAddressPoolName,</pre></code></td></tr><tr><td>228</td><td><code><pre>                ID:   to.StringPtr(appGWIdentifier.AddressPoolID(DefaultBackendAddressPoolName)),</pre></code></td></tr><tr><td>229</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>230</td><td><code><pre>                        BackendAddresses: &amp;[]n.ApplicationGatewayBackendAddress{},</pre></code></td></tr><tr><td>231</td><td><code><pre>                },</pre></code></td></tr><tr><td>232</td><td><code><pre>        }</pre></code></td></tr><tr><td>233</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.AddressPoolID">func Identifier.AddressPoolID</div><div class="info"><a href="#s_fn_Identifier.AddressPoolID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>33</td><td><code><pre>func (agw Identifier) AddressPoolID(poolName string) string {</pre></code></td></tr><tr><td>34</td><td><code><pre>        return agw.gatewayResourceID(&#34;backendAddressPools&#34;, poolName)</pre></code></td></tr><tr><td>35</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_serviceIdentifier.serviceFullName">func serviceIdentifier.serviceFullName</div><div class="info"><a href="#s_fn_serviceIdentifier.serviceFullName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>106</td><td><code><pre>func (s serviceIdentifier) serviceFullName() string {</pre></code></td></tr><tr><td>107</td><td><code><pre>        return fmt.Sprintf(&#34;%v-%v&#34;, s.Namespace, s.Name)</pre></code></td></tr><tr><td>108</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.frontendPortID">func Identifier.frontendPortID</div><div class="info"><a href="#s_fn_Identifier.frontendPortID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>41</td><td><code><pre>func (agw Identifier) frontendPortID(portName string) string {</pre></code></td></tr><tr><td>42</td><td><code><pre>        return agw.gatewayResourceID(&#34;frontendPorts&#34;, portName)</pre></code></td></tr><tr><td>43</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.sslCertificateID">func Identifier.sslCertificateID</div><div class="info"><a href="#s_fn_Identifier.sslCertificateID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>45</td><td><code><pre>func (agw Identifier) sslCertificateID(certname string) string {</pre></code></td></tr><tr><td>46</td><td><code><pre>        return agw.gatewayResourceID(&#34;sslCertificates&#34;, certname)</pre></code></td></tr><tr><td>47</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_defaultFrontendListenerIdentifier">func defaultFrontendListenerIdentifier</div><div class="info"><a href="#s_fn_defaultFrontendListenerIdentifier">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>235</td><td><code><pre>func defaultFrontendListenerIdentifier(usePrivateIP bool) listenerIdentifier {</pre></code></td></tr><tr><td>236</td><td><code><pre>        return listenerIdentifier{</pre></code></td></tr><tr><td>237</td><td><code><pre>                FrontendPort: Port(80),</pre></code></td></tr><tr><td>238</td><td><code><pre>                UsePrivateIP: usePrivateIP,</pre></code></td></tr><tr><td>239</td><td><code><pre>        }</pre></code></td></tr><tr><td>240</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.trustedRootCertificateID">func Identifier.trustedRootCertificateID</div><div class="info"><a href="#s_fn_Identifier.trustedRootCertificateID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func (agw Identifier) trustedRootCertificateID(certname string) string {</pre></code></td></tr><tr><td>54</td><td><code><pre>        return agw.gatewayResourceID(&#34;trustedRootCertificates&#34;, certname)</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_isPathCatchAll">func isPathCatchAll</div><div class="info"><a href="#s_fn_isPathCatchAll">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>500</td><td><code><pre>func isPathCatchAll(path string, pathType *networking.PathType) bool {</pre></code></td></tr><tr><td>501</td><td><code><pre>        return len(path) == 0 || path == &#34;/*&#34; || path == &#34;/&#34;</pre></code></td></tr><tr><td>502</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.urlPathMapID">func Identifier.urlPathMapID</div><div class="info"><a href="#s_fn_Identifier.urlPathMapID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>62</td><td><code><pre>func (agw Identifier) urlPathMapID(urlPathMapName string) string {</pre></code></td></tr><tr><td>63</td><td><code><pre>        return agw.gatewayResourceID(&#34;urlPathMaps&#34;, urlPathMapName)</pre></code></td></tr><tr><td>64</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetVersion">func GetVersion</div><div class="info"><a href="#s_fn_GetVersion">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>280</td><td><code><pre>func GetVersion() string {</pre></code></td></tr><tr><td>281</td><td><code><pre>        return fmt.Sprintf(&#34;%s/%s/%s&#34;, version.Version, version.GitCommit, version.BuildDate)</pre></code></td></tr><tr><td>282</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.listenerID">func Identifier.listenerID</div><div class="info"><a href="#s_fn_Identifier.listenerID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>71</td><td><code><pre>func (agw Identifier) listenerID(listenerName string) string {</pre></code></td></tr><tr><td>72</td><td><code><pre>        return agw.gatewayResourceID(&#34;httpListeners&#34;, listenerName)</pre></code></td></tr><tr><td>73</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.redirectConfigurationID">func Identifier.redirectConfigurationID</div><div class="info"><a href="#s_fn_Identifier.redirectConfigurationID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>75</td><td><code><pre>func (agw Identifier) redirectConfigurationID(configurationName string) string {</pre></code></td></tr><tr><td>76</td><td><code><pre>        return agw.gatewayResourceID(&#34;redirectConfigurations&#34;, configurationName)</pre></code></td></tr><tr><td>77</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.probeID">func Identifier.probeID</div><div class="info"><a href="#s_fn_Identifier.probeID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>79</td><td><code><pre>func (agw Identifier) probeID(probeName string) string {</pre></code></td></tr><tr><td>80</td><td><code><pre>        return agw.gatewayResourceID(&#34;probes&#34;, probeName)</pre></code></td></tr><tr><td>81</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_defaultProbeName">func defaultProbeName</div><div class="info"><a href="#s_fn_defaultProbeName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>176</td><td><code><pre>func defaultProbeName(protocol n.ApplicationGatewayProtocol) string {</pre></code></td></tr><tr><td>177</td><td><code><pre>        return fmt.Sprintf(&#34;%sdefaultprobe-%s&#34;, agPrefix, protocol)</pre></code></td></tr><tr><td>178</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generatePathRuleName">func generatePathRuleName</div><div class="info"><a href="#s_fn_generatePathRuleName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>166</td><td><code><pre>func generatePathRuleName(namespace, ingress string, ruleIdx, pathIdx int) string {</pre></code></td></tr><tr><td>167</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%s-%s-rule-%d-path-%d&#34;, agPrefix, prefixPathRule, namespace, ingress, ruleIdx, pathIdx))</pre></code></td></tr><tr><td>168</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateSSLRedirectConfigurationName">func generateSSLRedirectConfigurationName</div><div class="info"><a href="#s_fn_generateSSLRedirectConfigurationName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>162</td><td><code><pre>func generateSSLRedirectConfigurationName(targetListener listenerIdentifier) string {</pre></code></td></tr><tr><td>163</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%s&#34;, agPrefix, prefixRedirect, generateListenerName(targetListener)))</pre></code></td></tr><tr><td>164</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.requestRoutingRuleID">func Identifier.requestRoutingRuleID</div><div class="info"><a href="#s_fn_Identifier.requestRoutingRuleID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>96</td><td><code><pre>func (agw Identifier) requestRoutingRuleID(settingsName string) string {</pre></code></td></tr><tr><td>97</td><td><code><pre>        return agw.gatewayResourceID(&#34;requestRoutingRules&#34;, settingsName)</pre></code></td></tr><tr><td>98</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.rewriteRuleSetID">func Identifier.rewriteRuleSetID</div><div class="info"><a href="#s_fn_Identifier.rewriteRuleSetID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>100</td><td><code><pre>func (agw Identifier) rewriteRuleSetID(rewriteName string) string {</pre></code></td></tr><tr><td>101</td><td><code><pre>        return agw.gatewayResourceID(&#34;rewriteRuleSets&#34;, rewriteName)</pre></code></td></tr><tr><td>102</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_resourceRef">func resourceRef</div><div class="info"><a href="#s_fn_resourceRef">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>104</td><td><code><pre>func resourceRef(id string) *n.SubResource {</pre></code></td></tr><tr><td>105</td><td><code><pre>        return &amp;n.SubResource{ID: to.StringPtr(id)}</pre></code></td></tr><tr><td>106</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateRequestRoutingRuleName">func generateRequestRoutingRuleName</div><div class="info"><a href="#s_fn_generateRequestRoutingRuleName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>158</td><td><code><pre>func generateRequestRoutingRuleName(listenerID listenerIdentifier) string {</pre></code></td></tr><tr><td>159</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%s&#34;, agPrefix, prefixRoutingRule, utils.GetHashCode(listenerID)))</pre></code></td></tr><tr><td>160</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateBackendID">func generateBackendID</div><div class="info"><a href="#s_fn_generateBackendID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>213</td><td><code><pre>func generateBackendID(ingress *networking.Ingress, rule *networking.IngressRule, path *networking.HTTPIngressPath, backend *networking.IngressBackend) backendIdentifier {</pre></code></td></tr><tr><td>214</td><td><code><pre>        return backendIdentifier{</pre></code></td></tr><tr><td>215</td><td><code><pre>                serviceIdentifier: serviceIdentifier{</pre></code></td></tr><tr><td>216</td><td><code><pre>                        Namespace: ingress.Namespace,</pre></code></td></tr><tr><td>217</td><td><code><pre>                        Name:      backend.Service.Name,</pre></code></td></tr><tr><td>218</td><td><code><pre>                },</pre></code></td></tr><tr><td>219</td><td><code><pre>                Ingress: ingress,</pre></code></td></tr><tr><td>220</td><td><code><pre>                Rule:    rule,</pre></code></td></tr><tr><td>221</td><td><code><pre>                Path:    path,</pre></code></td></tr><tr><td>222</td><td><code><pre>                Backend: backend,</pre></code></td></tr><tr><td>223</td><td><code><pre>        }</pre></code></td></tr><tr><td>224</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_makeActionSet">func makeActionSet</div><div class="info"><a href="#s_fn_makeActionSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>146</td><td><code><pre>func makeActionSet(apiActions v1beta1.Actions) *n.ApplicationGatewayRewriteRuleActionSet {</pre></code></td></tr><tr><td>147</td><td><code><pre></pre></code></td></tr><tr><td>148</td><td><code><pre>        return &amp;n.ApplicationGatewayRewriteRuleActionSet{</pre></code></td></tr><tr><td>149</td><td><code><pre>                RequestHeaderConfigurations:  makeHeaderConfigs(apiActions.RequestHeaderConfigurations),</pre></code></td></tr><tr><td>150</td><td><code><pre>                ResponseHeaderConfigurations: makeHeaderConfigs(apiActions.ResponseHeaderConfigurations),</pre></code></td></tr><tr><td>151</td><td><code><pre>                URLConfiguration:             makeURLConfig(apiActions.UrlConfiguration),</pre></code></td></tr><tr><td>152</td><td><code><pre>        }</pre></code></td></tr><tr><td>153</td><td><code><pre></pre></code></td></tr><tr><td>154</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateURLPathMapName">func generateURLPathMapName</div><div class="info"><a href="#s_fn_generateURLPathMapName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>154</td><td><code><pre>func generateURLPathMapName(listenerID listenerIdentifier) string {</pre></code></td></tr><tr><td>155</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%s&#34;, agPrefix, prefixPathMap, utils.GetHashCode(listenerID)))</pre></code></td></tr><tr><td>156</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewConfigBuilder">func NewConfigBuilder</div><div class="info"><a href="#s_fn_NewConfigBuilder">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>69</td><td><code><pre>func NewConfigBuilder(context *k8scontext.Context, appGwIdentifier *Identifier, original *n.ApplicationGateway, recorder record.EventRecorder, clock Clock) ConfigBuilder {</pre></code></td></tr><tr><td>70</td><td><code><pre>        return &amp;appGwConfigBuilder{</pre></code></td></tr><tr><td>71</td><td><code><pre>                k8sContext:      context,</pre></code></td></tr><tr><td>72</td><td><code><pre>                appGwIdentifier: *appGwIdentifier,</pre></code></td></tr><tr><td>73</td><td><code><pre>                appGw:           *original,</pre></code></td></tr><tr><td>74</td><td><code><pre>                recorder:        recorder,</pre></code></td></tr><tr><td>75</td><td><code><pre>                clock:           clock,</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_makeURLConfig">func makeURLConfig</div><div class="info"><a href="#s_fn_makeURLConfig">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>174</td><td><code><pre>func makeURLConfig(apiURLConfig v1beta1.UrlConfiguration) *n.ApplicationGatewayURLConfiguration {</pre></code></td></tr><tr><td>175</td><td><code><pre>        return &amp;n.ApplicationGatewayURLConfiguration{</pre></code></td></tr><tr><td>176</td><td><code><pre>                ModifiedPath:        to.StringPtr(apiURLConfig.ModifiedPath),</pre></code></td></tr><tr><td>177</td><td><code><pre>                ModifiedQueryString: to.StringPtr(apiURLConfig.ModifiedQueryString),</pre></code></td></tr><tr><td>178</td><td><code><pre>                Reroute:             to.BoolPtr(apiURLConfig.Reroute),</pre></code></td></tr><tr><td>179</td><td><code><pre>        }</pre></code></td></tr><tr><td>180</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateListenerName">func generateListenerName</div><div class="info"><a href="#s_fn_generateListenerName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>150</td><td><code><pre>func generateListenerName(listenerID listenerIdentifier) string {</pre></code></td></tr><tr><td>151</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%s&#34;, agPrefix, prefixListener, utils.GetHashCode(listenerID)))</pre></code></td></tr><tr><td>152</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_serviceIdentifier.serviceKey">func serviceIdentifier.serviceKey</div><div class="info"><a href="#s_fn_serviceIdentifier.serviceKey">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>114</td><td><code><pre>func (s serviceIdentifier) serviceKey() string {</pre></code></td></tr><tr><td>115</td><td><code><pre>        return fmt.Sprintf(&#34;%v/%v&#34;, s.Namespace, s.Name)</pre></code></td></tr><tr><td>116</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_secretIdentifier.secretKey">func secretIdentifier.secretKey</div><div class="info"><a href="#s_fn_secretIdentifier.secretKey">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>118</td><td><code><pre>func (s secretIdentifier) secretKey() string {</pre></code></td></tr><tr><td>119</td><td><code><pre>        return fmt.Sprintf(&#34;%v/%v&#34;, s.Namespace, s.Name)</pre></code></td></tr><tr><td>120</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newPool">func appGwConfigBuilder.newPool</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>134</td><td><code><pre>func (c *appGwConfigBuilder) newPool(poolName string, subset v1.EndpointSubset) *n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>135</td><td><code><pre>        return &amp;n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>136</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>137</td><td><code><pre>                Name: &amp;poolName,</pre></code></td></tr><tr><td>138</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.AddressPoolID(poolName)),</pre></code></td></tr><tr><td>139</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>140</td><td><code><pre>                        BackendAddresses: getAddressesForSubset(subset),</pre></code></td></tr><tr><td>141</td><td><code><pre>                },</pre></code></td></tr><tr><td>142</td><td><code><pre>        }</pre></code></td></tr><tr><td>143</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getResourceKey">func getResourceKey</div><div class="info"><a href="#s_fn_getResourceKey">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>130</td><td><code><pre>func getResourceKey(namespace, name string) string {</pre></code></td></tr><tr><td>131</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%v/%v&#34;, namespace, name))</pre></code></td></tr><tr><td>132</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateHTTPSettingsName">func generateHTTPSettingsName</div><div class="info"><a href="#s_fn_generateHTTPSettingsName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>134</td><td><code><pre>func generateHTTPSettingsName(serviceName string, servicePort string, backendPort Port, ingress string) string {</pre></code></td></tr><tr><td>135</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%v-%v-%v-%s&#34;, agPrefix, prefixHTTPSettings, serviceName, servicePort, backendPort, ingress))</pre></code></td></tr><tr><td>136</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateProbeName">func generateProbeName</div><div class="info"><a href="#s_fn_generateProbeName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>138</td><td><code><pre>func generateProbeName(serviceName string, servicePort string, ingress *networking.Ingress) string {</pre></code></td></tr><tr><td>139</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%s-%v-%v-%s&#34;, agPrefix, prefixProbe, ingress.Namespace, serviceName, servicePort, ingress.Name))</pre></code></td></tr><tr><td>140</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateAddressPoolName">func generateAddressPoolName</div><div class="info"><a href="#s_fn_generateAddressPoolName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>142</td><td><code><pre>func generateAddressPoolName(serviceName string, servicePort string, backendPort Port) string {</pre></code></td></tr><tr><td>143</td><td><code><pre>        return formatPropName(fmt.Sprintf(&#34;%s%s-%v-%v-bp-%v&#34;, agPrefix, prefixPool, serviceName, servicePort, backendPort))</pre></code></td></tr><tr><td>144</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.HTTPSettingsID">func Identifier.HTTPSettingsID</div><div class="info"><a href="#s_fn_Identifier.HTTPSettingsID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>58</td><td><code><pre>func (agw Identifier) HTTPSettingsID(settingsName string) string {</pre></code></td></tr><tr><td>59</td><td><code><pre>        return agw.gatewayResourceID(&#34;backendHttpSettingsCollection&#34;, settingsName)</pre></code></td></tr><tr><td>60</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getDefaultFromRule">func appGwConfigBuilder.getDefaultFromRule</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getDefaultFromRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>259</td><td><code><pre>func (c *appGwConfigBuilder) getDefaultFromRule(cbCtx *ConfigBuilderContext, listenerID listenerIdentifier, listenerAzConfig listenerAzConfig, ingress *networking.Ingress, rule *networking.IngressRule) (*string, *string, *string, *string) {</pre></code></td></tr><tr><td>260</td><td><code><pre>        if sslRedirect, _ := annotations.IsSslRedirect(ingress); sslRedirect &amp;&amp; listenerAzConfig.Protocol == n.ApplicationGatewayProtocolHTTP {</pre></code></td></tr><tr><td>261</td><td><code><pre>                targetListener := listenerID</pre></code></td></tr><tr><td>262</td><td><code><pre>                targetListener.FrontendPort = 443</pre></code></td></tr><tr><td>263</td><td><code><pre></pre></code></td></tr><tr><td>264</td><td><code><pre>                // We could end up in a situation where we are attempting to attach a redirect, which does not exist.</pre></code></td></tr><tr><td>265</td><td><code><pre>                redirectRef := c.getSslRedirectConfigResourceReference(targetListener)</pre></code></td></tr><tr><td>266</td><td><code><pre>                redirectsSet := *c.groupRedirectsByID(c.getRedirectConfigurations(cbCtx))</pre></code></td></tr><tr><td>267</td><td><code><pre></pre></code></td></tr><tr><td>268</td><td><code><pre>                if _, exists := redirectsSet[*redirectRef.ID]; exists {</pre></code></td></tr><tr><td>269</td><td><code><pre>                        klog.V(5).Infof(&#34;Attached default redirection %s to rule %+v&#34;, *redirectRef.ID, *rule)</pre></code></td></tr><tr><td>270</td><td><code><pre>                        return nil, nil, redirectRef.ID, nil</pre></code></td></tr><tr><td>271</td><td><code><pre>                }</pre></code></td></tr><tr><td>272</td><td><code><pre>                klog.Errorf(&#34;Will not attach default redirect to rule; SSL Redirect does not exist: %s&#34;, *redirectRef.ID)</pre></code></td></tr><tr><td>273</td><td><code><pre>        }</pre></code></td></tr><tr><td>274</td><td><code><pre></pre></code></td></tr><tr><td>275</td><td><code><pre>        var defRule *networking.IngressRule</pre></code></td></tr><tr><td>276</td><td><code><pre>        var defPath *networking.HTTPIngressPath</pre></code></td></tr><tr><td>277</td><td><code><pre>        defBackend := ingress.Spec.DefaultBackend</pre></code></td></tr><tr><td>278</td><td><code><pre>        for pathIdx := range rule.HTTP.Paths {</pre></code></td></tr><tr><td>279</td><td><code><pre>                path := &amp;rule.HTTP.Paths[pathIdx]</pre></code></td></tr><tr><td>280</td><td><code><pre>                if isPathCatchAll(path.Path, path.PathType) {</pre></code></td></tr><tr><td>281</td><td><code><pre>                        defBackend = &amp;path.Backend</pre></code></td></tr><tr><td>282</td><td><code><pre>                        defPath = path</pre></code></td></tr><tr><td>283</td><td><code><pre>                        defRule = rule</pre></code></td></tr><tr><td>284</td><td><code><pre>                }</pre></code></td></tr><tr><td>285</td><td><code><pre>        }</pre></code></td></tr><tr><td>286</td><td><code><pre></pre></code></td></tr><tr><td>287</td><td><code><pre>        backendPools := c.newBackendPoolMap(cbCtx)</pre></code></td></tr><tr><td>288</td><td><code><pre>        _, backendHTTPSettingsMap, _, _ := c.getBackendsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>289</td><td><code><pre>        var defaultRewriteRuleSet *string</pre></code></td></tr><tr><td>290</td><td><code><pre>        if defBackend != nil {</pre></code></td></tr><tr><td>291</td><td><code><pre>                // has default backend</pre></code></td></tr><tr><td>292</td><td><code><pre>                defaultBackendID := generateBackendID(ingress, defRule, defPath, defBackend)</pre></code></td></tr><tr><td>293</td><td><code><pre>                defaultHTTPSettings := backendHTTPSettingsMap[defaultBackendID]</pre></code></td></tr><tr><td>294</td><td><code><pre>                defaultAddressPool := backendPools[defaultBackendID]</pre></code></td></tr><tr><td>295</td><td><code><pre></pre></code></td></tr><tr><td>296</td><td><code><pre>                // check both annotations for rewrite-rule-set, use appropriate one, if both are present - throw error</pre></code></td></tr><tr><td>297</td><td><code><pre>                rewriteRuleSet, err1 := annotations.RewriteRuleSet(ingress)</pre></code></td></tr><tr><td>298</td><td><code><pre>                rewriteRuleSetCR, err2 := annotations.RewriteRuleSetCustomResource(ingress)</pre></code></td></tr><tr><td>299</td><td><code><pre></pre></code></td></tr><tr><td>300</td><td><code><pre>                if err1 == nil &amp;&amp; rewriteRuleSet != &#34;&#34; &amp;&amp; err2 == nil &amp;&amp; rewriteRuleSetCR != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>301</td><td><code><pre>                        klog.Errorf(&#34;%s and %s both annotations are defined. Please use one.&#34;, annotations.RewriteRuleSetKey, annotations.RewriteRuleSetCustomResourceKey)</pre></code></td></tr><tr><td>302</td><td><code><pre>                } else if err1 == nil &amp;&amp; rewriteRuleSet != &#34;&#34; {</pre></code></td></tr><tr><td>303</td><td><code><pre>                        defaultRewriteRuleSet = to.StringPtr(c.appGwIdentifier.rewriteRuleSetID(rewriteRuleSet))</pre></code></td></tr><tr><td>304</td><td><code><pre>                } else if err2 == nil &amp;&amp; rewriteRuleSetCR != &#34;&#34; {</pre></code></td></tr><tr><td>305</td><td><code><pre>                        rewriteRuleSetCR = fmt.Sprintf(&#34;crd-%s-%s&#34;, ingress.Namespace, rewriteRuleSetCR)</pre></code></td></tr><tr><td>306</td><td><code><pre>                        defaultRewriteRuleSet = to.StringPtr(c.appGwIdentifier.rewriteRuleSetID(rewriteRuleSetCR))</pre></code></td></tr><tr><td>307</td><td><code><pre>                }</pre></code></td></tr><tr><td>308</td><td><code><pre></pre></code></td></tr><tr><td>309</td><td><code><pre>                if defaultAddressPool != nil &amp;&amp; defaultHTTPSettings != nil {</pre></code></td></tr><tr><td>310</td><td><code><pre>                        poolID := to.StringPtr(c.appGwIdentifier.AddressPoolID(*defaultAddressPool.Name))</pre></code></td></tr><tr><td>311</td><td><code><pre>                        settID := to.StringPtr(c.appGwIdentifier.HTTPSettingsID(*defaultHTTPSettings.Name))</pre></code></td></tr><tr><td>312</td><td><code><pre>                        return poolID, settID, nil, defaultRewriteRuleSet</pre></code></td></tr><tr><td>313</td><td><code><pre>                }</pre></code></td></tr><tr><td>314</td><td><code><pre>        }</pre></code></td></tr><tr><td>315</td><td><code><pre></pre></code></td></tr><tr><td>316</td><td><code><pre>        return cbCtx.DefaultAddressPoolID, cbCtx.DefaultHTTPSettingsID, nil, defaultRewriteRuleSet</pre></code></td></tr><tr><td>317</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.generateHealthProbe">func appGwConfigBuilder.generateHealthProbe</div><div class="info"><a href="#s_fn_appGwConfigBuilder.generateHealthProbe">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code>:</p></div><table class="listing">
<tr><td>78</td><td><code><pre>func (c *appGwConfigBuilder) generateHealthProbe(backendID backendIdentifier) *n.ApplicationGatewayProbe {</pre></code></td></tr><tr><td>79</td><td><code><pre>        // TODO(draychev): remove GetService</pre></code></td></tr><tr><td>80</td><td><code><pre>        service := c.k8sContext.GetService(backendID.serviceKey())</pre></code></td></tr><tr><td>81</td><td><code><pre>        if service == nil || backendID.Path == nil {</pre></code></td></tr><tr><td>82</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>83</td><td><code><pre>        }</pre></code></td></tr><tr><td>84</td><td><code><pre>        probe := defaultProbe(c.appGwIdentifier, n.ApplicationGatewayProtocolHTTP)</pre></code></td></tr><tr><td>85</td><td><code><pre>        probe.Name = to.StringPtr(generateProbeName(backendID.Path.Backend.Service.Name, serviceBackendPortToStr(backendID.Path.Backend.Service.Port), backendID.Ingress))</pre></code></td></tr><tr><td>86</td><td><code><pre>        probe.ID = to.StringPtr(c.appGwIdentifier.probeID(*probe.Name))</pre></code></td></tr><tr><td>87</td><td><code><pre></pre></code></td></tr><tr><td>88</td><td><code><pre>        // set defaults</pre></code></td></tr><tr><td>89</td><td><code><pre>        probe.Match = &amp;n.ApplicationGatewayProbeHealthResponseMatch{}</pre></code></td></tr><tr><td>90</td><td><code><pre>        probe.PickHostNameFromBackendHTTPSettings = to.BoolPtr(false)</pre></code></td></tr><tr><td>91</td><td><code><pre>        probe.MinServers = to.Int32Ptr(0)</pre></code></td></tr><tr><td>92</td><td><code><pre></pre></code></td></tr><tr><td>93</td><td><code><pre>        listenerID := generateListenerID(backendID.Ingress, backendID.Rule, n.ApplicationGatewayProtocolHTTP, nil, false)</pre></code></td></tr><tr><td>94</td><td><code><pre>        hostName := listenerID.getHostNameForProbes()</pre></code></td></tr><tr><td>95</td><td><code><pre>        if hostName != nil {</pre></code></td></tr><tr><td>96</td><td><code><pre>                probe.Host = hostName</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr><td>98</td><td><code><pre></pre></code></td></tr><tr><td>99</td><td><code><pre>        if hostName, err := annotations.BackendHostName(backendID.Ingress); err == nil {</pre></code></td></tr><tr><td>100</td><td><code><pre>                probe.Host = to.StringPtr(hostName)</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr><td>103</td><td><code><pre>        pathPrefix, err := annotations.BackendPathPrefix(backendID.Ingress)</pre></code></td></tr><tr><td>104</td><td><code><pre>        if err == nil {</pre></code></td></tr><tr><td>105</td><td><code><pre>                probe.Path = to.StringPtr(pathPrefix)</pre></code></td></tr><tr><td>106</td><td><code><pre>        } else if backendID.Path != nil &amp;&amp; len(backendID.Path.Path) != 0 {</pre></code></td></tr><tr><td>107</td><td><code><pre>                probe.Path = to.StringPtr(backendID.Path.Path)</pre></code></td></tr><tr><td>108</td><td><code><pre>        }</pre></code></td></tr><tr><td>109</td><td><code><pre></pre></code></td></tr><tr><td>110</td><td><code><pre>        // nil check on Service</pre></code></td></tr><tr><td>111</td><td><code><pre>        if backendID.Backend.Service != nil &amp;&amp; serviceBackendPortToStr(backendID.Backend.Service.Port) == &#34;443&#34; {</pre></code></td></tr><tr><td>112</td><td><code><pre>                probe.Protocol = n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre></pre></code></td></tr><tr><td>115</td><td><code><pre>        k8sProbeForServiceContainer := c.getProbeForServiceContainer(service, backendID)</pre></code></td></tr><tr><td>116</td><td><code><pre>        if k8sProbeForServiceContainer != nil {</pre></code></td></tr><tr><td>117</td><td><code><pre>                if len(k8sProbeForServiceContainer.Handler.HTTPGet.Host) != 0 {</pre></code></td></tr><tr><td>118</td><td><code><pre>                        probe.Host = to.StringPtr(k8sProbeForServiceContainer.Handler.HTTPGet.Host)</pre></code></td></tr><tr><td>119</td><td><code><pre>                }</pre></code></td></tr><tr><td>120</td><td><code><pre>                if len(k8sProbeForServiceContainer.Handler.HTTPGet.Path) != 0 {</pre></code></td></tr><tr><td>121</td><td><code><pre>                        probe.Path = to.StringPtr(k8sProbeForServiceContainer.Handler.HTTPGet.Path)</pre></code></td></tr><tr><td>122</td><td><code><pre>                }</pre></code></td></tr><tr><td>123</td><td><code><pre>                if len(k8sProbeForServiceContainer.Handler.HTTPGet.Port.String()) != 0 {</pre></code></td></tr><tr><td>124</td><td><code><pre>                        probe.Port = to.Int32Ptr(k8sProbeForServiceContainer.Handler.HTTPGet.Port.IntVal)</pre></code></td></tr><tr><td>125</td><td><code><pre>                }</pre></code></td></tr><tr><td>126</td><td><code><pre>                if k8sProbeForServiceContainer.Handler.HTTPGet.Scheme == v1.URISchemeHTTPS {</pre></code></td></tr><tr><td>127</td><td><code><pre>                        probe.Protocol = n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>128</td><td><code><pre>                }</pre></code></td></tr><tr><td>129</td><td><code><pre>                // httpGet schema is default to Http if not specified, double check with the port in case for Https</pre></code></td></tr><tr><td>130</td><td><code><pre>                if k8sProbeForServiceContainer.Handler.HTTPGet.Scheme == v1.URISchemeHTTP {</pre></code></td></tr><tr><td>131</td><td><code><pre>                        if k8sProbeForServiceContainer.Handler.HTTPGet.Port.IntVal == 443 {</pre></code></td></tr><tr class="miss"><td>132</td><td><code><pre>                                probe.Protocol = n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>133</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>134</td><td><code><pre>                                probe.Protocol = n.ApplicationGatewayProtocolHTTP</pre></code></td></tr><tr><td>135</td><td><code><pre>                        }</pre></code></td></tr><tr><td>136</td><td><code><pre>                }</pre></code></td></tr><tr><td>137</td><td><code><pre>                if k8sProbeForServiceContainer.PeriodSeconds != 0 {</pre></code></td></tr><tr><td>138</td><td><code><pre>                        probe.Interval = to.Int32Ptr(k8sProbeForServiceContainer.PeriodSeconds)</pre></code></td></tr><tr><td>139</td><td><code><pre>                }</pre></code></td></tr><tr><td>140</td><td><code><pre>                if k8sProbeForServiceContainer.TimeoutSeconds != 0 {</pre></code></td></tr><tr><td>141</td><td><code><pre>                        probe.Timeout = to.Int32Ptr(k8sProbeForServiceContainer.TimeoutSeconds)</pre></code></td></tr><tr><td>142</td><td><code><pre>                }</pre></code></td></tr><tr><td>143</td><td><code><pre>                if k8sProbeForServiceContainer.FailureThreshold != 0 {</pre></code></td></tr><tr><td>144</td><td><code><pre>                        // UnhealthyThreshold must be in range of 0 - 20, otherwise Application Gateway will not</pre></code></td></tr><tr><td>145</td><td><code><pre>                        // accept the configuration and all new pods will not be configured.</pre></code></td></tr><tr><td>146</td><td><code><pre>                        if k8sProbeForServiceContainer.FailureThreshold &gt; 20 {</pre></code></td></tr><tr class="miss"><td>147</td><td><code><pre>                                probe.UnhealthyThreshold = to.Int32Ptr(20)</pre></code></td></tr><tr><td>148</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>149</td><td><code><pre>                                probe.UnhealthyThreshold = to.Int32Ptr(k8sProbeForServiceContainer.FailureThreshold)</pre></code></td></tr><tr><td>150</td><td><code><pre>                        }</pre></code></td></tr><tr><td>151</td><td><code><pre>                }</pre></code></td></tr><tr><td>152</td><td><code><pre>        }</pre></code></td></tr><tr><td>153</td><td><code><pre></pre></code></td></tr><tr><td>154</td><td><code><pre>        // backend protocol must match http settings protocol</pre></code></td></tr><tr><td>155</td><td><code><pre>        backendProtocol, err := annotations.BackendProtocol(backendID.Ingress)</pre></code></td></tr><tr><td>156</td><td><code><pre>        if err == nil &amp;&amp; backendProtocol == annotations.HTTPS {</pre></code></td></tr><tr><td>157</td><td><code><pre>                probe.Protocol = n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>158</td><td><code><pre>        } else if err == nil &amp;&amp; backendProtocol == annotations.HTTP {</pre></code></td></tr><tr><td>159</td><td><code><pre>                probe.Protocol = n.ApplicationGatewayProtocolHTTP</pre></code></td></tr><tr><td>160</td><td><code><pre>        }</pre></code></td></tr><tr><td>161</td><td><code><pre></pre></code></td></tr><tr><td>162</td><td><code><pre>        // override healthcheck probe host with host defined in annotation if exists</pre></code></td></tr><tr><td>163</td><td><code><pre>        probeHost, err := annotations.HealthProbeHostName(backendID.Ingress)</pre></code></td></tr><tr><td>164</td><td><code><pre>        if err == nil &amp;&amp; probeHost != &#34;&#34; {</pre></code></td></tr><tr><td>165</td><td><code><pre>                probe.Host = to.StringPtr(probeHost)</pre></code></td></tr><tr><td>166</td><td><code><pre>        }</pre></code></td></tr><tr><td>167</td><td><code><pre></pre></code></td></tr><tr><td>168</td><td><code><pre>        // override healthcheck probe target port with port defined in annotation if exists</pre></code></td></tr><tr><td>169</td><td><code><pre>        probePort, err := annotations.HealthProbePort(backendID.Ingress)</pre></code></td></tr><tr><td>170</td><td><code><pre>        if err == nil &amp;&amp; probePort &gt; 0 &amp;&amp; probePort &lt; 65536 {</pre></code></td></tr><tr><td>171</td><td><code><pre>                probe.Port = to.Int32Ptr(probePort)</pre></code></td></tr><tr><td>172</td><td><code><pre>        }</pre></code></td></tr><tr><td>173</td><td><code><pre></pre></code></td></tr><tr><td>174</td><td><code><pre>        // override healthcheck probe path with path defined in annotation if exists</pre></code></td></tr><tr><td>175</td><td><code><pre>        probePath, err := annotations.HealthProbePath(backendID.Ingress)</pre></code></td></tr><tr><td>176</td><td><code><pre>        if err == nil &amp;&amp; probePath != &#34;&#34; {</pre></code></td></tr><tr><td>177</td><td><code><pre>                probe.Path = to.StringPtr(probePath)</pre></code></td></tr><tr><td>178</td><td><code><pre>        }</pre></code></td></tr><tr><td>179</td><td><code><pre></pre></code></td></tr><tr><td>180</td><td><code><pre>        if probe.Path != nil {</pre></code></td></tr><tr><td>181</td><td><code><pre>                probe.Path = to.StringPtr(strings.TrimRight(*probe.Path, &#34;*&#34;))</pre></code></td></tr><tr><td>182</td><td><code><pre>        }</pre></code></td></tr><tr><td>183</td><td><code><pre></pre></code></td></tr><tr><td>184</td><td><code><pre>        // override healthcheck probe match status codes with ones defined in annotation if exists</pre></code></td></tr><tr><td>185</td><td><code><pre>        probeStatuses, err := annotations.HealthProbeStatusCodes(backendID.Ingress)</pre></code></td></tr><tr><td>186</td><td><code><pre>        if err == nil &amp;&amp; len(probeStatuses) &gt; 0 {</pre></code></td></tr><tr><td>187</td><td><code><pre>                probe.Match.StatusCodes = &amp;probeStatuses</pre></code></td></tr><tr><td>188</td><td><code><pre>        }</pre></code></td></tr><tr><td>189</td><td><code><pre></pre></code></td></tr><tr><td>190</td><td><code><pre>        // override healthcheck probe interval with value defined in annotation if exists</pre></code></td></tr><tr><td>191</td><td><code><pre>        probeInterval, err := annotations.HealthProbeInterval(backendID.Ingress)</pre></code></td></tr><tr><td>192</td><td><code><pre>        if err == nil &amp;&amp; probeInterval &gt; 0 {</pre></code></td></tr><tr><td>193</td><td><code><pre>                probe.Interval = to.Int32Ptr(probeInterval)</pre></code></td></tr><tr><td>194</td><td><code><pre>        }</pre></code></td></tr><tr><td>195</td><td><code><pre></pre></code></td></tr><tr><td>196</td><td><code><pre>        // override healthcheck probe timeout with value defined in annotation if exists</pre></code></td></tr><tr><td>197</td><td><code><pre>        probeTimeout, err := annotations.HealthProbeTimeout(backendID.Ingress)</pre></code></td></tr><tr><td>198</td><td><code><pre>        if err == nil &amp;&amp; probeTimeout &gt; 0 {</pre></code></td></tr><tr><td>199</td><td><code><pre>                probe.Timeout = to.Int32Ptr(probeTimeout)</pre></code></td></tr><tr><td>200</td><td><code><pre>        }</pre></code></td></tr><tr><td>201</td><td><code><pre></pre></code></td></tr><tr><td>202</td><td><code><pre>        // override healthcheck probe threshold with value defined in annotation if exists</pre></code></td></tr><tr><td>203</td><td><code><pre>        probeThreshold, err := annotations.HealthProbeUnhealthyThreshold(backendID.Ingress)</pre></code></td></tr><tr><td>204</td><td><code><pre>        if err == nil &amp;&amp; probeThreshold &gt; 0 {</pre></code></td></tr><tr><td>205</td><td><code><pre>                probe.UnhealthyThreshold = to.Int32Ptr(probeThreshold)</pre></code></td></tr><tr><td>206</td><td><code><pre>        }</pre></code></td></tr><tr><td>207</td><td><code><pre></pre></code></td></tr><tr><td>208</td><td><code><pre>        // For V1 gateway, port property is not supported</pre></code></td></tr><tr><td>209</td><td><code><pre>        if c.appGw.Sku.Tier == n.ApplicationGatewayTierStandard || c.appGw.Sku.Tier == n.ApplicationGatewayTierWAF {</pre></code></td></tr><tr class="miss"><td>210</td><td><code><pre>                probe.Port = nil</pre></code></td></tr><tr><td>211</td><td><code><pre>        }</pre></code></td></tr><tr><td>212</td><td><code><pre></pre></code></td></tr><tr><td>213</td><td><code><pre>        return &amp;probe</pre></code></td></tr><tr><td>214</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newProbesMap">func appGwConfigBuilder.newProbesMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newProbesMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code>:</p></div><table class="listing">
<tr><td>43</td><td><code><pre>func (c *appGwConfigBuilder) newProbesMap(cbCtx *ConfigBuilderContext) (map[string]n.ApplicationGatewayProbe, map[backendIdentifier]*n.ApplicationGatewayProbe) {</pre></code></td></tr><tr><td>44</td><td><code><pre>        if c.mem.probesByName != nil &amp;&amp; c.mem.probesByBackend != nil {</pre></code></td></tr><tr><td>45</td><td><code><pre>                return *c.mem.probesByName, *c.mem.probesByBackend</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>        healthProbeCollection := make(map[string]n.ApplicationGatewayProbe)</pre></code></td></tr><tr><td>49</td><td><code><pre>        probesMap := make(map[backendIdentifier]*n.ApplicationGatewayProbe)</pre></code></td></tr><tr><td>50</td><td><code><pre>        defaultHTTPProbe := defaultProbe(c.appGwIdentifier, n.ApplicationGatewayProtocolHTTP)</pre></code></td></tr><tr><td>51</td><td><code><pre>        defaultHTTPSProbe := defaultProbe(c.appGwIdentifier, n.ApplicationGatewayProtocolHTTPS)</pre></code></td></tr><tr><td>52</td><td><code><pre></pre></code></td></tr><tr><td>53</td><td><code><pre>        healthProbeCollection[*defaultHTTPProbe.Name] = defaultHTTPProbe</pre></code></td></tr><tr><td>54</td><td><code><pre>        healthProbeCollection[*defaultHTTPSProbe.Name] = defaultHTTPSProbe</pre></code></td></tr><tr><td>55</td><td><code><pre>        klog.V(5).Info(&#34;Created default HTTP probe &#34;, *defaultHTTPProbe.Name)</pre></code></td></tr><tr><td>56</td><td><code><pre>        klog.V(5).Info(&#34;Created default HTTPS probe &#34;, *defaultHTTPProbe.Name)</pre></code></td></tr><tr><td>57</td><td><code><pre></pre></code></td></tr><tr><td>58</td><td><code><pre>        for backendID := range c.newBackendIdsFiltered(cbCtx) {</pre></code></td></tr><tr><td>59</td><td><code><pre>                probe := c.generateHealthProbe(backendID)</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>                if probe != nil {</pre></code></td></tr><tr><td>62</td><td><code><pre>                        probesMap[backendID] = probe</pre></code></td></tr><tr><td>63</td><td><code><pre>                        healthProbeCollection[*probe.Name] = *probe</pre></code></td></tr><tr><td>64</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>65</td><td><code><pre>                        probesMap[backendID] = &amp;defaultHTTPProbe</pre></code></td></tr><tr><td>66</td><td><code><pre>                        if protocol, _ := annotations.BackendProtocol(backendID.Ingress); protocol == annotations.HTTPS {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                                probesMap[backendID] = &amp;defaultHTTPSProbe</pre></code></td></tr><tr><td>68</td><td><code><pre>                        }</pre></code></td></tr><tr><td>69</td><td><code><pre>                }</pre></code></td></tr><tr><td>70</td><td><code><pre>                klog.V(5).Infof(&#34;Created probe %s for ingress %s/%s at service %s&#34;, *probesMap[backendID].Name, backendID.Ingress.Namespace, backendID.Ingress.Name, backendID.serviceKey())</pre></code></td></tr><tr><td>71</td><td><code><pre>        }</pre></code></td></tr><tr><td>72</td><td><code><pre></pre></code></td></tr><tr><td>73</td><td><code><pre>        c.mem.probesByName = &amp;healthProbeCollection</pre></code></td></tr><tr><td>74</td><td><code><pre>        c.mem.probesByBackend = &amp;probesMap</pre></code></td></tr><tr><td>75</td><td><code><pre>        return healthProbeCollection, probesMap</pre></code></td></tr><tr><td>76</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getPathRules">func appGwConfigBuilder.getPathRules</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getPathRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>319</td><td><code><pre>func (c *appGwConfigBuilder) getPathRules(cbCtx *ConfigBuilderContext, listenerID listenerIdentifier, listenerAzConfig listenerAzConfig, ingress *networking.Ingress, rule *networking.IngressRule, ruleIdx int) *[]n.ApplicationGatewayPathRule {</pre></code></td></tr><tr><td>320</td><td><code><pre>        backendPools := c.newBackendPoolMap(cbCtx)</pre></code></td></tr><tr><td>321</td><td><code><pre>        _, backendHTTPSettingsMap, _, _ := c.getBackendsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>322</td><td><code><pre>        pathRules := make([]n.ApplicationGatewayPathRule, 0)</pre></code></td></tr><tr><td>323</td><td><code><pre>        for pathIdx := range rule.HTTP.Paths {</pre></code></td></tr><tr><td>324</td><td><code><pre>                path := &amp;rule.HTTP.Paths[pathIdx]</pre></code></td></tr><tr><td>325</td><td><code><pre>                if isPathCatchAll(path.Path, path.PathType) {</pre></code></td></tr><tr><td>326</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>327</td><td><code><pre>                }</pre></code></td></tr><tr><td>328</td><td><code><pre></pre></code></td></tr><tr><td>329</td><td><code><pre>                pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr><td>330</td><td><code><pre>                pathRuleName := generatePathRuleName(ingress.Namespace, ingress.Name, ruleIdx, pathIdx)</pre></code></td></tr><tr><td>331</td><td><code><pre>                pathRule := n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>332</td><td><code><pre>                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>333</td><td><code><pre>                        Name: to.StringPtr(pathRuleName),</pre></code></td></tr><tr><td>334</td><td><code><pre>                        ID:   to.StringPtr(c.appGwIdentifier.pathRuleID(pathMapName, pathRuleName)),</pre></code></td></tr><tr><td>335</td><td><code><pre>                        ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>336</td><td><code><pre>                                Paths: &amp;[]string{preparePathFromPathType(path.Path, path.PathType)},</pre></code></td></tr><tr><td>337</td><td><code><pre>                        },</pre></code></td></tr><tr><td>338</td><td><code><pre>                }</pre></code></td></tr><tr><td>339</td><td><code><pre></pre></code></td></tr><tr><td>340</td><td><code><pre>                if wafPolicy, err := annotations.WAFPolicy(ingress); err == nil {</pre></code></td></tr><tr><td>341</td><td><code><pre>                        pathRule.FirewallPolicy = &amp;n.SubResource{ID: to.StringPtr(string(wafPolicy))}</pre></code></td></tr><tr><td>342</td><td><code><pre>                        var paths string</pre></code></td></tr><tr><td>343</td><td><code><pre>                        if pathRule.Paths != nil {</pre></code></td></tr><tr><td>344</td><td><code><pre>                                paths = strings.Join(*pathRule.Paths, &#34;,&#34;)</pre></code></td></tr><tr><td>345</td><td><code><pre>                        }</pre></code></td></tr><tr><td>346</td><td><code><pre>                        klog.V(5).Infof(&#34;Attach Firewall Policy %s to Path Rule %s&#34;, wafPolicy, paths)</pre></code></td></tr><tr><td>347</td><td><code><pre>                }</pre></code></td></tr><tr><td>348</td><td><code><pre></pre></code></td></tr><tr><td>349</td><td><code><pre>                // check both annotations for rewrite-rule-set, use appropriate one, if both are present - throw error</pre></code></td></tr><tr><td>350</td><td><code><pre>                rewriteRuleSet, err1 := annotations.RewriteRuleSet(ingress)</pre></code></td></tr><tr><td>351</td><td><code><pre>                rewriteRuleSetCR, err2 := annotations.RewriteRuleSetCustomResource(ingress)</pre></code></td></tr><tr><td>352</td><td><code><pre></pre></code></td></tr><tr><td>353</td><td><code><pre>                if err1 == nil &amp;&amp; rewriteRuleSet != &#34;&#34; &amp;&amp; err2 == nil &amp;&amp; rewriteRuleSetCR != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>354</td><td><code><pre>                        klog.Errorf(&#34;%s and %s both annotations are defined. Please use one.&#34;, annotations.RewriteRuleSetKey, annotations.RewriteRuleSetCustomResourceKey)</pre></code></td></tr><tr><td>355</td><td><code><pre>                } else if err1 == nil &amp;&amp; rewriteRuleSet != &#34;&#34; {</pre></code></td></tr><tr><td>356</td><td><code><pre></pre></code></td></tr><tr><td>357</td><td><code><pre>                        pathRule.RewriteRuleSet = resourceRef(c.appGwIdentifier.rewriteRuleSetID(rewriteRuleSet))</pre></code></td></tr><tr><td>358</td><td><code><pre>                        var paths string</pre></code></td></tr><tr><td>359</td><td><code><pre>                        if pathRule.Paths != nil {</pre></code></td></tr><tr><td>360</td><td><code><pre>                                paths = strings.Join(*pathRule.Paths, &#34;,&#34;)</pre></code></td></tr><tr><td>361</td><td><code><pre>                        }</pre></code></td></tr><tr><td>362</td><td><code><pre>                        klog.V(5).Infof(&#34;Attach Rewrite Rule Set %s to Path Rule %s&#34;, rewriteRuleSet, paths)</pre></code></td></tr><tr><td>363</td><td><code><pre></pre></code></td></tr><tr><td>364</td><td><code><pre>                } else if err2 == nil &amp;&amp; rewriteRuleSetCR != &#34;&#34; {</pre></code></td></tr><tr><td>365</td><td><code><pre></pre></code></td></tr><tr><td>366</td><td><code><pre>                        rewriteRuleSetCR = fmt.Sprintf(&#34;crd-%s-%s&#34;, ingress.Namespace, rewriteRuleSetCR)</pre></code></td></tr><tr><td>367</td><td><code><pre>                        pathRule.RewriteRuleSet = resourceRef(c.appGwIdentifier.rewriteRuleSetID(rewriteRuleSetCR))</pre></code></td></tr><tr><td>368</td><td><code><pre>                        var paths string</pre></code></td></tr><tr><td>369</td><td><code><pre>                        if pathRule.Paths != nil {</pre></code></td></tr><tr><td>370</td><td><code><pre>                                paths = strings.Join(*pathRule.Paths, &#34;,&#34;)</pre></code></td></tr><tr><td>371</td><td><code><pre>                        }</pre></code></td></tr><tr><td>372</td><td><code><pre>                        klog.V(5).Infof(&#34;Attach Rewrite Rule Set %s to Path Rule %s&#34;, rewriteRuleSetCR, paths)</pre></code></td></tr><tr><td>373</td><td><code><pre></pre></code></td></tr><tr><td>374</td><td><code><pre>                }</pre></code></td></tr><tr><td>375</td><td><code><pre></pre></code></td></tr><tr><td>376</td><td><code><pre>                if sslRedirect, _ := annotations.IsSslRedirect(ingress); sslRedirect &amp;&amp; listenerAzConfig.Protocol == n.ApplicationGatewayProtocolHTTP {</pre></code></td></tr><tr><td>377</td><td><code><pre>                        targetListener := listenerID</pre></code></td></tr><tr><td>378</td><td><code><pre>                        targetListener.FrontendPort = 443</pre></code></td></tr><tr><td>379</td><td><code><pre></pre></code></td></tr><tr><td>380</td><td><code><pre>                        // We could end up in a situation where we are attempting to attach a redirect, which does not exist.</pre></code></td></tr><tr><td>381</td><td><code><pre>                        redirectRef := c.getSslRedirectConfigResourceReference(targetListener)</pre></code></td></tr><tr><td>382</td><td><code><pre>                        redirectsSet := *c.groupRedirectsByID(c.getRedirectConfigurations(cbCtx))</pre></code></td></tr><tr><td>383</td><td><code><pre></pre></code></td></tr><tr><td>384</td><td><code><pre>                        if _, exists := redirectsSet[*redirectRef.ID]; exists {</pre></code></td></tr><tr><td>385</td><td><code><pre>                                // This Path Rule has a SSL Redirect!</pre></code></td></tr><tr><td>386</td><td><code><pre>                                // Add it and move on to the next Path Rule; No need to attach Backend Pools and Settings</pre></code></td></tr><tr><td>387</td><td><code><pre>                                pathRule.RedirectConfiguration = redirectRef</pre></code></td></tr><tr><td>388</td><td><code><pre>                                klog.V(5).Infof(&#34;Attached redirection %s to path rule: %s&#34;, *redirectRef.ID, *pathRule.Name)</pre></code></td></tr><tr><td>389</td><td><code><pre>                                pathRules = append(pathRules, pathRule)</pre></code></td></tr><tr><td>390</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>391</td><td><code><pre>                        } else {</pre></code></td></tr><tr class="miss"><td>392</td><td><code><pre>                                klog.Errorf(&#34;Will not attach redirect to rule; SSL Redirect does not exist: %s&#34;, *redirectRef.ID)</pre></code></td></tr><tr><td>393</td><td><code><pre>                        }</pre></code></td></tr><tr><td>394</td><td><code><pre></pre></code></td></tr><tr><td>395</td><td><code><pre>                }</pre></code></td></tr><tr><td>396</td><td><code><pre>                backendID := generateBackendID(ingress, rule, path, &amp;path.Backend)</pre></code></td></tr><tr><td>397</td><td><code><pre>                backendPool := backendPools[backendID]</pre></code></td></tr><tr><td>398</td><td><code><pre>                backendHTTPSettings := backendHTTPSettingsMap[backendID]</pre></code></td></tr><tr><td>399</td><td><code><pre>                if backendPool == nil || backendHTTPSettings == nil {</pre></code></td></tr><tr class="miss"><td>400</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>401</td><td><code><pre>                }</pre></code></td></tr><tr><td>402</td><td><code><pre></pre></code></td></tr><tr><td>403</td><td><code><pre>                pathRule.BackendAddressPool = &amp;n.SubResource{ID: backendPool.ID}</pre></code></td></tr><tr><td>404</td><td><code><pre>                pathRule.BackendHTTPSettings = &amp;n.SubResource{ID: backendHTTPSettings.ID}</pre></code></td></tr><tr><td>405</td><td><code><pre>                klog.V(5).Infof(&#34;Attached pool %s and http setting %s to path rule: %s&#34;, *backendPool.Name, *backendHTTPSettings.Name, *pathRule.Name)</pre></code></td></tr><tr><td>406</td><td><code><pre></pre></code></td></tr><tr><td>407</td><td><code><pre>                pathRules = append(pathRules, pathRule)</pre></code></td></tr><tr><td>408</td><td><code><pre>        }</pre></code></td></tr><tr><td>409</td><td><code><pre></pre></code></td></tr><tr><td>410</td><td><code><pre>        return &amp;pathRules</pre></code></td></tr><tr><td>411</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getListenersFromIngress">func appGwConfigBuilder.getListenersFromIngress</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getListenersFromIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code>:</p></div><table class="listing">
<tr><td>17</td><td><code><pre>func (c *appGwConfigBuilder) getListenersFromIngress(ingress *networking.Ingress, env environment.EnvVariables) map[listenerIdentifier]listenerAzConfig {</pre></code></td></tr><tr><td>18</td><td><code><pre>        listeners := make(map[listenerIdentifier]listenerAzConfig)</pre></code></td></tr><tr><td>19</td><td><code><pre></pre></code></td></tr><tr><td>20</td><td><code><pre>        // if ingress has only backend configured</pre></code></td></tr><tr><td>21</td><td><code><pre>        if ingress.Spec.DefaultBackend != nil &amp;&amp; len(ingress.Spec.Rules) == 0 {</pre></code></td></tr><tr><td>22</td><td><code><pre>                return listeners</pre></code></td></tr><tr><td>23</td><td><code><pre>        }</pre></code></td></tr><tr><td>24</td><td><code><pre></pre></code></td></tr><tr><td>25</td><td><code><pre>        // process ingress rules with TLS and Waf policy</pre></code></td></tr><tr><td>26</td><td><code><pre>        policy, _ := annotations.WAFPolicy(ingress)</pre></code></td></tr><tr><td>27</td><td><code><pre>        for ruleIdx := range ingress.Spec.Rules {</pre></code></td></tr><tr><td>28</td><td><code><pre>                rule := &amp;ingress.Spec.Rules[ruleIdx]</pre></code></td></tr><tr><td>29</td><td><code><pre>                if rule.HTTP == nil {</pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>31</td><td><code><pre>                }</pre></code></td></tr><tr><td>32</td><td><code><pre>                _, ruleListeners := c.processIngressRuleWithTLS(rule, ingress, env)</pre></code></td></tr><tr><td>33</td><td><code><pre></pre></code></td></tr><tr><td>34</td><td><code><pre>                applyToListener := false</pre></code></td></tr><tr><td>35</td><td><code><pre>                if policy != &#34;&#34; {</pre></code></td></tr><tr><td>36</td><td><code><pre>                        applyToListener = c.applyToListener(rule)</pre></code></td></tr><tr><td>37</td><td><code><pre>                }</pre></code></td></tr><tr><td>38</td><td><code><pre></pre></code></td></tr><tr><td>39</td><td><code><pre>                for k, v := range ruleListeners {</pre></code></td></tr><tr><td>40</td><td><code><pre>                        if applyToListener {</pre></code></td></tr><tr><td>41</td><td><code><pre>                                klog.V(3).Infof(&#34;Attach WAF policy: %s to listener: %s&#34;, policy, generateListenerName(k))</pre></code></td></tr><tr><td>42</td><td><code><pre>                                v.FirewallPolicy = policy</pre></code></td></tr><tr><td>43</td><td><code><pre>                        }</pre></code></td></tr><tr><td>44</td><td><code><pre>                        listeners[k] = v</pre></code></td></tr><tr><td>45</td><td><code><pre>                }</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>        return listeners</pre></code></td></tr><tr><td>49</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_validateFrontendIPConfiguration">func validateFrontendIPConfiguration</div><div class="info"><a href="#s_fn_validateFrontendIPConfiguration">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code>:</p></div><table class="listing">
<tr><td>114</td><td><code><pre>func validateFrontendIPConfiguration(eventRecorder record.EventRecorder, config n.ApplicationGatewayPropertiesFormat, envVariables environment.EnvVariables) error {</pre></code></td></tr><tr><td>115</td><td><code><pre>        privateIPPresent := false</pre></code></td></tr><tr><td>116</td><td><code><pre>        publicIPPresent := false</pre></code></td></tr><tr><td>117</td><td><code><pre>        var jsonConfigs []string</pre></code></td></tr><tr><td>118</td><td><code><pre>        for _, ip := range *config.FrontendIPConfigurations {</pre></code></td></tr><tr><td>119</td><td><code><pre>                if jsonConf, err := ip.MarshalJSON(); err != nil {</pre></code></td></tr><tr class="miss"><td>120</td><td><code><pre>                        klog.Error(&#34;Could not marshall IP configuration:&#34;, *ip.ID, err)</pre></code></td></tr><tr><td>121</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>122</td><td><code><pre>                        jsonConfigs = append(jsonConfigs, string(jsonConf))</pre></code></td></tr><tr><td>123</td><td><code><pre>                }</pre></code></td></tr><tr><td>124</td><td><code><pre></pre></code></td></tr><tr><td>125</td><td><code><pre>                privateIPPresent = privateIPPresent ||</pre></code></td></tr><tr><td>126</td><td><code><pre>                        (ip.ApplicationGatewayFrontendIPConfigurationPropertiesFormat != nil &amp;&amp; ip.PrivateIPAddress != nil)</pre></code></td></tr><tr><td>127</td><td><code><pre>                publicIPPresent = publicIPPresent ||</pre></code></td></tr><tr><td>128</td><td><code><pre>                        (ip.ApplicationGatewayFrontendIPConfigurationPropertiesFormat != nil &amp;&amp; ip.PublicIPAddress != nil)</pre></code></td></tr><tr><td>129</td><td><code><pre>        }</pre></code></td></tr><tr><td>130</td><td><code><pre></pre></code></td></tr><tr><td>131</td><td><code><pre>        if envVariables.UsePrivateIP &amp;&amp; !privateIPPresent {</pre></code></td></tr><tr><td>132</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>133</td><td><code><pre>                        controllererrors.ErrorNoPrivateIP,</pre></code></td></tr><tr><td>134</td><td><code><pre>                        &#34;Applcation Gateway doesn&#39;t have a private IP. Either add a private IP or set usePrivateIP flag to false in helm config.&#34;,</pre></code></td></tr><tr><td>135</td><td><code><pre>                )</pre></code></td></tr><tr><td>136</td><td><code><pre>                return e</pre></code></td></tr><tr><td>137</td><td><code><pre>        }</pre></code></td></tr><tr><td>138</td><td><code><pre></pre></code></td></tr><tr><td>139</td><td><code><pre>        if !publicIPPresent {</pre></code></td></tr><tr><td>140</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>141</td><td><code><pre>                        controllererrors.ErrorNoPublicIP,</pre></code></td></tr><tr><td>142</td><td><code><pre>                        &#34;Applcation Gateway doesn&#39;t have a public IP&#34;,</pre></code></td></tr><tr><td>143</td><td><code><pre>                )</pre></code></td></tr><tr><td>144</td><td><code><pre>                return e</pre></code></td></tr><tr><td>145</td><td><code><pre>        }</pre></code></td></tr><tr><td>146</td><td><code><pre></pre></code></td></tr><tr><td>147</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>148</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.resolveBackendPort">func appGwConfigBuilder.resolveBackendPort</div><div class="info"><a href="#s_fn_appGwConfigBuilder.resolveBackendPort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code>:</p></div><table class="listing">
<tr><td>112</td><td><code><pre>func (c *appGwConfigBuilder) resolveBackendPort(backendID backendIdentifier) (Port, error) {</pre></code></td></tr><tr><td>113</td><td><code><pre>        var e error</pre></code></td></tr><tr><td>114</td><td><code><pre>        service := c.k8sContext.GetService(backendID.serviceKey())</pre></code></td></tr><tr><td>115</td><td><code><pre>        if service == nil {</pre></code></td></tr><tr><td>116</td><td><code><pre>                // This should never happen since newBackendIdsFiltered() already filters out backends for non-existent Services</pre></code></td></tr><tr><td>117</td><td><code><pre>                e = controllererrors.NewErrorf(</pre></code></td></tr><tr><td>118</td><td><code><pre>                        controllererrors.ErrorServiceNotFound,</pre></code></td></tr><tr><td>119</td><td><code><pre>                        &#34;Service not found %s&#34;,</pre></code></td></tr><tr><td>120</td><td><code><pre>                        backendID.serviceKey())</pre></code></td></tr><tr><td>121</td><td><code><pre></pre></code></td></tr><tr><td>122</td><td><code><pre>                backendPort := Port(80)</pre></code></td></tr><tr><td>123</td><td><code><pre>                if backendID.Backend.Service.Port.Name == &#34;&#34; &amp;&amp; backendID.Backend.Service.Port.Number &lt; 65536 {</pre></code></td></tr><tr><td>124</td><td><code><pre>                        backendPort = Port(backendID.Backend.Service.Port.Number)</pre></code></td></tr><tr><td>125</td><td><code><pre>                }</pre></code></td></tr><tr><td>126</td><td><code><pre></pre></code></td></tr><tr><td>127</td><td><code><pre>                return backendPort, e</pre></code></td></tr><tr><td>128</td><td><code><pre>        }</pre></code></td></tr><tr><td>129</td><td><code><pre></pre></code></td></tr><tr><td>130</td><td><code><pre>        // find the target port number for service port specified in the ingress manifest</pre></code></td></tr><tr><td>131</td><td><code><pre>        servicePortInIngress := fmt.Sprint(backendID.Backend.Service.Port.Number)</pre></code></td></tr><tr><td>132</td><td><code><pre>        if backendID.Backend.Service.Port.Name != &#34;&#34; {</pre></code></td></tr><tr><td>133</td><td><code><pre>                servicePortInIngress = fmt.Sprint(backendID.Backend.Service.Port.Name)</pre></code></td></tr><tr><td>134</td><td><code><pre>        }</pre></code></td></tr><tr><td>135</td><td><code><pre></pre></code></td></tr><tr><td>136</td><td><code><pre>        resolvedBackendPorts := make(map[serviceBackendPortPair]interface{})</pre></code></td></tr><tr><td>137</td><td><code><pre>        for _, servicePort := range service.Spec.Ports {</pre></code></td></tr><tr><td>138</td><td><code><pre>                // ignore UDP ports</pre></code></td></tr><tr><td>139</td><td><code><pre>                if servicePort.Protocol != v1.ProtocolTCP {</pre></code></td></tr><tr><td>140</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>141</td><td><code><pre>                }</pre></code></td></tr><tr><td>142</td><td><code><pre></pre></code></td></tr><tr><td>143</td><td><code><pre>                // match service by either port, port name or target port</pre></code></td></tr><tr><td>144</td><td><code><pre>                if fmt.Sprint(servicePort.Port) != servicePortInIngress &amp;&amp;</pre></code></td></tr><tr><td>145</td><td><code><pre>                        servicePort.Name != servicePortInIngress &amp;&amp;</pre></code></td></tr><tr><td>146</td><td><code><pre>                        servicePort.TargetPort.String() != servicePortInIngress {</pre></code></td></tr><tr><td>147</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>148</td><td><code><pre>                }</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>                // if target port is not specified, use the service port as backend port</pre></code></td></tr><tr><td>151</td><td><code><pre>                if servicePort.TargetPort.String() == &#34;&#34; {</pre></code></td></tr><tr><td>152</td><td><code><pre>                        // targetPort is not defined, by default targetPort == port</pre></code></td></tr><tr class="miss"><td>153</td><td><code><pre>                        pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>154</td><td><code><pre>                                ServicePort: Port(servicePort.Port),</pre></code></td></tr><tr><td>155</td><td><code><pre>                                BackendPort: Port(servicePort.Port),</pre></code></td></tr><tr><td>156</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>157</td><td><code><pre>                        resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr class="miss"><td>158</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>159</td><td><code><pre>                }</pre></code></td></tr><tr><td>160</td><td><code><pre></pre></code></td></tr><tr><td>161</td><td><code><pre>                // if target port is an int, use it as backend port</pre></code></td></tr><tr><td>162</td><td><code><pre>                if servicePort.TargetPort.Type == intstr.Int {</pre></code></td></tr><tr><td>163</td><td><code><pre>                        // port is defined as port number</pre></code></td></tr><tr><td>164</td><td><code><pre>                        pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>165</td><td><code><pre>                                ServicePort: Port(servicePort.Port),</pre></code></td></tr><tr><td>166</td><td><code><pre>                                BackendPort: Port(servicePort.TargetPort.IntVal),</pre></code></td></tr><tr><td>167</td><td><code><pre>                        }</pre></code></td></tr><tr><td>168</td><td><code><pre>                        resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr><td>169</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>170</td><td><code><pre>                }</pre></code></td></tr><tr><td>171</td><td><code><pre></pre></code></td></tr><tr><td>172</td><td><code><pre>                // if target port is port name, then resolve the port number for the port name</pre></code></td></tr><tr><td>173</td><td><code><pre>                // k8s matches service port name against endpoints port name retrieved by passing backendID service key to endpoint api.</pre></code></td></tr><tr><td>174</td><td><code><pre>                klog.V(5).Infof(&#34;resolving port name &#39;%s&#39; for service &#39;%s&#39; and service port &#39;%s&#39; for Ingress &#39;%s&#39;&#34;, servicePort.Name, backendID.serviceKey(), serviceBackendPortToStr(backendID.Backend.Service.Port), backendID.Ingress.Name)</pre></code></td></tr><tr><td>175</td><td><code><pre>                targetPortsResolved := c.resolvePortName(servicePort.Name, &amp;backendID)</pre></code></td></tr><tr><td>176</td><td><code><pre>                for targetPort := range targetPortsResolved {</pre></code></td></tr><tr><td>177</td><td><code><pre>                        pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>178</td><td><code><pre>                                ServicePort: Port(servicePort.Port),</pre></code></td></tr><tr><td>179</td><td><code><pre>                                BackendPort: Port(targetPort),</pre></code></td></tr><tr><td>180</td><td><code><pre>                        }</pre></code></td></tr><tr><td>181</td><td><code><pre>                        resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr><td>182</td><td><code><pre>                }</pre></code></td></tr><tr><td>183</td><td><code><pre>        }</pre></code></td></tr><tr><td>184</td><td><code><pre></pre></code></td></tr><tr><td>185</td><td><code><pre>        backendPort := Port(65536)</pre></code></td></tr><tr><td>186</td><td><code><pre>        if len(resolvedBackendPorts) == 0 {</pre></code></td></tr><tr><td>187</td><td><code><pre>                e = controllererrors.NewErrorf(</pre></code></td></tr><tr><td>188</td><td><code><pre>                        controllererrors.ErrorUnableToResolveBackendPortFromServicePort,</pre></code></td></tr><tr><td>189</td><td><code><pre>                        &#34;No port matched %s&#34;,</pre></code></td></tr><tr><td>190</td><td><code><pre>                        backendID.serviceKey())</pre></code></td></tr><tr><td>191</td><td><code><pre>                if backendID.Backend.Service.Port.Name == &#34;&#34; {</pre></code></td></tr><tr><td>192</td><td><code><pre>                        backendPort = Port(backendID.Backend.Service.Port.Number)</pre></code></td></tr><tr><td>193</td><td><code><pre>                }</pre></code></td></tr><tr><td>194</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>195</td><td><code><pre>                var ports []string</pre></code></td></tr><tr><td>196</td><td><code><pre>                for k := range resolvedBackendPorts {</pre></code></td></tr><tr><td>197</td><td><code><pre>                        ports = append(ports, string(k.BackendPort))</pre></code></td></tr><tr><td>198</td><td><code><pre>                        if k.BackendPort &lt;= backendPort {</pre></code></td></tr><tr><td>199</td><td><code><pre>                                backendPort = k.BackendPort</pre></code></td></tr><tr><td>200</td><td><code><pre>                        }</pre></code></td></tr><tr><td>201</td><td><code><pre>                }</pre></code></td></tr><tr><td>202</td><td><code><pre></pre></code></td></tr><tr><td>203</td><td><code><pre>                if len(resolvedBackendPorts) &gt; 1 {</pre></code></td></tr><tr><td>204</td><td><code><pre>                        // found more than 1 backend port for the service port which is a conflicting scenario</pre></code></td></tr><tr><td>205</td><td><code><pre>                        e = controllererrors.NewErrorf(</pre></code></td></tr><tr><td>206</td><td><code><pre>                                controllererrors.ErrorMultipleServiceBackendPortBinding,</pre></code></td></tr><tr><td>207</td><td><code><pre>                                &#34;service %s and service port %s has more than one service-backend port binding which is not an ideal scenario, choosing the smallest service-backend port %d. Ports found %s.&#34;,</pre></code></td></tr><tr><td>208</td><td><code><pre>                                backendID.serviceKey(), serviceBackendPortToStr(backendID.Backend.Service.Port), backendPort, strings.Join(ports, &#34;,&#34;),</pre></code></td></tr><tr><td>209</td><td><code><pre>                        )</pre></code></td></tr><tr><td>210</td><td><code><pre>                }</pre></code></td></tr><tr><td>211</td><td><code><pre>        }</pre></code></td></tr><tr><td>212</td><td><code><pre></pre></code></td></tr><tr><td>213</td><td><code><pre>        if backendPort &gt;= Port(65536) {</pre></code></td></tr><tr><td>214</td><td><code><pre>                e = controllererrors.NewErrorf(</pre></code></td></tr><tr><td>215</td><td><code><pre>                        controllererrors.ErrorServiceResolvedToInvalidPort,</pre></code></td></tr><tr><td>216</td><td><code><pre>                        &#34;service %s and service port %s was resolved to an invalid service-backend port %d, defaulting to port 80&#34;,</pre></code></td></tr><tr><td>217</td><td><code><pre>                        backendID.serviceKey(), serviceBackendPortToStr(backendID.Backend.Service.Port), backendPort,</pre></code></td></tr><tr><td>218</td><td><code><pre>                )</pre></code></td></tr><tr><td>219</td><td><code><pre>                backendPort = Port(80)</pre></code></td></tr><tr><td>220</td><td><code><pre>        }</pre></code></td></tr><tr><td>221</td><td><code><pre></pre></code></td></tr><tr><td>222</td><td><code><pre>        return backendPort, e</pre></code></td></tr><tr><td>223</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getProbeForServiceContainer">func appGwConfigBuilder.getProbeForServiceContainer</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getProbeForServiceContainer">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code>:</p></div><table class="listing">
<tr><td>216</td><td><code><pre>func (c *appGwConfigBuilder) getProbeForServiceContainer(service *v1.Service, backendID backendIdentifier) *v1.Probe {</pre></code></td></tr><tr><td>217</td><td><code><pre>        // find all the target ports used by the service</pre></code></td></tr><tr><td>218</td><td><code><pre>        allPorts := make(map[int32]interface{})</pre></code></td></tr><tr><td>219</td><td><code><pre>        for _, sp := range service.Spec.Ports {</pre></code></td></tr><tr><td>220</td><td><code><pre>                if sp.Protocol != v1.ProtocolTCP {</pre></code></td></tr><tr><td>221</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>222</td><td><code><pre>                }</pre></code></td></tr><tr><td>223</td><td><code><pre></pre></code></td></tr><tr><td>224</td><td><code><pre>                if backendID.Backend.Service != nil &amp;&amp; (fmt.Sprint(sp.Port) == serviceBackendPortToStr(backendID.Backend.Service.Port) ||</pre></code></td></tr><tr><td>225</td><td><code><pre>                        sp.Name == serviceBackendPortToStr(backendID.Backend.Service.Port) ||</pre></code></td></tr><tr><td>226</td><td><code><pre>                        sp.TargetPort.String() == serviceBackendPortToStr(backendID.Backend.Service.Port)) {</pre></code></td></tr><tr><td>227</td><td><code><pre></pre></code></td></tr><tr><td>228</td><td><code><pre>                        // Matched a service port in the service</pre></code></td></tr><tr><td>229</td><td><code><pre>                        if sp.TargetPort.String() == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>230</td><td><code><pre>                                allPorts[sp.Port] = nil</pre></code></td></tr><tr><td>231</td><td><code><pre>                        } else if sp.TargetPort.Type == intstr.Int {</pre></code></td></tr><tr><td>232</td><td><code><pre>                                // port is defined as port number</pre></code></td></tr><tr><td>233</td><td><code><pre>                                allPorts[sp.TargetPort.IntVal] = nil</pre></code></td></tr><tr><td>234</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>235</td><td><code><pre>                                for targetPort := range c.resolvePortName(sp.Name, &amp;backendID) {</pre></code></td></tr><tr><td>236</td><td><code><pre>                                        allPorts[targetPort] = nil</pre></code></td></tr><tr><td>237</td><td><code><pre>                                }</pre></code></td></tr><tr><td>238</td><td><code><pre>                        }</pre></code></td></tr><tr><td>239</td><td><code><pre>                }</pre></code></td></tr><tr><td>240</td><td><code><pre>        }</pre></code></td></tr><tr><td>241</td><td><code><pre></pre></code></td></tr><tr><td>242</td><td><code><pre>        podList := c.k8sContext.ListPodsByServiceSelector(service)</pre></code></td></tr><tr><td>243</td><td><code><pre></pre></code></td></tr><tr><td>244</td><td><code><pre>        if len(podList) == 0 {</pre></code></td></tr><tr><td>245</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>246</td><td><code><pre>        }</pre></code></td></tr><tr><td>247</td><td><code><pre></pre></code></td></tr><tr><td>248</td><td><code><pre>        // use the target port to figure out the container and use it&#39;s readiness/liveness probe</pre></code></td></tr><tr><td>249</td><td><code><pre>        for _, container := range podList[0].Spec.Containers {</pre></code></td></tr><tr><td>250</td><td><code><pre>                for _, port := range container.Ports {</pre></code></td></tr><tr><td>251</td><td><code><pre>                        if _, ok := allPorts[port.ContainerPort]; !ok {</pre></code></td></tr><tr><td>252</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>253</td><td><code><pre>                        }</pre></code></td></tr><tr><td>254</td><td><code><pre></pre></code></td></tr><tr><td>255</td><td><code><pre>                        // found the container</pre></code></td></tr><tr><td>256</td><td><code><pre>                        var probe *v1.Probe</pre></code></td></tr><tr><td>257</td><td><code><pre>                        if container.ReadinessProbe != nil &amp;&amp; container.ReadinessProbe.Handler.HTTPGet != nil {</pre></code></td></tr><tr><td>258</td><td><code><pre>                                probe = container.ReadinessProbe</pre></code></td></tr><tr><td>259</td><td><code><pre>                        } else if container.LivenessProbe != nil &amp;&amp; container.LivenessProbe.Handler.HTTPGet != nil {</pre></code></td></tr><tr class="miss"><td>260</td><td><code><pre>                                probe = container.LivenessProbe</pre></code></td></tr><tr><td>261</td><td><code><pre>                        }</pre></code></td></tr><tr><td>262</td><td><code><pre></pre></code></td></tr><tr><td>263</td><td><code><pre>                        // if probe port is named, resolve it by going through container port and set it in the probe itself</pre></code></td></tr><tr><td>264</td><td><code><pre>                        if probe != nil &amp;&amp; probe.HTTPGet.Port.String() != &#34;&#34; &amp;&amp; probe.HTTPGet.Port.Type == intstr.String {</pre></code></td></tr><tr><td>265</td><td><code><pre>                                for _, port := range container.Ports {</pre></code></td></tr><tr><td>266</td><td><code><pre>                                        if port.Name == probe.HTTPGet.Port.StrVal {</pre></code></td></tr><tr><td>267</td><td><code><pre>                                                probe.HTTPGet.Port = intstr.IntOrString{</pre></code></td></tr><tr><td>268</td><td><code><pre>                                                        Type:   intstr.Int,</pre></code></td></tr><tr><td>269</td><td><code><pre>                                                        IntVal: port.ContainerPort,</pre></code></td></tr><tr><td>270</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>271</td><td><code><pre>                                                break</pre></code></td></tr><tr><td>272</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>273</td><td><code><pre>                                }</pre></code></td></tr><tr><td>274</td><td><code><pre>                        }</pre></code></td></tr><tr><td>275</td><td><code><pre></pre></code></td></tr><tr><td>276</td><td><code><pre>                        return probe</pre></code></td></tr><tr><td>277</td><td><code><pre>                }</pre></code></td></tr><tr><td>278</td><td><code><pre>        }</pre></code></td></tr><tr><td>279</td><td><code><pre></pre></code></td></tr><tr><td>280</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>281</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newHostToSecretMap">func appGwConfigBuilder.newHostToSecretMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newHostToSecretMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code>:</p></div><table class="listing">
<tr><td>99</td><td><code><pre>func (c *appGwConfigBuilder) newHostToSecretMap(ingress *networking.Ingress) map[string]secretIdentifier {</pre></code></td></tr><tr><td>100</td><td><code><pre>        hostToSecretMap := make(map[string]secretIdentifier)</pre></code></td></tr><tr><td>101</td><td><code><pre>        for _, tls := range ingress.Spec.TLS {</pre></code></td></tr><tr><td>102</td><td><code><pre>                if len(tls.SecretName) == 0 {</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>104</td><td><code><pre>                }</pre></code></td></tr><tr><td>105</td><td><code><pre></pre></code></td></tr><tr><td>106</td><td><code><pre>                tlsSecret := secretIdentifier{</pre></code></td></tr><tr><td>107</td><td><code><pre>                        Name:      tls.SecretName,</pre></code></td></tr><tr><td>108</td><td><code><pre>                        Namespace: ingress.Namespace,</pre></code></td></tr><tr><td>109</td><td><code><pre>                }</pre></code></td></tr><tr><td>110</td><td><code><pre></pre></code></td></tr><tr><td>111</td><td><code><pre>                // add hostname-tlsSecret mapping to a per-ingress map</pre></code></td></tr><tr><td>112</td><td><code><pre>                cert := c.k8sContext.CertificateSecretStore.GetPfxCertificate(tlsSecret.secretKey())</pre></code></td></tr><tr><td>113</td><td><code><pre>                if cert == nil {</pre></code></td></tr><tr><td>114</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>115</td><td><code><pre>                }</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr><td>117</td><td><code><pre>                // default secret</pre></code></td></tr><tr><td>118</td><td><code><pre>                if len(tls.Hosts) == 0 {</pre></code></td></tr><tr><td>119</td><td><code><pre>                        hostToSecretMap[&#34;&#34;] = tlsSecret</pre></code></td></tr><tr><td>120</td><td><code><pre>                }</pre></code></td></tr><tr><td>121</td><td><code><pre></pre></code></td></tr><tr><td>122</td><td><code><pre>                for _, hostname := range tls.Hosts {</pre></code></td></tr><tr><td>123</td><td><code><pre>                        // default secret</pre></code></td></tr><tr><td>124</td><td><code><pre>                        if len(hostname) == 0 {</pre></code></td></tr><tr><td>125</td><td><code><pre>                                hostToSecretMap[&#34;&#34;] = tlsSecret</pre></code></td></tr><tr><td>126</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>127</td><td><code><pre>                                hostToSecretMap[hostname] = tlsSecret</pre></code></td></tr><tr><td>128</td><td><code><pre>                        }</pre></code></td></tr><tr><td>129</td><td><code><pre>                }</pre></code></td></tr><tr><td>130</td><td><code><pre>        }</pre></code></td></tr><tr><td>131</td><td><code><pre>        return hostToSecretMap</pre></code></td></tr><tr><td>132</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getSslCertificates">func appGwConfigBuilder.getSslCertificates</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getSslCertificates">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code>:</p></div><table class="listing">
<tr><td>24</td><td><code><pre>func (c *appGwConfigBuilder) getSslCertificates(cbCtx *ConfigBuilderContext) *[]n.ApplicationGatewaySslCertificate {</pre></code></td></tr><tr><td>25</td><td><code><pre>        if c.mem.certs != nil {</pre></code></td></tr><tr><td>26</td><td><code><pre>                return c.mem.certs</pre></code></td></tr><tr><td>27</td><td><code><pre>        }</pre></code></td></tr><tr><td>28</td><td><code><pre>        secretIDCertificateMap := make(map[secretIdentifier]*string)</pre></code></td></tr><tr><td>29</td><td><code><pre></pre></code></td></tr><tr><td>30</td><td><code><pre>        for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>31</td><td><code><pre>                for k, v := range c.getSecretToCertificateMap(ingress) {</pre></code></td></tr><tr><td>32</td><td><code><pre>                        secretIDCertificateMap[k] = v</pre></code></td></tr><tr><td>33</td><td><code><pre>                }</pre></code></td></tr><tr><td>34</td><td><code><pre>        }</pre></code></td></tr><tr><td>35</td><td><code><pre></pre></code></td></tr><tr><td>36</td><td><code><pre>        sslCertificates := []n.ApplicationGatewaySslCertificate{}</pre></code></td></tr><tr><td>37</td><td><code><pre>        for secretID, cert := range secretIDCertificateMap {</pre></code></td></tr><tr><td>38</td><td><code><pre>                sslCertificates = append(sslCertificates, c.newCert(secretID, cert))</pre></code></td></tr><tr><td>39</td><td><code><pre>        }</pre></code></td></tr><tr><td>40</td><td><code><pre></pre></code></td></tr><tr><td>41</td><td><code><pre>        // Merge certs from k8s ingress with existing appgw certs</pre></code></td></tr><tr><td>42</td><td><code><pre>        if c.appGw.SslCertificates != nil {</pre></code></td></tr><tr><td>43</td><td><code><pre>                // MergePools would produce unique list of pools based on Name. Blacklisted pools, which have the same name</pre></code></td></tr><tr><td>44</td><td><code><pre>                // as a managed pool would be overwritten.</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>                sslCertificates = brownfield.MergeCerts(*c.appGw.SslCertificates, sslCertificates)</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>        sort.Sort(sorter.ByCertificateName(sslCertificates))</pre></code></td></tr><tr><td>49</td><td><code><pre>        c.mem.certs = &amp;sslCertificates</pre></code></td></tr><tr><td>50</td><td><code><pre>        return &amp;sslCertificates</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newBackendIdsFiltered">func appGwConfigBuilder.newBackendIdsFiltered</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newBackendIdsFiltered">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/ingress_rules.go</code>:</p></div><table class="listing">
<tr><td>139</td><td><code><pre>func (c *appGwConfigBuilder) newBackendIdsFiltered(cbCtx *ConfigBuilderContext) map[backendIdentifier]interface{} {</pre></code></td></tr><tr><td>140</td><td><code><pre>        if c.mem.backendIDs != nil {</pre></code></td></tr><tr><td>141</td><td><code><pre>                return *c.mem.backendIDs</pre></code></td></tr><tr><td>142</td><td><code><pre>        }</pre></code></td></tr><tr><td>143</td><td><code><pre></pre></code></td></tr><tr><td>144</td><td><code><pre>        backendIDs := make(map[backendIdentifier]interface{})</pre></code></td></tr><tr><td>145</td><td><code><pre>        for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>146</td><td><code><pre>                if ingress.Spec.DefaultBackend != nil {</pre></code></td></tr><tr><td>147</td><td><code><pre>                        backendID := generateBackendID(ingress, nil, nil, ingress.Spec.DefaultBackend)</pre></code></td></tr><tr><td>148</td><td><code><pre>                        klog.V(3).Info(&#34;Found default backend:&#34;, backendID.serviceKey())</pre></code></td></tr><tr><td>149</td><td><code><pre>                        backendIDs[backendID] = nil</pre></code></td></tr><tr><td>150</td><td><code><pre>                }</pre></code></td></tr><tr><td>151</td><td><code><pre>                for ruleIdx := range ingress.Spec.Rules {</pre></code></td></tr><tr><td>152</td><td><code><pre>                        rule := &amp;ingress.Spec.Rules[ruleIdx]</pre></code></td></tr><tr><td>153</td><td><code><pre>                        if rule.HTTP == nil {</pre></code></td></tr><tr><td>154</td><td><code><pre>                                // skip no http rule</pre></code></td></tr><tr class="miss"><td>155</td><td><code><pre>                                klog.V(5).Infof(&#34;[%s] Skip rule #%d for host &#39;%s&#39; - it has no HTTP rules.&#34;, ingress.Namespace, ruleIdx+1, rule.Host)</pre></code></td></tr><tr class="miss"><td>156</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>157</td><td><code><pre>                        }</pre></code></td></tr><tr><td>158</td><td><code><pre>                        for pathIdx := range rule.HTTP.Paths {</pre></code></td></tr><tr><td>159</td><td><code><pre>                                path := &amp;rule.HTTP.Paths[pathIdx]</pre></code></td></tr><tr><td>160</td><td><code><pre>                                backendID := generateBackendID(ingress, rule, path, &amp;path.Backend)</pre></code></td></tr><tr><td>161</td><td><code><pre>                                klog.V(5).Info(&#34;Found backend:&#34;, backendID.serviceKey())</pre></code></td></tr><tr><td>162</td><td><code><pre>                                backendIDs[backendID] = nil</pre></code></td></tr><tr><td>163</td><td><code><pre>                        }</pre></code></td></tr><tr><td>164</td><td><code><pre>                }</pre></code></td></tr><tr><td>165</td><td><code><pre>        }</pre></code></td></tr><tr><td>166</td><td><code><pre></pre></code></td></tr><tr><td>167</td><td><code><pre>        finalBackendIDs := make(map[backendIdentifier]interface{})</pre></code></td></tr><tr><td>168</td><td><code><pre>        serviceSet := newServiceSet(&amp;cbCtx.ServiceList)</pre></code></td></tr><tr><td>169</td><td><code><pre>        // Filter out backends, where Ingresses reference non-existent Services</pre></code></td></tr><tr><td>170</td><td><code><pre>        for be := range backendIDs {</pre></code></td></tr><tr><td>171</td><td><code><pre>                if _, exists := serviceSet[be.serviceKey()]; !exists {</pre></code></td></tr><tr><td>172</td><td><code><pre>                        klog.Errorf(&#34;Ingress %s/%s references non existent Service %s. Please correct the Service section of your Kubernetes YAML&#34;, be.Ingress.Namespace, be.Ingress.Name, be.serviceKey())</pre></code></td></tr><tr><td>173</td><td><code><pre>                        // TODO(draychev): Enable this filter when we are certain this won&#39;t break anything!</pre></code></td></tr><tr><td>174</td><td><code><pre>                        // continue</pre></code></td></tr><tr><td>175</td><td><code><pre>                }</pre></code></td></tr><tr><td>176</td><td><code><pre>                finalBackendIDs[be] = nil</pre></code></td></tr><tr><td>177</td><td><code><pre>        }</pre></code></td></tr><tr><td>178</td><td><code><pre></pre></code></td></tr><tr><td>179</td><td><code><pre>        c.mem.backendIDs = &amp;finalBackendIDs</pre></code></td></tr><tr><td>180</td><td><code><pre>        return finalBackendIDs</pre></code></td></tr><tr><td>181</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getRules">func appGwConfigBuilder.getRules</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>72</td><td><code><pre>func (c *appGwConfigBuilder) getRules(cbCtx *ConfigBuilderContext) ([]n.ApplicationGatewayRequestRoutingRule, []n.ApplicationGatewayURLPathMap) {</pre></code></td></tr><tr><td>73</td><td><code><pre>        if c.mem.routingRules != nil &amp;&amp; c.mem.pathMaps != nil {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                return *c.mem.routingRules, *c.mem.pathMaps</pre></code></td></tr><tr><td>75</td><td><code><pre>        }</pre></code></td></tr><tr><td>76</td><td><code><pre>        httpListenersMap := c.groupListenersByListenerIdentifier(cbCtx)</pre></code></td></tr><tr><td>77</td><td><code><pre>        pathMap := []n.ApplicationGatewayURLPathMap{}</pre></code></td></tr><tr><td>78</td><td><code><pre>        var requestRoutingRules []n.ApplicationGatewayRequestRoutingRule</pre></code></td></tr><tr><td>79</td><td><code><pre>        urlPathMaps := c.getPathMaps(cbCtx)</pre></code></td></tr><tr><td>80</td><td><code><pre>        for listenerID, urlPathMap := range urlPathMaps {</pre></code></td></tr><tr><td>81</td><td><code><pre>                routingRuleName := generateRequestRoutingRuleName(listenerID)</pre></code></td></tr><tr><td>82</td><td><code><pre>                httpListener, exists := httpListenersMap[listenerID]</pre></code></td></tr><tr><td>83</td><td><code><pre>                if !exists {</pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>                        klog.Errorf(&#34;Routing rule %s will not be created; listener %+v does not exist&#34;, routingRuleName, listenerID)</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>86</td><td><code><pre>                }</pre></code></td></tr><tr><td>87</td><td><code><pre>                rule := n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>88</td><td><code><pre>                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>89</td><td><code><pre>                        Name: to.StringPtr(routingRuleName),</pre></code></td></tr><tr><td>90</td><td><code><pre>                        ID:   to.StringPtr(c.appGwIdentifier.requestRoutingRuleID(routingRuleName)),</pre></code></td></tr><tr><td>91</td><td><code><pre>                        ApplicationGatewayRequestRoutingRulePropertiesFormat: &amp;n.ApplicationGatewayRequestRoutingRulePropertiesFormat{</pre></code></td></tr><tr><td>92</td><td><code><pre>                                HTTPListener: &amp;n.SubResource{ID: to.StringPtr(c.appGwIdentifier.listenerID(*httpListener.Name))},</pre></code></td></tr><tr><td>93</td><td><code><pre>                        },</pre></code></td></tr><tr><td>94</td><td><code><pre>                }</pre></code></td></tr><tr><td>95</td><td><code><pre>                if urlPathMap.PathRules == nil || len(*urlPathMap.PathRules) == 0 {</pre></code></td></tr><tr><td>96</td><td><code><pre>                        // Basic Rule, because we have no path-based rule</pre></code></td></tr><tr><td>97</td><td><code><pre>                        rule.RuleType = n.ApplicationGatewayRequestRoutingRuleTypeBasic</pre></code></td></tr><tr><td>98</td><td><code><pre>                        rule.RedirectConfiguration = urlPathMap.DefaultRedirectConfiguration</pre></code></td></tr><tr><td>99</td><td><code><pre></pre></code></td></tr><tr><td>100</td><td><code><pre>                        // We setup the default backend address pools and default backend HTTP settings only if</pre></code></td></tr><tr><td>101</td><td><code><pre>                        // this rule does not have an `ssl-redirect` configuration.</pre></code></td></tr><tr><td>102</td><td><code><pre>                        if rule.RedirectConfiguration == nil {</pre></code></td></tr><tr><td>103</td><td><code><pre>                                rule.BackendAddressPool = urlPathMap.DefaultBackendAddressPool</pre></code></td></tr><tr><td>104</td><td><code><pre>                                rule.BackendHTTPSettings = urlPathMap.DefaultBackendHTTPSettings</pre></code></td></tr><tr><td>105</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>106</td><td><code><pre>                                rule.BackendAddressPool = nil</pre></code></td></tr><tr><td>107</td><td><code><pre>                                rule.BackendHTTPSettings = nil</pre></code></td></tr><tr><td>108</td><td><code><pre>                        }</pre></code></td></tr><tr><td>109</td><td><code><pre>                        rule.RewriteRuleSet = urlPathMap.DefaultRewriteRuleSet</pre></code></td></tr><tr><td>110</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>111</td><td><code><pre>                        // Path-based Rule</pre></code></td></tr><tr><td>112</td><td><code><pre>                        rule.RuleType = n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting</pre></code></td></tr><tr><td>113</td><td><code><pre>                        rule.URLPathMap = &amp;n.SubResource{ID: to.StringPtr(c.appGwIdentifier.urlPathMapID(*urlPathMap.Name))}</pre></code></td></tr><tr><td>114</td><td><code><pre>                        pathMap = append(pathMap, *urlPathMap)</pre></code></td></tr><tr><td>115</td><td><code><pre>                }</pre></code></td></tr><tr><td>116</td><td><code><pre>                if rule.RuleType == n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting {</pre></code></td></tr><tr><td>117</td><td><code><pre>                        klog.V(5).Infof(&#34;Bound path-based rule: %s to listener: %s (%s, %d) and url path map %s&#34;, *rule.Name, *httpListener.Name, listenerID.HostNames, listenerID.FrontendPort, utils.GetLastChunkOfSlashed(*rule.URLPathMap.ID))</pre></code></td></tr><tr><td>118</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>119</td><td><code><pre>                        if rule.RedirectConfiguration != nil {</pre></code></td></tr><tr><td>120</td><td><code><pre>                                klog.V(5).Infof(&#34;Bound basic rule: %s to listener: %s (%s, %d) and redirect configuration %s&#34;, *rule.Name, *httpListener.Name, listenerID.HostNames, listenerID.FrontendPort, utils.GetLastChunkOfSlashed(*rule.RedirectConfiguration.ID))</pre></code></td></tr><tr><td>121</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>122</td><td><code><pre>                                klog.V(5).Infof(&#34;Bound basic rule: %s to listener: %s (%s, %d) for backend pool %s and backend http settings %s&#34;, *rule.Name, *httpListener.Name, listenerID.HostNames, listenerID.FrontendPort, utils.GetLastChunkOfSlashed(*rule.BackendAddressPool.ID), utils.GetLastChunkOfSlashed(*rule.BackendHTTPSettings.ID))</pre></code></td></tr><tr><td>123</td><td><code><pre>                        }</pre></code></td></tr><tr><td>124</td><td><code><pre>                }</pre></code></td></tr><tr><td>125</td><td><code><pre>                requestRoutingRules = append(requestRoutingRules, rule)</pre></code></td></tr><tr><td>126</td><td><code><pre>        }</pre></code></td></tr><tr><td>127</td><td><code><pre></pre></code></td></tr><tr><td>128</td><td><code><pre>        c.mem.routingRules = &amp;requestRoutingRules</pre></code></td></tr><tr><td>129</td><td><code><pre>        c.mem.pathMaps = &amp;pathMap</pre></code></td></tr><tr><td>130</td><td><code><pre>        return requestRoutingRules, pathMap</pre></code></td></tr><tr><td>131</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.assignPriorityWhereMissing">func appGwConfigBuilder.assignPriorityWhereMissing</div><div class="info"><a href="#s_fn_appGwConfigBuilder.assignPriorityWhereMissing">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>508</td><td><code><pre>func (c *appGwConfigBuilder) assignPriorityWhereMissing(rules []n.ApplicationGatewayRequestRoutingRule) []n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>509</td><td><code><pre></pre></code></td></tr><tr><td>510</td><td><code><pre>        usedUpPriorities := make(map[int32]interface{})</pre></code></td></tr><tr><td>511</td><td><code><pre>        for _, rule := range rules {</pre></code></td></tr><tr><td>512</td><td><code><pre>                if rule.Priority != nil {</pre></code></td></tr><tr class="miss"><td>513</td><td><code><pre>                        usedUpPriorities[*rule.Priority] = nil</pre></code></td></tr><tr><td>514</td><td><code><pre>                }</pre></code></td></tr><tr><td>515</td><td><code><pre>        }</pre></code></td></tr><tr><td>516</td><td><code><pre></pre></code></td></tr><tr><td>517</td><td><code><pre>        var lastMultiSiteRulePriority int32 = 19000</pre></code></td></tr><tr><td>518</td><td><code><pre>        var lastBasicRulePriority int32 = 19500</pre></code></td></tr><tr><td>519</td><td><code><pre>        var priorityJump int32 = 5</pre></code></td></tr><tr><td>520</td><td><code><pre>        for _, rule := range rules {</pre></code></td></tr><tr><td>521</td><td><code><pre>                listener := LookupListenerByID(c.appGw.HTTPListeners, rule.HTTPListener.ID)</pre></code></td></tr><tr><td>522</td><td><code><pre></pre></code></td></tr><tr><td>523</td><td><code><pre>                if rule.Priority != nil {</pre></code></td></tr><tr><td>524</td><td><code><pre>                        // rule already has a priority assigned</pre></code></td></tr><tr class="miss"><td>525</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>526</td><td><code><pre>                }</pre></code></td></tr><tr><td>527</td><td><code><pre></pre></code></td></tr><tr><td>528</td><td><code><pre>                // find priority to assign to the rule</pre></code></td></tr><tr><td>529</td><td><code><pre>                var priority int32</pre></code></td></tr><tr><td>530</td><td><code><pre>                if IsMutliSiteListener(listener) {</pre></code></td></tr><tr><td>531</td><td><code><pre>                        priority = findNextFreePriority(usedUpPriorities, lastMultiSiteRulePriority, priorityJump)</pre></code></td></tr><tr><td>532</td><td><code><pre>                        lastMultiSiteRulePriority = priority</pre></code></td></tr><tr><td>533</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>534</td><td><code><pre>                        priority = findNextFreePriority(usedUpPriorities, lastBasicRulePriority, priorityJump)</pre></code></td></tr><tr><td>535</td><td><code><pre>                        lastBasicRulePriority = priority</pre></code></td></tr><tr><td>536</td><td><code><pre>                }</pre></code></td></tr><tr><td>537</td><td><code><pre></pre></code></td></tr><tr><td>538</td><td><code><pre>                rule.Priority = to.Int32Ptr(priority)</pre></code></td></tr><tr><td>539</td><td><code><pre>                usedUpPriorities[priority] = nil</pre></code></td></tr><tr><td>540</td><td><code><pre>        }</pre></code></td></tr><tr><td>541</td><td><code><pre></pre></code></td></tr><tr><td>542</td><td><code><pre>        return rules</pre></code></td></tr><tr><td>543</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getSecretToCertificateMap">func appGwConfigBuilder.getSecretToCertificateMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getSecretToCertificateMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func (c *appGwConfigBuilder) getSecretToCertificateMap(ingress *networking.Ingress) map[secretIdentifier]*string {</pre></code></td></tr><tr><td>54</td><td><code><pre>        secretIDCertificateMap := make(map[secretIdentifier]*string)</pre></code></td></tr><tr><td>55</td><td><code><pre>        for _, tls := range ingress.Spec.TLS {</pre></code></td></tr><tr><td>56</td><td><code><pre>                if len(tls.SecretName) == 0 {</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>58</td><td><code><pre>                }</pre></code></td></tr><tr><td>59</td><td><code><pre></pre></code></td></tr><tr><td>60</td><td><code><pre>                tlsSecret := secretIdentifier{</pre></code></td></tr><tr><td>61</td><td><code><pre>                        Name:      tls.SecretName,</pre></code></td></tr><tr><td>62</td><td><code><pre>                        Namespace: ingress.Namespace,</pre></code></td></tr><tr><td>63</td><td><code><pre>                }</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr><td>65</td><td><code><pre>                // add hostname-tlsSecret mapping to a per-ingress map</pre></code></td></tr><tr><td>66</td><td><code><pre>                if cert := c.k8sContext.CertificateSecretStore.GetPfxCertificate(tlsSecret.secretKey()); cert != nil {</pre></code></td></tr><tr><td>67</td><td><code><pre>                        secretIDCertificateMap[tlsSecret] = to.StringPtr(base64.StdEncoding.EncodeToString(cert))</pre></code></td></tr><tr><td>68</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>69</td><td><code><pre>                        logLine := fmt.Sprintf(&#34;Unable to find the secret associated to secretId: [%s]&#34;, tlsSecret.secretKey())</pre></code></td></tr><tr><td>70</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonSecretNotFound, logLine)</pre></code></td></tr><tr><td>71</td><td><code><pre>                }</pre></code></td></tr><tr><td>72</td><td><code><pre>        }</pre></code></td></tr><tr><td>73</td><td><code><pre></pre></code></td></tr><tr><td>74</td><td><code><pre>        return secretIDCertificateMap</pre></code></td></tr><tr><td>75</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.groupListenersByListenerIdentifier">func appGwConfigBuilder.groupListenersByListenerIdentifier</div><div class="info"><a href="#s_fn_appGwConfigBuilder.groupListenersByListenerIdentifier">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code>:</p></div><table class="listing">
<tr><td>197</td><td><code><pre>func (c *appGwConfigBuilder) groupListenersByListenerIdentifier(cbCtx *ConfigBuilderContext) map[listenerIdentifier]*n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>198</td><td><code><pre>        listeners, ports := c.getListeners(cbCtx)</pre></code></td></tr><tr><td>199</td><td><code><pre>        portsByID := make(map[string]n.ApplicationGatewayFrontendPort)</pre></code></td></tr><tr><td>200</td><td><code><pre>        for _, port := range *ports {</pre></code></td></tr><tr><td>201</td><td><code><pre>                portsByID[*port.ID] = port</pre></code></td></tr><tr><td>202</td><td><code><pre>        }</pre></code></td></tr><tr><td>203</td><td><code><pre></pre></code></td></tr><tr><td>204</td><td><code><pre>        listenersByID := make(map[listenerIdentifier]*n.ApplicationGatewayHTTPListener)</pre></code></td></tr><tr><td>205</td><td><code><pre>        // Update the listenerMap with the final listener lists</pre></code></td></tr><tr><td>206</td><td><code><pre>        for idx, listener := range *listeners {</pre></code></td></tr><tr><td>207</td><td><code><pre>                port, portExists := portsByID[*listener.FrontendPort.ID]</pre></code></td></tr><tr><td>208</td><td><code><pre></pre></code></td></tr><tr><td>209</td><td><code><pre>                listenerID := listenerIdentifier{</pre></code></td></tr><tr><td>210</td><td><code><pre>                        UsePrivateIP: IsPrivateIPConfiguration(LookupIPConfigurationByID(c.appGw.FrontendIPConfigurations, listener.FrontendIPConfiguration.ID)),</pre></code></td></tr><tr><td>211</td><td><code><pre>                }</pre></code></td></tr><tr><td>212</td><td><code><pre></pre></code></td></tr><tr><td>213</td><td><code><pre>                if listener.HostNames != nil &amp;&amp; len(*listener.HostNames) &gt; 0 {</pre></code></td></tr><tr><td>214</td><td><code><pre>                        listenerID.setHostNames(*listener.HostNames)</pre></code></td></tr><tr><td>215</td><td><code><pre>                } else if listener.HostName != nil {</pre></code></td></tr><tr class="miss"><td>216</td><td><code><pre>                        listenerID.setHostNames([]string{*listener.HostName})</pre></code></td></tr><tr><td>217</td><td><code><pre>                }</pre></code></td></tr><tr><td>218</td><td><code><pre></pre></code></td></tr><tr><td>219</td><td><code><pre>                if portExists &amp;&amp; port.Port != nil {</pre></code></td></tr><tr><td>220</td><td><code><pre>                        listenerID.FrontendPort = Port(*port.Port)</pre></code></td></tr><tr><td>221</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>222</td><td><code><pre>                        klog.Errorf(&#34;Failed to find port &#39;%s&#39; referenced by listener &#39;%s&#39;&#34;, *listener.FrontendPort.ID, *listener.Name)</pre></code></td></tr><tr><td>223</td><td><code><pre>                }</pre></code></td></tr><tr><td>224</td><td><code><pre>                listenersByID[listenerID] = &amp;((*listeners)[idx])</pre></code></td></tr><tr><td>225</td><td><code><pre>        }</pre></code></td></tr><tr><td>226</td><td><code><pre></pre></code></td></tr><tr><td>227</td><td><code><pre>        return listenersByID</pre></code></td></tr><tr><td>228</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getAGICRewriteRuleSets">func appGwConfigBuilder.getAGICRewriteRuleSets</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getAGICRewriteRuleSets">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/rewrites.go</code>:</p></div><table class="listing">
<tr><td>52</td><td><code><pre>func (c appGwConfigBuilder) getAGICRewriteRuleSets(cbCtx *ConfigBuilderContext) []n.ApplicationGatewayRewriteRuleSet {</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr><td>54</td><td><code><pre>        type rewriteCRDInfo struct {</pre></code></td></tr><tr><td>55</td><td><code><pre>                ingressNamespace string</pre></code></td></tr><tr><td>56</td><td><code><pre>                crdName          string</pre></code></td></tr><tr><td>57</td><td><code><pre>        }</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>        uniqueRewriteRuleSetCR := map[string]rewriteCRDInfo{}</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>        // insert all referenced rewrite rule sets into a map to avoid duplicates</pre></code></td></tr><tr><td>62</td><td><code><pre>        for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>63</td><td><code><pre></pre></code></td></tr><tr><td>64</td><td><code><pre>                klog.V(9).Infof(&#34;Looking for %s annotation in %s/%s&#34;, annotations.RewriteRuleSetCustomResourceKey, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr><td>65</td><td><code><pre>                rewriteRuleSetCRName, err := annotations.RewriteRuleSetCustomResource(ingress)</pre></code></td></tr><tr><td>66</td><td><code><pre></pre></code></td></tr><tr><td>67</td><td><code><pre>                // if there is error fetching CR or if the value is &#34;&#34;, move onto the next ingress</pre></code></td></tr><tr><td>68</td><td><code><pre>                if err != nil || rewriteRuleSetCRName == &#34;&#34; {</pre></code></td></tr><tr><td>69</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>70</td><td><code><pre>                }</pre></code></td></tr><tr><td>71</td><td><code><pre></pre></code></td></tr><tr><td>72</td><td><code><pre>                uniqueRewriteRuleSetCR[ingress.Namespace+&#34;/&#34;+rewriteRuleSetCRName] = rewriteCRDInfo{</pre></code></td></tr><tr><td>73</td><td><code><pre>                        ingressNamespace: ingress.Namespace,</pre></code></td></tr><tr><td>74</td><td><code><pre>                        crdName:          rewriteRuleSetCRName,</pre></code></td></tr><tr><td>75</td><td><code><pre>                }</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre></pre></code></td></tr><tr><td>78</td><td><code><pre>        var appGwRewriteRuleSet []n.ApplicationGatewayRewriteRuleSet</pre></code></td></tr><tr><td>79</td><td><code><pre></pre></code></td></tr><tr><td>80</td><td><code><pre>        // get details of all the unique rewrite rule sets referenced in various ingress manifest</pre></code></td></tr><tr><td>81</td><td><code><pre>        for _, rewriteRuleSetCRInfo := range uniqueRewriteRuleSetCR {</pre></code></td></tr><tr><td>82</td><td><code><pre></pre></code></td></tr><tr><td>83</td><td><code><pre>                rewrite, err := c.k8sContext.GetRewriteRuleSetCustomResource(rewriteRuleSetCRInfo.ingressNamespace, rewriteRuleSetCRInfo.crdName)</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr><td>85</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                        klog.Errorf(&#34;Error occured while fetching rewrite rule set custom resource named %s.&#34;, rewriteRuleSetCRInfo.crdName)</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>88</td><td><code><pre>                }</pre></code></td></tr><tr><td>89</td><td><code><pre></pre></code></td></tr><tr><td>90</td><td><code><pre>                appGwRewriteRuleSet = append(appGwRewriteRuleSet, c.makeRewrite(rewriteRuleSetCRInfo.ingressNamespace, rewriteRuleSetCRInfo.crdName, rewrite))</pre></code></td></tr><tr><td>91</td><td><code><pre>        }</pre></code></td></tr><tr><td>92</td><td><code><pre></pre></code></td></tr><tr><td>93</td><td><code><pre>        return appGwRewriteRuleSet</pre></code></td></tr><tr><td>94</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_printPathRule">func printPathRule</div><div class="info"><a href="#s_fn_printPathRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>462</td><td><code><pre>func printPathRule(pathRule n.ApplicationGatewayPathRule) string {</pre></code></td></tr><tr><td>463</td><td><code><pre>        s := fmt.Sprintf(&#34;pathMapName=%s&#34;, *pathRule.Name)</pre></code></td></tr><tr><td>464</td><td><code><pre></pre></code></td></tr><tr><td>465</td><td><code><pre>        if pathRule.BackendAddressPool != nil &amp;&amp; pathRule.BackendAddressPool.ID != nil {</pre></code></td></tr><tr><td>466</td><td><code><pre>                s = fmt.Sprintf(&#34;%s poolID=%s&#34;, s, *pathRule.BackendAddressPool.ID)</pre></code></td></tr><tr><td>467</td><td><code><pre>        }</pre></code></td></tr><tr><td>468</td><td><code><pre></pre></code></td></tr><tr><td>469</td><td><code><pre>        if pathRule.RedirectConfiguration != nil &amp;&amp; pathRule.RedirectConfiguration.ID != nil {</pre></code></td></tr><tr><td>470</td><td><code><pre>                s = fmt.Sprintf(&#34;%s redirectID=%s&#34;, s, *pathRule.RedirectConfiguration.ID)</pre></code></td></tr><tr><td>471</td><td><code><pre>        }</pre></code></td></tr><tr><td>472</td><td><code><pre></pre></code></td></tr><tr><td>473</td><td><code><pre>        if pathRule.LoadDistributionPolicy != nil &amp;&amp; pathRule.LoadDistributionPolicy.ID != nil {</pre></code></td></tr><tr class="miss"><td>474</td><td><code><pre>                s = fmt.Sprintf(&#34;%s ldpID=%s&#34;, s, *pathRule.LoadDistributionPolicy.ID)</pre></code></td></tr><tr><td>475</td><td><code><pre>        }</pre></code></td></tr><tr><td>476</td><td><code><pre></pre></code></td></tr><tr><td>477</td><td><code><pre>        return s</pre></code></td></tr><tr><td>478</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_findNextFreePriority">func findNextFreePriority</div><div class="info"><a href="#s_fn_findNextFreePriority">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>545</td><td><code><pre>func findNextFreePriority(usedUpPriorities map[int32]interface{}, lastPriority int32, jump int32) int32 {</pre></code></td></tr><tr><td>546</td><td><code><pre>        priority := lastPriority</pre></code></td></tr><tr><td>547</td><td><code><pre>        for {</pre></code></td></tr><tr><td>548</td><td><code><pre>                if _, exists := usedUpPriorities[priority]; !exists {</pre></code></td></tr><tr><td>549</td><td><code><pre>                        return priority</pre></code></td></tr><tr><td>550</td><td><code><pre>                }</pre></code></td></tr><tr><td>551</td><td><code><pre></pre></code></td></tr><tr><td>552</td><td><code><pre>                priority = priority + jump</pre></code></td></tr><tr><td>553</td><td><code><pre>                if priority &gt; MaxAllowedPriority {</pre></code></td></tr><tr class="miss"><td>554</td><td><code><pre>                        return MaxAllowedPriority</pre></code></td></tr><tr><td>555</td><td><code><pre>                }</pre></code></td></tr><tr><td>556</td><td><code><pre>        }</pre></code></td></tr><tr><td>557</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.noRulesIngress">func appGwConfigBuilder.noRulesIngress</div><div class="info"><a href="#s_fn_appGwConfigBuilder.noRulesIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>133</td><td><code><pre>func (c *appGwConfigBuilder) noRulesIngress(cbCtx *ConfigBuilderContext, ingress *networking.Ingress, urlPathMaps *map[listenerIdentifier]*n.ApplicationGatewayURLPathMap) {</pre></code></td></tr><tr><td>134</td><td><code><pre>        // There are no Rules. We are dealing with some very rudimentary Ingress definition.</pre></code></td></tr><tr><td>135</td><td><code><pre>        if ingress.Spec.DefaultBackend == nil {</pre></code></td></tr><tr class="miss"><td>136</td><td><code><pre>                return</pre></code></td></tr><tr><td>137</td><td><code><pre>        }</pre></code></td></tr><tr><td>138</td><td><code><pre>        backendID := generateBackendID(ingress, nil, nil, ingress.Spec.DefaultBackend)</pre></code></td></tr><tr><td>139</td><td><code><pre>        _, _, serviceBackendPairMap, err := c.getBackendsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>140</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>                klog.Error(&#34;Error fetching Backends and Settings: &#34;, err)</pre></code></td></tr><tr><td>142</td><td><code><pre>        }</pre></code></td></tr><tr><td>143</td><td><code><pre>        if serviceBackendPair, exists := serviceBackendPairMap[backendID]; exists {</pre></code></td></tr><tr><td>144</td><td><code><pre>                poolName := generateAddressPoolName(backendID.serviceFullName(), serviceBackendPortToStr(backendID.Backend.Service.Port), serviceBackendPair.BackendPort)</pre></code></td></tr><tr><td>145</td><td><code><pre>                defaultAddressPoolID := c.appGwIdentifier.AddressPoolID(poolName)</pre></code></td></tr><tr><td>146</td><td><code><pre>                defaultHTTPSettingsID := c.appGwIdentifier.HTTPSettingsID(DefaultBackendHTTPSettingsName)</pre></code></td></tr><tr><td>147</td><td><code><pre>                listenerID := defaultFrontendListenerIdentifier(cbCtx.EnvVariables.UsePrivateIP)</pre></code></td></tr><tr><td>148</td><td><code><pre>                pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr><td>149</td><td><code><pre>                (*urlPathMaps)[listenerID] = &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>150</td><td><code><pre>                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>151</td><td><code><pre>                        Name: to.StringPtr(pathMapName),</pre></code></td></tr><tr><td>152</td><td><code><pre>                        ID:   to.StringPtr(c.appGwIdentifier.urlPathMapID(pathMapName)),</pre></code></td></tr><tr><td>153</td><td><code><pre>                        ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>154</td><td><code><pre>                                DefaultBackendAddressPool:  &amp;n.SubResource{ID: &amp;defaultAddressPoolID},</pre></code></td></tr><tr><td>155</td><td><code><pre>                                DefaultBackendHTTPSettings: &amp;n.SubResource{ID: &amp;defaultHTTPSettingsID},</pre></code></td></tr><tr><td>156</td><td><code><pre>                                PathRules:                  &amp;[]n.ApplicationGatewayPathRule{},</pre></code></td></tr><tr><td>157</td><td><code><pre>                        },</pre></code></td></tr><tr><td>158</td><td><code><pre>                }</pre></code></td></tr><tr><td>159</td><td><code><pre>        }</pre></code></td></tr><tr><td>160</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getListenerConfigs">func appGwConfigBuilder.getListenerConfigs</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getListenerConfigs">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code>:</p></div><table class="listing">
<tr><td>112</td><td><code><pre>func (c *appGwConfigBuilder) getListenerConfigs(cbCtx *ConfigBuilderContext) map[listenerIdentifier]listenerAzConfig {</pre></code></td></tr><tr><td>113</td><td><code><pre>        if c.mem.listenerConfigs != nil {</pre></code></td></tr><tr><td>114</td><td><code><pre>                return *c.mem.listenerConfigs</pre></code></td></tr><tr><td>115</td><td><code><pre>        }</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr><td>117</td><td><code><pre>        if cbCtx.EnvVariables.AttachWAFPolicyToListener {</pre></code></td></tr><tr><td>118</td><td><code><pre>                // logging to see if customer configures env.AttachWAFPolicyToListener or not</pre></code></td></tr><tr class="miss"><td>119</td><td><code><pre>                klog.V(5).Info(&#34;env.AttachWAFPolicyToListener is enabled&#34;)</pre></code></td></tr><tr><td>120</td><td><code><pre>        }</pre></code></td></tr><tr><td>121</td><td><code><pre></pre></code></td></tr><tr><td>122</td><td><code><pre>        // TODO(draychev): Emit an error event if 2 namespaces define different TLS for the same domain!</pre></code></td></tr><tr><td>123</td><td><code><pre>        allListeners := make(map[listenerIdentifier]listenerAzConfig)</pre></code></td></tr><tr><td>124</td><td><code><pre>        for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>125</td><td><code><pre>                klog.V(5).Infof(&#34;Processing Rules for Ingress: %s/%s&#34;, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr><td>126</td><td><code><pre>                azListenerConfigs := c.getListenersFromIngress(ingress, cbCtx.EnvVariables)</pre></code></td></tr><tr><td>127</td><td><code><pre>                for listenerID, azConfig := range azListenerConfigs {</pre></code></td></tr><tr><td>128</td><td><code><pre>                        allListeners[listenerID] = azConfig</pre></code></td></tr><tr><td>129</td><td><code><pre>                }</pre></code></td></tr><tr><td>130</td><td><code><pre>        }</pre></code></td></tr><tr><td>131</td><td><code><pre></pre></code></td></tr><tr><td>132</td><td><code><pre>        // App Gateway must have at least one listener - the default one!</pre></code></td></tr><tr><td>133</td><td><code><pre>        if len(allListeners) == 0 {</pre></code></td></tr><tr><td>134</td><td><code><pre>                listenerConfig := listenerAzConfig{</pre></code></td></tr><tr><td>135</td><td><code><pre>                        // Default protocol</pre></code></td></tr><tr><td>136</td><td><code><pre>                        Protocol: n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>137</td><td><code><pre>                }</pre></code></td></tr><tr><td>138</td><td><code><pre>                // See if we have an ingress annotated with a Firewall Policy; Attach it to the listener</pre></code></td></tr><tr><td>139</td><td><code><pre>                for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>140</td><td><code><pre>                        // if ingress has only backend configured or ingress rule without path but empty host</pre></code></td></tr><tr><td>141</td><td><code><pre>                        if policy, _ := annotations.WAFPolicy(ingress); policy != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>                                listenerConfig.FirewallPolicy = policy</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                                break</pre></code></td></tr><tr><td>144</td><td><code><pre>                        }</pre></code></td></tr><tr><td>145</td><td><code><pre>                }</pre></code></td></tr><tr><td>146</td><td><code><pre></pre></code></td></tr><tr><td>147</td><td><code><pre>                allListeners[defaultFrontendListenerIdentifier(cbCtx.EnvVariables.UsePrivateIP)] = listenerConfig</pre></code></td></tr><tr><td>148</td><td><code><pre>        }</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>        c.mem.listenerConfigs = &amp;allListeners</pre></code></td></tr><tr><td>151</td><td><code><pre>        return allListeners</pre></code></td></tr><tr><td>152</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.addTags">func appGwConfigBuilder.addTags</div><div class="info"><a href="#s_fn_appGwConfigBuilder.addTags">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>266</td><td><code><pre>func (c *appGwConfigBuilder) addTags() {</pre></code></td></tr><tr><td>267</td><td><code><pre>        if c.appGw.Tags == nil {</pre></code></td></tr><tr><td>268</td><td><code><pre>                c.appGw.Tags = make(map[string]*string)</pre></code></td></tr><tr><td>269</td><td><code><pre>        }</pre></code></td></tr><tr><td>270</td><td><code><pre>        // Identify the App Gateway as being exclusively managed by a Kubernetes Ingress.</pre></code></td></tr><tr><td>271</td><td><code><pre>        c.appGw.Tags[tags.ManagedByK8sIngress] = to.StringPtr(GetVersion())</pre></code></td></tr><tr><td>272</td><td><code><pre>        if aksResourceID, err := azure.ConvertToClusterResourceGroup(c.k8sContext.GetInfrastructureResourceGroupID()); err == nil {</pre></code></td></tr><tr><td>273</td><td><code><pre>                c.appGw.Tags[tags.IngressForAKSClusterID] = to.StringPtr(aksResourceID)</pre></code></td></tr><tr><td>274</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>275</td><td><code><pre>                klog.V(5).Infof(&#34;Error while parsing cluster resource ID for tagging: %s&#34;, err)</pre></code></td></tr><tr><td>276</td><td><code><pre>        }</pre></code></td></tr><tr><td>277</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getCertificate">func appGwConfigBuilder.getCertificate</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getCertificate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/certificates.go</code>:</p></div><table class="listing">
<tr><td>77</td><td><code><pre>func (c *appGwConfigBuilder) getCertificate(ingress *networking.Ingress, hostname string, hostnameSecretIDMap map[string]secretIdentifier) (*string, *secretIdentifier) {</pre></code></td></tr><tr><td>78</td><td><code><pre>        if hostnameSecretIDMap == nil {</pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>                return nil, nil</pre></code></td></tr><tr><td>80</td><td><code><pre>        }</pre></code></td></tr><tr><td>81</td><td><code><pre>        secID, exists := hostnameSecretIDMap[hostname]</pre></code></td></tr><tr><td>82</td><td><code><pre>        if !exists {</pre></code></td></tr><tr><td>83</td><td><code><pre>                // check if wildcard exists</pre></code></td></tr><tr><td>84</td><td><code><pre>                secID, exists = hostnameSecretIDMap[&#34;&#34;]</pre></code></td></tr><tr><td>85</td><td><code><pre>        }</pre></code></td></tr><tr><td>86</td><td><code><pre>        if !exists {</pre></code></td></tr><tr><td>87</td><td><code><pre>                // no wildcard or matched certificate</pre></code></td></tr><tr><td>88</td><td><code><pre>                return nil, nil</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr><td>90</td><td><code><pre></pre></code></td></tr><tr><td>91</td><td><code><pre>        cert, exists := c.getSecretToCertificateMap(ingress)[secID]</pre></code></td></tr><tr><td>92</td><td><code><pre>        if !exists {</pre></code></td></tr><tr><td>93</td><td><code><pre>                // secret referred does not correspond to a certificate</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>                return nil, nil</pre></code></td></tr><tr><td>95</td><td><code><pre>        }</pre></code></td></tr><tr><td>96</td><td><code><pre>        return cert, &amp;secID</pre></code></td></tr><tr><td>97</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.generateHTTPSettings">func appGwConfigBuilder.generateHTTPSettings</div><div class="info"><a href="#s_fn_appGwConfigBuilder.generateHTTPSettings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code>:</p></div><table class="listing">
<tr><td>225</td><td><code><pre>func (c *appGwConfigBuilder) generateHTTPSettings(backendID backendIdentifier, port Port, cbCtx *ConfigBuilderContext) n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr><td>226</td><td><code><pre>        httpSettingsName := generateHTTPSettingsName(backendID.serviceFullName(), serviceBackendPortToStr(backendID.Backend.Service.Port), port, backendID.Ingress.Name)</pre></code></td></tr><tr><td>227</td><td><code><pre></pre></code></td></tr><tr><td>228</td><td><code><pre>        httpSettings := n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>229</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>230</td><td><code><pre>                Name: &amp;httpSettingsName,</pre></code></td></tr><tr><td>231</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.HTTPSettingsID(httpSettingsName)),</pre></code></td></tr><tr><td>232</td><td><code><pre>                ApplicationGatewayBackendHTTPSettingsPropertiesFormat: &amp;n.ApplicationGatewayBackendHTTPSettingsPropertiesFormat{</pre></code></td></tr><tr><td>233</td><td><code><pre>                        Protocol: n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>234</td><td><code><pre>                        Port:     to.Int32Ptr(int32(port)),</pre></code></td></tr><tr><td>235</td><td><code><pre></pre></code></td></tr><tr><td>236</td><td><code><pre>                        // setting to default</pre></code></td></tr><tr><td>237</td><td><code><pre>                        PickHostNameFromBackendAddress: to.BoolPtr(false),</pre></code></td></tr><tr><td>238</td><td><code><pre>                        CookieBasedAffinity:            n.ApplicationGatewayCookieBasedAffinityDisabled,</pre></code></td></tr><tr><td>239</td><td><code><pre>                        RequestTimeout:                 to.Int32Ptr(30),</pre></code></td></tr><tr><td>240</td><td><code><pre>                },</pre></code></td></tr><tr><td>241</td><td><code><pre>        }</pre></code></td></tr><tr><td>242</td><td><code><pre>        _, probesMap := c.newProbesMap(cbCtx)</pre></code></td></tr><tr><td>243</td><td><code><pre></pre></code></td></tr><tr><td>244</td><td><code><pre>        if probesMap[backendID] != nil {</pre></code></td></tr><tr><td>245</td><td><code><pre>                probeName := probesMap[backendID].Name</pre></code></td></tr><tr><td>246</td><td><code><pre>                probeID := c.appGwIdentifier.probeID(*probeName)</pre></code></td></tr><tr><td>247</td><td><code><pre>                httpSettings.ApplicationGatewayBackendHTTPSettingsPropertiesFormat.Probe = resourceRef(probeID)</pre></code></td></tr><tr><td>248</td><td><code><pre>        }</pre></code></td></tr><tr><td>249</td><td><code><pre></pre></code></td></tr><tr><td>250</td><td><code><pre>        if pathPrefix, err := annotations.BackendPathPrefix(backendID.Ingress); err == nil {</pre></code></td></tr><tr><td>251</td><td><code><pre>                httpSettings.Path = to.StringPtr(pathPrefix)</pre></code></td></tr><tr><td>252</td><td><code><pre>        } else if !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>253</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>254</td><td><code><pre>        }</pre></code></td></tr><tr><td>255</td><td><code><pre></pre></code></td></tr><tr><td>256</td><td><code><pre>        if hostName, err := annotations.BackendHostName(backendID.Ingress); err == nil {</pre></code></td></tr><tr><td>257</td><td><code><pre>                httpSettings.HostName = to.StringPtr(hostName)</pre></code></td></tr><tr><td>258</td><td><code><pre>        } else if !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>259</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>260</td><td><code><pre>        }</pre></code></td></tr><tr><td>261</td><td><code><pre></pre></code></td></tr><tr><td>262</td><td><code><pre>        if isConnDrain, err := annotations.IsConnectionDraining(backendID.Ingress); err == nil &amp;&amp; isConnDrain {</pre></code></td></tr><tr><td>263</td><td><code><pre>                httpSettings.ConnectionDraining = &amp;n.ApplicationGatewayConnectionDraining{</pre></code></td></tr><tr><td>264</td><td><code><pre>                        Enabled: to.BoolPtr(true),</pre></code></td></tr><tr><td>265</td><td><code><pre>                }</pre></code></td></tr><tr><td>266</td><td><code><pre></pre></code></td></tr><tr><td>267</td><td><code><pre>                if connDrainTimeout, err := annotations.ConnectionDrainingTimeout(backendID.Ingress); err == nil {</pre></code></td></tr><tr><td>268</td><td><code><pre>                        httpSettings.ConnectionDraining.DrainTimeoutInSec = to.Int32Ptr(connDrainTimeout)</pre></code></td></tr><tr><td>269</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>270</td><td><code><pre>                        httpSettings.ConnectionDraining.DrainTimeoutInSec = to.Int32Ptr(DefaultConnDrainTimeoutInSec)</pre></code></td></tr><tr><td>271</td><td><code><pre>                }</pre></code></td></tr><tr><td>272</td><td><code><pre>        } else if err != nil &amp;&amp; !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>273</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>274</td><td><code><pre>        }</pre></code></td></tr><tr><td>275</td><td><code><pre></pre></code></td></tr><tr><td>276</td><td><code><pre>        if affinity, err := annotations.IsCookieBasedAffinity(backendID.Ingress); err == nil &amp;&amp; affinity {</pre></code></td></tr><tr><td>277</td><td><code><pre>                httpSettings.CookieBasedAffinity = n.ApplicationGatewayCookieBasedAffinityEnabled</pre></code></td></tr><tr><td>278</td><td><code><pre>        } else if err != nil &amp;&amp; !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>279</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>280</td><td><code><pre>        }</pre></code></td></tr><tr><td>281</td><td><code><pre></pre></code></td></tr><tr><td>282</td><td><code><pre>        if distinctName, err := annotations.IsCookieBasedAffinityDistinctName(backendID.Ingress); err == nil &amp;&amp; distinctName {</pre></code></td></tr><tr class="miss"><td>283</td><td><code><pre>                httpSettings.AffinityCookieName = to.StringPtr(fmt.Sprintf(&#34;%s%s&#34;, &#34;appgw-affinity-&#34;, backendID.serviceFullNameHash()))</pre></code></td></tr><tr><td>284</td><td><code><pre>        } else if err != nil &amp;&amp; !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>285</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>286</td><td><code><pre>        }</pre></code></td></tr><tr><td>287</td><td><code><pre></pre></code></td></tr><tr><td>288</td><td><code><pre>        if reqTimeout, err := annotations.RequestTimeout(backendID.Ingress); err == nil {</pre></code></td></tr><tr><td>289</td><td><code><pre>                httpSettings.RequestTimeout = to.Int32Ptr(reqTimeout)</pre></code></td></tr><tr><td>290</td><td><code><pre>        } else if !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>291</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>292</td><td><code><pre>        }</pre></code></td></tr><tr><td>293</td><td><code><pre></pre></code></td></tr><tr><td>294</td><td><code><pre>        // when ingress is defined with backend at port 443 but without annotation backend-protocol set to https.</pre></code></td></tr><tr><td>295</td><td><code><pre>        if int32(port) == 443 {</pre></code></td></tr><tr><td>296</td><td><code><pre>                httpSettings.Protocol = n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>297</td><td><code><pre>        }</pre></code></td></tr><tr><td>298</td><td><code><pre></pre></code></td></tr><tr><td>299</td><td><code><pre>        // backend protocol take precedence over port</pre></code></td></tr><tr><td>300</td><td><code><pre>        backendProtocol, err := annotations.BackendProtocol(backendID.Ingress)</pre></code></td></tr><tr><td>301</td><td><code><pre>        if err == nil &amp;&amp; backendProtocol == annotations.HTTPS {</pre></code></td></tr><tr><td>302</td><td><code><pre>                httpSettings.Protocol = n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>303</td><td><code><pre>        } else if err == nil &amp;&amp; backendProtocol == annotations.HTTP {</pre></code></td></tr><tr><td>304</td><td><code><pre>                httpSettings.Protocol = n.ApplicationGatewayProtocolHTTP</pre></code></td></tr><tr><td>305</td><td><code><pre>        } else if err != nil &amp;&amp; !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>306</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>307</td><td><code><pre>        }</pre></code></td></tr><tr><td>308</td><td><code><pre></pre></code></td></tr><tr><td>309</td><td><code><pre>        if trustedRootCertificates, err := annotations.GetAppGwTrustedRootCertificate(backendID.Ingress); err == nil {</pre></code></td></tr><tr><td>310</td><td><code><pre>                certificateNames := strings.TrimRight(trustedRootCertificates, &#34;,&#34;)</pre></code></td></tr><tr><td>311</td><td><code><pre>                certificateNameList := strings.Split(certificateNames, &#34;,&#34;)</pre></code></td></tr><tr><td>312</td><td><code><pre>                var certs []n.SubResource</pre></code></td></tr><tr><td>313</td><td><code><pre>                for _, certName := range certificateNameList {</pre></code></td></tr><tr><td>314</td><td><code><pre>                        trustCertID := c.appGwIdentifier.trustedRootCertificateID(certName)</pre></code></td></tr><tr><td>315</td><td><code><pre>                        certs = append(certs, *resourceRef(trustCertID))</pre></code></td></tr><tr><td>316</td><td><code><pre>                }</pre></code></td></tr><tr><td>317</td><td><code><pre>                httpSettings.TrustedRootCertificates = &amp;certs</pre></code></td></tr><tr><td>318</td><td><code><pre>                klog.V(5).Infof(&#34;Found trusted root certificate(s): %s from ingress: %s/%s&#34;, certificateNames, backendID.Ingress.Namespace, backendID.Ingress.Name)</pre></code></td></tr><tr><td>319</td><td><code><pre></pre></code></td></tr><tr><td>320</td><td><code><pre>        } else if err != nil &amp;&amp; !controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr class="miss"><td>321</td><td><code><pre>                c.recorder.Event(backendID.Ingress, v1.EventTypeWarning, events.ReasonInvalidAnnotation, err.Error())</pre></code></td></tr><tr><td>322</td><td><code><pre>        }</pre></code></td></tr><tr><td>323</td><td><code><pre></pre></code></td></tr><tr><td>324</td><td><code><pre>        // To use an HTTP setting with a trusted root certificate, we must either override with a specific domain name or choose &#34;Pick host name from backend target&#34;.</pre></code></td></tr><tr><td>325</td><td><code><pre>        if httpSettings.TrustedRootCertificates != nil {</pre></code></td></tr><tr><td>326</td><td><code><pre>                if httpSettings.Protocol == n.ApplicationGatewayProtocolHTTPS &amp;&amp; len(*httpSettings.TrustedRootCertificates) &gt; 0 {</pre></code></td></tr><tr><td>327</td><td><code><pre>                        if httpSettings.HostName != nil &amp;&amp; len(*httpSettings.HostName) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>328</td><td><code><pre>                                httpSettings.PickHostNameFromBackendAddress = to.BoolPtr(false)</pre></code></td></tr><tr><td>329</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>330</td><td><code><pre>                                httpSettings.PickHostNameFromBackendAddress = to.BoolPtr(true)</pre></code></td></tr><tr><td>331</td><td><code><pre>                        }</pre></code></td></tr><tr><td>332</td><td><code><pre>                }</pre></code></td></tr><tr><td>333</td><td><code><pre>        }</pre></code></td></tr><tr><td>334</td><td><code><pre></pre></code></td></tr><tr><td>335</td><td><code><pre>        return httpSettings</pre></code></td></tr><tr><td>336</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_IsMutliSiteListener">func IsMutliSiteListener</div><div class="info"><a href="#s_fn_IsMutliSiteListener">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code>:</p></div><table class="listing">
<tr><td>240</td><td><code><pre>func IsMutliSiteListener(listener *n.ApplicationGatewayHTTPListener) bool {</pre></code></td></tr><tr><td>241</td><td><code><pre>        if listener == nil {</pre></code></td></tr><tr class="miss"><td>242</td><td><code><pre>                return false</pre></code></td></tr><tr><td>243</td><td><code><pre>        }</pre></code></td></tr><tr><td>244</td><td><code><pre></pre></code></td></tr><tr><td>245</td><td><code><pre>        if listener.HostName != nil &amp;&amp; *listener.HostName != &#34;&#34; {</pre></code></td></tr><tr><td>246</td><td><code><pre>                return true</pre></code></td></tr><tr><td>247</td><td><code><pre>        }</pre></code></td></tr><tr><td>248</td><td><code><pre></pre></code></td></tr><tr><td>249</td><td><code><pre>        return listener.HostNames != nil &amp;&amp; len(*listener.HostNames) &gt; 0</pre></code></td></tr><tr><td>250</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getListeners">func appGwConfigBuilder.getListeners</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getListeners">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func (c *appGwConfigBuilder) getListeners(cbCtx *ConfigBuilderContext) (*[]n.ApplicationGatewayHTTPListener, *[]n.ApplicationGatewayFrontendPort) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        if c.mem.listeners != nil &amp;&amp; c.mem.ports != nil {</pre></code></td></tr><tr><td>23</td><td><code><pre>                return c.mem.listeners, c.mem.ports</pre></code></td></tr><tr><td>24</td><td><code><pre>        }</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr><td>26</td><td><code><pre>        publIPPorts := make(map[string]string)</pre></code></td></tr><tr><td>27</td><td><code><pre>        portsByNumber := cbCtx.ExistingPortsByNumber</pre></code></td></tr><tr><td>28</td><td><code><pre>        var listeners []n.ApplicationGatewayHTTPListener</pre></code></td></tr><tr><td>29</td><td><code><pre></pre></code></td></tr><tr><td>30</td><td><code><pre>        if portsByNumber == nil {</pre></code></td></tr><tr><td>31</td><td><code><pre>                portsByNumber = make(map[Port]n.ApplicationGatewayFrontendPort)</pre></code></td></tr><tr><td>32</td><td><code><pre>        }</pre></code></td></tr><tr><td>33</td><td><code><pre></pre></code></td></tr><tr><td>34</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                listeners, portsByNumber, publIPPorts = c.getIstioListenersPorts(cbCtx)</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr><tr><td>37</td><td><code><pre></pre></code></td></tr><tr><td>38</td><td><code><pre>        for listenerID, config := range c.getListenerConfigs(cbCtx) {</pre></code></td></tr><tr><td>39</td><td><code><pre>                listener, port, err := c.newListener(cbCtx, listenerID, config.Protocol, portsByNumber)</pre></code></td></tr><tr><td>40</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                        klog.Errorf(&#34;Failed creating listener %+v: %s&#34;, listenerID, err)</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>43</td><td><code><pre>                }</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr><td>45</td><td><code><pre>                if listenerName, exists := publIPPorts[*port.Name]; exists &amp;&amp; listenerID.UsePrivateIP {</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                        klog.Errorf(&#34;Can&#39;t assign port %s to Private IP Listener %s; already assigned to Public IP Listener %s; Will not create listener %+v&#34;, *port.Name, *listener.Name, listenerName, listenerID)</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>48</td><td><code><pre>                }</pre></code></td></tr><tr><td>49</td><td><code><pre></pre></code></td></tr><tr><td>50</td><td><code><pre>                if !listenerID.UsePrivateIP {</pre></code></td></tr><tr><td>51</td><td><code><pre>                        publIPPorts[*port.Name] = *listener.Name</pre></code></td></tr><tr><td>52</td><td><code><pre>                }</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr><td>54</td><td><code><pre>                // newlistener created a new port; Add it to the set</pre></code></td></tr><tr><td>55</td><td><code><pre>                if _, exists := portsByNumber[Port(*port.Port)]; !exists {</pre></code></td></tr><tr><td>56</td><td><code><pre>                        portsByNumber[Port(*port.Port)] = *port</pre></code></td></tr><tr><td>57</td><td><code><pre>                }</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>                if config.Protocol == n.ApplicationGatewayProtocolHTTPS {</pre></code></td></tr><tr><td>60</td><td><code><pre>                        sslCertificateID := c.appGwIdentifier.sslCertificateID(config.Secret.secretFullName())</pre></code></td></tr><tr><td>61</td><td><code><pre>                        listener.SslCertificate = resourceRef(sslCertificateID)</pre></code></td></tr><tr><td>62</td><td><code><pre>                        if config.SslProfile != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                                sslProfileID := c.appGwIdentifier.sslProfileID(config.SslProfile)</pre></code></td></tr><tr class="miss"><td>64</td><td><code><pre>                                listener.SslProfile = resourceRef(sslProfileID)</pre></code></td></tr><tr><td>65</td><td><code><pre>                        }</pre></code></td></tr><tr><td>66</td><td><code><pre>                }</pre></code></td></tr><tr><td>67</td><td><code><pre>                if config.FirewallPolicy != &#34;&#34; {</pre></code></td></tr><tr><td>68</td><td><code><pre>                        listener.FirewallPolicy = &amp;n.SubResource{ID: to.StringPtr(config.FirewallPolicy)}</pre></code></td></tr><tr><td>69</td><td><code><pre>                }</pre></code></td></tr><tr><td>70</td><td><code><pre>                listeners = append(listeners, *listener)</pre></code></td></tr><tr><td>71</td><td><code><pre>        }</pre></code></td></tr><tr><td>72</td><td><code><pre></pre></code></td></tr><tr><td>73</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                er := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, nil)</pre></code></td></tr><tr><td>75</td><td><code><pre></pre></code></td></tr><tr><td>76</td><td><code><pre>                // Listeners we obtained from App Gateway - we segment them into ones AGIC is and is not allowed to change.</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>                existingBlacklisted, existingNonBlacklisted := er.GetBlacklistedListeners()</pre></code></td></tr><tr><td>78</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>                brownfield.LogListeners(existingBlacklisted, existingNonBlacklisted, listeners)</pre></code></td></tr><tr><td>80</td><td><code><pre></pre></code></td></tr><tr><td>81</td><td><code><pre>                // MergeListeners would produce unique list of listeners based on Name. Blacklisted listeners,</pre></code></td></tr><tr><td>82</td><td><code><pre>                // which have the same name as a managed listeners would be overwritten.</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                listeners = brownfield.MergeListeners(existingBlacklisted, listeners)</pre></code></td></tr><tr><td>84</td><td><code><pre>        }</pre></code></td></tr><tr><td>85</td><td><code><pre></pre></code></td></tr><tr><td>86</td><td><code><pre>        portIDs := make(map[string]interface{})</pre></code></td></tr><tr><td>87</td><td><code><pre>        // Cleanup unused ports</pre></code></td></tr><tr><td>88</td><td><code><pre>        for _, listener := range listeners {</pre></code></td></tr><tr><td>89</td><td><code><pre>                if listener.FrontendPort != nil &amp;&amp; listener.FrontendPort.ID != nil {</pre></code></td></tr><tr><td>90</td><td><code><pre>                        portIDs[*listener.FrontendPort.ID] = nil</pre></code></td></tr><tr><td>91</td><td><code><pre>                }</pre></code></td></tr><tr><td>92</td><td><code><pre>        }</pre></code></td></tr><tr><td>93</td><td><code><pre></pre></code></td></tr><tr><td>94</td><td><code><pre>        var ports []n.ApplicationGatewayFrontendPort</pre></code></td></tr><tr><td>95</td><td><code><pre>        for _, port := range portsByNumber {</pre></code></td></tr><tr><td>96</td><td><code><pre>                if _, exists := portIDs[*port.ID]; exists {</pre></code></td></tr><tr><td>97</td><td><code><pre>                        ports = append(ports, port)</pre></code></td></tr><tr><td>98</td><td><code><pre>                }</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        sort.Sort(sorter.ByListenerName(listeners))</pre></code></td></tr><tr><td>102</td><td><code><pre>        sort.Sort(sorter.ByFrontendPortName(ports))</pre></code></td></tr><tr><td>103</td><td><code><pre></pre></code></td></tr><tr><td>104</td><td><code><pre>        // Since getListeners() would be called multiple times within the life cycle of a MutateAppGateway(Event)</pre></code></td></tr><tr><td>105</td><td><code><pre>        // we cache the results of this function in what would be final place to store the Listeners.</pre></code></td></tr><tr><td>106</td><td><code><pre>        c.mem.listeners = &amp;listeners</pre></code></td></tr><tr><td>107</td><td><code><pre>        c.mem.ports = &amp;ports</pre></code></td></tr><tr><td>108</td><td><code><pre>        return &amp;listeners, &amp;ports</pre></code></td></tr><tr><td>109</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.resolvePortName">func appGwConfigBuilder.resolvePortName</div><div class="info"><a href="#s_fn_appGwConfigBuilder.resolvePortName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>192</td><td><code><pre>func (c *appGwConfigBuilder) resolvePortName(portName string, backendID *backendIdentifier) map[int32]interface{} {</pre></code></td></tr><tr><td>193</td><td><code><pre>        resolvedPorts := make(map[int32]interface{})</pre></code></td></tr><tr><td>194</td><td><code><pre>        endpoints, err := c.k8sContext.GetEndpointsByService(backendID.serviceKey())</pre></code></td></tr><tr><td>195</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>196</td><td><code><pre>                klog.Error(&#34;Could not fetch endpoint by service key from cache&#34;, err)</pre></code></td></tr><tr class="miss"><td>197</td><td><code><pre>                return resolvedPorts</pre></code></td></tr><tr><td>198</td><td><code><pre>        }</pre></code></td></tr><tr><td>199</td><td><code><pre></pre></code></td></tr><tr><td>200</td><td><code><pre>        if endpoints == nil {</pre></code></td></tr><tr class="miss"><td>201</td><td><code><pre>                return resolvedPorts</pre></code></td></tr><tr><td>202</td><td><code><pre>        }</pre></code></td></tr><tr><td>203</td><td><code><pre>        for _, subset := range endpoints.Subsets {</pre></code></td></tr><tr><td>204</td><td><code><pre>                for _, epPort := range subset.Ports {</pre></code></td></tr><tr><td>205</td><td><code><pre>                        if epPort.Name == portName {</pre></code></td></tr><tr><td>206</td><td><code><pre>                                resolvedPorts[epPort.Port] = nil</pre></code></td></tr><tr><td>207</td><td><code><pre>                        }</pre></code></td></tr><tr><td>208</td><td><code><pre>                }</pre></code></td></tr><tr><td>209</td><td><code><pre>        }</pre></code></td></tr><tr><td>210</td><td><code><pre>        return resolvedPorts</pre></code></td></tr><tr><td>211</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LookupIPConfigurationByType">func LookupIPConfigurationByType</div><div class="info"><a href="#s_fn_LookupIPConfigurationByType">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_ipconfigurations.go</code>:</p></div><table class="listing">
<tr><td>8</td><td><code><pre>func LookupIPConfigurationByType(frontendIPConfigurations *[]n.ApplicationGatewayFrontendIPConfiguration, privateIP bool) *n.ApplicationGatewayFrontendIPConfiguration {</pre></code></td></tr><tr><td>9</td><td><code><pre>        for _, ip := range *frontendIPConfigurations {</pre></code></td></tr><tr><td>10</td><td><code><pre>                if ip.ApplicationGatewayFrontendIPConfigurationPropertiesFormat != nil &amp;&amp;</pre></code></td></tr><tr><td>11</td><td><code><pre>                        ((privateIP &amp;&amp; ip.PrivateIPAddress != nil) ||</pre></code></td></tr><tr><td>12</td><td><code><pre>                                (!privateIP &amp;&amp; ip.PublicIPAddress != nil)) {</pre></code></td></tr><tr><td>13</td><td><code><pre>                        return &amp;ip</pre></code></td></tr><tr><td>14</td><td><code><pre>                }</pre></code></td></tr><tr><td>15</td><td><code><pre>        }</pre></code></td></tr><tr><td>16</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>18</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LookupIPConfigurationByID">func LookupIPConfigurationByID</div><div class="info"><a href="#s_fn_LookupIPConfigurationByID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_ipconfigurations.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func LookupIPConfigurationByID(frontendIPConfigurations *[]n.ApplicationGatewayFrontendIPConfiguration, ID *string) *n.ApplicationGatewayFrontendIPConfiguration {</pre></code></td></tr><tr><td>22</td><td><code><pre>        for _, ip := range *frontendIPConfigurations {</pre></code></td></tr><tr><td>23</td><td><code><pre>                if *ip.ID == *ID {</pre></code></td></tr><tr><td>24</td><td><code><pre>                        return &amp;ip</pre></code></td></tr><tr><td>25</td><td><code><pre>                }</pre></code></td></tr><tr><td>26</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>28</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getRedirectConfigurations">func appGwConfigBuilder.getRedirectConfigurations</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getRedirectConfigurations">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/redirects.go</code>:</p></div><table class="listing">
<tr><td>20</td><td><code><pre>func (c *appGwConfigBuilder) getRedirectConfigurations(cbCtx *ConfigBuilderContext) *[]n.ApplicationGatewayRedirectConfiguration {</pre></code></td></tr><tr><td>21</td><td><code><pre>        if c.mem.redirectConfigs != nil {</pre></code></td></tr><tr><td>22</td><td><code><pre>                return c.mem.redirectConfigs</pre></code></td></tr><tr><td>23</td><td><code><pre>        }</pre></code></td></tr><tr><td>24</td><td><code><pre></pre></code></td></tr><tr><td>25</td><td><code><pre>        redirectConfigs := []n.ApplicationGatewayRedirectConfiguration{}</pre></code></td></tr><tr><td>26</td><td><code><pre></pre></code></td></tr><tr><td>27</td><td><code><pre>        // Iterate over all possible Listeners (generated from the K8s Ingress configurations)</pre></code></td></tr><tr><td>28</td><td><code><pre>        httpListenersMap := c.groupListenersByListenerIdentifier(cbCtx)</pre></code></td></tr><tr><td>29</td><td><code><pre>        for listenerID, listenerConfig := range c.getListenerConfigs(cbCtx) {</pre></code></td></tr><tr><td>30</td><td><code><pre>                httpListener, exists := httpListenersMap[listenerID]</pre></code></td></tr><tr><td>31</td><td><code><pre>                if !exists {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                        klog.Errorf(&#34;Redirect will not be created for target listener %+v as listener does not exist in listenerMap&#34;, listenerID)</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>34</td><td><code><pre>                }</pre></code></td></tr><tr><td>35</td><td><code><pre></pre></code></td></tr><tr><td>36</td><td><code><pre>                isHTTPS := listenerConfig.Protocol == n.ApplicationGatewayProtocolHTTPS</pre></code></td></tr><tr><td>37</td><td><code><pre>                // What if multiple namespaces have a redirect configured?</pre></code></td></tr><tr><td>38</td><td><code><pre>                hasSslRedirect := listenerConfig.SslRedirectConfigurationName != &#34;&#34;</pre></code></td></tr><tr><td>39</td><td><code><pre></pre></code></td></tr><tr><td>40</td><td><code><pre>                // We will configure a Redirect only if the listener has TLS enabled (has a Certificate)</pre></code></td></tr><tr><td>41</td><td><code><pre>                if isHTTPS &amp;&amp; hasSslRedirect {</pre></code></td></tr><tr><td>42</td><td><code><pre>                        targetListener := resourceRef(*httpListener.ID)</pre></code></td></tr><tr><td>43</td><td><code><pre>                        redirectConfigs = append(redirectConfigs, c.newSSLRedirectConfig(listenerConfig, targetListener))</pre></code></td></tr><tr><td>44</td><td><code><pre>                        klog.Infof(&#34;Created redirection configuration %s for (%s,%d); not yet linked to a routing rule&#34;, listenerConfig.SslRedirectConfigurationName, listenerID.HostNames, listenerID.FrontendPort)</pre></code></td></tr><tr><td>45</td><td><code><pre>                }</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                er := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, nil)</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>                // Listeners we obtained from App Gateway - we segment them into ones AGIC is and is not allowed to change.</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                existingBlacklisted, existingNonBlacklisted := er.GetBlacklistedRedirects()</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>                brownfield.LogRedirects(existingBlacklisted, existingNonBlacklisted, redirectConfigs)</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>                // MergeRedirects would produce unique list of redirects based on Name. Blacklisted redirects,</pre></code></td></tr><tr><td>57</td><td><code><pre>                // which have the same name as a managed redirects would be overwritten.</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                redirectConfigs = brownfield.MergeRedirects(existingBlacklisted, redirectConfigs)</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>        sort.Sort(sorter.ByRedirectName(redirectConfigs))</pre></code></td></tr><tr><td>62</td><td><code><pre>        c.mem.redirectConfigs = &amp;redirectConfigs</pre></code></td></tr><tr><td>63</td><td><code><pre>        return &amp;redirectConfigs</pre></code></td></tr><tr><td>64</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getPathMaps">func appGwConfigBuilder.getPathMaps</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getPathMaps">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>162</td><td><code><pre>func (c *appGwConfigBuilder) getPathMaps(cbCtx *ConfigBuilderContext) map[listenerIdentifier]*n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>163</td><td><code><pre>        urlPathMaps := make(map[listenerIdentifier]*n.ApplicationGatewayURLPathMap)</pre></code></td></tr><tr><td>164</td><td><code><pre>        for ingressIdx := range cbCtx.IngressList {</pre></code></td></tr><tr><td>165</td><td><code><pre>                ingress := cbCtx.IngressList[ingressIdx]</pre></code></td></tr><tr><td>166</td><td><code><pre></pre></code></td></tr><tr><td>167</td><td><code><pre>                if len(ingress.Spec.Rules) == 0 {</pre></code></td></tr><tr><td>168</td><td><code><pre>                        c.noRulesIngress(cbCtx, ingress, &amp;urlPathMaps)</pre></code></td></tr><tr><td>169</td><td><code><pre>                }</pre></code></td></tr><tr><td>170</td><td><code><pre></pre></code></td></tr><tr><td>171</td><td><code><pre>                for ruleIdx := range ingress.Spec.Rules {</pre></code></td></tr><tr><td>172</td><td><code><pre>                        rule := &amp;ingress.Spec.Rules[ruleIdx]</pre></code></td></tr><tr><td>173</td><td><code><pre>                        // skip no http rule</pre></code></td></tr><tr><td>174</td><td><code><pre>                        if rule.HTTP == nil {</pre></code></td></tr><tr class="miss"><td>175</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>176</td><td><code><pre>                        }</pre></code></td></tr><tr><td>177</td><td><code><pre></pre></code></td></tr><tr><td>178</td><td><code><pre>                        _, azListenerConfig := c.processIngressRuleWithTLS(rule, ingress, cbCtx.EnvVariables)</pre></code></td></tr><tr><td>179</td><td><code><pre></pre></code></td></tr><tr><td>180</td><td><code><pre>                        for listenerID, listenerAzConfig := range azListenerConfig {</pre></code></td></tr><tr><td>181</td><td><code><pre>                                if _, exists := urlPathMaps[listenerID]; !exists {</pre></code></td></tr><tr><td>182</td><td><code><pre>                                        pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr><td>183</td><td><code><pre>                                        urlPathMaps[listenerID] = &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>184</td><td><code><pre>                                                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>185</td><td><code><pre>                                                Name: to.StringPtr(pathMapName),</pre></code></td></tr><tr><td>186</td><td><code><pre>                                                ID:   to.StringPtr(c.appGwIdentifier.urlPathMapID(pathMapName)),</pre></code></td></tr><tr><td>187</td><td><code><pre>                                                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>188</td><td><code><pre>                                                        DefaultBackendAddressPool:  &amp;n.SubResource{ID: cbCtx.DefaultAddressPoolID},</pre></code></td></tr><tr><td>189</td><td><code><pre>                                                        DefaultBackendHTTPSettings: &amp;n.SubResource{ID: cbCtx.DefaultHTTPSettingsID},</pre></code></td></tr><tr><td>190</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>191</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>192</td><td><code><pre>                                }</pre></code></td></tr><tr><td>193</td><td><code><pre></pre></code></td></tr><tr><td>194</td><td><code><pre>                                pathMap := c.getPathMap(cbCtx, listenerID, listenerAzConfig, ingress, rule, ruleIdx)</pre></code></td></tr><tr><td>195</td><td><code><pre>                                urlPathMaps[listenerID] = c.mergePathMap(urlPathMaps[listenerID], pathMap, cbCtx)</pre></code></td></tr><tr><td>196</td><td><code><pre>                        }</pre></code></td></tr><tr><td>197</td><td><code><pre>                }</pre></code></td></tr><tr><td>198</td><td><code><pre>        }</pre></code></td></tr><tr><td>199</td><td><code><pre></pre></code></td></tr><tr><td>200</td><td><code><pre>        // if no url pathmaps were created, then add a default path map since this will be translated to</pre></code></td></tr><tr><td>201</td><td><code><pre>        // a basic request routing rule which is needed on Application Gateway to avoid validation error.</pre></code></td></tr><tr><td>202</td><td><code><pre>        if len(urlPathMaps) == 0 {</pre></code></td></tr><tr class="miss"><td>203</td><td><code><pre>                defaultAddressPoolID := c.appGwIdentifier.AddressPoolID(DefaultBackendAddressPoolName)</pre></code></td></tr><tr class="miss"><td>204</td><td><code><pre>                defaultHTTPSettingsID := c.appGwIdentifier.HTTPSettingsID(DefaultBackendHTTPSettingsName)</pre></code></td></tr><tr class="miss"><td>205</td><td><code><pre>                listenerID := defaultFrontendListenerIdentifier(cbCtx.EnvVariables.UsePrivateIP)</pre></code></td></tr><tr class="miss"><td>206</td><td><code><pre>                pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr class="miss"><td>207</td><td><code><pre>                urlPathMaps[listenerID] = &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>208</td><td><code><pre>                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>209</td><td><code><pre>                        Name: to.StringPtr(pathMapName),</pre></code></td></tr><tr><td>210</td><td><code><pre>                        ID:   to.StringPtr(c.appGwIdentifier.urlPathMapID(pathMapName)),</pre></code></td></tr><tr><td>211</td><td><code><pre>                        ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>212</td><td><code><pre>                                DefaultBackendAddressPool:  &amp;n.SubResource{ID: &amp;defaultAddressPoolID},</pre></code></td></tr><tr><td>213</td><td><code><pre>                                DefaultBackendHTTPSettings: &amp;n.SubResource{ID: &amp;defaultHTTPSettingsID},</pre></code></td></tr><tr><td>214</td><td><code><pre>                                PathRules:                  &amp;[]n.ApplicationGatewayPathRule{},</pre></code></td></tr><tr><td>215</td><td><code><pre>                        },</pre></code></td></tr><tr><td>216</td><td><code><pre>                }</pre></code></td></tr><tr><td>217</td><td><code><pre>        }</pre></code></td></tr><tr><td>218</td><td><code><pre></pre></code></td></tr><tr><td>219</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>220</td><td><code><pre>                for listenerID, pathMap := range c.getIstioPathMaps(cbCtx) {</pre></code></td></tr><tr class="miss"><td>221</td><td><code><pre>                        if _, exists := urlPathMaps[listenerID]; !exists {</pre></code></td></tr><tr class="miss"><td>222</td><td><code><pre>                                urlPathMaps[listenerID] = pathMap</pre></code></td></tr><tr><td>223</td><td><code><pre>                        }</pre></code></td></tr><tr><td>224</td><td><code><pre>                }</pre></code></td></tr><tr><td>225</td><td><code><pre>        }</pre></code></td></tr><tr><td>226</td><td><code><pre></pre></code></td></tr><tr><td>227</td><td><code><pre>        return urlPathMaps</pre></code></td></tr><tr><td>228</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.HealthProbesCollection">func appGwConfigBuilder.HealthProbesCollection</div><div class="info"><a href="#s_fn_appGwConfigBuilder.HealthProbesCollection">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/health_probes.go</code>:</p></div><table class="listing">
<tr><td>24</td><td><code><pre>func (c *appGwConfigBuilder) HealthProbesCollection(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>25</td><td><code><pre>        healthProbeCollection, _ := c.newProbesMap(cbCtx)</pre></code></td></tr><tr><td>26</td><td><code><pre>        agicCreatedProbes := make([]n.ApplicationGatewayProbe, 0, len(healthProbeCollection))</pre></code></td></tr><tr><td>27</td><td><code><pre>        for _, probe := range healthProbeCollection {</pre></code></td></tr><tr><td>28</td><td><code><pre>                agicCreatedProbes = append(agicCreatedProbes, probe)</pre></code></td></tr><tr><td>29</td><td><code><pre>        }</pre></code></td></tr><tr><td>30</td><td><code><pre></pre></code></td></tr><tr><td>31</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                er := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, nil)</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                existingBlacklisted, existingNonBlacklisted := er.GetBlacklistedProbes()</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                brownfield.LogProbes(klog.V(3), existingBlacklisted, existingNonBlacklisted, agicCreatedProbes)</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                agicCreatedProbes = brownfield.MergeProbes(existingBlacklisted, agicCreatedProbes)</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr><tr><td>37</td><td><code><pre></pre></code></td></tr><tr><td>38</td><td><code><pre>        sort.Sort(sorter.ByHealthProbeName(agicCreatedProbes))</pre></code></td></tr><tr><td>39</td><td><code><pre>        c.appGw.Probes = &amp;agicCreatedProbes</pre></code></td></tr><tr><td>40</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>41</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.newIstioBackendPoolMap">func appGwConfigBuilder.newIstioBackendPoolMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.newIstioBackendPoolMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_pools.go</code>:</p></div><table class="listing">
<tr><td>48</td><td><code><pre>func (c *appGwConfigBuilder) newIstioBackendPoolMap(cbCtx *ConfigBuilderContext) map[istioDestinationIdentifier]*n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>49</td><td><code><pre>        defaultPool := defaultBackendAddressPool(c.appGwIdentifier)</pre></code></td></tr><tr><td>50</td><td><code><pre>        addressPools := map[string]*n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>51</td><td><code><pre>                *defaultPool.Name: &amp;defaultPool,</pre></code></td></tr><tr><td>52</td><td><code><pre>        }</pre></code></td></tr><tr><td>53</td><td><code><pre>        backendPoolMap := make(map[istioDestinationIdentifier]*n.ApplicationGatewayBackendAddressPool)</pre></code></td></tr><tr><td>54</td><td><code><pre>        _, _, istioServiceBackendPairMap, _ := c.getIstioDestinationsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>55</td><td><code><pre>        for destinationID, serviceBackendPair := range istioServiceBackendPairMap {</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                backendPoolMap[destinationID] = &amp;defaultPool</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>                if pool := c.getIstioBackendAddressPool(destinationID, serviceBackendPair, addressPools); pool != nil {</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                        backendPoolMap[destinationID] = pool</pre></code></td></tr><tr><td>59</td><td><code><pre>                }</pre></code></td></tr><tr><td>60</td><td><code><pre>        }</pre></code></td></tr><tr><td>61</td><td><code><pre>        return backendPoolMap</pre></code></td></tr><tr><td>62</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getPools">func appGwConfigBuilder.getPools</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getPools">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendaddresspools.go</code>:</p></div><table class="listing">
<tr><td>30</td><td><code><pre>func (c appGwConfigBuilder) getPools(cbCtx *ConfigBuilderContext) []n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>31</td><td><code><pre>        if c.mem.pools != nil {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                return *c.mem.pools</pre></code></td></tr><tr><td>33</td><td><code><pre>        }</pre></code></td></tr><tr><td>34</td><td><code><pre></pre></code></td></tr><tr><td>35</td><td><code><pre>        defaultPool := defaultBackendAddressPool(c.appGwIdentifier)</pre></code></td></tr><tr><td>36</td><td><code><pre>        klog.V(5).Infof(&#34;Created default backend pool %s&#34;, *defaultPool.Name)</pre></code></td></tr><tr><td>37</td><td><code><pre>        managedPoolsByName := map[string]*n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>38</td><td><code><pre>                *defaultPool.Name: &amp;defaultPool,</pre></code></td></tr><tr><td>39</td><td><code><pre>        }</pre></code></td></tr><tr><td>40</td><td><code><pre>        _, _, serviceBackendPairMap, err := c.getBackendsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>41</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                klog.Error(&#34;Error fetching Backends and Settings: &#34;, err)</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr><tr><td>44</td><td><code><pre>        for backendID, serviceBackendPair := range serviceBackendPairMap {</pre></code></td></tr><tr><td>45</td><td><code><pre>                if pool := c.getBackendAddressPool(backendID, serviceBackendPair, managedPoolsByName); pool != nil {</pre></code></td></tr><tr><td>46</td><td><code><pre>                        managedPoolsByName[*pool.Name] = pool</pre></code></td></tr><tr><td>47</td><td><code><pre>                        klog.V(5).Infof(&#34;Created backend pool %s for service %s&#34;, *pool.Name, backendID.serviceKey())</pre></code></td></tr><tr><td>48</td><td><code><pre>                }</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                _, _, istioServiceBackendPairMap, _ := c.getIstioDestinationsAndSettingsMap(cbCtx)</pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>                for destinationID, serviceBackendPair := range istioServiceBackendPairMap {</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>                        if pool := c.getIstioBackendAddressPool(destinationID, serviceBackendPair, managedPoolsByName); pool != nil {</pre></code></td></tr><tr class="miss"><td>55</td><td><code><pre>                                managedPoolsByName[*pool.Name] = pool</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                                klog.V(5).Infof(&#34;Created backend pool %s for service %s&#34;, *pool.Name, destinationID.serviceKey())</pre></code></td></tr><tr><td>57</td><td><code><pre>                        }</pre></code></td></tr><tr><td>58</td><td><code><pre>                }</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>        var agicCreatedPools []n.ApplicationGatewayBackendAddressPool</pre></code></td></tr><tr><td>62</td><td><code><pre>        for _, managedPool := range managedPoolsByName {</pre></code></td></tr><tr><td>63</td><td><code><pre>                agicCreatedPools = append(agicCreatedPools, *managedPool)</pre></code></td></tr><tr><td>64</td><td><code><pre>        }</pre></code></td></tr><tr><td>65</td><td><code><pre></pre></code></td></tr><tr><td>66</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                er := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, &amp;defaultPool)</pre></code></td></tr><tr><td>68</td><td><code><pre></pre></code></td></tr><tr><td>69</td><td><code><pre>                // Split the existing pools we obtained from App Gateway into ones AGIC is and is not allowed to change.</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>                existingBlacklisted, existingNonBlacklisted := er.GetBlacklistedPools()</pre></code></td></tr><tr><td>71</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>72</td><td><code><pre>                brownfield.LogPools(existingBlacklisted, existingNonBlacklisted, agicCreatedPools)</pre></code></td></tr><tr><td>73</td><td><code><pre></pre></code></td></tr><tr><td>74</td><td><code><pre>                // MergePools would produce unique list of pools based on Name. Blacklisted pools, which have the same name</pre></code></td></tr><tr><td>75</td><td><code><pre>                // as a managed pool would be overwritten.</pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>                return brownfield.MergePools(existingBlacklisted, agicCreatedPools)</pre></code></td></tr><tr><td>77</td><td><code><pre>        }</pre></code></td></tr><tr><td>78</td><td><code><pre></pre></code></td></tr><tr><td>79</td><td><code><pre>        c.mem.pools = &amp;agicCreatedPools</pre></code></td></tr><tr><td>80</td><td><code><pre>        return agicCreatedPools</pre></code></td></tr><tr><td>81</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_validateURLPathMaps">func validateURLPathMaps</div><div class="info"><a href="#s_fn_validateURLPathMaps">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code>:</p></div><table class="listing">
<tr><td>57</td><td><code><pre>func validateURLPathMaps(eventRecorder record.EventRecorder, config *n.ApplicationGatewayPropertiesFormat, envVariables environment.EnvVariables, ingressList []*networking.Ingress, serviceList []*v1.Service) error {</pre></code></td></tr><tr><td>58</td><td><code><pre>        if config.URLPathMaps == nil {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>60</td><td><code><pre>        }</pre></code></td></tr><tr><td>61</td><td><code><pre></pre></code></td></tr><tr><td>62</td><td><code><pre>        for _, pathMap := range *config.URLPathMaps {</pre></code></td></tr><tr><td>63</td><td><code><pre>                if len(*pathMap.PathRules) == 0 {</pre></code></td></tr><tr><td>64</td><td><code><pre>                        // There are no paths. This is a rule of type &#34;Basic&#34;</pre></code></td></tr><tr><td>65</td><td><code><pre>                        validRedirect := pathMap.DefaultRedirectConfiguration != nil</pre></code></td></tr><tr><td>66</td><td><code><pre>                        validBackend := pathMap.DefaultBackendAddressPool != nil &amp;&amp; pathMap.DefaultBackendHTTPSettings != nil</pre></code></td></tr><tr><td>67</td><td><code><pre></pre></code></td></tr><tr><td>68</td><td><code><pre>                        if !validRedirect &amp;&amp; !validBackend {</pre></code></td></tr><tr><td>69</td><td><code><pre>                                // TODO(draychev): Emit an event for the appropriate object</pre></code></td></tr><tr><td>70</td><td><code><pre>                                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>71</td><td><code><pre>                                        controllererrors.ErrorNoDefaults,</pre></code></td></tr><tr><td>72</td><td><code><pre>                                        &#34;URL path map &#39;%s&#39; needs either a default backend pool or default redirect&#34;, *pathMap.Name,</pre></code></td></tr><tr><td>73</td><td><code><pre>                                )</pre></code></td></tr><tr><td>74</td><td><code><pre>                                return e</pre></code></td></tr><tr><td>75</td><td><code><pre>                        }</pre></code></td></tr><tr><td>76</td><td><code><pre></pre></code></td></tr><tr><td>77</td><td><code><pre>                        if validRedirect &amp;&amp; validBackend || !validRedirect &amp;&amp; !validBackend {</pre></code></td></tr><tr><td>78</td><td><code><pre>                                // TODO(draychev): Emit an event for the appropriate object</pre></code></td></tr><tr><td>79</td><td><code><pre>                                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>80</td><td><code><pre>                                        controllererrors.ErrorEitherDefaults,</pre></code></td></tr><tr><td>81</td><td><code><pre>                                        &#34;URL path map &#39;%s&#39; needs only one of default backend pool or default redirect&#34;, *pathMap.Name,</pre></code></td></tr><tr><td>82</td><td><code><pre>                                )</pre></code></td></tr><tr><td>83</td><td><code><pre>                                return e</pre></code></td></tr><tr><td>84</td><td><code><pre>                        }</pre></code></td></tr><tr><td>85</td><td><code><pre></pre></code></td></tr><tr><td>86</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>87</td><td><code><pre>                        // There are paths defined. This is a rule of type &#34;Path-based&#34;</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>                        for _, rule := range *pathMap.PathRules {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                                validRedirect := rule.RedirectConfiguration != nil</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>                                validBackend := rule.BackendAddressPool != nil &amp;&amp; rule.BackendHTTPSettings != nil</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>                                if !validRedirect &amp;&amp; !validBackend {</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>                                        e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>94</td><td><code><pre>                                                controllererrors.ErrorNoBackendorRedirect,</pre></code></td></tr><tr><td>95</td><td><code><pre>                                                &#34;Path Rule &#39;%s&#39; needs either a default backend pool or default redirect&#34;, *rule.Name,</pre></code></td></tr><tr><td>96</td><td><code><pre>                                        )</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>                                        return e</pre></code></td></tr><tr><td>98</td><td><code><pre>                                }</pre></code></td></tr><tr><td>99</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>100</td><td><code><pre>                                if validRedirect &amp;&amp; validBackend || !validRedirect &amp;&amp; !validBackend {</pre></code></td></tr><tr class="miss"><td>101</td><td><code><pre>                                        e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>102</td><td><code><pre>                                                controllererrors.ErrorEitherBackendorRedirect,</pre></code></td></tr><tr><td>103</td><td><code><pre>                                                &#34;Path Rule &#39;%s&#39; needs either a default backend pool or default redirect&#34;, *rule.Name,</pre></code></td></tr><tr><td>104</td><td><code><pre>                                        )</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                                        return e</pre></code></td></tr><tr><td>106</td><td><code><pre>                                }</pre></code></td></tr><tr><td>107</td><td><code><pre>                        }</pre></code></td></tr><tr><td>108</td><td><code><pre></pre></code></td></tr><tr><td>109</td><td><code><pre>                }</pre></code></td></tr><tr><td>110</td><td><code><pre>        }</pre></code></td></tr><tr><td>111</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>112</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.RequestRoutingRules">func appGwConfigBuilder.RequestRoutingRules</div><div class="info"><a href="#s_fn_appGwConfigBuilder.RequestRoutingRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/requestroutingrules.go</code>:</p></div><table class="listing">
<tr><td>28</td><td><code><pre>func (c *appGwConfigBuilder) RequestRoutingRules(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>29</td><td><code><pre>        requestRoutingRules, pathMaps := c.getRules(cbCtx)</pre></code></td></tr><tr><td>30</td><td><code><pre></pre></code></td></tr><tr><td>31</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                rCtx := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, nil)</pre></code></td></tr><tr><td>33</td><td><code><pre>                {</pre></code></td></tr><tr><td>34</td><td><code><pre>                        // PathMaps we obtained from App Gateway - we segment them into ones AGIC is and is not allowed to change.</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                        existingBlacklisted, existingNonBlacklisted := rCtx.GetBlacklistedPathMaps()</pre></code></td></tr><tr><td>36</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                        brownfield.LogPathMaps(existingBlacklisted, existingNonBlacklisted, pathMaps)</pre></code></td></tr><tr><td>38</td><td><code><pre></pre></code></td></tr><tr><td>39</td><td><code><pre>                        // MergePathMaps would produce unique list of routing rules based on Name. Routing rules, which have the same name</pre></code></td></tr><tr><td>40</td><td><code><pre>                        // as a managed rule would be overwritten.</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                        pathMaps = brownfield.MergePathMaps(existingBlacklisted, pathMaps)</pre></code></td></tr><tr><td>42</td><td><code><pre>                }</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr><td>45</td><td><code><pre>        sort.Sort(sorter.ByPathMap(pathMaps))</pre></code></td></tr><tr><td>46</td><td><code><pre>        c.appGw.URLPathMaps = &amp;pathMaps</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                rCtx := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, nil)</pre></code></td></tr><tr><td>50</td><td><code><pre>                {</pre></code></td></tr><tr><td>51</td><td><code><pre>                        // RoutingRules we obtained from App Gateway - we segment them into ones AGIC is and is not allowed to change.</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                        existingBlacklisted, existingNonBlacklisted := rCtx.GetBlacklistedRoutingRules()</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>                        brownfield.LogRules(existingBlacklisted, existingNonBlacklisted, requestRoutingRules)</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>                        // MergeRules would produce unique list of routing rules based on Name. Routing rules, which have the same name</pre></code></td></tr><tr><td>57</td><td><code><pre>                        // as a managed rule would be overwritten.</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                        requestRoutingRules = brownfield.MergeRules(&amp;c.appGw, existingBlacklisted, requestRoutingRules)</pre></code></td></tr><tr><td>59</td><td><code><pre>                }</pre></code></td></tr><tr><td>60</td><td><code><pre>        }</pre></code></td></tr><tr><td>61</td><td><code><pre></pre></code></td></tr><tr><td>62</td><td><code><pre>        sort.Sort(sorter.ByRequestRoutingRuleName(requestRoutingRules))</pre></code></td></tr><tr><td>63</td><td><code><pre></pre></code></td></tr><tr><td>64</td><td><code><pre>        // Apply rule priority after sorting to come up with stable priority.</pre></code></td></tr><tr><td>65</td><td><code><pre>        requestRoutingRules = c.assignPriorityWhereMissing(requestRoutingRules)</pre></code></td></tr><tr><td>66</td><td><code><pre></pre></code></td></tr><tr><td>67</td><td><code><pre>        c.appGw.RequestRoutingRules = &amp;requestRoutingRules</pre></code></td></tr><tr><td>68</td><td><code><pre></pre></code></td></tr><tr><td>69</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>70</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.BackendHTTPSettingsCollection">func appGwConfigBuilder.BackendHTTPSettingsCollection</div><div class="info"><a href="#s_fn_appGwConfigBuilder.BackendHTTPSettingsCollection">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/backendhttpsettings.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func (c *appGwConfigBuilder) BackendHTTPSettingsCollection(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>32</td><td><code><pre>        agicHTTPSettings, _, _, err := c.getBackendsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>33</td><td><code><pre></pre></code></td></tr><tr><td>34</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                rCtx := brownfield.NewExistingResources(c.appGw, cbCtx.ProhibitedTargets, nil)</pre></code></td></tr><tr><td>36</td><td><code><pre></pre></code></td></tr><tr><td>37</td><td><code><pre>                // PathMaps we obtained from App Gateway - we segment them into ones AGIC is and is not allowed to change.</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                existingBlacklisted, existingNonBlacklisted := rCtx.GetBlacklistedHTTPSettings()</pre></code></td></tr><tr><td>39</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>                brownfield.LogHTTPSettings(klog.V(3), existingBlacklisted, existingNonBlacklisted, agicHTTPSettings)</pre></code></td></tr><tr><td>41</td><td><code><pre></pre></code></td></tr><tr><td>42</td><td><code><pre>                // MergePathMaps would produce unique list of routing rules based on Name. Routing rules, which have the same name</pre></code></td></tr><tr><td>43</td><td><code><pre>                // as a managed rule would be overwritten.</pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>                agicHTTPSettings = brownfield.MergeHTTPSettings(existingBlacklisted, agicHTTPSettings)</pre></code></td></tr><tr><td>45</td><td><code><pre>        }</pre></code></td></tr><tr><td>46</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                istioHTTPSettings, _, _, _ := c.getIstioDestinationsAndSettingsMap(cbCtx)</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>                if istioHTTPSettings != nil {</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                        sort.Sort(sorter.BySettingsName(istioHTTPSettings))</pre></code></td></tr><tr><td>50</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>                agicHTTPSettings = append(agicHTTPSettings, istioHTTPSettings...)</pre></code></td></tr><tr><td>52</td><td><code><pre>        }</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr><td>54</td><td><code><pre>        if agicHTTPSettings != nil {</pre></code></td></tr><tr><td>55</td><td><code><pre>                sort.Sort(sorter.BySettingsName(agicHTTPSettings))</pre></code></td></tr><tr><td>56</td><td><code><pre>        }</pre></code></td></tr><tr><td>57</td><td><code><pre></pre></code></td></tr><tr><td>58</td><td><code><pre>        c.appGw.BackendHTTPSettingsCollection = &amp;agicHTTPSettings</pre></code></td></tr><tr><td>59</td><td><code><pre>        return err</pre></code></td></tr><tr><td>60</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.Build">func appGwConfigBuilder.Build</div><div class="info"><a href="#s_fn_appGwConfigBuilder.Build">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>80</td><td><code><pre>func (c *appGwConfigBuilder) Build(cbCtx *ConfigBuilderContext) (*n.ApplicationGateway, error) {</pre></code></td></tr><tr><td>81</td><td><code><pre>        err := c.HealthProbesCollection(cbCtx)</pre></code></td></tr><tr><td>82</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>84</td><td><code><pre>                        controllererrors.ErrorGeneratingProbes,</pre></code></td></tr><tr><td>85</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>86</td><td><code><pre>                        &#34;unable to generate Health Probes&#34;,</pre></code></td></tr><tr><td>87</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>90</td><td><code><pre>        }</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr><td>92</td><td><code><pre>        err = c.BackendHTTPSettingsCollection(cbCtx)</pre></code></td></tr><tr><td>93</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>95</td><td><code><pre>                        controllererrors.ErrorGeneratingBackendSettings,</pre></code></td></tr><tr><td>96</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>97</td><td><code><pre>                        &#34;unable to generate backend http settings&#34;,</pre></code></td></tr><tr><td>98</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>99</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>100</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr><td>103</td><td><code><pre>        // BackendAddressPools depend on BackendHTTPSettings</pre></code></td></tr><tr><td>104</td><td><code><pre>        err = c.BackendAddressPools(cbCtx)</pre></code></td></tr><tr><td>105</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>107</td><td><code><pre>                        controllererrors.ErrorCreatingBackendPools,</pre></code></td></tr><tr><td>108</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>109</td><td><code><pre>                        &#34;unable to generate backend address pools&#34;,</pre></code></td></tr><tr><td>110</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>112</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre></pre></code></td></tr><tr><td>115</td><td><code><pre>        // Listener configures the frontend listeners</pre></code></td></tr><tr><td>116</td><td><code><pre>        // This also creates redirection configuration (if TLS is configured and Ingress is annotated).</pre></code></td></tr><tr><td>117</td><td><code><pre>        // This configuration must be attached to request routing rules, which are created in the steps below.</pre></code></td></tr><tr><td>118</td><td><code><pre>        // The order of operations matters.</pre></code></td></tr><tr><td>119</td><td><code><pre>        err = c.Listeners(cbCtx)</pre></code></td></tr><tr><td>120</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>121</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>122</td><td><code><pre>                        controllererrors.ErrorGeneratingListeners,</pre></code></td></tr><tr><td>123</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>124</td><td><code><pre>                        &#34;unable to generate frontend listeners&#34;,</pre></code></td></tr><tr><td>125</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>126</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>127</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>128</td><td><code><pre>        }</pre></code></td></tr><tr><td>129</td><td><code><pre></pre></code></td></tr><tr><td>130</td><td><code><pre>        // Build RewriteRuleSets configuration</pre></code></td></tr><tr><td>131</td><td><code><pre>        err = c.RewriteRuleSets(cbCtx)</pre></code></td></tr><tr><td>132</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>133</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>134</td><td><code><pre>                        controllererrors.ErrorCreatingRewrites,</pre></code></td></tr><tr><td>135</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>136</td><td><code><pre>                        &#34;unable to generate rewrite rule sets&#34;,</pre></code></td></tr><tr><td>137</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>138</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>139</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>140</td><td><code><pre>        }</pre></code></td></tr><tr><td>141</td><td><code><pre></pre></code></td></tr><tr><td>142</td><td><code><pre>        // SSL redirection configurations created elsewhere will be attached to the appropriate rule in this step.</pre></code></td></tr><tr><td>143</td><td><code><pre>        err = c.RequestRoutingRules(cbCtx)</pre></code></td></tr><tr><td>144</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>145</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>146</td><td><code><pre>                        controllererrors.ErrorGeneratingRoutingRules,</pre></code></td></tr><tr><td>147</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>148</td><td><code><pre>                        &#34;unable to generate request routing rules&#34;,</pre></code></td></tr><tr><td>149</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>150</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>151</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>152</td><td><code><pre>        }</pre></code></td></tr><tr><td>153</td><td><code><pre></pre></code></td></tr><tr><td>154</td><td><code><pre>        c.addTags()</pre></code></td></tr><tr><td>155</td><td><code><pre></pre></code></td></tr><tr><td>156</td><td><code><pre>        return &amp;c.appGw, nil</pre></code></td></tr><tr><td>157</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.resolveIstioPortName">func appGwConfigBuilder.resolveIstioPortName</div><div class="info"><a href="#s_fn_appGwConfigBuilder.resolveIstioPortName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_config.go</code>:</p></div><table class="listing">
<tr><td>13</td><td><code><pre>func (c *appGwConfigBuilder) resolveIstioPortName(portName string, destinationID *istioDestinationIdentifier) map[Port]interface{} {</pre></code></td></tr><tr><td>14</td><td><code><pre>        resolvedPorts := make(map[Port]interface{})</pre></code></td></tr><tr><td>15</td><td><code><pre>        endpoints, err := c.k8sContext.GetEndpointsByService(destinationID.serviceKey())</pre></code></td></tr><tr><td>16</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>17</td><td><code><pre>                klog.Error(&#34;Could not fetch endpoint by service key from cache&#34;, err)</pre></code></td></tr><tr><td>18</td><td><code><pre>                return resolvedPorts</pre></code></td></tr><tr><td>19</td><td><code><pre>        }</pre></code></td></tr><tr><td>20</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>21</td><td><code><pre>        if endpoints == nil {</pre></code></td></tr><tr class="miss"><td>22</td><td><code><pre>                return resolvedPorts</pre></code></td></tr><tr><td>23</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>        for _, subset := range endpoints.Subsets {</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                for _, epPort := range subset.Ports {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                        if epPort.Name == portName {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                                resolvedPorts[Port(epPort.Port)] = nil</pre></code></td></tr><tr><td>28</td><td><code><pre>                        }</pre></code></td></tr><tr><td>29</td><td><code><pre>                }</pre></code></td></tr><tr><td>30</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>        return resolvedPorts</pre></code></td></tr><tr><td>32</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getIstioPathMaps">func appGwConfigBuilder.getIstioPathMaps</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getIstioPathMaps">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_routing_rules.go</code>:</p></div><table class="listing">
<tr><td>15</td><td><code><pre>func (c *appGwConfigBuilder) getIstioPathMaps(cbCtx *ConfigBuilderContext) map[listenerIdentifier]*n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>16</td><td><code><pre>        defaultAddressPoolID := to.StringPtr(c.appGwIdentifier.AddressPoolID(DefaultBackendAddressPoolName))</pre></code></td></tr><tr><td>17</td><td><code><pre>        defaultHTTPSettingsID := to.StringPtr(c.appGwIdentifier.HTTPSettingsID(DefaultBackendHTTPSettingsName))</pre></code></td></tr><tr><td>18</td><td><code><pre></pre></code></td></tr><tr><td>19</td><td><code><pre>        // TODO(delqn)</pre></code></td></tr><tr><td>20</td><td><code><pre>        istioHTTPSettings, _, _, _ := c.getIstioDestinationsAndSettingsMap(cbCtx)</pre></code></td></tr><tr><td>21</td><td><code><pre></pre></code></td></tr><tr><td>22</td><td><code><pre>        backendByDestination := c.newIstioBackendPoolMap(cbCtx)</pre></code></td></tr><tr><td>23</td><td><code><pre></pre></code></td></tr><tr><td>24</td><td><code><pre>        urlPathMaps := make(map[listenerIdentifier]*n.ApplicationGatewayURLPathMap)</pre></code></td></tr><tr><td>25</td><td><code><pre>        for virtSvcIdx, virtSvc := range cbCtx.IstioVirtualServices {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                for _, http := range virtSvc.Spec.HTTP {</pre></code></td></tr><tr><td>27</td><td><code><pre>                        // TODO(delqn): consider weights</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                        host := http.Route[0].Destination.Host</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                        var port uint32</pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>                        if http.Route[0].Destination.Port.Number != 0 {</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                                port = http.Route[0].Destination.Port.Number</pre></code></td></tr><tr><td>32</td><td><code><pre>                        } else {</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                                port64, _ := strconv.ParseUint(http.Route[0].Destination.Port.Name, 10, 32)</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                                port = uint32(port64)</pre></code></td></tr><tr><td>35</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>                        for matchIdx, match := range http.Match {</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                                dst := istioDestinationIdentifier{</pre></code></td></tr><tr><td>38</td><td><code><pre>                                        serviceIdentifier: serviceIdentifier{</pre></code></td></tr><tr><td>39</td><td><code><pre>                                                Namespace: virtSvc.Namespace,</pre></code></td></tr><tr><td>40</td><td><code><pre>                                                Name:      virtSvc.Name,</pre></code></td></tr><tr><td>41</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>42</td><td><code><pre>                                        istioVirtualServiceIdentifier: istioVirtualServiceIdentifier{</pre></code></td></tr><tr><td>43</td><td><code><pre>                                                Namespace: virtSvc.Namespace,</pre></code></td></tr><tr><td>44</td><td><code><pre>                                                Name:      virtSvc.Name,</pre></code></td></tr><tr><td>45</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>46</td><td><code><pre>                                        // TODO(delqn)</pre></code></td></tr><tr><td>47</td><td><code><pre>                                        DestinationHost: host,</pre></code></td></tr><tr><td>48</td><td><code><pre>                                        DestinationPort: port,</pre></code></td></tr><tr><td>49</td><td><code><pre>                                }</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>                                // TODO(delqn)</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                                listenerID := listenerIdentifier{</pre></code></td></tr><tr><td>53</td><td><code><pre>                                        FrontendPort: 80,</pre></code></td></tr><tr><td>54</td><td><code><pre>                                        HostNames:    [5]string{virtSvc.Spec.Hosts[0]}, // TODO(delqn),</pre></code></td></tr><tr><td>55</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                                pool, found := backendByDestination[dst]</pre></code></td></tr><tr><td>57</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                                if !found {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>60</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                                pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                                pathMap := n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>63</td><td><code><pre>                                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>64</td><td><code><pre>                                        Name: to.StringPtr(pathMapName),</pre></code></td></tr><tr><td>65</td><td><code><pre>                                        ID:   to.StringPtr(c.appGwIdentifier.urlPathMapID(pathMapName)),</pre></code></td></tr><tr><td>66</td><td><code><pre>                                        ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>67</td><td><code><pre>                                                DefaultBackendAddressPool:  &amp;n.SubResource{ID: defaultAddressPoolID},</pre></code></td></tr><tr><td>68</td><td><code><pre>                                                DefaultBackendHTTPSettings: &amp;n.SubResource{ID: defaultHTTPSettingsID},</pre></code></td></tr><tr><td>69</td><td><code><pre>                                                PathRules:                  &amp;[]n.ApplicationGatewayPathRule{},</pre></code></td></tr><tr><td>70</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>71</td><td><code><pre>                                }</pre></code></td></tr><tr><td>72</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>                                pathRuleName := generatePathRuleName(virtSvc.Namespace, virtSvc.Name, virtSvcIdx, matchIdx)</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                                pathRule := n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>75</td><td><code><pre>                                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>76</td><td><code><pre>                                        Name: to.StringPtr(pathRuleName),</pre></code></td></tr><tr><td>77</td><td><code><pre>                                        ID:   to.StringPtr(c.appGwIdentifier.pathRuleID(pathMapName, pathRuleName)),</pre></code></td></tr><tr><td>78</td><td><code><pre>                                        ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>79</td><td><code><pre>                                                Paths: &amp;[]string{</pre></code></td></tr><tr><td>80</td><td><code><pre>                                                        match.URI.Prefix,</pre></code></td></tr><tr><td>81</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>82</td><td><code><pre>                                                BackendAddressPool: &amp;n.SubResource{ID: pool.ID},</pre></code></td></tr><tr><td>83</td><td><code><pre>                                                // TODO(delqn)</pre></code></td></tr><tr><td>84</td><td><code><pre>                                                BackendHTTPSettings: &amp;n.SubResource{ID: istioHTTPSettings[0].ID},</pre></code></td></tr><tr><td>85</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>86</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>                                pathMap.PathRules = &amp;[]n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>88</td><td><code><pre>                                        pathRule,</pre></code></td></tr><tr><td>89</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>                                urlPathMaps[listenerID] = &amp;pathMap</pre></code></td></tr><tr><td>91</td><td><code><pre>                        }</pre></code></td></tr><tr><td>92</td><td><code><pre>                }</pre></code></td></tr><tr><td>93</td><td><code><pre>        }</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr><td>95</td><td><code><pre>        // if no url pathmaps were created, then add a default path map since this will be translated to</pre></code></td></tr><tr><td>96</td><td><code><pre>        // a basic request routing rule which is needed on Application Gateway to avoid validation error.</pre></code></td></tr><tr><td>97</td><td><code><pre>        if len(urlPathMaps) == 0 {</pre></code></td></tr><tr><td>98</td><td><code><pre>                defaultAddressPoolID := c.appGwIdentifier.AddressPoolID(DefaultBackendAddressPoolName)</pre></code></td></tr><tr><td>99</td><td><code><pre>                defaultHTTPSettingsID := c.appGwIdentifier.HTTPSettingsID(DefaultBackendHTTPSettingsName)</pre></code></td></tr><tr><td>100</td><td><code><pre>                // TODO(aksgupta): refactor to get environment variable</pre></code></td></tr><tr><td>101</td><td><code><pre>                listenerID := defaultFrontendListenerIdentifier(false)</pre></code></td></tr><tr><td>102</td><td><code><pre>                pathMapName := generateURLPathMapName(listenerID)</pre></code></td></tr><tr><td>103</td><td><code><pre>                urlPathMaps[listenerID] = &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>104</td><td><code><pre>                        Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>105</td><td><code><pre>                        Name: to.StringPtr(pathMapName),</pre></code></td></tr><tr><td>106</td><td><code><pre>                        ID:   to.StringPtr(c.appGwIdentifier.urlPathMapID(pathMapName)),</pre></code></td></tr><tr><td>107</td><td><code><pre>                        ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>108</td><td><code><pre>                                DefaultBackendAddressPool:  &amp;n.SubResource{ID: &amp;defaultAddressPoolID},</pre></code></td></tr><tr><td>109</td><td><code><pre>                                DefaultBackendHTTPSettings: &amp;n.SubResource{ID: &amp;defaultHTTPSettingsID},</pre></code></td></tr><tr><td>110</td><td><code><pre>                                PathRules:                  &amp;[]n.ApplicationGatewayPathRule{},</pre></code></td></tr><tr><td>111</td><td><code><pre>                        },</pre></code></td></tr><tr><td>112</td><td><code><pre>                }</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre></pre></code></td></tr><tr><td>115</td><td><code><pre>        return urlPathMaps</pre></code></td></tr><tr><td>116</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getListenerConfigsFromIstio">func appGwConfigBuilder.getListenerConfigsFromIstio</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getListenerConfigsFromIstio">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_listeners.go</code>:</p></div><table class="listing">
<tr><td>14</td><td><code><pre>func (c *appGwConfigBuilder) getListenerConfigsFromIstio(istioGateways []*v1alpha3.Gateway, istioVirtualServices []*v1alpha3.VirtualService) map[listenerIdentifier]listenerAzConfig {</pre></code></td></tr><tr><td>15</td><td><code><pre>        knownHosts := make(map[string]interface{})</pre></code></td></tr><tr><td>16</td><td><code><pre>        for _, virtualService := range istioVirtualServices {</pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>                for _, host := range virtualService.Spec.Hosts {</pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>                        knownHosts[host] = nil</pre></code></td></tr><tr><td>19</td><td><code><pre>                }</pre></code></td></tr><tr><td>20</td><td><code><pre>        }</pre></code></td></tr><tr><td>21</td><td><code><pre></pre></code></td></tr><tr><td>22</td><td><code><pre>        allListeners := make(map[listenerIdentifier]listenerAzConfig)</pre></code></td></tr><tr><td>23</td><td><code><pre>        for _, igwy := range istioGateways {</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>                for _, server := range igwy.Spec.Servers {</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                        if server.Port.Protocol != v1alpha3.ProtocolHTTP {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                                klog.Infof(&#34;[istio] AGIC does not support Gateway with Server.Port.Protocol=%+v&#34;, server.Port.Protocol)</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>28</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                        for _, host := range server.Hosts {</pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>                                if _, exist := knownHosts[host]; !exist {</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>32</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                                listenerID := listenerIdentifier{</pre></code></td></tr><tr><td>34</td><td><code><pre>                                        FrontendPort: Port(server.Port.Number),</pre></code></td></tr><tr><td>35</td><td><code><pre>                                        HostNames:    [5]string{host},</pre></code></td></tr><tr><td>36</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                                allListeners[listenerID] = listenerAzConfig{Protocol: n.ApplicationGatewayProtocolHTTP}</pre></code></td></tr><tr><td>38</td><td><code><pre>                        }</pre></code></td></tr><tr><td>39</td><td><code><pre>                }</pre></code></td></tr><tr><td>40</td><td><code><pre>        }</pre></code></td></tr><tr><td>41</td><td><code><pre></pre></code></td></tr><tr><td>42</td><td><code><pre>        // App Gateway must have at least one listener - the default one!</pre></code></td></tr><tr><td>43</td><td><code><pre>        if len(allListeners) == 0 {</pre></code></td></tr><tr><td>44</td><td><code><pre>                // TODO(aksgupta): refactor to get environment variable</pre></code></td></tr><tr><td>45</td><td><code><pre>                allListeners[defaultFrontendListenerIdentifier(false)] = listenerAzConfig{</pre></code></td></tr><tr><td>46</td><td><code><pre>                        // Default protocol</pre></code></td></tr><tr><td>47</td><td><code><pre>                        Protocol: n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>48</td><td><code><pre>                }</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>        return allListeners</pre></code></td></tr><tr><td>52</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getIstioBackendAddressPool">func appGwConfigBuilder.getIstioBackendAddressPool</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getIstioBackendAddressPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_pools.go</code>:</p></div><table class="listing">
<tr><td>16</td><td><code><pre>func (c *appGwConfigBuilder) getIstioBackendAddressPool(destinationID istioDestinationIdentifier, serviceBackendPair serviceBackendPortPair, addressPools map[string]*n.ApplicationGatewayBackendAddressPool) *n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>17</td><td><code><pre>        endpoints, err := c.k8sContext.GetEndpointsByService(destinationID.serviceKey())</pre></code></td></tr><tr><td>18</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>19</td><td><code><pre>                logLine := fmt.Sprintf(&#34;Failed fetching endpoints for service: %s&#34;, destinationID.serviceKey())</pre></code></td></tr><tr><td>20</td><td><code><pre>                klog.Errorf(logLine)</pre></code></td></tr><tr><td>21</td><td><code><pre>                //TODO(rhea): add recorder event for error</pre></code></td></tr><tr><td>22</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>23</td><td><code><pre>        }</pre></code></td></tr><tr><td>24</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>        for _, subset := range endpoints.Subsets {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                if _, portExists := getUniqueTCPPorts(subset)[serviceBackendPair.BackendPort]; portExists {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                        backendServicePort := &#34;&#34;</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                        if destinationID.DestinationPort != 0 {</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                                backendServicePort = fmt.Sprint(destinationID.DestinationPort)</pre></code></td></tr><tr><td>30</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>31</td><td><code><pre>                                // TODO(delqn): lookup port by name</pre></code></td></tr><tr><td>32</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                        poolName := generateAddressPoolName(destinationID.serviceFullName(), backendServicePort, serviceBackendPair.BackendPort)</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                        if pool, ok := addressPools[poolName]; ok {</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                                return pool</pre></code></td></tr><tr><td>36</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                        pool := c.newPool(poolName, subset)</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                        pool.ID = to.StringPtr(c.appGwIdentifier.AddressPoolID(poolName))</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>                        return pool</pre></code></td></tr><tr><td>40</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                logLine := fmt.Sprintf(&#34;Backend target port %d does not have matching endpoint port&#34;, serviceBackendPair.BackendPort)</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                klog.Error(logLine)</pre></code></td></tr><tr><td>43</td><td><code><pre>                //TODO(rhea): add recorder event for error</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>46</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_istioMatchDestinationIds">func istioMatchDestinationIds</div><div class="info"><a href="#s_fn_istioMatchDestinationIds">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_settings.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func istioMatchDestinationIds(cbCtx *ConfigBuilderContext) ([]istioMatchIdentifier, map[istioDestinationIdentifier]interface{}) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        matchIDs := make([]istioMatchIdentifier, 0)</pre></code></td></tr><tr><td>23</td><td><code><pre>        destinationIDs := make(map[istioDestinationIdentifier]interface{})</pre></code></td></tr><tr><td>24</td><td><code><pre>        for _, virtualService := range cbCtx.IstioVirtualServices {</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                for _, rule := range virtualService.Spec.HTTP {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                        destinations := make([]*v1alpha3.Destination, 0)</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                        for _, routeDestination := range rule.Route {</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                                if routeDestination.Weight != 0 {</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                                        destinations = append(destinations, &amp;routeDestination.Destination)</pre></code></td></tr><tr><td>30</td><td><code><pre>                                        /* TODO(rhea): Weights are being ignored for now, since this is not</pre></code></td></tr><tr><td>31</td><td><code><pre>                                        yet supported on App Gateway. Include gates from routeDestination when</pre></code></td></tr><tr><td>32</td><td><code><pre>                                        this is supported */</pre></code></td></tr><tr><td>33</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                                destinationID := generateIstioDestinationID(virtualService, &amp;routeDestination.Destination)</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                                destinationIDs[destinationID] = nil</pre></code></td></tr><tr><td>36</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                        for _, match := range rule.Match {</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                                if match.URI == nil {</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>                                        klog.V(5).Infof(&#34;Skipped match request, no URI field. Other forms of match requests are not supported.&#34;)</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>41</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                                matchID := generateIstioMatchID(virtualService, &amp;rule, &amp;match, destinations)</pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>                                matchIDs = append(matchIDs, matchID)</pre></code></td></tr><tr><td>44</td><td><code><pre>                        }</pre></code></td></tr><tr><td>45</td><td><code><pre>                }</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre>        /* TODO(rhea): Filter out destinations for virtual services referencing non-existent Services */</pre></code></td></tr><tr><td>48</td><td><code><pre>        return matchIDs, destinationIDs</pre></code></td></tr><tr><td>49</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getIstioDestinationsAndSettingsMap">func appGwConfigBuilder.getIstioDestinationsAndSettingsMap</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getIstioDestinationsAndSettingsMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_settings.go</code>:</p></div><table class="listing">
<tr><td>51</td><td><code><pre>func (c *appGwConfigBuilder) getIstioDestinationsAndSettingsMap(cbCtx *ConfigBuilderContext) ([]n.ApplicationGatewayBackendHTTPSettings, map[istioDestinationIdentifier]*n.ApplicationGatewayBackendHTTPSettings, map[istioDestinationIdentifier]serviceBackendPortPair, error) {</pre></code></td></tr><tr><td>52</td><td><code><pre>        serviceBackendPairsMap := make(map[istioDestinationIdentifier]map[serviceBackendPortPair]interface{})</pre></code></td></tr><tr><td>53</td><td><code><pre>        backendHTTPSettingsMap := make(map[istioDestinationIdentifier]*n.ApplicationGatewayBackendHTTPSettings)</pre></code></td></tr><tr><td>54</td><td><code><pre>        finalServiceBackendPairMap := make(map[istioDestinationIdentifier]serviceBackendPortPair)</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>        var unresolvedDestinationID []istioDestinationIdentifier</pre></code></td></tr><tr><td>57</td><td><code><pre>        _, destinationIDs := istioMatchDestinationIds(cbCtx)</pre></code></td></tr><tr><td>58</td><td><code><pre>        for destinationID := range destinationIDs {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>                resolvedBackendPorts := make(map[serviceBackendPortPair]interface{})</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                service := c.k8sContext.GetService(destinationID.serviceKey())</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                destinationPortNum := Port(destinationID.DestinationPort)</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                if service == nil {</pre></code></td></tr><tr><td>64</td><td><code><pre>                        // Once services are filtered in the istioMatchDestinationIDs function, this should never happen</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>                        logLine := fmt.Sprintf(&#34;Unable to get the service [%s]&#34;, destinationID.serviceKey())</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>                        klog.Errorf(logLine)</pre></code></td></tr><tr><td>67</td><td><code><pre>                        // TODO(rhea): add error event</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                        pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>69</td><td><code><pre>                                ServicePort: Port(destinationPortNum),</pre></code></td></tr><tr><td>70</td><td><code><pre>                                BackendPort: Port(destinationPortNum),</pre></code></td></tr><tr><td>71</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>72</td><td><code><pre>                        resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr><td>73</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                        for _, sp := range service.Spec.Ports {</pre></code></td></tr><tr><td>75</td><td><code><pre>                                // find the backend port number</pre></code></td></tr><tr><td>76</td><td><code><pre>                                // check if any service ports matches the specified ports</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>                                if sp.Protocol != v1.ProtocolTCP {</pre></code></td></tr><tr><td>78</td><td><code><pre>                                        // ignore UDP ports</pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>80</td><td><code><pre>                                }</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>                                // TODO(delqn): implement correctly port lookup by name</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                                if Port(sp.Port) == destinationPortNum || sp.TargetPort.String() == fmt.Sprint(destinationPortNum) {</pre></code></td></tr><tr><td>84</td><td><code><pre>                                        // matched a service port with a port from the service</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>                                        if sp.TargetPort.String() == &#34;&#34; {</pre></code></td></tr><tr><td>86</td><td><code><pre>                                                // targetPort is not defined, by default targetPort == port</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>                                                pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>88</td><td><code><pre>                                                        ServicePort: Port(sp.Port),</pre></code></td></tr><tr><td>89</td><td><code><pre>                                                        BackendPort: Port(sp.Port),</pre></code></td></tr><tr><td>90</td><td><code><pre>                                                }</pre></code></td></tr><tr class="miss"><td>91</td><td><code><pre>                                                resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr><td>92</td><td><code><pre>                                        } else {</pre></code></td></tr><tr><td>93</td><td><code><pre>                                                // target port is defined as name or port number</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>                                                if sp.TargetPort.Type == intstr.Int {</pre></code></td></tr><tr><td>95</td><td><code><pre>                                                        // port is defined as port number</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>                                                        pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>97</td><td><code><pre>                                                                ServicePort: Port(sp.Port),</pre></code></td></tr><tr><td>98</td><td><code><pre>                                                                BackendPort: Port(sp.TargetPort.IntVal),</pre></code></td></tr><tr><td>99</td><td><code><pre>                                                        }</pre></code></td></tr><tr class="miss"><td>100</td><td><code><pre>                                                        resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr><td>101</td><td><code><pre>                                                } else {</pre></code></td></tr><tr><td>102</td><td><code><pre>                                                        // if service port is defined by name, need to resolve</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>                                                        targetPortName := sp.TargetPort.StrVal</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                                                        klog.V(1).Infof(&#34;resolving port name %s&#34;, targetPortName)</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                                                        targetPortsResolved := c.resolveIstioPortName(targetPortName, &amp;destinationID)</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>                                                        for targetPort := range targetPortsResolved {</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>                                                                pair := serviceBackendPortPair{</pre></code></td></tr><tr><td>108</td><td><code><pre>                                                                        ServicePort: Port(sp.Port),</pre></code></td></tr><tr><td>109</td><td><code><pre>                                                                        BackendPort: Port(targetPort),</pre></code></td></tr><tr><td>110</td><td><code><pre>                                                                }</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                                                                resolvedBackendPorts[pair] = nil</pre></code></td></tr><tr><td>112</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>113</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>114</td><td><code><pre>                                        }</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>                                        break</pre></code></td></tr><tr><td>116</td><td><code><pre>                                }</pre></code></td></tr><tr><td>117</td><td><code><pre>                        }</pre></code></td></tr><tr><td>118</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>119</td><td><code><pre>                if len(resolvedBackendPorts) == 0 {</pre></code></td></tr><tr class="miss"><td>120</td><td><code><pre>                        logLine := fmt.Sprintf(&#34;Unable to resolve any backend port for service [%s]&#34;, destinationID.serviceKey())</pre></code></td></tr><tr class="miss"><td>121</td><td><code><pre>                        klog.Error(logLine)</pre></code></td></tr><tr><td>122</td><td><code><pre>                        //TODO(rhea): Add error event</pre></code></td></tr><tr><td>123</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>124</td><td><code><pre>                        unresolvedDestinationID = append(unresolvedDestinationID, destinationID)</pre></code></td></tr><tr class="miss"><td>125</td><td><code><pre>                        break</pre></code></td></tr><tr><td>126</td><td><code><pre>                }</pre></code></td></tr><tr><td>127</td><td><code><pre></pre></code></td></tr><tr><td>128</td><td><code><pre>                // Merge serviceBackendPairsMap[backendID] into resolvedBackendPorts</pre></code></td></tr><tr class="miss"><td>129</td><td><code><pre>                if _, ok := serviceBackendPairsMap[destinationID]; !ok {</pre></code></td></tr><tr class="miss"><td>130</td><td><code><pre>                        serviceBackendPairsMap[destinationID] = make(map[serviceBackendPortPair]interface{})</pre></code></td></tr><tr><td>131</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>132</td><td><code><pre>                for portPair := range resolvedBackendPorts {</pre></code></td></tr><tr class="miss"><td>133</td><td><code><pre>                        serviceBackendPairsMap[destinationID][portPair] = nil</pre></code></td></tr><tr><td>134</td><td><code><pre>                }</pre></code></td></tr><tr><td>135</td><td><code><pre>        }</pre></code></td></tr><tr><td>136</td><td><code><pre>        if len(unresolvedDestinationID) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>137</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>138</td><td><code><pre>                        controllererrors.ErrorIstioResolvePortsForServices,</pre></code></td></tr><tr><td>139</td><td><code><pre>                        &#34;unable to resolve backend port for some services&#34;,</pre></code></td></tr><tr><td>140</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>                return nil, nil, nil, e</pre></code></td></tr><tr><td>142</td><td><code><pre>        }</pre></code></td></tr><tr><td>143</td><td><code><pre></pre></code></td></tr><tr><td>144</td><td><code><pre>        httpSettingsCollection := make(map[string]n.ApplicationGatewayBackendHTTPSettings)</pre></code></td></tr><tr><td>145</td><td><code><pre>        for destinationID, serviceBackendPairs := range serviceBackendPairsMap {</pre></code></td></tr><tr class="miss"><td>146</td><td><code><pre>                if len(serviceBackendPairs) &gt; 1 {</pre></code></td></tr><tr><td>147</td><td><code><pre>                        // more than one possible backend port exposed through ingress</pre></code></td></tr><tr class="miss"><td>148</td><td><code><pre>                        backendServicePort := &#34;&#34;</pre></code></td></tr><tr class="miss"><td>149</td><td><code><pre>                        if destinationID.DestinationPort != 0 {</pre></code></td></tr><tr class="miss"><td>150</td><td><code><pre>                                backendServicePort = fmt.Sprint(destinationID.DestinationPort)</pre></code></td></tr><tr><td>151</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>152</td><td><code><pre>                                // TODO(delqn): implement port lookup by name</pre></code></td></tr><tr><td>153</td><td><code><pre>                        }</pre></code></td></tr><tr><td>154</td><td><code><pre></pre></code></td></tr><tr><td>155</td><td><code><pre>                        //TODO(rhea): add error event recorder</pre></code></td></tr><tr class="miss"><td>156</td><td><code><pre>                        e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>157</td><td><code><pre>                                controllererrors.ErrorIstioMultipleServiceBackendPortBinding,</pre></code></td></tr><tr><td>158</td><td><code><pre>                                &#34;service:port [%s:%s] has more than one service-backend port binding&#34;,</pre></code></td></tr><tr><td>159</td><td><code><pre>                                destinationID.serviceKey(), backendServicePort,</pre></code></td></tr><tr><td>160</td><td><code><pre>                        )</pre></code></td></tr><tr class="miss"><td>161</td><td><code><pre>                        klog.Warning(e.Error())</pre></code></td></tr><tr class="miss"><td>162</td><td><code><pre>                        return nil, nil, nil, e</pre></code></td></tr><tr><td>163</td><td><code><pre>                }</pre></code></td></tr><tr><td>164</td><td><code><pre></pre></code></td></tr><tr><td>165</td><td><code><pre>                // At this point there will be only one pair</pre></code></td></tr><tr class="miss"><td>166</td><td><code><pre>                var uniquePair serviceBackendPortPair</pre></code></td></tr><tr class="miss"><td>167</td><td><code><pre>                for k := range serviceBackendPairs {</pre></code></td></tr><tr class="miss"><td>168</td><td><code><pre>                        uniquePair = k</pre></code></td></tr><tr><td>169</td><td><code><pre>                }</pre></code></td></tr><tr><td>170</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>171</td><td><code><pre>                finalServiceBackendPairMap[destinationID] = uniquePair</pre></code></td></tr><tr class="miss"><td>172</td><td><code><pre>                httpSettings := c.generateIstioHTTPSettings(destinationID, uniquePair.BackendPort, cbCtx)</pre></code></td></tr><tr class="miss"><td>173</td><td><code><pre>                httpSettingsCollection[*httpSettings.Name] = httpSettings</pre></code></td></tr><tr class="miss"><td>174</td><td><code><pre>                backendHTTPSettingsMap[destinationID] = &amp;httpSettings</pre></code></td></tr><tr><td>175</td><td><code><pre>        }</pre></code></td></tr><tr><td>176</td><td><code><pre></pre></code></td></tr><tr><td>177</td><td><code><pre>        httpSettings := make([]n.ApplicationGatewayBackendHTTPSettings, 0, len(httpSettingsCollection))</pre></code></td></tr><tr><td>178</td><td><code><pre>        for _, backend := range httpSettingsCollection {</pre></code></td></tr><tr class="miss"><td>179</td><td><code><pre>                httpSettings = append(httpSettings, backend)</pre></code></td></tr><tr><td>180</td><td><code><pre>        }</pre></code></td></tr><tr><td>181</td><td><code><pre></pre></code></td></tr><tr><td>182</td><td><code><pre>        return httpSettings, backendHTTPSettingsMap, finalServiceBackendPairMap, nil</pre></code></td></tr><tr><td>183</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_validateServiceDefinition">func validateServiceDefinition</div><div class="info"><a href="#s_fn_validateServiceDefinition">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code>:</p></div><table class="listing">
<tr><td>22</td><td><code><pre>func validateServiceDefinition(eventRecorder record.EventRecorder, config *n.ApplicationGatewayPropertiesFormat, envVariables environment.EnvVariables, ingressList []*networking.Ingress, serviceList []*v1.Service) error {</pre></code></td></tr><tr><td>23</td><td><code><pre>        // TODO(draychev): reuse newBackendIds() to get backendIDs oncehttps://github.com/Azure/application-gateway-kubernetes-ingress/pull/262 is merged</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>        backendIDs := make(map[backendIdentifier]interface{})</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>        for _, ingress := range ingressList {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                if ingress.Spec.DefaultBackend != nil {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                        backendIDs[generateBackendID(ingress, nil, nil, ingress.Spec.DefaultBackend)] = nil</pre></code></td></tr><tr><td>28</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                for ruleIdx := range ingress.Spec.Rules {</pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>                        rule := &amp;ingress.Spec.Rules[ruleIdx]</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                        if rule.HTTP == nil {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>33</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                        for pathIdx := range rule.HTTP.Paths {</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                                if ingress.Spec.DefaultBackend == nil {</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>37</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                                path := &amp;rule.HTTP.Paths[pathIdx]</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>                                backendIDs[generateBackendID(ingress, rule, path, &amp;path.Backend)] = nil</pre></code></td></tr><tr><td>40</td><td><code><pre>                        }</pre></code></td></tr><tr><td>41</td><td><code><pre>                }</pre></code></td></tr><tr><td>42</td><td><code><pre>        }</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>        serviceSet := newServiceSet(&amp;serviceList)</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>        for be := range backendIDs {</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                if _, exists := serviceSet[be.serviceKey()]; !exists {</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                        logLine := fmt.Sprintf(&#34;Ingress %s/%s references non existent Service %s. Please correct the Service section of your Kubernetes YAML&#34;, be.Ingress.Namespace, be.Ingress.Name, be.serviceKey())</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>                        eventRecorder.Event(be.Ingress, v1.EventTypeWarning, events.ReasonIngressServiceTargetMatch, logLine)</pre></code></td></tr><tr><td>49</td><td><code><pre>                        // NOTE: We could and should return a new error here.</pre></code></td></tr><tr><td>50</td><td><code><pre>                        // However this could be enabled at a later point in time once we know with certainty that there are no valid</pre></code></td></tr><tr><td>51</td><td><code><pre>                        // scenarios where one could have Ingress pointing to a missing Service targets.</pre></code></td></tr><tr><td>52</td><td><code><pre>                }</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.getIstioListenersPorts">func appGwConfigBuilder.getIstioListenersPorts</div><div class="info"><a href="#s_fn_appGwConfigBuilder.getIstioListenersPorts">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/frontend_listeners_istio.go</code>:</p></div><table class="listing">
<tr><td>13</td><td><code><pre>func (c *appGwConfigBuilder) getIstioListenersPorts(cbCtx *ConfigBuilderContext) ([]n.ApplicationGatewayHTTPListener, map[Port]n.ApplicationGatewayFrontendPort, map[string]string) {</pre></code></td></tr><tr class="miss"><td>14</td><td><code><pre>        publIPPorts := make(map[string]string)</pre></code></td></tr><tr class="miss"><td>15</td><td><code><pre>        portsByNumber := cbCtx.ExistingPortsByNumber</pre></code></td></tr><tr class="miss"><td>16</td><td><code><pre>        var listeners []n.ApplicationGatewayHTTPListener</pre></code></td></tr><tr><td>17</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>19</td><td><code><pre>                for listenerID, config := range c.getListenerConfigsFromIstio(cbCtx.IstioGateways, cbCtx.IstioVirtualServices) {</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>                        listener, port, err := c.newListener(cbCtx, listenerID, config.Protocol, portsByNumber)</pre></code></td></tr><tr class="miss"><td>21</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>22</td><td><code><pre>                                klog.Errorf(&#34;Failed creating listener %+v: %s&#34;, listenerID, err)</pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>24</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                        if listenerName, exists := publIPPorts[*port.Name]; exists &amp;&amp; listenerID.UsePrivateIP {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                                klog.Errorf(&#34;Can&#39;t assign port %s to Private IP Listener %s; already assigned to Public IP Listener %s&#34;, *port.Name, *listener.Name, listenerName)</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>28</td><td><code><pre>                        }</pre></code></td></tr><tr><td>29</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>30</td><td><code><pre>                        if !listenerID.UsePrivateIP {</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                                publIPPorts[*port.Name] = *listener.Name</pre></code></td></tr><tr><td>32</td><td><code><pre>                        }</pre></code></td></tr><tr><td>33</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                        listeners = append(listeners, *listener)</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                        if _, exists := portsByNumber[Port(*port.Port)]; !exists {</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>                                portsByNumber[Port(*port.Port)] = *port</pre></code></td></tr><tr><td>37</td><td><code><pre>                        }</pre></code></td></tr><tr><td>38</td><td><code><pre>                }</pre></code></td></tr><tr><td>39</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>        return listeners, portsByNumber, publIPPorts</pre></code></td></tr><tr><td>41</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FatalValidateOnExistingConfig">func FatalValidateOnExistingConfig</div><div class="info"><a href="#s_fn_FatalValidateOnExistingConfig">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/validators.go</code>:</p></div><table class="listing">
<tr><td>151</td><td><code><pre>func FatalValidateOnExistingConfig(eventRecorder record.EventRecorder, config *n.ApplicationGatewayPropertiesFormat, envVariables environment.EnvVariables) error {</pre></code></td></tr><tr class="miss"><td>152</td><td><code><pre>        if config == nil {</pre></code></td></tr><tr class="miss"><td>153</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>154</td><td><code><pre>                        controllererrors.ErrorEmptyConfig,</pre></code></td></tr><tr><td>155</td><td><code><pre>                        &#34;Application Gateway configuration should not be empty.&#34;,</pre></code></td></tr><tr><td>156</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>157</td><td><code><pre>                return e</pre></code></td></tr><tr><td>158</td><td><code><pre>        }</pre></code></td></tr><tr><td>159</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>160</td><td><code><pre>        validators := []func(eventRecorder record.EventRecorder, config n.ApplicationGatewayPropertiesFormat, envVariables environment.EnvVariables) error{</pre></code></td></tr><tr><td>161</td><td><code><pre>                validateFrontendIPConfiguration,</pre></code></td></tr><tr><td>162</td><td><code><pre>        }</pre></code></td></tr><tr><td>163</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>164</td><td><code><pre>        for _, fn := range validators {</pre></code></td></tr><tr class="miss"><td>165</td><td><code><pre>                if err := fn(eventRecorder, *config, envVariables); err != nil {</pre></code></td></tr><tr class="miss"><td>166</td><td><code><pre>                        return err</pre></code></td></tr><tr><td>167</td><td><code><pre>                }</pre></code></td></tr><tr><td>168</td><td><code><pre>        }</pre></code></td></tr><tr><td>169</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>170</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>171</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_printEndpoints">func printEndpoints</div><div class="info"><a href="#s_fn_printEndpoints">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder_debug.go</code>:</p></div><table class="listing">
<tr><td>15</td><td><code><pre>func printEndpoints(endpoints v1.Endpoints) {</pre></code></td></tr><tr class="miss"><td>16</td><td><code><pre>        fmt.Printf(&#34;Endpoint [%s]\n&#34;, endpoints.Name)</pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>        for _, subset := range endpoints.Subsets {</pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>                ports := subset.Ports</pre></code></td></tr><tr class="miss"><td>19</td><td><code><pre>                tmp := make([]string, 0, len(ports))</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>                for _, port := range ports {</pre></code></td></tr><tr class="miss"><td>21</td><td><code><pre>                        tmp = append(tmp, port.Name)</pre></code></td></tr><tr><td>22</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>                portsString := strings.Join(tmp, &#34;,&#34;)</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>                fmt.Printf(&#34; - subset ports=[%s]\n&#34;, portsString)</pre></code></td></tr><tr><td>25</td><td><code><pre>        }</pre></code></td></tr><tr><td>26</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.generateIstioHTTPSettings">func appGwConfigBuilder.generateIstioHTTPSettings</div><div class="info"><a href="#s_fn_appGwConfigBuilder.generateIstioHTTPSettings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_settings.go</code>:</p></div><table class="listing">
<tr><td>185</td><td><code><pre>func (c *appGwConfigBuilder) generateIstioHTTPSettings(destinationID istioDestinationIdentifier, port Port, cbCtx *ConfigBuilderContext) n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr class="miss"><td>186</td><td><code><pre>        backendServicePort := &#34;&#34;</pre></code></td></tr><tr class="miss"><td>187</td><td><code><pre>        if destinationID.DestinationPort != 0 {</pre></code></td></tr><tr class="miss"><td>188</td><td><code><pre>                backendServicePort = fmt.Sprint(destinationID.DestinationPort)</pre></code></td></tr><tr><td>189</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>190</td><td><code><pre>                // TODO(delqn): Implement port lookup by name</pre></code></td></tr><tr><td>191</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>192</td><td><code><pre>        httpSettingsName := generateHTTPSettingsName(destinationID.serviceFullName(), backendServicePort, port, destinationID.istioVirtualServiceIdentifier.Name)</pre></code></td></tr><tr class="miss"><td>193</td><td><code><pre>        klog.V(5).Infof(&#34;Created a new HTTP setting w/ name: %s\n&#34;, httpSettingsName)</pre></code></td></tr><tr class="miss"><td>194</td><td><code><pre>        httpSettings := n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>195</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>196</td><td><code><pre>                Name: &amp;httpSettingsName,</pre></code></td></tr><tr><td>197</td><td><code><pre>                ID:   to.StringPtr(c.appGwIdentifier.HTTPSettingsID(httpSettingsName)),</pre></code></td></tr><tr><td>198</td><td><code><pre>                ApplicationGatewayBackendHTTPSettingsPropertiesFormat: &amp;n.ApplicationGatewayBackendHTTPSettingsPropertiesFormat{</pre></code></td></tr><tr><td>199</td><td><code><pre>                        Protocol: n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>200</td><td><code><pre>                        Port:     to.Int32Ptr(int32(port)),</pre></code></td></tr><tr><td>201</td><td><code><pre>                },</pre></code></td></tr><tr><td>202</td><td><code><pre>        }</pre></code></td></tr><tr><td>203</td><td><code><pre></pre></code></td></tr><tr><td>204</td><td><code><pre>        //TODO(rhea): check relevant annotations and modify http settings accordingly</pre></code></td></tr><tr><td>205</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>206</td><td><code><pre>        return httpSettings</pre></code></td></tr><tr><td>207</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.runValidationFunctions">func appGwConfigBuilder.runValidationFunctions</div><div class="info"><a href="#s_fn_appGwConfigBuilder.runValidationFunctions">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>180</td><td><code><pre>func (c *appGwConfigBuilder) runValidationFunctions(cbCtx *ConfigBuilderContext, validationFunctions []valFunc) error {</pre></code></td></tr><tr class="miss"><td>181</td><td><code><pre>        for _, fn := range validationFunctions {</pre></code></td></tr><tr class="miss"><td>182</td><td><code><pre>                if err := fn(c.recorder, c.appGw.ApplicationGatewayPropertiesFormat, cbCtx.EnvVariables, cbCtx.IngressList, cbCtx.ServiceList); err != nil {</pre></code></td></tr><tr class="miss"><td>183</td><td><code><pre>                        return err</pre></code></td></tr><tr><td>184</td><td><code><pre>                }</pre></code></td></tr><tr><td>185</td><td><code><pre>        }</pre></code></td></tr><tr><td>186</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>187</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>188</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_newURLPathMap">func newURLPathMap</div><div class="info"><a href="#s_fn_newURLPathMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/test_fixtures.go</code>:</p></div><table class="listing">
<tr><td>129</td><td><code><pre>func newURLPathMap() n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr class="miss"><td>130</td><td><code><pre>        rule := n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>131</td><td><code><pre>                ID:   to.StringPtr(&#34;-the-id-&#34;),</pre></code></td></tr><tr><td>132</td><td><code><pre>                Type: to.StringPtr(&#34;-the-type-&#34;),</pre></code></td></tr><tr><td>133</td><td><code><pre>                Etag: to.StringPtr(&#34;-the-etag-&#34;),</pre></code></td></tr><tr><td>134</td><td><code><pre>                Name: to.StringPtr(&#34;/some/path&#34;),</pre></code></td></tr><tr><td>135</td><td><code><pre>                ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>136</td><td><code><pre>                        // A Path Rule must have either RedirectConfiguration xor (BackendAddressPool + BackendHTTPSettings)</pre></code></td></tr><tr><td>137</td><td><code><pre>                        RedirectConfiguration: nil,</pre></code></td></tr><tr><td>138</td><td><code><pre></pre></code></td></tr><tr><td>139</td><td><code><pre>                        BackendAddressPool:  resourceRef(&#34;--BackendAddressPool--&#34;),</pre></code></td></tr><tr><td>140</td><td><code><pre>                        BackendHTTPSettings: resourceRef(&#34;--BackendHTTPSettings--&#34;),</pre></code></td></tr><tr><td>141</td><td><code><pre></pre></code></td></tr><tr><td>142</td><td><code><pre>                        RewriteRuleSet:    resourceRef(&#34;--RewriteRuleSet--&#34;),</pre></code></td></tr><tr><td>143</td><td><code><pre>                        ProvisioningState: &#34;--provisionStateExpected--&#34;,</pre></code></td></tr><tr><td>144</td><td><code><pre>                },</pre></code></td></tr><tr><td>145</td><td><code><pre>        }</pre></code></td></tr><tr><td>146</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>147</td><td><code><pre>        return n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>148</td><td><code><pre>                Name: to.StringPtr(&#34;-path-map-name-&#34;),</pre></code></td></tr><tr><td>149</td><td><code><pre>                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>150</td><td><code><pre>                        // URL Path Map must have either DefaultRedirectConfiguration xor (DefaultBackendAddressPool + DefaultBackendHTTPSettings)</pre></code></td></tr><tr><td>151</td><td><code><pre>                        DefaultRedirectConfiguration: nil,</pre></code></td></tr><tr><td>152</td><td><code><pre></pre></code></td></tr><tr><td>153</td><td><code><pre>                        DefaultBackendAddressPool:  resourceRef(&#34;--DefaultBackendAddressPool--&#34;),</pre></code></td></tr><tr><td>154</td><td><code><pre>                        DefaultBackendHTTPSettings: resourceRef(&#34;--DefaultBackendHTTPSettings--&#34;),</pre></code></td></tr><tr><td>155</td><td><code><pre></pre></code></td></tr><tr><td>156</td><td><code><pre>                        PathRules: &amp;[]n.ApplicationGatewayPathRule{rule},</pre></code></td></tr><tr><td>157</td><td><code><pre>                },</pre></code></td></tr><tr><td>158</td><td><code><pre>        }</pre></code></td></tr><tr><td>159</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.PreBuildValidate">func appGwConfigBuilder.PreBuildValidate</div><div class="info"><a href="#s_fn_appGwConfigBuilder.PreBuildValidate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>162</td><td><code><pre>func (c *appGwConfigBuilder) PreBuildValidate(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr><td>163</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>164</td><td><code><pre>        validationFunctions := []valFunc{</pre></code></td></tr><tr><td>165</td><td><code><pre>                validateServiceDefinition,</pre></code></td></tr><tr><td>166</td><td><code><pre>        }</pre></code></td></tr><tr><td>167</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>168</td><td><code><pre>        return c.runValidationFunctions(cbCtx, validationFunctions)</pre></code></td></tr><tr><td>169</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.subnetID">func Identifier.subnetID</div><div class="info"><a href="#s_fn_Identifier.subnetID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>83</td><td><code><pre>func (agw Identifier) subnetID(vnetName string, subnetName string) string {</pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>        resourcePath := fmt.Sprintf(&#34;%s/subnets/%s&#34;, vnetName, subnetName)</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>        return agw.resourceID(&#34;Microsoft.Network&#34;, &#34;virtualNetworks&#34;, resourcePath)</pre></code></td></tr><tr><td>86</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_appGwConfigBuilder.PostBuildValidate">func appGwConfigBuilder.PostBuildValidate</div><div class="info"><a href="#s_fn_appGwConfigBuilder.PostBuildValidate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/configbuilder.go</code>:</p></div><table class="listing">
<tr><td>172</td><td><code><pre>func (c *appGwConfigBuilder) PostBuildValidate(cbCtx *ConfigBuilderContext) error {</pre></code></td></tr><tr class="miss"><td>173</td><td><code><pre>        validationFunctions := []valFunc{</pre></code></td></tr><tr><td>174</td><td><code><pre>                validateURLPathMaps,</pre></code></td></tr><tr><td>175</td><td><code><pre>        }</pre></code></td></tr><tr><td>176</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>177</td><td><code><pre>        return c.runValidationFunctions(cbCtx, validationFunctions)</pre></code></td></tr><tr><td>178</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.wafPolicyID">func Identifier.wafPolicyID</div><div class="info"><a href="#s_fn_Identifier.wafPolicyID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>88</td><td><code><pre>func (agw Identifier) wafPolicyID(wafPolicyName string) string {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>        return agw.resourceID(&#34;Microsoft.Network&#34;, &#34;ApplicationGatewayWebApplicationFirewallPolicies&#34;, wafPolicyName)</pre></code></td></tr><tr><td>90</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.sslProfileID">func Identifier.sslProfileID</div><div class="info"><a href="#s_fn_Identifier.sslProfileID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>49</td><td><code><pre>func (agw Identifier) sslProfileID(profilename string) string {</pre></code></td></tr><tr class="miss"><td>50</td><td><code><pre>        return agw.gatewayResourceID(&#34;sslProfiles&#34;, profilename)</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.frontendIPID">func Identifier.frontendIPID</div><div class="info"><a href="#s_fn_Identifier.frontendIPID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>37</td><td><code><pre>func (agw Identifier) frontendIPID(fipName string) string {</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>        return agw.gatewayResourceID(&#34;frontendIPConfigurations&#34;, fipName)</pre></code></td></tr><tr><td>39</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateIstioMatchID">func generateIstioMatchID</div><div class="info"><a href="#s_fn_generateIstioMatchID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_config.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func generateIstioMatchID(virtualService *v1alpha3.VirtualService, rule *v1alpha3.HTTPRoute, match *v1alpha3.HTTPMatchRequest, destinations []*v1alpha3.Destination) istioMatchIdentifier {</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>        return istioMatchIdentifier{</pre></code></td></tr><tr><td>36</td><td><code><pre>                Namespace:      virtualService.Namespace,</pre></code></td></tr><tr><td>37</td><td><code><pre>                VirtualService: virtualService,</pre></code></td></tr><tr><td>38</td><td><code><pre>                Rule:           rule,</pre></code></td></tr><tr><td>39</td><td><code><pre>                Match:          match,</pre></code></td></tr><tr><td>40</td><td><code><pre>                Destinations:   destinations,</pre></code></td></tr><tr><td>41</td><td><code><pre>                Gateways:       match.Gateways,</pre></code></td></tr><tr><td>42</td><td><code><pre>        }</pre></code></td></tr><tr><td>43</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_generateIstioDestinationID">func generateIstioDestinationID</div><div class="info"><a href="#s_fn_generateIstioDestinationID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/istio_config.go</code>:</p></div><table class="listing">
<tr><td>45</td><td><code><pre>func generateIstioDestinationID(virtualService *v1alpha3.VirtualService, destination *v1alpha3.Destination) istioDestinationIdentifier {</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>        return istioDestinationIdentifier{</pre></code></td></tr><tr><td>47</td><td><code><pre>                serviceIdentifier: serviceIdentifier{</pre></code></td></tr><tr><td>48</td><td><code><pre>                        Namespace: virtualService.Namespace,</pre></code></td></tr><tr><td>49</td><td><code><pre>                        Name:      destination.Host,</pre></code></td></tr><tr><td>50</td><td><code><pre>                },</pre></code></td></tr><tr><td>51</td><td><code><pre></pre></code></td></tr><tr><td>52</td><td><code><pre>                istioVirtualServiceIdentifier: istioVirtualServiceIdentifier{</pre></code></td></tr><tr><td>53</td><td><code><pre>                        Namespace: virtualService.Namespace,</pre></code></td></tr><tr><td>54</td><td><code><pre>                        Name:      virtualService.Name,</pre></code></td></tr><tr><td>55</td><td><code><pre>                },</pre></code></td></tr><tr><td>56</td><td><code><pre></pre></code></td></tr><tr><td>57</td><td><code><pre>                DestinationHost:   destination.Host,</pre></code></td></tr><tr><td>58</td><td><code><pre>                DestinationSubset: destination.Subset,</pre></code></td></tr><tr><td>59</td><td><code><pre>                DestinationPort:   destination.Port.Number,</pre></code></td></tr><tr><td>60</td><td><code><pre>        }</pre></code></td></tr><tr><td>61</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Identifier.publicIPID">func Identifier.publicIPID</div><div class="info"><a href="#s_fn_Identifier.publicIPID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/identifier.go</code>:</p></div><table class="listing">
<tr><td>92</td><td><code><pre>func (agw Identifier) publicIPID(publicIPName string) string {</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>        return agw.resourceID(&#34;Microsoft.Network&#34;, &#34;publicIPAddresses&#34;, publicIPName)</pre></code></td></tr><tr><td>94</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_serviceIdentifier.serviceFullNameHash">func serviceIdentifier.serviceFullNameHash</div><div class="info"><a href="#s_fn_serviceIdentifier.serviceFullNameHash">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/appgw/internaltypes.go</code>:</p></div><table class="listing">
<tr><td>110</td><td><code><pre>func (s serviceIdentifier) serviceFullNameHash() string {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>        return fmt.Sprintf(&#34;%x&#34;, md5.Sum([]byte(s.serviceFullName())))</pre></code></td></tr><tr><td>112</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/appgw DONE:76.48
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure <span class="packageTotal">29.41%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_GetOperationIDFromPollingURL"><td><code><a href="#fn_GetOperationIDFromPollingURL">GetOperationIDFromPollingURL(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_ParseSubResourceID"><td><code><a href="#fn_ParseSubResourceID">ParseSubResourceID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_GetAuthorizerWithRetry"><td><code><a href="#fn_GetAuthorizerWithRetry">GetAuthorizerWithRetry(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/auth.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_azClient.WaitForGetAccessOnGateway"><td><code><a href="#fn_azClient.WaitForGetAccessOnGateway">azClient.WaitForGetAccessOnGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_@23:3"><td><code><a href="#fn_@23:3">@23:3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/auth.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_azClient.SetDuration"><td><code><a href="#fn_azClient.SetDuration">azClient.SetDuration(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_RouteTableID"><td><code><a href="#fn_RouteTableID">RouteTableID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_ApplicationGatewayID"><td><code><a href="#fn_ApplicationGatewayID">ApplicationGatewayID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_ResourceGroupID"><td><code><a href="#fn_ResourceGroupID">ResourceGroupID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_azClient.SetSender"><td><code><a href="#fn_azClient.SetSender">azClient.SetSender(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_ResourceID"><td><code><a href="#fn_ResourceID">ResourceID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_@131:3"><td><code><a href="#fn_@131:3">@131:3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>92.00%</code></td><td class="linecount"><code>23/25</code></td></tr>
<tr id="s_fn_ConvertToClusterResourceGroup"><td><code><a href="#fn_ConvertToClusterResourceGroup">ConvertToClusterResourceGroup(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>87.50%</code></td><td class="linecount"><code>7/8</code></td></tr>
<tr id="s_fn_NewAzClient"><td><code><a href="#fn_NewAzClient">NewAzClient(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>60.00%</code></td><td class="linecount"><code>12/20</code></td></tr>
<tr id="s_fn_ParseResourceID"><td><code><a href="#fn_ParseResourceID">ParseResourceID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code></td><td class="percent"><code>60.00%</code></td><td class="linecount"><code>3/5</code></td></tr>
<tr id="s_fn_getAuthorizer"><td><code><a href="#fn_getAuthorizer">getAuthorizer(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/auth.go</code></td><td class="percent"><code>33.33%</code></td><td class="linecount"><code>4/12</code></td></tr>
<tr id="s_fn_azClient.ApplyRouteTable"><td><code><a href="#fn_azClient.ApplyRouteTable">azClient.ApplyRouteTable(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/25</code></td></tr>
<tr id="s_fn_azClient.DeployGatewayWithVnet"><td><code><a href="#fn_azClient.DeployGatewayWithVnet">azClient.DeployGatewayWithVnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/15</code></td></tr>
<tr id="s_fn_azClient.DeployGatewayWithSubnet"><td><code><a href="#fn_azClient.DeployGatewayWithSubnet">azClient.DeployGatewayWithSubnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/14</code></td></tr>
<tr id="s_fn_NewCloudProviderConfig"><td><code><a href="#fn_NewCloudProviderConfig">NewCloudProviderConfig(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/cloudproviderconfig.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_azClient.createDeployment"><td><code><a href="#fn_azClient.createDeployment">azClient.createDeployment(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_azClient.createSubnet"><td><code><a href="#fn_azClient.createSubnet">azClient.createSubnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/9</code></td></tr>
<tr id="s_fn_azClient.GetPublicIP"><td><code><a href="#fn_azClient.GetPublicIP">azClient.GetPublicIP(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/8</code></td></tr>
<tr id="s_fn_azClient.UpdateGateway"><td><code><a href="#fn_azClient.UpdateGateway">azClient.UpdateGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_azClient.SetAuthorizer"><td><code><a href="#fn_azClient.SetAuthorizer">azClient.SetAuthorizer(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_FakeAzClient.WaitForGetAccessOnGateway"><td><code><a href="#fn_FakeAzClient.WaitForGetAccessOnGateway">FakeAzClient.WaitForGetAccessOnGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_azClient.findSubnet"><td><code><a href="#fn_azClient.findSubnet">azClient.findSubnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_@351:3"><td><code><a href="#fn_@351:3">@351:3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_getTemplate"><td><code><a href="#fn_getTemplate">getTemplate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_@199:3"><td><code><a href="#fn_@199:3">@199:3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_@364:3"><td><code><a href="#fn_@364:3">@364:3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_FakeAzClient.GetGateway"><td><code><a href="#fn_FakeAzClient.GetGateway">FakeAzClient.GetGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_FakeAzClient.GetPublicIP"><td><code><a href="#fn_FakeAzClient.GetPublicIP">FakeAzClient.GetPublicIP(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_FakeAzClient.DeployGatewayWithVnet"><td><code><a href="#fn_FakeAzClient.DeployGatewayWithVnet">FakeAzClient.DeployGatewayWithVnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_FakeAzClient.DeployGatewayWithSubnet"><td><code><a href="#fn_FakeAzClient.DeployGatewayWithSubnet">FakeAzClient.DeployGatewayWithSubnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_FakeAzClient.UpdateGateway"><td><code><a href="#fn_FakeAzClient.UpdateGateway">FakeAzClient.UpdateGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_FakeAzClient.ApplyRouteTable"><td><code><a href="#fn_FakeAzClient.ApplyRouteTable">FakeAzClient.ApplyRouteTable(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_azClient.GetGateway"><td><code><a href="#fn_azClient.GetGateway">azClient.GetGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_azClient.getGroup"><td><code><a href="#fn_azClient.getGroup">azClient.getGroup(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_azClient.getVnet"><td><code><a href="#fn_azClient.getVnet">azClient.getVnet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/client.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_NewFakeAzClient"><td><code><a href="#fn_NewFakeAzClient">NewFakeAzClient(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_FakeAzClient.SetSender"><td><code><a href="#fn_FakeAzClient.SetSender">FakeAzClient.SetSender(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/0</code></td></tr>
<tr id="s_fn_FakeAzClient.SetAuthorizer"><td><code><a href="#fn_FakeAzClient.SetAuthorizer">FakeAzClient.SetAuthorizer(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/0</code></td></tr>
<tr id="s_fn_FakeAzClient.SetDuration"><td><code><a href="#fn_FakeAzClient.SetDuration">FakeAzClient.SetDuration(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/0</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure</code></td><td class="percent"><code>29.41%</code></td><td class="linecount"><code>75/255</code></td></tr>
</table>

<div class="funcname" id="fn_GetOperationIDFromPollingURL">func GetOperationIDFromPollingURL</div><div class="info"><a href="#s_fn_GetOperationIDFromPollingURL">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>95</td><td><code><pre>func GetOperationIDFromPollingURL(pollingURL string) string {</pre></code></td></tr><tr><td>96</td><td><code><pre>        operationID := &#34;&#34;</pre></code></td></tr><tr><td>97</td><td><code><pre>        if pollingURL != &#34;&#34; {</pre></code></td></tr><tr><td>98</td><td><code><pre>                matchGroup := operationIDRegex.FindStringSubmatch(pollingURL)</pre></code></td></tr><tr><td>99</td><td><code><pre>                if len(matchGroup) == 2 {</pre></code></td></tr><tr><td>100</td><td><code><pre>                        operationID = matchGroup[1]</pre></code></td></tr><tr><td>101</td><td><code><pre>                }</pre></code></td></tr><tr><td>102</td><td><code><pre>        }</pre></code></td></tr><tr><td>103</td><td><code><pre></pre></code></td></tr><tr><td>104</td><td><code><pre>        return operationID</pre></code></td></tr><tr><td>105</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ParseSubResourceID">func ParseSubResourceID</div><div class="info"><a href="#s_fn_ParseSubResourceID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>45</td><td><code><pre>func ParseSubResourceID(ID string) (SubscriptionID, ResourceGroup, ResourceName, ResourceName) {</pre></code></td></tr><tr><td>46</td><td><code><pre>        split := strings.Split(ID, &#34;/&#34;)</pre></code></td></tr><tr><td>47</td><td><code><pre>        if len(split) &lt; 11 {</pre></code></td></tr><tr><td>48</td><td><code><pre>                klog.Errorf(&#34;resourceID %s is invalid. There should be atleast 9 segments in resourceID&#34;, ID)</pre></code></td></tr><tr><td>49</td><td><code><pre>                return &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;</pre></code></td></tr><tr><td>50</td><td><code><pre>        }</pre></code></td></tr><tr><td>51</td><td><code><pre></pre></code></td></tr><tr><td>52</td><td><code><pre>        return SubscriptionID(split[2]), ResourceGroup(split[4]), ResourceName(split[8]), ResourceName(split[10])</pre></code></td></tr><tr><td>53</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAuthorizerWithRetry">func GetAuthorizerWithRetry</div><div class="info"><a href="#s_fn_GetAuthorizerWithRetry">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/auth.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func GetAuthorizerWithRetry(authLocation string, useManagedidentity bool, cpConfig *CloudProviderConfig, maxAuthRetryCount int, retryPause time.Duration) (authorizer autorest.Authorizer, err error) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        utils.Retry(maxAuthRetryCount, retryPause,</pre></code></td></tr><tr><td>23</td><td><code><pre>                func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>24</td><td><code><pre>                        // Fetch a new token</pre></code></td></tr><tr><td>25</td><td><code><pre>                        authorizer, err = getAuthorizer(authLocation, useManagedidentity, cpConfig)</pre></code></td></tr><tr><td>26</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>27</td><td><code><pre>                })</pre></code></td></tr><tr><td>28</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>29</td><td><code><pre>                klog.Errorf(&#34;Error getting an authorizer %s&#34;, err.Error())</pre></code></td></tr><tr><td>30</td><td><code><pre>        }</pre></code></td></tr><tr><td>31</td><td><code><pre>        return authorizer, err</pre></code></td></tr><tr><td>32</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.WaitForGetAccessOnGateway">func azClient.WaitForGetAccessOnGateway</div><div class="info"><a href="#s_fn_azClient.WaitForGetAccessOnGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>128</td><td><code><pre>func (az *azClient) WaitForGetAccessOnGateway(maxRetryCount int) (err error) {</pre></code></td></tr><tr><td>129</td><td><code><pre>        klog.V(5).Info(&#34;Getting Application Gateway configuration.&#34;)</pre></code></td></tr><tr><td>130</td><td><code><pre>        err = utils.Retry(maxRetryCount, retryPause,</pre></code></td></tr><tr><td>131</td><td><code><pre>                func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>132</td><td><code><pre>                        response, err := az.appGatewaysClient.Get(az.ctx, string(az.resourceGroupName), string(az.appGwName))</pre></code></td></tr><tr><td>133</td><td><code><pre>                        if err == nil {</pre></code></td></tr><tr><td>134</td><td><code><pre>                                return utils.Retriable(true), nil</pre></code></td></tr><tr><td>135</td><td><code><pre>                        }</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr><td>137</td><td><code><pre>                        e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>138</td><td><code><pre>                                controllererrors.ErrorGetApplicationGatewayError,</pre></code></td></tr><tr><td>139</td><td><code><pre>                                err,</pre></code></td></tr><tr><td>140</td><td><code><pre>                                &#34;Failed fetching configuration for Application Gateway. Will retry in %v.&#34;, retryPause,</pre></code></td></tr><tr><td>141</td><td><code><pre>                        )</pre></code></td></tr><tr><td>142</td><td><code><pre></pre></code></td></tr><tr><td>143</td><td><code><pre>                        if response.Response.Response != nil {</pre></code></td></tr><tr><td>144</td><td><code><pre>                                e = controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>145</td><td><code><pre>                                        controllererrors.ErrorApplicationGatewayUnexpectedStatusCode,</pre></code></td></tr><tr><td>146</td><td><code><pre>                                        err,</pre></code></td></tr><tr><td>147</td><td><code><pre>                                        &#34;Unexpected status code &#39;%d&#39; while performing a GET on Application Gateway.&#34;, response.Response.StatusCode,</pre></code></td></tr><tr><td>148</td><td><code><pre>                                )</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>                                if response.Response.StatusCode == 404 {</pre></code></td></tr><tr><td>151</td><td><code><pre>                                        e.Code = controllererrors.ErrorApplicationGatewayNotFound</pre></code></td></tr><tr><td>152</td><td><code><pre>                                }</pre></code></td></tr><tr><td>153</td><td><code><pre></pre></code></td></tr><tr><td>154</td><td><code><pre>                                if response.Response.StatusCode == 403 {</pre></code></td></tr><tr><td>155</td><td><code><pre>                                        e.Code = controllererrors.ErrorApplicationGatewayForbidden</pre></code></td></tr><tr><td>156</td><td><code><pre></pre></code></td></tr><tr><td>157</td><td><code><pre>                                        clientID := &#34;&lt;agic-client-id&gt;&#34;</pre></code></td></tr><tr><td>158</td><td><code><pre>                                        if az.clientID != &#34;&#34; {</pre></code></td></tr><tr><td>159</td><td><code><pre>                                                clientID = az.clientID</pre></code></td></tr><tr><td>160</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>161</td><td><code><pre></pre></code></td></tr><tr><td>162</td><td><code><pre>                                        groupID := ResourceGroupID(az.subscriptionID, az.resourceGroupName)</pre></code></td></tr><tr><td>163</td><td><code><pre>                                        applicationGatewayID := ApplicationGatewayID(az.subscriptionID, az.resourceGroupName, az.appGwName)</pre></code></td></tr><tr><td>164</td><td><code><pre>                                        roleAssignmentCmd := fmt.Sprintf(&#34;az role assignment create --role Reader --scope %s --assignee %s;&#34;+</pre></code></td></tr><tr><td>165</td><td><code><pre>                                                &#34; az role assignment create --role Contributor --scope %s --assignee %s&#34;,</pre></code></td></tr><tr><td>166</td><td><code><pre>                                                groupID,</pre></code></td></tr><tr><td>167</td><td><code><pre>                                                clientID,</pre></code></td></tr><tr><td>168</td><td><code><pre>                                                applicationGatewayID,</pre></code></td></tr><tr><td>169</td><td><code><pre>                                                clientID,</pre></code></td></tr><tr><td>170</td><td><code><pre>                                        )</pre></code></td></tr><tr><td>171</td><td><code><pre></pre></code></td></tr><tr><td>172</td><td><code><pre>                                        e.Message += fmt.Sprintf(&#34; You can use &#39;%s&#39; to assign permissions.&#34;+</pre></code></td></tr><tr><td>173</td><td><code><pre>                                                &#34; AGIC Identity needs atleast has &#39;Contributor&#39; access to Application Gateway &#39;%s&#39; and &#39;Reader&#39; access to Application Gateway&#39;s Resource Group &#39;%s&#39;.&#34;,</pre></code></td></tr><tr><td>174</td><td><code><pre>                                                roleAssignmentCmd,</pre></code></td></tr><tr><td>175</td><td><code><pre>                                                string(az.appGwName),</pre></code></td></tr><tr><td>176</td><td><code><pre>                                                string(az.resourceGroupName),</pre></code></td></tr><tr><td>177</td><td><code><pre>                                        )</pre></code></td></tr><tr><td>178</td><td><code><pre>                                }</pre></code></td></tr><tr><td>179</td><td><code><pre>                                if response.Response.StatusCode == 400 || response.Response.StatusCode == 401 {</pre></code></td></tr><tr><td>180</td><td><code><pre>                                        klog.Errorf(&#34;configuration error (bad request) or unauthorized error while performing a GET using the authorizer&#34;)</pre></code></td></tr><tr><td>181</td><td><code><pre>                                        klog.Errorf(&#34;stopping GET retries&#34;)</pre></code></td></tr><tr><td>182</td><td><code><pre>                                        return utils.Retriable(false), e</pre></code></td></tr><tr><td>183</td><td><code><pre>                                }</pre></code></td></tr><tr><td>184</td><td><code><pre>                        }</pre></code></td></tr><tr><td>185</td><td><code><pre></pre></code></td></tr><tr><td>186</td><td><code><pre>                        klog.Errorf(e.Error())</pre></code></td></tr><tr><td>187</td><td><code><pre>                        if controllererrors.IsErrorCode(e, controllererrors.ErrorApplicationGatewayNotFound) {</pre></code></td></tr><tr><td>188</td><td><code><pre>                                return utils.Retriable(false), e</pre></code></td></tr><tr><td>189</td><td><code><pre>                        }</pre></code></td></tr><tr><td>190</td><td><code><pre></pre></code></td></tr><tr><td>191</td><td><code><pre>                        return utils.Retriable(true), e</pre></code></td></tr><tr><td>192</td><td><code><pre>                })</pre></code></td></tr><tr><td>193</td><td><code><pre></pre></code></td></tr><tr><td>194</td><td><code><pre>        return</pre></code></td></tr><tr><td>195</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@23:3">func @23:3</div><div class="info"><a href="#s_fn_@23:3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/auth.go</code>:</p></div><table class="listing">
<tr><td>23</td><td><code><pre>func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>24</td><td><code><pre>                        // Fetch a new token</pre></code></td></tr><tr><td>25</td><td><code><pre>                        authorizer, err = getAuthorizer(authLocation, useManagedidentity, cpConfig)</pre></code></td></tr><tr><td>26</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>27</td><td><code><pre>                }</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.SetDuration">func azClient.SetDuration</div><div class="info"><a href="#s_fn_azClient.SetDuration">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>124</td><td><code><pre>func (az *azClient) SetDuration(retryDuration int) {</pre></code></td></tr><tr><td>125</td><td><code><pre>        az.appGatewaysClient.Client.RetryDuration = time.Duration(retryDuration)</pre></code></td></tr><tr><td>126</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_RouteTableID">func RouteTableID</div><div class="info"><a href="#s_fn_RouteTableID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>61</td><td><code><pre>func RouteTableID(subscriptionID SubscriptionID, resourceGroup ResourceGroup, routeTableName ResourceName) string {</pre></code></td></tr><tr><td>62</td><td><code><pre>        return ResourceID(subscriptionID, resourceGroup, &#34;Microsoft.Network&#34;, &#34;routeTables&#34;, string(routeTableName))</pre></code></td></tr><tr><td>63</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ApplicationGatewayID">func ApplicationGatewayID</div><div class="info"><a href="#s_fn_ApplicationGatewayID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>66</td><td><code><pre>func ApplicationGatewayID(subscriptionID SubscriptionID, resourceGroup ResourceGroup, applicationGatewayName ResourceName) string {</pre></code></td></tr><tr><td>67</td><td><code><pre>        return ResourceID(subscriptionID, resourceGroup, &#34;Microsoft.Network&#34;, &#34;applicationGateways&#34;, string(applicationGatewayName))</pre></code></td></tr><tr><td>68</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ResourceGroupID">func ResourceGroupID</div><div class="info"><a href="#s_fn_ResourceGroupID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>71</td><td><code><pre>func ResourceGroupID(subscriptionID SubscriptionID, resourceGroup ResourceGroup) string {</pre></code></td></tr><tr><td>72</td><td><code><pre>        return fmt.Sprintf(&#34;/subscriptions/%s/resourceGroups/%s&#34;, subscriptionID, resourceGroup)</pre></code></td></tr><tr><td>73</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.SetSender">func azClient.SetSender</div><div class="info"><a href="#s_fn_azClient.SetSender">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>120</td><td><code><pre>func (az *azClient) SetSender(sender autorest.Sender) {</pre></code></td></tr><tr><td>121</td><td><code><pre>        az.appGatewaysClient.Client.Sender = sender</pre></code></td></tr><tr><td>122</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ResourceID">func ResourceID</div><div class="info"><a href="#s_fn_ResourceID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>56</td><td><code><pre>func ResourceID(subscriptionID SubscriptionID, resourceGroup ResourceGroup, provider string, resourceKind string, resourcePath string) string {</pre></code></td></tr><tr><td>57</td><td><code><pre>        return fmt.Sprintf(&#34;/subscriptions/%s/resourceGroups/%s/providers/%s/%s/%s&#34;, subscriptionID, resourceGroup, provider, resourceKind, resourcePath)</pre></code></td></tr><tr><td>58</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@131:3">func @131:3</div><div class="info"><a href="#s_fn_@131:3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>131</td><td><code><pre>func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>132</td><td><code><pre>                        response, err := az.appGatewaysClient.Get(az.ctx, string(az.resourceGroupName), string(az.appGwName))</pre></code></td></tr><tr><td>133</td><td><code><pre>                        if err == nil {</pre></code></td></tr><tr class="miss"><td>134</td><td><code><pre>                                return utils.Retriable(true), nil</pre></code></td></tr><tr><td>135</td><td><code><pre>                        }</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr><td>137</td><td><code><pre>                        e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>138</td><td><code><pre>                                controllererrors.ErrorGetApplicationGatewayError,</pre></code></td></tr><tr><td>139</td><td><code><pre>                                err,</pre></code></td></tr><tr><td>140</td><td><code><pre>                                &#34;Failed fetching configuration for Application Gateway. Will retry in %v.&#34;, retryPause,</pre></code></td></tr><tr><td>141</td><td><code><pre>                        )</pre></code></td></tr><tr><td>142</td><td><code><pre></pre></code></td></tr><tr><td>143</td><td><code><pre>                        if response.Response.Response != nil {</pre></code></td></tr><tr><td>144</td><td><code><pre>                                e = controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>145</td><td><code><pre>                                        controllererrors.ErrorApplicationGatewayUnexpectedStatusCode,</pre></code></td></tr><tr><td>146</td><td><code><pre>                                        err,</pre></code></td></tr><tr><td>147</td><td><code><pre>                                        &#34;Unexpected status code &#39;%d&#39; while performing a GET on Application Gateway.&#34;, response.Response.StatusCode,</pre></code></td></tr><tr><td>148</td><td><code><pre>                                )</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>                                if response.Response.StatusCode == 404 {</pre></code></td></tr><tr><td>151</td><td><code><pre>                                        e.Code = controllererrors.ErrorApplicationGatewayNotFound</pre></code></td></tr><tr><td>152</td><td><code><pre>                                }</pre></code></td></tr><tr><td>153</td><td><code><pre></pre></code></td></tr><tr><td>154</td><td><code><pre>                                if response.Response.StatusCode == 403 {</pre></code></td></tr><tr><td>155</td><td><code><pre>                                        e.Code = controllererrors.ErrorApplicationGatewayForbidden</pre></code></td></tr><tr><td>156</td><td><code><pre></pre></code></td></tr><tr><td>157</td><td><code><pre>                                        clientID := &#34;&lt;agic-client-id&gt;&#34;</pre></code></td></tr><tr><td>158</td><td><code><pre>                                        if az.clientID != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>159</td><td><code><pre>                                                clientID = az.clientID</pre></code></td></tr><tr><td>160</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>161</td><td><code><pre></pre></code></td></tr><tr><td>162</td><td><code><pre>                                        groupID := ResourceGroupID(az.subscriptionID, az.resourceGroupName)</pre></code></td></tr><tr><td>163</td><td><code><pre>                                        applicationGatewayID := ApplicationGatewayID(az.subscriptionID, az.resourceGroupName, az.appGwName)</pre></code></td></tr><tr><td>164</td><td><code><pre>                                        roleAssignmentCmd := fmt.Sprintf(&#34;az role assignment create --role Reader --scope %s --assignee %s;&#34;+</pre></code></td></tr><tr><td>165</td><td><code><pre>                                                &#34; az role assignment create --role Contributor --scope %s --assignee %s&#34;,</pre></code></td></tr><tr><td>166</td><td><code><pre>                                                groupID,</pre></code></td></tr><tr><td>167</td><td><code><pre>                                                clientID,</pre></code></td></tr><tr><td>168</td><td><code><pre>                                                applicationGatewayID,</pre></code></td></tr><tr><td>169</td><td><code><pre>                                                clientID,</pre></code></td></tr><tr><td>170</td><td><code><pre>                                        )</pre></code></td></tr><tr><td>171</td><td><code><pre></pre></code></td></tr><tr><td>172</td><td><code><pre>                                        e.Message += fmt.Sprintf(&#34; You can use &#39;%s&#39; to assign permissions.&#34;+</pre></code></td></tr><tr><td>173</td><td><code><pre>                                                &#34; AGIC Identity needs atleast has &#39;Contributor&#39; access to Application Gateway &#39;%s&#39; and &#39;Reader&#39; access to Application Gateway&#39;s Resource Group &#39;%s&#39;.&#34;,</pre></code></td></tr><tr><td>174</td><td><code><pre>                                                roleAssignmentCmd,</pre></code></td></tr><tr><td>175</td><td><code><pre>                                                string(az.appGwName),</pre></code></td></tr><tr><td>176</td><td><code><pre>                                                string(az.resourceGroupName),</pre></code></td></tr><tr><td>177</td><td><code><pre>                                        )</pre></code></td></tr><tr><td>178</td><td><code><pre>                                }</pre></code></td></tr><tr><td>179</td><td><code><pre>                                if response.Response.StatusCode == 400 || response.Response.StatusCode == 401 {</pre></code></td></tr><tr><td>180</td><td><code><pre>                                        klog.Errorf(&#34;configuration error (bad request) or unauthorized error while performing a GET using the authorizer&#34;)</pre></code></td></tr><tr><td>181</td><td><code><pre>                                        klog.Errorf(&#34;stopping GET retries&#34;)</pre></code></td></tr><tr><td>182</td><td><code><pre>                                        return utils.Retriable(false), e</pre></code></td></tr><tr><td>183</td><td><code><pre>                                }</pre></code></td></tr><tr><td>184</td><td><code><pre>                        }</pre></code></td></tr><tr><td>185</td><td><code><pre></pre></code></td></tr><tr><td>186</td><td><code><pre>                        klog.Errorf(e.Error())</pre></code></td></tr><tr><td>187</td><td><code><pre>                        if controllererrors.IsErrorCode(e, controllererrors.ErrorApplicationGatewayNotFound) {</pre></code></td></tr><tr><td>188</td><td><code><pre>                                return utils.Retriable(false), e</pre></code></td></tr><tr><td>189</td><td><code><pre>                        }</pre></code></td></tr><tr><td>190</td><td><code><pre></pre></code></td></tr><tr><td>191</td><td><code><pre>                        return utils.Retriable(true), e</pre></code></td></tr><tr><td>192</td><td><code><pre>                }</pre></code></td></tr></table>

<div class="funcname" id="fn_ConvertToClusterResourceGroup">func ConvertToClusterResourceGroup</div><div class="info"><a href="#s_fn_ConvertToClusterResourceGroup">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>76</td><td><code><pre>func ConvertToClusterResourceGroup(subscriptionID SubscriptionID, resourceGroup ResourceGroup, err error) (string, error) {</pre></code></td></tr><tr><td>77</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>                return &#34;&#34;, err</pre></code></td></tr><tr><td>79</td><td><code><pre>        }</pre></code></td></tr><tr><td>80</td><td><code><pre></pre></code></td></tr><tr><td>81</td><td><code><pre>        split := strings.Split(string(resourceGroup), &#34;_&#34;)</pre></code></td></tr><tr><td>82</td><td><code><pre>        if len(split) != 4 || strings.ToUpper(split[0]) != &#34;MC&#34; {</pre></code></td></tr><tr><td>83</td><td><code><pre>                err := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>84</td><td><code><pre>                        controllererrors.ErrorMissingResourceGroup,</pre></code></td></tr><tr><td>85</td><td><code><pre>                        &#34;infrastructure resource group name: %s is expected to be of format MC_ResourceGroup_ResourceName_Location&#34;, string(resourceGroup),</pre></code></td></tr><tr><td>86</td><td><code><pre>                )</pre></code></td></tr><tr><td>87</td><td><code><pre>                klog.V(5).Info(err.Error())</pre></code></td></tr><tr><td>88</td><td><code><pre>                return &#34;&#34;, err</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr><td>90</td><td><code><pre></pre></code></td></tr><tr><td>91</td><td><code><pre>        return fmt.Sprintf(&#34;/subscriptions/%s/resourcegroups/%s/providers/Microsoft.ContainerService/managedClusters/%s&#34;, subscriptionID, split[1], split[2]), nil</pre></code></td></tr><tr><td>92</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewAzClient">func NewAzClient</div><div class="info"><a href="#s_fn_NewAzClient">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>60</td><td><code><pre>func NewAzClient(subscriptionID SubscriptionID, resourceGroupName ResourceGroup, appGwName ResourceName, uniqueUserAgentSuffix, clientID string) AzClient {</pre></code></td></tr><tr><td>61</td><td><code><pre>        settings, err := auth.GetSettingsFromEnvironment()</pre></code></td></tr><tr><td>62</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>64</td><td><code><pre>        }</pre></code></td></tr><tr><td>65</td><td><code><pre></pre></code></td></tr><tr><td>66</td><td><code><pre>        userAgent := fmt.Sprintf(&#34;ingress-appgw/%s/%s&#34;, version.Version, uniqueUserAgentSuffix)</pre></code></td></tr><tr><td>67</td><td><code><pre>        az := &amp;azClient{</pre></code></td></tr><tr><td>68</td><td><code><pre>                appGatewaysClient:     n.NewApplicationGatewaysClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>69</td><td><code><pre>                publicIPsClient:       n.NewPublicIPAddressesClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>70</td><td><code><pre>                virtualNetworksClient: n.NewVirtualNetworksClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>71</td><td><code><pre>                subnetsClient:         n.NewSubnetsClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>72</td><td><code><pre>                routeTablesClient:     n.NewRouteTablesClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>73</td><td><code><pre>                groupsClient:          r.NewGroupsClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>74</td><td><code><pre>                deploymentsClient:     r.NewDeploymentsClientWithBaseURI(settings.Environment.ResourceManagerEndpoint, string(subscriptionID)),</pre></code></td></tr><tr><td>75</td><td><code><pre>                clientID:              clientID,</pre></code></td></tr><tr><td>76</td><td><code><pre></pre></code></td></tr><tr><td>77</td><td><code><pre>                subscriptionID:    subscriptionID,</pre></code></td></tr><tr><td>78</td><td><code><pre>                resourceGroupName: resourceGroupName,</pre></code></td></tr><tr><td>79</td><td><code><pre>                appGwName:         appGwName,</pre></code></td></tr><tr><td>80</td><td><code><pre>                memoizedIPs:       make(map[string]n.PublicIPAddress),</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>                ctx: context.Background(),</pre></code></td></tr><tr><td>83</td><td><code><pre>        }</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr><td>85</td><td><code><pre>        if err := az.appGatewaysClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to App Gateway client: &#34;, userAgent)</pre></code></td></tr><tr><td>87</td><td><code><pre>        }</pre></code></td></tr><tr><td>88</td><td><code><pre>        if err := az.publicIPsClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to Public IP client: &#34;, userAgent)</pre></code></td></tr><tr><td>90</td><td><code><pre>        }</pre></code></td></tr><tr><td>91</td><td><code><pre>        if err := az.virtualNetworksClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to Virtual Networks client: &#34;, userAgent)</pre></code></td></tr><tr><td>93</td><td><code><pre>        }</pre></code></td></tr><tr><td>94</td><td><code><pre>        if err := az.subnetsClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to Subnets client: &#34;, userAgent)</pre></code></td></tr><tr><td>96</td><td><code><pre>        }</pre></code></td></tr><tr><td>97</td><td><code><pre>        if err := az.routeTablesClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to Route Tables client: &#34;, userAgent)</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre>        if err := az.groupsClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>101</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to Groups client: &#34;, userAgent)</pre></code></td></tr><tr><td>102</td><td><code><pre>        }</pre></code></td></tr><tr><td>103</td><td><code><pre>        if err := az.deploymentsClient.AddToUserAgent(userAgent); err != nil {</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                klog.Error(&#34;Error adding User Agent to Deployments client: &#34;, userAgent)</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr><td>106</td><td><code><pre></pre></code></td></tr><tr><td>107</td><td><code><pre>        return az</pre></code></td></tr><tr><td>108</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ParseResourceID">func ParseResourceID</div><div class="info"><a href="#s_fn_ParseResourceID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/azure.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func ParseResourceID(ID string) (SubscriptionID, ResourceGroup, ResourceName) {</pre></code></td></tr><tr><td>35</td><td><code><pre>        split := strings.Split(ID, &#34;/&#34;)</pre></code></td></tr><tr><td>36</td><td><code><pre>        if len(split) &lt; 9 {</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                klog.Errorf(&#34;resourceID %s is invalid. There should be atleast 9 segments in resourceID&#34;, ID)</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                return &#34;&#34;, &#34;&#34;, &#34;&#34;</pre></code></td></tr><tr><td>39</td><td><code><pre>        }</pre></code></td></tr><tr><td>40</td><td><code><pre></pre></code></td></tr><tr><td>41</td><td><code><pre>        return SubscriptionID(split[2]), ResourceGroup(split[4]), ResourceName(split[8])</pre></code></td></tr><tr><td>42</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getAuthorizer">func getAuthorizer</div><div class="info"><a href="#s_fn_getAuthorizer">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/auth.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func getAuthorizer(authLocation string, useManagedidentity bool, cpConfig *CloudProviderConfig) (autorest.Authorizer, error) {</pre></code></td></tr><tr><td>35</td><td><code><pre>        // Authorizer logic:</pre></code></td></tr><tr><td>36</td><td><code><pre>        // 1. If User provided authLocation, then use the file.</pre></code></td></tr><tr><td>37</td><td><code><pre>        // 2. If User provided a managed identity in ex: helm config, then use Environment</pre></code></td></tr><tr><td>38</td><td><code><pre>        // 3. If User provided nothing and CloudProviderConfig has value, then use CloudProviderConfig</pre></code></td></tr><tr><td>39</td><td><code><pre>        // 4. Fall back to environment</pre></code></td></tr><tr><td>40</td><td><code><pre>        if authLocation != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                klog.V(1).Infof(&#34;Creating authorizer from file referenced by environment variable: %s&#34;, authLocation)</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                return auth.NewAuthorizerFromFile(n.DefaultBaseURI)</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr><tr><td>44</td><td><code><pre>        if !useManagedidentity &amp;&amp; cpConfig != nil {</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>                klog.V(1).Info(&#34;Creating authorizer using Cluster Service Principal.&#34;)</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                credAuthorizer := auth.NewClientCredentialsConfig(cpConfig.ClientID, cpConfig.ClientSecret, cpConfig.TenantID)</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr><td>48</td><td><code><pre>                // Set active directory endpoint using environment</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                azureEnv, _ := azure.EnvironmentFromName(cpConfig.Cloud)</pre></code></td></tr><tr class="miss"><td>50</td><td><code><pre>                credAuthorizer.AADEndpoint = azureEnv.ActiveDirectoryEndpoint</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>                credAuthorizer.Resource = azureEnv.ResourceManagerEndpoint</pre></code></td></tr><tr><td>52</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>                return credAuthorizer.Authorizer()</pre></code></td></tr><tr><td>54</td><td><code><pre>        }</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>        klog.V(1).Info(&#34;Creating authorizer from Azure Managed Service Identity&#34;)</pre></code></td></tr><tr><td>57</td><td><code><pre>        return auth.NewAuthorizerFromEnvironment()</pre></code></td></tr><tr><td>58</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.ApplyRouteTable">func azClient.ApplyRouteTable</div><div class="info"><a href="#s_fn_azClient.ApplyRouteTable">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>239</td><td><code><pre>func (az *azClient) ApplyRouteTable(subnetID string, routeTableID string) error {</pre></code></td></tr><tr><td>240</td><td><code><pre>        // Check if the route table exists</pre></code></td></tr><tr class="miss"><td>241</td><td><code><pre>        _, routeTableResourceGroup, routeTableName := ParseResourceID(routeTableID)</pre></code></td></tr><tr class="miss"><td>242</td><td><code><pre>        routeTable, err := az.routeTablesClient.Get(az.ctx, string(routeTableResourceGroup), string(routeTableName), &#34;&#34;)</pre></code></td></tr><tr><td>243</td><td><code><pre></pre></code></td></tr><tr><td>244</td><td><code><pre>        // if route table is not found, then simply add a log and return no error. routeTable will always be initialized.</pre></code></td></tr><tr class="miss"><td>245</td><td><code><pre>        if routeTable.Response.StatusCode == 404 {</pre></code></td></tr><tr class="miss"><td>246</td><td><code><pre>                klog.V(5).Infof(&#34;Error getting route table &#39;%s&#39; (this is relevant for AKS clusters using &#39;Kubenet&#39; network plugin): %s&#34;,</pre></code></td></tr><tr><td>247</td><td><code><pre>                        routeTableID,</pre></code></td></tr><tr><td>248</td><td><code><pre>                        err.Error())</pre></code></td></tr><tr class="miss"><td>249</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>250</td><td><code><pre>        }</pre></code></td></tr><tr><td>251</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>252</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>253</td><td><code><pre>                // no access or no route table</pre></code></td></tr><tr class="miss"><td>254</td><td><code><pre>                return err</pre></code></td></tr><tr><td>255</td><td><code><pre>        }</pre></code></td></tr><tr><td>256</td><td><code><pre></pre></code></td></tr><tr><td>257</td><td><code><pre>        // Get subnet and check if it is already associated to a route table</pre></code></td></tr><tr class="miss"><td>258</td><td><code><pre>        _, subnetResourceGroup, subnetVnetName, subnetName := ParseSubResourceID(subnetID)</pre></code></td></tr><tr class="miss"><td>259</td><td><code><pre>        subnet, err := az.subnetsClient.Get(az.ctx, string(subnetResourceGroup), string(subnetVnetName), string(subnetName), &#34;&#34;)</pre></code></td></tr><tr class="miss"><td>260</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>261</td><td><code><pre>                return err</pre></code></td></tr><tr><td>262</td><td><code><pre>        }</pre></code></td></tr><tr><td>263</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>264</td><td><code><pre>        if subnet.RouteTable != nil {</pre></code></td></tr><tr class="miss"><td>265</td><td><code><pre>                if *subnet.RouteTable.ID != routeTableID {</pre></code></td></tr><tr class="miss"><td>266</td><td><code><pre>                        klog.V(5).Infof(&#34;Skipping associating Application Gateway subnet &#39;%s&#39; with route table &#39;%s&#39; used by k8s cluster as it is already associated to route table &#39;%s&#39;.&#34;,</pre></code></td></tr><tr><td>267</td><td><code><pre>                                subnetID,</pre></code></td></tr><tr><td>268</td><td><code><pre>                                routeTableID,</pre></code></td></tr><tr><td>269</td><td><code><pre>                                *subnet.SubnetPropertiesFormat.RouteTable.ID)</pre></code></td></tr><tr><td>270</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>271</td><td><code><pre>                        klog.V(5).Infof(&#34;Application Gateway subnet &#39;%s&#39; is associated with route table &#39;%s&#39; used by k8s cluster.&#34;,</pre></code></td></tr><tr><td>272</td><td><code><pre>                                subnetID,</pre></code></td></tr><tr><td>273</td><td><code><pre>                                routeTableID)</pre></code></td></tr><tr><td>274</td><td><code><pre>                }</pre></code></td></tr><tr><td>275</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>276</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>277</td><td><code><pre>        }</pre></code></td></tr><tr><td>278</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>279</td><td><code><pre>        klog.Infof(&#34;Associating Application Gateway subnet &#39;%s&#39; with route table &#39;%s&#39; used by k8s cluster.&#34;, subnetID, routeTableID)</pre></code></td></tr><tr class="miss"><td>280</td><td><code><pre>        subnet.RouteTable = &amp;routeTable</pre></code></td></tr><tr><td>281</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>282</td><td><code><pre>        subnetFuture, err := az.subnetsClient.CreateOrUpdate(az.ctx, string(subnetResourceGroup), string(subnetVnetName), string(subnetName), subnet)</pre></code></td></tr><tr class="miss"><td>283</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>284</td><td><code><pre>                return err</pre></code></td></tr><tr><td>285</td><td><code><pre>        }</pre></code></td></tr><tr><td>286</td><td><code><pre></pre></code></td></tr><tr><td>287</td><td><code><pre>        // Wait until deployment finshes and save the error message</pre></code></td></tr><tr class="miss"><td>288</td><td><code><pre>        err = subnetFuture.WaitForCompletionRef(az.ctx, az.subnetsClient.BaseClient.Client)</pre></code></td></tr><tr class="miss"><td>289</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>290</td><td><code><pre>                return err</pre></code></td></tr><tr><td>291</td><td><code><pre>        }</pre></code></td></tr><tr><td>292</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>293</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>294</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.DeployGatewayWithVnet">func azClient.DeployGatewayWithVnet</div><div class="info"><a href="#s_fn_azClient.DeployGatewayWithVnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>297</td><td><code><pre>func (az *azClient) DeployGatewayWithVnet(resourceGroupName ResourceGroup, vnetName ResourceName, subnetName ResourceName, subnetPrefix, skuName string) (err error) {</pre></code></td></tr><tr class="miss"><td>298</td><td><code><pre>        vnet, err := az.getVnet(resourceGroupName, vnetName)</pre></code></td></tr><tr class="miss"><td>299</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>300</td><td><code><pre>                return</pre></code></td></tr><tr><td>301</td><td><code><pre>        }</pre></code></td></tr><tr><td>302</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>303</td><td><code><pre>        klog.Infof(&#34;Checking the Vnet %s for a subnet with prefix %s&#34;, vnetName, subnetPrefix)</pre></code></td></tr><tr class="miss"><td>304</td><td><code><pre>        subnet, err := az.findSubnet(vnet, subnetName, subnetPrefix)</pre></code></td></tr><tr class="miss"><td>305</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>306</td><td><code><pre>                if subnetPrefix == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>307</td><td><code><pre>                        klog.Infof(&#34;Unable to find a subnet with subnetName %s. Please provide subnetPrefix in order to allow AGIC to create a subnet in Vnet %s&#34;, subnetName, vnetName)</pre></code></td></tr><tr class="miss"><td>308</td><td><code><pre>                        return</pre></code></td></tr><tr><td>309</td><td><code><pre>                }</pre></code></td></tr><tr><td>310</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>311</td><td><code><pre>                klog.Infof(&#34;Unable to find a subnet. Creating a subnet %s with prefix %s in Vnet %s&#34;, subnetName, subnetPrefix, vnetName)</pre></code></td></tr><tr class="miss"><td>312</td><td><code><pre>                subnet, err = az.createSubnet(vnet, subnetName, subnetPrefix)</pre></code></td></tr><tr class="miss"><td>313</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>314</td><td><code><pre>                        return</pre></code></td></tr><tr><td>315</td><td><code><pre>                }</pre></code></td></tr><tr><td>316</td><td><code><pre>        }</pre></code></td></tr><tr><td>317</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>318</td><td><code><pre>        err = az.DeployGatewayWithSubnet(*subnet.ID, skuName)</pre></code></td></tr><tr class="miss"><td>319</td><td><code><pre>        return</pre></code></td></tr><tr><td>320</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.DeployGatewayWithSubnet">func azClient.DeployGatewayWithSubnet</div><div class="info"><a href="#s_fn_azClient.DeployGatewayWithSubnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>323</td><td><code><pre>func (az *azClient) DeployGatewayWithSubnet(subnetID, skuName string) (err error) {</pre></code></td></tr><tr class="miss"><td>324</td><td><code><pre>        klog.Infof(&#34;Deploying Gateway&#34;)</pre></code></td></tr><tr><td>325</td><td><code><pre></pre></code></td></tr><tr><td>326</td><td><code><pre>        // Check if group exists</pre></code></td></tr><tr class="miss"><td>327</td><td><code><pre>        group, err := az.getGroup()</pre></code></td></tr><tr class="miss"><td>328</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>329</td><td><code><pre>                return</pre></code></td></tr><tr><td>330</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>331</td><td><code><pre>        klog.Infof(&#34;Using resource group: %v&#34;, *group.Name)</pre></code></td></tr><tr><td>332</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>333</td><td><code><pre>        deploymentName := string(az.appGwName)</pre></code></td></tr><tr class="miss"><td>334</td><td><code><pre>        klog.Infof(&#34;Starting ARM template deployment: %s&#34;, deploymentName)</pre></code></td></tr><tr class="miss"><td>335</td><td><code><pre>        result, err := az.createDeployment(subnetID, skuName)</pre></code></td></tr><tr class="miss"><td>336</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>337</td><td><code><pre>                return</pre></code></td></tr><tr><td>338</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>339</td><td><code><pre>        if result.Name != nil {</pre></code></td></tr><tr class="miss"><td>340</td><td><code><pre>                klog.Infof(&#34;Completed deployment %v: %v&#34;, deploymentName, result.Properties.ProvisioningState)</pre></code></td></tr><tr><td>341</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>342</td><td><code><pre>                klog.Infof(&#34;Completed deployment %v (no data returned to SDK)&#34;, deploymentName)</pre></code></td></tr><tr><td>343</td><td><code><pre>        }</pre></code></td></tr><tr><td>344</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>345</td><td><code><pre>        return</pre></code></td></tr><tr><td>346</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewCloudProviderConfig">func NewCloudProviderConfig</div><div class="info"><a href="#s_fn_NewCloudProviderConfig">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/cloudproviderconfig.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func NewCloudProviderConfig(path string) (*CloudProviderConfig, error) {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>        b, err := ioutil.ReadFile(path)</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                return nil, fmt.Errorf(&#34;Reading Az Context file %q failed: %v&#34;, path, err)</pre></code></td></tr><tr><td>35</td><td><code><pre>        }</pre></code></td></tr><tr><td>36</td><td><code><pre></pre></code></td></tr><tr><td>37</td><td><code><pre>        // Unmarshal the authentication file.</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>        var context CloudProviderConfig</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>        if err := json.Unmarshal(b, &amp;context); err != nil {</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>41</td><td><code><pre>        }</pre></code></td></tr><tr><td>42</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>        if context.VNetResourceGroup == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>                context.VNetResourceGroup = context.ResourceGroup</pre></code></td></tr><tr><td>45</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>        if context.RouteTableResourceGroup == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                context.RouteTableResourceGroup = context.ResourceGroup</pre></code></td></tr><tr><td>48</td><td><code><pre>        }</pre></code></td></tr><tr><td>49</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>50</td><td><code><pre>        return &amp;context, nil</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.createDeployment">func azClient.createDeployment</div><div class="info"><a href="#s_fn_azClient.createDeployment">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>410</td><td><code><pre>func (az *azClient) createDeployment(subnetID, skuName string) (deployment r.DeploymentExtended, err error) {</pre></code></td></tr><tr class="miss"><td>411</td><td><code><pre>        template := getTemplate()</pre></code></td></tr><tr class="miss"><td>412</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>413</td><td><code><pre>                return</pre></code></td></tr><tr><td>414</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>415</td><td><code><pre>        params := map[string]interface{}{</pre></code></td></tr><tr><td>416</td><td><code><pre>                &#34;applicationGatewayName&#34;: map[string]string{</pre></code></td></tr><tr><td>417</td><td><code><pre>                        &#34;value&#34;: string(az.appGwName),</pre></code></td></tr><tr><td>418</td><td><code><pre>                },</pre></code></td></tr><tr><td>419</td><td><code><pre>                &#34;applicationGatewaySubnetId&#34;: map[string]string{</pre></code></td></tr><tr><td>420</td><td><code><pre>                        &#34;value&#34;: subnetID,</pre></code></td></tr><tr><td>421</td><td><code><pre>                },</pre></code></td></tr><tr><td>422</td><td><code><pre>                &#34;applicationGatewaySku&#34;: map[string]string{</pre></code></td></tr><tr><td>423</td><td><code><pre>                        &#34;value&#34;: skuName,</pre></code></td></tr><tr><td>424</td><td><code><pre>                },</pre></code></td></tr><tr><td>425</td><td><code><pre>        }</pre></code></td></tr><tr><td>426</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>427</td><td><code><pre>        deploymentFuture, err := az.deploymentsClient.CreateOrUpdate(</pre></code></td></tr><tr><td>428</td><td><code><pre>                az.ctx,</pre></code></td></tr><tr><td>429</td><td><code><pre>                string(az.resourceGroupName),</pre></code></td></tr><tr><td>430</td><td><code><pre>                string(az.appGwName),</pre></code></td></tr><tr><td>431</td><td><code><pre>                r.Deployment{</pre></code></td></tr><tr><td>432</td><td><code><pre>                        Properties: &amp;r.DeploymentProperties{</pre></code></td></tr><tr><td>433</td><td><code><pre>                                Template:   template,</pre></code></td></tr><tr><td>434</td><td><code><pre>                                Parameters: params,</pre></code></td></tr><tr><td>435</td><td><code><pre>                                Mode:       r.DeploymentModeIncremental,</pre></code></td></tr><tr><td>436</td><td><code><pre>                        },</pre></code></td></tr><tr><td>437</td><td><code><pre>                },</pre></code></td></tr><tr><td>438</td><td><code><pre>        )</pre></code></td></tr><tr class="miss"><td>439</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>440</td><td><code><pre>                return</pre></code></td></tr><tr><td>441</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>442</td><td><code><pre>        err = deploymentFuture.WaitForCompletionRef(az.ctx, az.deploymentsClient.BaseClient.Client)</pre></code></td></tr><tr class="miss"><td>443</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>444</td><td><code><pre>                return</pre></code></td></tr><tr><td>445</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>446</td><td><code><pre>        return deploymentFuture.Result(az.deploymentsClient)</pre></code></td></tr><tr><td>447</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.createSubnet">func azClient.createSubnet</div><div class="info"><a href="#s_fn_azClient.createSubnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>388</td><td><code><pre>func (az *azClient) createSubnet(vnet n.VirtualNetwork, subnetName ResourceName, subnetPrefix string) (subnet n.Subnet, err error) {</pre></code></td></tr><tr class="miss"><td>389</td><td><code><pre>        _, resourceGroup, vnetName := ParseResourceID(*vnet.ID)</pre></code></td></tr><tr class="miss"><td>390</td><td><code><pre>        subnet = n.Subnet{</pre></code></td></tr><tr><td>391</td><td><code><pre>                SubnetPropertiesFormat: &amp;n.SubnetPropertiesFormat{</pre></code></td></tr><tr><td>392</td><td><code><pre>                        AddressPrefix: &amp;subnetPrefix,</pre></code></td></tr><tr><td>393</td><td><code><pre>                },</pre></code></td></tr><tr><td>394</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>395</td><td><code><pre>        subnetFuture, err := az.subnetsClient.CreateOrUpdate(az.ctx, string(resourceGroup), string(vnetName), string(subnetName), subnet)</pre></code></td></tr><tr class="miss"><td>396</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>397</td><td><code><pre>                return</pre></code></td></tr><tr><td>398</td><td><code><pre>        }</pre></code></td></tr><tr><td>399</td><td><code><pre></pre></code></td></tr><tr><td>400</td><td><code><pre>        // Wait until deployment finshes and save the error message</pre></code></td></tr><tr class="miss"><td>401</td><td><code><pre>        err = subnetFuture.WaitForCompletionRef(az.ctx, az.subnetsClient.BaseClient.Client)</pre></code></td></tr><tr class="miss"><td>402</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>403</td><td><code><pre>                return</pre></code></td></tr><tr><td>404</td><td><code><pre>        }</pre></code></td></tr><tr><td>405</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>406</td><td><code><pre>        return az.subnetsClient.Get(az.ctx, string(resourceGroup), string(vnetName), string(subnetName), &#34;&#34;)</pre></code></td></tr><tr><td>407</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.GetPublicIP">func azClient.GetPublicIP</div><div class="info"><a href="#s_fn_azClient.GetPublicIP">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>224</td><td><code><pre>func (az *azClient) GetPublicIP(resourceID string) (n.PublicIPAddress, error) {</pre></code></td></tr><tr class="miss"><td>225</td><td><code><pre>        if ip, ok := az.memoizedIPs[resourceID]; ok {</pre></code></td></tr><tr class="miss"><td>226</td><td><code><pre>                return ip, nil</pre></code></td></tr><tr><td>227</td><td><code><pre>        }</pre></code></td></tr><tr><td>228</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>229</td><td><code><pre>        _, resourceGroupName, publicIPName := ParseResourceID(resourceID)</pre></code></td></tr><tr><td>230</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>231</td><td><code><pre>        ip, err := az.publicIPsClient.Get(az.ctx, string(resourceGroupName), string(publicIPName), &#34;&#34;)</pre></code></td></tr><tr class="miss"><td>232</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>233</td><td><code><pre>                return n.PublicIPAddress{}, err</pre></code></td></tr><tr><td>234</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>235</td><td><code><pre>        az.memoizedIPs[resourceID] = ip</pre></code></td></tr><tr class="miss"><td>236</td><td><code><pre>        return ip, nil</pre></code></td></tr><tr><td>237</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.UpdateGateway">func azClient.UpdateGateway</div><div class="info"><a href="#s_fn_azClient.UpdateGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>209</td><td><code><pre>func (az *azClient) UpdateGateway(appGwObj *n.ApplicationGateway) (err error) {</pre></code></td></tr><tr class="miss"><td>210</td><td><code><pre>        appGwFuture, err := az.appGatewaysClient.CreateOrUpdate(az.ctx, string(az.resourceGroupName), string(az.appGwName), *appGwObj)</pre></code></td></tr><tr class="miss"><td>211</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>212</td><td><code><pre>                return</pre></code></td></tr><tr><td>213</td><td><code><pre>        }</pre></code></td></tr><tr><td>214</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>215</td><td><code><pre>        if appGwFuture.PollingURL() != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>216</td><td><code><pre>                klog.V(3).Infof(&#34;OperationID=&#39;%s&#39;&#34;, GetOperationIDFromPollingURL(appGwFuture.PollingURL()))</pre></code></td></tr><tr><td>217</td><td><code><pre>        }</pre></code></td></tr><tr><td>218</td><td><code><pre></pre></code></td></tr><tr><td>219</td><td><code><pre>        // Wait until deployment finshes and save the error message</pre></code></td></tr><tr class="miss"><td>220</td><td><code><pre>        err = appGwFuture.WaitForCompletionRef(az.ctx, az.appGatewaysClient.BaseClient.Client)</pre></code></td></tr><tr class="miss"><td>221</td><td><code><pre>        return</pre></code></td></tr><tr><td>222</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.SetAuthorizer">func azClient.SetAuthorizer</div><div class="info"><a href="#s_fn_azClient.SetAuthorizer">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>110</td><td><code><pre>func (az *azClient) SetAuthorizer(authorizer autorest.Authorizer) {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>        az.appGatewaysClient.Authorizer = authorizer</pre></code></td></tr><tr class="miss"><td>112</td><td><code><pre>        az.publicIPsClient.Authorizer = authorizer</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>        az.virtualNetworksClient.Authorizer = authorizer</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>        az.subnetsClient.Authorizer = authorizer</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>        az.routeTablesClient.Authorizer = authorizer</pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>        az.groupsClient.Authorizer = authorizer</pre></code></td></tr><tr class="miss"><td>117</td><td><code><pre>        az.deploymentsClient.Authorizer = authorizer</pre></code></td></tr><tr><td>118</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.WaitForGetAccessOnGateway">func FakeAzClient.WaitForGetAccessOnGateway</div><div class="info"><a href="#s_fn_FakeAzClient.WaitForGetAccessOnGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>64</td><td><code><pre>func (az *FakeAzClient) WaitForGetAccessOnGateway(maxRetryCount int) error {</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>        if az.GetGatewayFunc != nil {</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>                for {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                        _, err := az.GetGatewayFunc()</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                        if err == nil {</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>                                return nil</pre></code></td></tr><tr><td>70</td><td><code><pre>                        }</pre></code></td></tr><tr><td>71</td><td><code><pre>                }</pre></code></td></tr><tr><td>72</td><td><code><pre>        }</pre></code></td></tr><tr><td>73</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>75</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.findSubnet">func azClient.findSubnet</div><div class="info"><a href="#s_fn_azClient.findSubnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>375</td><td><code><pre>func (az *azClient) findSubnet(vnet n.VirtualNetwork, subnetName ResourceName, subnetPrefix string) (subnet n.Subnet, err error) {</pre></code></td></tr><tr class="miss"><td>376</td><td><code><pre>        for _, subnet := range *vnet.Subnets {</pre></code></td></tr><tr class="miss"><td>377</td><td><code><pre>                if string(subnetName) == *subnet.Name &amp;&amp; (subnetPrefix == &#34;&#34; || subnetPrefix == *subnet.AddressPrefix) {</pre></code></td></tr><tr class="miss"><td>378</td><td><code><pre>                        return subnet, nil</pre></code></td></tr><tr><td>379</td><td><code><pre>                }</pre></code></td></tr><tr><td>380</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>381</td><td><code><pre>        err = controllererrors.NewErrorf(</pre></code></td></tr><tr><td>382</td><td><code><pre>                controllererrors.ErrorSubnetNotFound,</pre></code></td></tr><tr><td>383</td><td><code><pre>                &#34;Unable to find subnet with matching subnetName %s and subnetPrefix %s in virtual network %s&#34;, subnetName, subnetPrefix, *vnet.ID,</pre></code></td></tr><tr><td>384</td><td><code><pre>        )</pre></code></td></tr><tr class="miss"><td>385</td><td><code><pre>        return</pre></code></td></tr><tr><td>386</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@351:3">func @351:3</div><div class="info"><a href="#s_fn_@351:3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>351</td><td><code><pre>func() (utils.Retriable, error) {</pre></code></td></tr><tr class="miss"><td>352</td><td><code><pre>                        group, err = az.groupsClient.Get(az.ctx, string(az.resourceGroupName))</pre></code></td></tr><tr class="miss"><td>353</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>354</td><td><code><pre>                                klog.Errorf(&#34;Error while getting resource group &#39;%s&#39;: %s&#34;, az.resourceGroupName, err)</pre></code></td></tr><tr><td>355</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>356</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>357</td><td><code><pre>                }</pre></code></td></tr></table>

<div class="funcname" id="fn_getTemplate">func getTemplate</div><div class="info"><a href="#s_fn_getTemplate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>449</td><td><code><pre>func getTemplate() map[string]interface{} {</pre></code></td></tr><tr class="miss"><td>450</td><td><code><pre>        template := `</pre></code></td></tr><tr><td>451</td><td><code><pre>        {</pre></code></td></tr><tr><td>452</td><td><code><pre>                &#34;$schema&#34;: &#34;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#34;,</pre></code></td></tr><tr><td>453</td><td><code><pre>                &#34;contentVersion&#34;: &#34;1.0.0.0&#34;,</pre></code></td></tr><tr><td>454</td><td><code><pre>                &#34;parameters&#34;: {</pre></code></td></tr><tr><td>455</td><td><code><pre>                        &#34;applicationGatewayName&#34;: {</pre></code></td></tr><tr><td>456</td><td><code><pre>                                &#34;defaultValue&#34;: &#34;appgw&#34;,</pre></code></td></tr><tr><td>457</td><td><code><pre>                                &#34;type&#34;: &#34;string&#34;,</pre></code></td></tr><tr><td>458</td><td><code><pre>                                &#34;metadata&#34;: {</pre></code></td></tr><tr><td>459</td><td><code><pre>                                        &#34;description&#34;: &#34;Name of the Application Gateway.&#34;</pre></code></td></tr><tr><td>460</td><td><code><pre>                                }</pre></code></td></tr><tr><td>461</td><td><code><pre>                        },</pre></code></td></tr><tr><td>462</td><td><code><pre>                        &#34;applicationGatewaySubnetId&#34;: {</pre></code></td></tr><tr><td>463</td><td><code><pre>                                &#34;type&#34;: &#34;string&#34;,</pre></code></td></tr><tr><td>464</td><td><code><pre>                                &#34;metadata&#34;: {</pre></code></td></tr><tr><td>465</td><td><code><pre>                                        &#34;description&#34;: &#34;Resource Id of Subnet in which Application Gateway will be deployed.&#34;</pre></code></td></tr><tr><td>466</td><td><code><pre>                                }</pre></code></td></tr><tr><td>467</td><td><code><pre>                        },</pre></code></td></tr><tr><td>468</td><td><code><pre>                        &#34;applicationGatewaySku&#34;: {</pre></code></td></tr><tr><td>469</td><td><code><pre>                                &#34;allowedValues&#34;: [</pre></code></td></tr><tr><td>470</td><td><code><pre>                                        &#34;Standard_v2&#34;,</pre></code></td></tr><tr><td>471</td><td><code><pre>                                        &#34;WAF_v2&#34;</pre></code></td></tr><tr><td>472</td><td><code><pre>                                ],</pre></code></td></tr><tr><td>473</td><td><code><pre>                                &#34;type&#34;: &#34;string&#34;,</pre></code></td></tr><tr><td>474</td><td><code><pre>                                &#34;metadata&#34;: {</pre></code></td></tr><tr><td>475</td><td><code><pre>                                        &#34;description&#34;: &#34;The sku of the Application Gateway. Default: WAF_v2 (Detection mode). In order to further customize WAF, use azure portal or cli.&#34;</pre></code></td></tr><tr><td>476</td><td><code><pre>                                }</pre></code></td></tr><tr><td>477</td><td><code><pre>                        }</pre></code></td></tr><tr><td>478</td><td><code><pre>                },</pre></code></td></tr><tr><td>479</td><td><code><pre>                &#34;variables&#34;: {</pre></code></td></tr><tr><td>480</td><td><code><pre>                        &#34;resgpguid&#34;: &#34;[substring(replace(guid(resourceGroup().id), &#39;-&#39;, &#39;&#39;), 0, 4)]&#34;,</pre></code></td></tr><tr><td>481</td><td><code><pre>                        &#34;vnetName&#34;: &#34;[concat(&#39;virtualnetwork&#39; , variables(&#39;resgpguid&#39;))]&#34;,</pre></code></td></tr><tr><td>482</td><td><code><pre>                        &#34;applicationGatewayPublicIpName&#34;: &#34;[concat(parameters(&#39;applicationGatewayName&#39;), &#39;-appgwpip&#39;)]&#34;,</pre></code></td></tr><tr><td>483</td><td><code><pre>                        &#34;applicationGatewayPublicIpId&#34;: &#34;[resourceId(&#39;Microsoft.Network/publicIPAddresses&#39;,variables(&#39;applicationGatewayPublicIpName&#39;))]&#34;,</pre></code></td></tr><tr><td>484</td><td><code><pre>                        &#34;applicationGatewayId&#34;: &#34;[resourceId(&#39;Microsoft.Network/applicationGateways&#39;, parameters(&#39;applicationGatewayName&#39;))]&#34;,</pre></code></td></tr><tr><td>485</td><td><code><pre>                        &#34;webApplicationFirewallConfiguration&#34;: {</pre></code></td></tr><tr><td>486</td><td><code><pre>                          &#34;enabled&#34;: &#34;true&#34;,</pre></code></td></tr><tr><td>487</td><td><code><pre>                          &#34;firewallMode&#34;: &#34;Detection&#34;</pre></code></td></tr><tr><td>488</td><td><code><pre>                        }</pre></code></td></tr><tr><td>489</td><td><code><pre>                },</pre></code></td></tr><tr><td>490</td><td><code><pre>                &#34;resources&#34;: [</pre></code></td></tr><tr><td>491</td><td><code><pre>                        {</pre></code></td></tr><tr><td>492</td><td><code><pre>                                &#34;type&#34;: &#34;Microsoft.Network/publicIPAddresses&#34;,</pre></code></td></tr><tr><td>493</td><td><code><pre>                                &#34;name&#34;: &#34;[variables(&#39;applicationGatewayPublicIpName&#39;)]&#34;,</pre></code></td></tr><tr><td>494</td><td><code><pre>                                &#34;apiVersion&#34;: &#34;2018-08-01&#34;,</pre></code></td></tr><tr><td>495</td><td><code><pre>                                &#34;location&#34;: &#34;[resourceGroup().location]&#34;,</pre></code></td></tr><tr><td>496</td><td><code><pre>                                &#34;sku&#34;: {</pre></code></td></tr><tr><td>497</td><td><code><pre>                                        &#34;name&#34;: &#34;Standard&#34;</pre></code></td></tr><tr><td>498</td><td><code><pre>                                },</pre></code></td></tr><tr><td>499</td><td><code><pre>                                &#34;properties&#34;: {</pre></code></td></tr><tr><td>500</td><td><code><pre>                                        &#34;publicIPAllocationMethod&#34;: &#34;Static&#34;</pre></code></td></tr><tr><td>501</td><td><code><pre>                                }</pre></code></td></tr><tr><td>502</td><td><code><pre>                        },</pre></code></td></tr><tr><td>503</td><td><code><pre>                        {</pre></code></td></tr><tr><td>504</td><td><code><pre>                                &#34;type&#34;: &#34;Microsoft.Network/applicationGateways&#34;,</pre></code></td></tr><tr><td>505</td><td><code><pre>                                &#34;name&#34;: &#34;[parameters(&#39;applicationGatewayName&#39;)]&#34;,</pre></code></td></tr><tr><td>506</td><td><code><pre>                                &#34;apiVersion&#34;: &#34;2018-08-01&#34;,</pre></code></td></tr><tr><td>507</td><td><code><pre>                                &#34;location&#34;: &#34;[resourceGroup().location]&#34;,</pre></code></td></tr><tr><td>508</td><td><code><pre>                                &#34;tags&#34;: {</pre></code></td></tr><tr><td>509</td><td><code><pre>                                        &#34;managed-by-k8s-ingress&#34;: &#34;true&#34;,</pre></code></td></tr><tr><td>510</td><td><code><pre>                                        &#34;created-by&#34;: &#34;ingress-appgw&#34;</pre></code></td></tr><tr><td>511</td><td><code><pre>                                },</pre></code></td></tr><tr><td>512</td><td><code><pre>                                &#34;properties&#34;: {</pre></code></td></tr><tr><td>513</td><td><code><pre>                                        &#34;sku&#34;: {</pre></code></td></tr><tr><td>514</td><td><code><pre>                                                &#34;name&#34;: &#34;[parameters(&#39;applicationGatewaySku&#39;)]&#34;,</pre></code></td></tr><tr><td>515</td><td><code><pre>                                                &#34;tier&#34;: &#34;[parameters(&#39;applicationGatewaySku&#39;)]&#34;,</pre></code></td></tr><tr><td>516</td><td><code><pre>                                                &#34;capacity&#34;: 2</pre></code></td></tr><tr><td>517</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>518</td><td><code><pre>                                        &#34;gatewayIPConfigurations&#34;: [</pre></code></td></tr><tr><td>519</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>520</td><td><code><pre>                                                        &#34;name&#34;: &#34;appGatewayIpConfig&#34;,</pre></code></td></tr><tr><td>521</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>522</td><td><code><pre>                                                                &#34;subnet&#34;: {</pre></code></td></tr><tr><td>523</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[parameters(&#39;applicationGatewaySubnetId&#39;)]&#34;</pre></code></td></tr><tr><td>524</td><td><code><pre>                                                                }</pre></code></td></tr><tr><td>525</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>526</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>527</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>528</td><td><code><pre>                                        &#34;frontendIPConfigurations&#34;: [</pre></code></td></tr><tr><td>529</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>530</td><td><code><pre>                                                        &#34;name&#34;: &#34;appGatewayFrontendIP&#34;,</pre></code></td></tr><tr><td>531</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>532</td><td><code><pre>                                                                &#34;PublicIPAddress&#34;: {</pre></code></td></tr><tr><td>533</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[variables(&#39;applicationGatewayPublicIpId&#39;)]&#34;</pre></code></td></tr><tr><td>534</td><td><code><pre>                                                                }</pre></code></td></tr><tr><td>535</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>536</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>537</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>538</td><td><code><pre>                                        &#34;frontendPorts&#34;: [</pre></code></td></tr><tr><td>539</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>540</td><td><code><pre>                                                        &#34;name&#34;: &#34;httpPort&#34;,</pre></code></td></tr><tr><td>541</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>542</td><td><code><pre>                                                                &#34;Port&#34;: 80</pre></code></td></tr><tr><td>543</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>544</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>545</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>546</td><td><code><pre>                                                        &#34;name&#34;: &#34;httpsPort&#34;,</pre></code></td></tr><tr><td>547</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>548</td><td><code><pre>                                                                &#34;Port&#34;: 443</pre></code></td></tr><tr><td>549</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>550</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>551</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>552</td><td><code><pre>                                        &#34;backendAddressPools&#34;: [</pre></code></td></tr><tr><td>553</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>554</td><td><code><pre>                                                        &#34;name&#34;: &#34;bepool&#34;,</pre></code></td></tr><tr><td>555</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>556</td><td><code><pre>                                                                &#34;backendAddresses&#34;: []</pre></code></td></tr><tr><td>557</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>558</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>559</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>560</td><td><code><pre>                                        &#34;httpListeners&#34;: [</pre></code></td></tr><tr><td>561</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>562</td><td><code><pre>                                                        &#34;name&#34;: &#34;httpListener&#34;,</pre></code></td></tr><tr><td>563</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>564</td><td><code><pre>                                                                &#34;protocol&#34;: &#34;Http&#34;,</pre></code></td></tr><tr><td>565</td><td><code><pre>                                                                &#34;frontendPort&#34;: {</pre></code></td></tr><tr><td>566</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[concat(variables(&#39;applicationGatewayId&#39;), &#39;/frontendPorts/httpPort&#39;)]&#34;</pre></code></td></tr><tr><td>567</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>568</td><td><code><pre>                                                                &#34;frontendIPConfiguration&#34;: {</pre></code></td></tr><tr><td>569</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[concat(variables(&#39;applicationGatewayId&#39;), &#39;/frontendIPConfigurations/appGatewayFrontendIP&#39;)]&#34;</pre></code></td></tr><tr><td>570</td><td><code><pre>                                                                }</pre></code></td></tr><tr><td>571</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>572</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>573</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>574</td><td><code><pre>                                        &#34;backendHttpSettingsCollection&#34;: [</pre></code></td></tr><tr><td>575</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>576</td><td><code><pre>                                                        &#34;name&#34;: &#34;setting&#34;,</pre></code></td></tr><tr><td>577</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>578</td><td><code><pre>                                                                &#34;port&#34;: 80,</pre></code></td></tr><tr><td>579</td><td><code><pre>                                                                &#34;protocol&#34;: &#34;Http&#34;</pre></code></td></tr><tr><td>580</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>581</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>582</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>583</td><td><code><pre>                                        &#34;requestRoutingRules&#34;: [</pre></code></td></tr><tr><td>584</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>585</td><td><code><pre>                                                        &#34;name&#34;: &#34;rule1&#34;,</pre></code></td></tr><tr><td>586</td><td><code><pre>                                                        &#34;properties&#34;: {</pre></code></td></tr><tr><td>587</td><td><code><pre>                                                                &#34;httpListener&#34;: {</pre></code></td></tr><tr><td>588</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[concat(variables(&#39;applicationGatewayId&#39;), &#39;/httpListeners/httpListener&#39;)]&#34;</pre></code></td></tr><tr><td>589</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>590</td><td><code><pre>                                                                &#34;backendAddressPool&#34;: {</pre></code></td></tr><tr><td>591</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[concat(variables(&#39;applicationGatewayId&#39;), &#39;/backendAddressPools/bepool&#39;)]&#34;</pre></code></td></tr><tr><td>592</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>593</td><td><code><pre>                                                                &#34;backendHttpSettings&#34;: {</pre></code></td></tr><tr><td>594</td><td><code><pre>                                                                        &#34;id&#34;: &#34;[concat(variables(&#39;applicationGatewayId&#39;), &#39;/backendHttpSettingsCollection/setting&#39;)]&#34;</pre></code></td></tr><tr><td>595</td><td><code><pre>                                                                }</pre></code></td></tr><tr><td>596</td><td><code><pre>                                                        }</pre></code></td></tr><tr><td>597</td><td><code><pre>                                                }</pre></code></td></tr><tr><td>598</td><td><code><pre>                                        ],</pre></code></td></tr><tr><td>599</td><td><code><pre>                                        &#34;webApplicationFirewallConfiguration&#34;: &#34;[if(equals(parameters(&#39;applicationGatewaySku&#39;), &#39;WAF_v2&#39;), variables(&#39;webApplicationFirewallConfiguration&#39;), json(&#39;null&#39;))]&#34;</pre></code></td></tr><tr><td>600</td><td><code><pre>                                },</pre></code></td></tr><tr><td>601</td><td><code><pre>                                &#34;dependsOn&#34;: [</pre></code></td></tr><tr><td>602</td><td><code><pre>                                        &#34;[concat(&#39;Microsoft.Network/publicIPAddresses/&#39;, variables(&#39;applicationGatewayPublicIpName&#39;))]&#34;</pre></code></td></tr><tr><td>603</td><td><code><pre>                                ]</pre></code></td></tr><tr><td>604</td><td><code><pre>                        }</pre></code></td></tr><tr><td>605</td><td><code><pre>                ],</pre></code></td></tr><tr><td>606</td><td><code><pre>                &#34;outputs&#34;: {</pre></code></td></tr><tr><td>607</td><td><code><pre>                        &#34;subscriptionId&#34;: {</pre></code></td></tr><tr><td>608</td><td><code><pre>                                &#34;type&#34;: &#34;string&#34;,</pre></code></td></tr><tr><td>609</td><td><code><pre>                                &#34;value&#34;: &#34;[subscription().subscriptionId]&#34;</pre></code></td></tr><tr><td>610</td><td><code><pre>                        },</pre></code></td></tr><tr><td>611</td><td><code><pre>                        &#34;resourceGroupName&#34;: {</pre></code></td></tr><tr><td>612</td><td><code><pre>                                &#34;type&#34;: &#34;string&#34;,</pre></code></td></tr><tr><td>613</td><td><code><pre>                                &#34;value&#34;: &#34;[resourceGroup().name]&#34;</pre></code></td></tr><tr><td>614</td><td><code><pre>                        },</pre></code></td></tr><tr><td>615</td><td><code><pre>                        &#34;applicationGatewayName&#34;: {</pre></code></td></tr><tr><td>616</td><td><code><pre>                                &#34;type&#34;: &#34;string&#34;,</pre></code></td></tr><tr><td>617</td><td><code><pre>                                &#34;value&#34;: &#34;[parameters(&#39;applicationGatewayName&#39;)]&#34;</pre></code></td></tr><tr><td>618</td><td><code><pre>                        }</pre></code></td></tr><tr><td>619</td><td><code><pre>                }</pre></code></td></tr><tr><td>620</td><td><code><pre>        }`</pre></code></td></tr><tr><td>621</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>622</td><td><code><pre>        contents := make(map[string]interface{})</pre></code></td></tr><tr class="miss"><td>623</td><td><code><pre>        json.Unmarshal([]byte(template), &amp;contents)</pre></code></td></tr><tr class="miss"><td>624</td><td><code><pre>        return contents</pre></code></td></tr><tr><td>625</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@199:3">func @199:3</div><div class="info"><a href="#s_fn_@199:3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>199</td><td><code><pre>func() (utils.Retriable, error) {</pre></code></td></tr><tr class="miss"><td>200</td><td><code><pre>                        gateway, err = az.appGatewaysClient.Get(az.ctx, string(az.resourceGroupName), string(az.appGwName))</pre></code></td></tr><tr class="miss"><td>201</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>202</td><td><code><pre>                                klog.Errorf(&#34;Error while getting application gateway &#39;%s&#39;: %s&#34;, string(az.appGwName), err)</pre></code></td></tr><tr><td>203</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>204</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>205</td><td><code><pre>                }</pre></code></td></tr></table>

<div class="funcname" id="fn_@364:3">func @364:3</div><div class="info"><a href="#s_fn_@364:3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>364</td><td><code><pre>func() (utils.Retriable, error) {</pre></code></td></tr><tr class="miss"><td>365</td><td><code><pre>                        vnet, err = az.virtualNetworksClient.Get(az.ctx, string(resourceGroupName), string(vnetName), &#34;&#34;)</pre></code></td></tr><tr class="miss"><td>366</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr class="miss"><td>367</td><td><code><pre>                                klog.Errorf(&#34;Error while getting virtual network &#39;%s&#39;: %s&#34;, vnetName, err)</pre></code></td></tr><tr><td>368</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>369</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>370</td><td><code><pre>                }</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.GetGateway">func FakeAzClient.GetGateway</div><div class="info"><a href="#s_fn_FakeAzClient.GetGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>56</td><td><code><pre>func (az *FakeAzClient) GetGateway() (n.ApplicationGateway, error) {</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>        if az.GetGatewayFunc != nil {</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                return az.GetGatewayFunc()</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>        return n.ApplicationGateway{}, nil</pre></code></td></tr><tr><td>61</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.GetPublicIP">func FakeAzClient.GetPublicIP</div><div class="info"><a href="#s_fn_FakeAzClient.GetPublicIP">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>102</td><td><code><pre>func (az *FakeAzClient) GetPublicIP(resourceID string) (n.PublicIPAddress, error) {</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        if az.GetPublicIPFunc != nil {</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                return az.GetPublicIPFunc(resourceID)</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>        return n.PublicIPAddress{}, nil</pre></code></td></tr><tr><td>107</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.DeployGatewayWithVnet">func FakeAzClient.DeployGatewayWithVnet</div><div class="info"><a href="#s_fn_FakeAzClient.DeployGatewayWithVnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>94</td><td><code><pre>func (az *FakeAzClient) DeployGatewayWithVnet(resourceGroupName ResourceGroup, vnetName ResourceName, subnetName ResourceName, subnetPrefix, skuName string) (err error) {</pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>        if az.DeployGatewayFunc != nil {</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>                return az.DeployGatewayFunc(subnetPrefix)</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>99</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.DeployGatewayWithSubnet">func FakeAzClient.DeployGatewayWithSubnet</div><div class="info"><a href="#s_fn_FakeAzClient.DeployGatewayWithSubnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>86</td><td><code><pre>func (az *FakeAzClient) DeployGatewayWithSubnet(subnetID, skuName string) (err error) {</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>        if az.DeployGatewayFunc != nil {</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>                return az.DeployGatewayFunc(subnetID)</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>91</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.UpdateGateway">func FakeAzClient.UpdateGateway</div><div class="info"><a href="#s_fn_FakeAzClient.UpdateGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>78</td><td><code><pre>func (az *FakeAzClient) UpdateGateway(appGwObj *n.ApplicationGateway) (err error) {</pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>        if az.UpdateGatewayFunc != nil {</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>                return az.UpdateGatewayFunc(appGwObj)</pre></code></td></tr><tr><td>81</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>83</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.ApplyRouteTable">func FakeAzClient.ApplyRouteTable</div><div class="info"><a href="#s_fn_FakeAzClient.ApplyRouteTable">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>110</td><td><code><pre>func (az *FakeAzClient) ApplyRouteTable(subnetID string, routeTableID string) error {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>        if az.ApplyRouteTableFunc != nil {</pre></code></td></tr><tr class="miss"><td>112</td><td><code><pre>                return az.ApplyRouteTableFunc(subnetID, routeTableID)</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>115</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.GetGateway">func azClient.GetGateway</div><div class="info"><a href="#s_fn_azClient.GetGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>197</td><td><code><pre>func (az *azClient) GetGateway() (gateway n.ApplicationGateway, err error) {</pre></code></td></tr><tr class="miss"><td>198</td><td><code><pre>        err = utils.Retry(retryCount, retryPause,</pre></code></td></tr><tr><td>199</td><td><code><pre>                func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>200</td><td><code><pre>                        gateway, err = az.appGatewaysClient.Get(az.ctx, string(az.resourceGroupName), string(az.appGwName))</pre></code></td></tr><tr><td>201</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr><td>202</td><td><code><pre>                                klog.Errorf(&#34;Error while getting application gateway &#39;%s&#39;: %s&#34;, string(az.appGwName), err)</pre></code></td></tr><tr><td>203</td><td><code><pre>                        }</pre></code></td></tr><tr><td>204</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>205</td><td><code><pre>                })</pre></code></td></tr><tr class="miss"><td>206</td><td><code><pre>        return</pre></code></td></tr><tr><td>207</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.getGroup">func azClient.getGroup</div><div class="info"><a href="#s_fn_azClient.getGroup">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>349</td><td><code><pre>func (az *azClient) getGroup() (group r.Group, err error) {</pre></code></td></tr><tr class="miss"><td>350</td><td><code><pre>        utils.Retry(retryCount, retryPause,</pre></code></td></tr><tr><td>351</td><td><code><pre>                func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>352</td><td><code><pre>                        group, err = az.groupsClient.Get(az.ctx, string(az.resourceGroupName))</pre></code></td></tr><tr><td>353</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr><td>354</td><td><code><pre>                                klog.Errorf(&#34;Error while getting resource group &#39;%s&#39;: %s&#34;, az.resourceGroupName, err)</pre></code></td></tr><tr><td>355</td><td><code><pre>                        }</pre></code></td></tr><tr><td>356</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>357</td><td><code><pre>                })</pre></code></td></tr><tr><td>358</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>359</td><td><code><pre>        return</pre></code></td></tr><tr><td>360</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_azClient.getVnet">func azClient.getVnet</div><div class="info"><a href="#s_fn_azClient.getVnet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/client.go</code>:</p></div><table class="listing">
<tr><td>362</td><td><code><pre>func (az *azClient) getVnet(resourceGroupName ResourceGroup, vnetName ResourceName) (vnet n.VirtualNetwork, err error) {</pre></code></td></tr><tr class="miss"><td>363</td><td><code><pre>        utils.Retry(extendedRetryCount, retryPause,</pre></code></td></tr><tr><td>364</td><td><code><pre>                func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>365</td><td><code><pre>                        vnet, err = az.virtualNetworksClient.Get(az.ctx, string(resourceGroupName), string(vnetName), &#34;&#34;)</pre></code></td></tr><tr><td>366</td><td><code><pre>                        if err != nil {</pre></code></td></tr><tr><td>367</td><td><code><pre>                                klog.Errorf(&#34;Error while getting virtual network &#39;%s&#39;: %s&#34;, vnetName, err)</pre></code></td></tr><tr><td>368</td><td><code><pre>                        }</pre></code></td></tr><tr><td>369</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>370</td><td><code><pre>                })</pre></code></td></tr><tr><td>371</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>372</td><td><code><pre>        return</pre></code></td></tr><tr><td>373</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewFakeAzClient">func NewFakeAzClient</div><div class="info"><a href="#s_fn_NewFakeAzClient">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>39</td><td><code><pre>func NewFakeAzClient() *FakeAzClient {</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>        return &amp;FakeAzClient{}</pre></code></td></tr><tr><td>41</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.SetSender">func FakeAzClient.SetSender</div><div class="info"><a href="#s_fn_FakeAzClient.SetSender">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>48</td><td><code><pre>func (az *FakeAzClient) SetSender(sender autorest.Sender) {</pre></code></td></tr><tr><td>49</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.SetAuthorizer">func FakeAzClient.SetAuthorizer</div><div class="info"><a href="#s_fn_FakeAzClient.SetAuthorizer">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>44</td><td><code><pre>func (az *FakeAzClient) SetAuthorizer(authorizer autorest.Authorizer) {</pre></code></td></tr><tr><td>45</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeAzClient.SetDuration">func FakeAzClient.SetDuration</div><div class="info"><a href="#s_fn_FakeAzClient.SetDuration">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/azure/fake.go</code>:</p></div><table class="listing">
<tr><td>52</td><td><code><pre>func (az *FakeAzClient) SetDuration(retryDuration int) {</pre></code></td></tr><tr><td>53</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/azure DONE:29.41
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield <span class="packageTotal">69.40%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_ExistingResources.getBlacklistedListenersSet"><td><code><a href="#fn_ExistingResources.getBlacklistedListenersSet">ExistingResources.getBlacklistedListenersSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>18/18</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedProbes"><td><code><a href="#fn_ExistingResources.GetBlacklistedProbes">ExistingResources.GetBlacklistedProbes(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>11/11</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedPools"><td><code><a href="#fn_ExistingResources.GetBlacklistedPools">ExistingResources.GetBlacklistedPools(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>11/11</code></td></tr>
<tr id="s_fn_MergeRules"><td><code><a href="#fn_MergeRules">MergeRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>11/11</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedListeners"><td><code><a href="#fn_ExistingResources.GetBlacklistedListeners">ExistingResources.GetBlacklistedListeners(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>11/11</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedHTTPSettings"><td><code><a href="#fn_ExistingResources.GetBlacklistedHTTPSettings">ExistingResources.GetBlacklistedHTTPSettings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>11/11</code></td></tr>
<tr id="s_fn_deletePathMap"><td><code><a href="#fn_deletePathMap">deletePathMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>10/10</code></td></tr>
<tr id="s_fn_Target.IsBlacklisted"><td><code><a href="#fn_Target.IsBlacklisted">Target.IsBlacklisted(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>9/9</code></td></tr>
<tr id="s_fn_MergeHTTPSettings"><td><code><a href="#fn_MergeHTTPSettings">MergeHTTPSettings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_MergeCerts"><td><code><a href="#fn_MergeCerts">MergeCerts(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_MergePools"><td><code><a href="#fn_MergePools">MergePools(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_MergeProbes"><td><code><a href="#fn_MergeProbes">MergeProbes(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_ExistingResources.getBlacklistedProbesSet"><td><code><a href="#fn_ExistingResources.getBlacklistedProbesSet">ExistingResources.getBlacklistedProbesSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_@35:19"><td><code><a href="#fn_@35:19">@35:19(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_GetTargetBlacklist"><td><code><a href="#fn_GetTargetBlacklist">GetTargetBlacklist(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_@33:19"><td><code><a href="#fn_@33:19">@33:19(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_ExistingResources.getProhibitedHostNames"><td><code><a href="#fn_ExistingResources.getProhibitedHostNames">ExistingResources.getProhibitedHostNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/types.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_indexProbesByName"><td><code><a href="#fn_indexProbesByName">indexProbesByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_indexRedirectsByName"><td><code><a href="#fn_indexRedirectsByName">indexRedirectsByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_getProbeNames"><td><code><a href="#fn_getProbeNames">getProbeNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_getSettingNames"><td><code><a href="#fn_getSettingNames">getSettingNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_indexSettingsByName"><td><code><a href="#fn_indexSettingsByName">indexSettingsByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_TargetPath.lower"><td><code><a href="#fn_TargetPath.lower">TargetPath.lower(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewExistingResources"><td><code><a href="#fn_NewExistingResources">NewExistingResources(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/types.go</code></td><td class="percent"><code>96.43%</code></td><td class="linecount"><code>27/28</code></td></tr>
<tr id="s_fn_TargetPath.contains"><td><code><a href="#fn_TargetPath.contains">TargetPath.contains(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code></td><td class="percent"><code>93.75%</code></td><td class="linecount"><code>15/16</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedPathMaps"><td><code><a href="#fn_ExistingResources.GetBlacklistedPathMaps">ExistingResources.GetBlacklistedPathMaps(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>92.86%</code></td><td class="linecount"><code>13/14</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedRoutingRules"><td><code><a href="#fn_ExistingResources.GetBlacklistedRoutingRules">ExistingResources.GetBlacklistedRoutingRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>92.86%</code></td><td class="linecount"><code>13/14</code></td></tr>
<tr id="s_fn_LogProbes"><td><code><a href="#fn_LogProbes">LogProbes(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code></td><td class="percent"><code>90.91%</code></td><td class="linecount"><code>10/11</code></td></tr>
<tr id="s_fn_mergePathRules"><td><code><a href="#fn_mergePathRules">mergePathRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>90.91%</code></td><td class="linecount"><code>10/11</code></td></tr>
<tr id="s_fn_LogHTTPSettings"><td><code><a href="#fn_LogHTTPSettings">LogHTTPSettings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code></td><td class="percent"><code>90.91%</code></td><td class="linecount"><code>10/11</code></td></tr>
<tr id="s_fn_ExistingResources.getBlacklistedPoolsSet"><td><code><a href="#fn_ExistingResources.getBlacklistedPoolsSet">ExistingResources.getBlacklistedPoolsSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code></td><td class="percent"><code>89.47%</code></td><td class="linecount"><code>17/19</code></td></tr>
<tr id="s_fn_ExistingResources.getBlacklistedSettingsSet"><td><code><a href="#fn_ExistingResources.getBlacklistedSettingsSet">ExistingResources.getBlacklistedSettingsSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code></td><td class="percent"><code>89.47%</code></td><td class="linecount"><code>17/19</code></td></tr>
<tr id="s_fn_ExistingResources.getBlacklistedRedirectsSet"><td><code><a href="#fn_ExistingResources.getBlacklistedRedirectsSet">ExistingResources.getBlacklistedRedirectsSet(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code></td><td class="percent"><code>89.47%</code></td><td class="linecount"><code>17/19</code></td></tr>
<tr id="s_fn_ExistingResources.getRuleToTargets"><td><code><a href="#fn_ExistingResources.getRuleToTargets">ExistingResources.getRuleToTargets(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>86.96%</code></td><td class="linecount"><code>20/23</code></td></tr>
<tr id="s_fn_ExistingResources.getListenersByName"><td><code><a href="#fn_ExistingResources.getListenersByName">ExistingResources.getListenersByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>85.71%</code></td><td class="linecount"><code>6/7</code></td></tr>
<tr id="s_fn_ExistingResources.getURLPathMapsByName"><td><code><a href="#fn_ExistingResources.getURLPathMapsByName">ExistingResources.getURLPathMapsByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>85.71%</code></td><td class="linecount"><code>6/7</code></td></tr>
<tr id="s_fn_PruneIngressRules"><td><code><a href="#fn_PruneIngressRules">PruneIngressRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/ingress.go</code></td><td class="percent"><code>79.17%</code></td><td class="linecount"><code>19/24</code></td></tr>
<tr id="s_fn_mergeRoutingRules"><td><code><a href="#fn_mergeRoutingRules">mergeRoutingRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>77.78%</code></td><td class="linecount"><code>14/18</code></td></tr>
<tr id="s_fn_lookupPathMap"><td><code><a href="#fn_lookupPathMap">lookupPathMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_ExistingResources.GetBlacklistedRedirects"><td><code><a href="#fn_ExistingResources.GetBlacklistedRedirects">ExistingResources.GetBlacklistedRedirects(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code></td><td class="percent"><code>72.73%</code></td><td class="linecount"><code>8/11</code></td></tr>
<tr id="s_fn_ExistingResources.getHostNamesForRoutingRule"><td><code><a href="#fn_ExistingResources.getHostNamesForRoutingRule">ExistingResources.getHostNamesForRoutingRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>70.00%</code></td><td class="linecount"><code>7/10</code></td></tr>
<tr id="s_fn_ExistingResources.getPathRules"><td><code><a href="#fn_ExistingResources.getPathRules">ExistingResources.getPathRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>4/6</code></td></tr>
<tr id="s_fn_MergeListeners"><td><code><a href="#fn_MergeListeners">MergeListeners(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/18</code></td></tr>
<tr id="s_fn_MergePathMaps"><td><code><a href="#fn_MergePathMaps">MergePathMaps(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_LogRedirects"><td><code><a href="#fn_LogRedirects">LogRedirects(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_LogListeners"><td><code><a href="#fn_LogListeners">LogListeners(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_LogPools"><td><code><a href="#fn_LogPools">LogPools(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_LogRules"><td><code><a href="#fn_LogRules">LogRules(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_LogPathMaps"><td><code><a href="#fn_LogPathMaps">LogPathMaps(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_MergeRedirects"><td><code><a href="#fn_MergeRedirects">MergeRedirects(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/8</code></td></tr>
<tr id="s_fn_getRuleNames"><td><code><a href="#fn_getRuleNames">getRuleNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_getRedirectNames"><td><code><a href="#fn_getRedirectNames">getRedirectNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_getPoolNames"><td><code><a href="#fn_getPoolNames">getPoolNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_getListenerNames"><td><code><a href="#fn_getListenerNames">getListenerNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_getPathMapNames"><td><code><a href="#fn_getPathMapNames">getPathMapNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_mergePathMapsWithBasicRule"><td><code><a href="#fn_mergePathMapsWithBasicRule">mergePathMapsWithBasicRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_indexRulesByName"><td><code><a href="#fn_indexRulesByName">indexRulesByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_indexPoolsByName"><td><code><a href="#fn_indexPoolsByName">indexPoolsByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_indexPathMapsByName"><td><code><a href="#fn_indexPathMapsByName">indexPathMapsByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_indexListenersByName"><td><code><a href="#fn_indexListenersByName">indexListenersByName(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_uniqueListenerConfig.setHostNames"><td><code><a href="#fn_uniqueListenerConfig.setHostNames">uniqueListenerConfig.setHostNames(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield</code></td><td class="percent"><code>69.40%</code></td><td class="linecount"><code>415/598</code></td></tr>
</table>

<div class="funcname" id="fn_ExistingResources.getBlacklistedListenersSet">func ExistingResources.getBlacklistedListenersSet</div><div class="info"><a href="#s_fn_ExistingResources.getBlacklistedListenersSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>140</td><td><code><pre>func (er ExistingResources) getBlacklistedListenersSet() map[listenerName]interface{} {</pre></code></td></tr><tr><td>141</td><td><code><pre>        // Determine the list of prohibited listeners from the HostNames</pre></code></td></tr><tr><td>142</td><td><code><pre>        blacklistedListenersSet := make(map[listenerName]interface{})</pre></code></td></tr><tr><td>143</td><td><code><pre>        prohibitedHostNames := er.getProhibitedHostNames()</pre></code></td></tr><tr><td>144</td><td><code><pre>        for _, listener := range er.Listeners {</pre></code></td></tr><tr><td>145</td><td><code><pre>                if listener.HostName != nil {</pre></code></td></tr><tr><td>146</td><td><code><pre>                        if _, exists := prohibitedHostNames[*listener.HostName]; exists {</pre></code></td></tr><tr><td>147</td><td><code><pre>                                blacklistedListenersSet[listenerName(*listener.Name)] = nil</pre></code></td></tr><tr><td>148</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>149</td><td><code><pre>                        }</pre></code></td></tr><tr><td>150</td><td><code><pre>                }</pre></code></td></tr><tr><td>151</td><td><code><pre>                if listener.HostNames != nil &amp;&amp; len(*listener.HostNames) &gt; 0 {</pre></code></td></tr><tr><td>152</td><td><code><pre>                        for _, hostName := range *listener.HostNames {</pre></code></td></tr><tr><td>153</td><td><code><pre>                                if _, exists := prohibitedHostNames[hostName]; exists {</pre></code></td></tr><tr><td>154</td><td><code><pre>                                        blacklistedListenersSet[listenerName(*listener.Name)] = nil</pre></code></td></tr><tr><td>155</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>156</td><td><code><pre>                                }</pre></code></td></tr><tr><td>157</td><td><code><pre>                        }</pre></code></td></tr><tr><td>158</td><td><code><pre>                }</pre></code></td></tr><tr><td>159</td><td><code><pre>        }</pre></code></td></tr><tr><td>160</td><td><code><pre></pre></code></td></tr><tr><td>161</td><td><code><pre>        // Augment the list of prohibited listeners by looking at the rules</pre></code></td></tr><tr><td>162</td><td><code><pre>        blacklistedRoutingRules, _ := er.GetBlacklistedRoutingRules()</pre></code></td></tr><tr><td>163</td><td><code><pre>        for _, rule := range blacklistedRoutingRules {</pre></code></td></tr><tr><td>164</td><td><code><pre>                if rule.HTTPListener != nil &amp;&amp; rule.HTTPListener.ID != nil {</pre></code></td></tr><tr><td>165</td><td><code><pre>                        listenerName := listenerName(utils.GetLastChunkOfSlashed(*rule.HTTPListener.ID))</pre></code></td></tr><tr><td>166</td><td><code><pre>                        blacklistedListenersSet[listenerName] = nil</pre></code></td></tr><tr><td>167</td><td><code><pre>                }</pre></code></td></tr><tr><td>168</td><td><code><pre>        }</pre></code></td></tr><tr><td>169</td><td><code><pre>        return blacklistedListenersSet</pre></code></td></tr><tr><td>170</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedProbes">func ExistingResources.GetBlacklistedProbes</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedProbes">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func (er ExistingResources) GetBlacklistedProbes() ([]n.ApplicationGatewayProbe, []n.ApplicationGatewayProbe) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        blacklistedProbesSet := er.getBlacklistedProbesSet()</pre></code></td></tr><tr><td>23</td><td><code><pre>        var nonBlacklistedProbes []n.ApplicationGatewayProbe</pre></code></td></tr><tr><td>24</td><td><code><pre>        var blacklistedProbes []n.ApplicationGatewayProbe</pre></code></td></tr><tr><td>25</td><td><code><pre>        for _, probe := range er.Probes {</pre></code></td></tr><tr><td>26</td><td><code><pre>                if _, isBlacklisted := blacklistedProbesSet[probeName(*probe.Name)]; isBlacklisted {</pre></code></td></tr><tr><td>27</td><td><code><pre>                        klog.V(5).Infof(&#34;Probe %s is blacklisted&#34;, *probe.Name)</pre></code></td></tr><tr><td>28</td><td><code><pre>                        blacklistedProbes = append(blacklistedProbes, probe)</pre></code></td></tr><tr><td>29</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr><td>31</td><td><code><pre>                klog.V(5).Infof(&#34;Probe %s is not blacklisted&#34;, *probe.Name)</pre></code></td></tr><tr><td>32</td><td><code><pre>                nonBlacklistedProbes = append(nonBlacklistedProbes, probe)</pre></code></td></tr><tr><td>33</td><td><code><pre>        }</pre></code></td></tr><tr><td>34</td><td><code><pre>        return blacklistedProbes, nonBlacklistedProbes</pre></code></td></tr><tr><td>35</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedPools">func ExistingResources.GetBlacklistedPools</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedPools">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func (er ExistingResources) GetBlacklistedPools() ([]n.ApplicationGatewayBackendAddressPool, []n.ApplicationGatewayBackendAddressPool) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        blacklistedPoolsSet := er.getBlacklistedPoolsSet()</pre></code></td></tr><tr><td>23</td><td><code><pre>        var blacklistedPools []n.ApplicationGatewayBackendAddressPool</pre></code></td></tr><tr><td>24</td><td><code><pre>        var nonBlacklistedPools []n.ApplicationGatewayBackendAddressPool</pre></code></td></tr><tr><td>25</td><td><code><pre>        for _, pool := range er.BackendPools {</pre></code></td></tr><tr><td>26</td><td><code><pre>                if _, isBlacklisted := blacklistedPoolsSet[backendPoolName(*pool.Name)]; isBlacklisted {</pre></code></td></tr><tr><td>27</td><td><code><pre>                        blacklistedPools = append(blacklistedPools, pool)</pre></code></td></tr><tr><td>28</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Backend Address Pool %s is blacklisted&#34;, *pool.Name)</pre></code></td></tr><tr><td>29</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr><td>31</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Backend Address Pool %s is NOT blacklisted&#34;, *pool.Name)</pre></code></td></tr><tr><td>32</td><td><code><pre>                nonBlacklistedPools = append(nonBlacklistedPools, pool)</pre></code></td></tr><tr><td>33</td><td><code><pre>        }</pre></code></td></tr><tr><td>34</td><td><code><pre>        return blacklistedPools, nonBlacklistedPools</pre></code></td></tr><tr><td>35</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergeRules">func MergeRules</div><div class="info"><a href="#s_fn_MergeRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>60</td><td><code><pre>func MergeRules(appGw *n.ApplicationGateway, ruleBuckets ...[]n.ApplicationGatewayRequestRoutingRule) []n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>61</td><td><code><pre>        uniq := make(map[string]*n.ApplicationGatewayRequestRoutingRule)</pre></code></td></tr><tr><td>62</td><td><code><pre>        for _, bucket := range ruleBuckets {</pre></code></td></tr><tr><td>63</td><td><code><pre>                for idx := range bucket {</pre></code></td></tr><tr><td>64</td><td><code><pre>                        rule := &amp;bucket[idx]</pre></code></td></tr><tr><td>65</td><td><code><pre>                        // If two rules share the listener, we merge them. We keep the existing rule and merge the url path maps.</pre></code></td></tr><tr><td>66</td><td><code><pre>                        if existingRule, exists := uniq[*rule.HTTPListener.ID]; exists {</pre></code></td></tr><tr><td>67</td><td><code><pre>                                uniq[*rule.HTTPListener.ID] = mergeRoutingRules(appGw, existingRule, rule)</pre></code></td></tr><tr><td>68</td><td><code><pre>                        } else {</pre></code></td></tr><tr><td>69</td><td><code><pre>                                uniq[*rule.HTTPListener.ID] = rule</pre></code></td></tr><tr><td>70</td><td><code><pre>                        }</pre></code></td></tr><tr><td>71</td><td><code><pre>                }</pre></code></td></tr><tr><td>72</td><td><code><pre>        }</pre></code></td></tr><tr><td>73</td><td><code><pre>        var merged []n.ApplicationGatewayRequestRoutingRule</pre></code></td></tr><tr><td>74</td><td><code><pre>        for _, rule := range uniq {</pre></code></td></tr><tr><td>75</td><td><code><pre>                merged = append(merged, *rule)</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>78</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedListeners">func ExistingResources.GetBlacklistedListeners</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedListeners">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>26</td><td><code><pre>func (er ExistingResources) GetBlacklistedListeners() ([]n.ApplicationGatewayHTTPListener, []n.ApplicationGatewayHTTPListener) {</pre></code></td></tr><tr><td>27</td><td><code><pre>        blacklistedListenersSet := er.getBlacklistedListenersSet()</pre></code></td></tr><tr><td>28</td><td><code><pre>        var blacklisted, nonBlacklisted []n.ApplicationGatewayHTTPListener</pre></code></td></tr><tr><td>29</td><td><code><pre>        for _, listener := range er.Listeners {</pre></code></td></tr><tr><td>30</td><td><code><pre>                listenerNm := listenerName(*listener.Name)</pre></code></td></tr><tr><td>31</td><td><code><pre>                if _, exists := blacklistedListenersSet[listenerNm]; exists {</pre></code></td></tr><tr><td>32</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Listener %s is blacklisted&#34;, listenerNm)</pre></code></td></tr><tr><td>33</td><td><code><pre>                        blacklisted = append(blacklisted, listener)</pre></code></td></tr><tr><td>34</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>35</td><td><code><pre>                }</pre></code></td></tr><tr><td>36</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Listener %s is not blacklisted&#34;, listenerNm)</pre></code></td></tr><tr><td>37</td><td><code><pre>                nonBlacklisted = append(nonBlacklisted, listener)</pre></code></td></tr><tr><td>38</td><td><code><pre>        }</pre></code></td></tr><tr><td>39</td><td><code><pre>        return blacklisted, nonBlacklisted</pre></code></td></tr><tr><td>40</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedHTTPSettings">func ExistingResources.GetBlacklistedHTTPSettings</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedHTTPSettings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code>:</p></div><table class="listing">
<tr><td>22</td><td><code><pre>func (er ExistingResources) GetBlacklistedHTTPSettings() ([]n.ApplicationGatewayBackendHTTPSettings, []n.ApplicationGatewayBackendHTTPSettings) {</pre></code></td></tr><tr><td>23</td><td><code><pre>        blacklistedSettingsSet := er.getBlacklistedSettingsSet()</pre></code></td></tr><tr><td>24</td><td><code><pre>        var blacklisted []n.ApplicationGatewayBackendHTTPSettings</pre></code></td></tr><tr><td>25</td><td><code><pre>        var nonBlacklisted []n.ApplicationGatewayBackendHTTPSettings</pre></code></td></tr><tr><td>26</td><td><code><pre>        for _, setting := range er.HTTPSettings {</pre></code></td></tr><tr><td>27</td><td><code><pre>                if _, isBlacklisted := blacklistedSettingsSet[settingName(*setting.Name)]; isBlacklisted {</pre></code></td></tr><tr><td>28</td><td><code><pre>                        blacklisted = append(blacklisted, setting)</pre></code></td></tr><tr><td>29</td><td><code><pre>                        klog.V(5).Infof(&#34;HTTP Setting %s is blacklisted&#34;, *setting.Name)</pre></code></td></tr><tr><td>30</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>31</td><td><code><pre>                }</pre></code></td></tr><tr><td>32</td><td><code><pre>                klog.V(5).Infof(&#34;HTTP Setting %s is NOT blacklisted&#34;, *setting.Name)</pre></code></td></tr><tr><td>33</td><td><code><pre>                nonBlacklisted = append(nonBlacklisted, setting)</pre></code></td></tr><tr><td>34</td><td><code><pre>        }</pre></code></td></tr><tr><td>35</td><td><code><pre>        return blacklisted, nonBlacklisted</pre></code></td></tr><tr><td>36</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_deletePathMap">func deletePathMap</div><div class="info"><a href="#s_fn_deletePathMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>140</td><td><code><pre>func deletePathMap(pathMapsPtr *[]n.ApplicationGatewayURLPathMap, resourceID *string) *[]n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>141</td><td><code><pre>        pathMaps := *pathMapsPtr</pre></code></td></tr><tr><td>142</td><td><code><pre>        deleteIdx := -1</pre></code></td></tr><tr><td>143</td><td><code><pre>        for idx, pathMap := range pathMaps {</pre></code></td></tr><tr><td>144</td><td><code><pre>                if *pathMap.ID == *resourceID {</pre></code></td></tr><tr><td>145</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Deleting %s&#34;, *resourceID)</pre></code></td></tr><tr><td>146</td><td><code><pre>                        deleteIdx = idx</pre></code></td></tr><tr><td>147</td><td><code><pre>                }</pre></code></td></tr><tr><td>148</td><td><code><pre>        }</pre></code></td></tr><tr><td>149</td><td><code><pre></pre></code></td></tr><tr><td>150</td><td><code><pre>        if deleteIdx != -1 {</pre></code></td></tr><tr><td>151</td><td><code><pre>                pathMaps[deleteIdx] = pathMaps[len(pathMaps)-1]</pre></code></td></tr><tr><td>152</td><td><code><pre>                *pathMapsPtr = pathMaps[:len(pathMaps)-1]</pre></code></td></tr><tr><td>153</td><td><code><pre>        }</pre></code></td></tr><tr><td>154</td><td><code><pre></pre></code></td></tr><tr><td>155</td><td><code><pre>        return pathMapsPtr</pre></code></td></tr><tr><td>156</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Target.IsBlacklisted">func Target.IsBlacklisted</div><div class="info"><a href="#s_fn_Target.IsBlacklisted">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code>:</p></div><table class="listing">
<tr><td>30</td><td><code><pre>func (t Target) IsBlacklisted(blacklist TargetBlacklist) bool {</pre></code></td></tr><tr><td>31</td><td><code><pre>        jsonTarget, _ := json.Marshal(t)</pre></code></td></tr><tr><td>32</td><td><code><pre>        for _, blTarget := range *blacklist {</pre></code></td></tr><tr><td>33</td><td><code><pre></pre></code></td></tr><tr><td>34</td><td><code><pre>                // An empty blacklist hostname indicates that any hostname would be blacklisted.</pre></code></td></tr><tr><td>35</td><td><code><pre>                // If host names match - this target is in the blacklist.</pre></code></td></tr><tr><td>36</td><td><code><pre>                // AGIC is allowed to create and modify App Gwy config for blank host.</pre></code></td></tr><tr><td>37</td><td><code><pre>                hostIsBlacklisted := blTarget.Hostname == &#34;&#34; || strings.ToLower(t.Hostname) == strings.ToLower(blTarget.Hostname)</pre></code></td></tr><tr><td>38</td><td><code><pre></pre></code></td></tr><tr><td>39</td><td><code><pre>                pathIsBlacklisted := blTarget.Path == &#34;&#34; || blTarget.Path == &#34;/*&#34; || t.Path.lower() == blTarget.Path.lower() || blTarget.Path.contains(t.Path) // TODO(draychev): || t.Path.contains(blTarget.Path)</pre></code></td></tr><tr><td>40</td><td><code><pre></pre></code></td></tr><tr><td>41</td><td><code><pre>                // With this version we keep things as simple as possible: match host and exact path to determine</pre></code></td></tr><tr><td>42</td><td><code><pre>                // whether given target is in the blacklist. Ideally this would be URL Path set overlap operation,</pre></code></td></tr><tr><td>43</td><td><code><pre>                // which we deliberately leave for a later time.</pre></code></td></tr><tr><td>44</td><td><code><pre>                if hostIsBlacklisted &amp;&amp; pathIsBlacklisted {</pre></code></td></tr><tr><td>45</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Target %s is blacklisted&#34;, jsonTarget)</pre></code></td></tr><tr><td>46</td><td><code><pre>                        return true // Found it</pre></code></td></tr><tr><td>47</td><td><code><pre>                }</pre></code></td></tr><tr><td>48</td><td><code><pre>        }</pre></code></td></tr><tr><td>49</td><td><code><pre>        klog.V(5).Infof(&#34;[brownfield] Target %s is not blacklisted&#34;, jsonTarget)</pre></code></td></tr><tr><td>50</td><td><code><pre>        return false // Did not find it</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergeHTTPSettings">func MergeHTTPSettings</div><div class="info"><a href="#s_fn_MergeHTTPSettings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code>:</p></div><table class="listing">
<tr><td>39</td><td><code><pre>func MergeHTTPSettings(settingBuckets ...[]n.ApplicationGatewayBackendHTTPSettings) []n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr><td>40</td><td><code><pre>        uniq := make(map[string]n.ApplicationGatewayBackendHTTPSettings)</pre></code></td></tr><tr><td>41</td><td><code><pre>        for _, bucket := range settingBuckets {</pre></code></td></tr><tr><td>42</td><td><code><pre>                for _, setting := range bucket {</pre></code></td></tr><tr><td>43</td><td><code><pre>                        uniq[*setting.Name] = setting</pre></code></td></tr><tr><td>44</td><td><code><pre>                }</pre></code></td></tr><tr><td>45</td><td><code><pre>        }</pre></code></td></tr><tr><td>46</td><td><code><pre>        var merged []n.ApplicationGatewayBackendHTTPSettings</pre></code></td></tr><tr><td>47</td><td><code><pre>        for _, setting := range uniq {</pre></code></td></tr><tr><td>48</td><td><code><pre>                merged = append(merged, setting)</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergeCerts">func MergeCerts</div><div class="info"><a href="#s_fn_MergeCerts">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/certificates.go</code>:</p></div><table class="listing">
<tr><td>16</td><td><code><pre>func MergeCerts(certBuckets ...[]n.ApplicationGatewaySslCertificate) []n.ApplicationGatewaySslCertificate {</pre></code></td></tr><tr><td>17</td><td><code><pre>        uniq := make(certsByName)</pre></code></td></tr><tr><td>18</td><td><code><pre>        for _, bucket := range certBuckets {</pre></code></td></tr><tr><td>19</td><td><code><pre>                for _, cert := range bucket {</pre></code></td></tr><tr><td>20</td><td><code><pre>                        uniq[certName(*cert.Name)] = cert</pre></code></td></tr><tr><td>21</td><td><code><pre>                }</pre></code></td></tr><tr><td>22</td><td><code><pre>        }</pre></code></td></tr><tr><td>23</td><td><code><pre>        merged := []n.ApplicationGatewaySslCertificate{}</pre></code></td></tr><tr><td>24</td><td><code><pre>        for _, cert := range uniq {</pre></code></td></tr><tr><td>25</td><td><code><pre>                merged = append(merged, cert)</pre></code></td></tr><tr><td>26</td><td><code><pre>        }</pre></code></td></tr><tr><td>27</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>28</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergePools">func MergePools</div><div class="info"><a href="#s_fn_MergePools">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code>:</p></div><table class="listing">
<tr><td>38</td><td><code><pre>func MergePools(pools ...[]n.ApplicationGatewayBackendAddressPool) []n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>39</td><td><code><pre>        uniqPool := make(poolsByName)</pre></code></td></tr><tr><td>40</td><td><code><pre>        for _, bucket := range pools {</pre></code></td></tr><tr><td>41</td><td><code><pre>                for _, pool := range bucket {</pre></code></td></tr><tr><td>42</td><td><code><pre>                        uniqPool[backendPoolName(*pool.Name)] = pool</pre></code></td></tr><tr><td>43</td><td><code><pre>                }</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre>        var merged []n.ApplicationGatewayBackendAddressPool</pre></code></td></tr><tr><td>46</td><td><code><pre>        for _, pool := range uniqPool {</pre></code></td></tr><tr><td>47</td><td><code><pre>                merged = append(merged, pool)</pre></code></td></tr><tr><td>48</td><td><code><pre>        }</pre></code></td></tr><tr><td>49</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>50</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergeProbes">func MergeProbes</div><div class="info"><a href="#s_fn_MergeProbes">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code>:</p></div><table class="listing">
<tr><td>38</td><td><code><pre>func MergeProbes(probesBuckets ...[]n.ApplicationGatewayProbe) []n.ApplicationGatewayProbe {</pre></code></td></tr><tr><td>39</td><td><code><pre>        uniqProbes := make(probesByName)</pre></code></td></tr><tr><td>40</td><td><code><pre>        for _, bucket := range probesBuckets {</pre></code></td></tr><tr><td>41</td><td><code><pre>                for _, probe := range bucket {</pre></code></td></tr><tr><td>42</td><td><code><pre>                        uniqProbes[probeName(*probe.Name)] = probe</pre></code></td></tr><tr><td>43</td><td><code><pre>                }</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre>        var managedProbes []n.ApplicationGatewayProbe</pre></code></td></tr><tr><td>46</td><td><code><pre>        for _, probe := range uniqProbes {</pre></code></td></tr><tr><td>47</td><td><code><pre>                managedProbes = append(managedProbes, probe)</pre></code></td></tr><tr><td>48</td><td><code><pre>        }</pre></code></td></tr><tr><td>49</td><td><code><pre>        return managedProbes</pre></code></td></tr><tr><td>50</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getBlacklistedProbesSet">func ExistingResources.getBlacklistedProbesSet</div><div class="info"><a href="#s_fn_ExistingResources.getBlacklistedProbesSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code>:</p></div><table class="listing">
<tr><td>88</td><td><code><pre>func (er ExistingResources) getBlacklistedProbesSet() map[probeName]interface{} {</pre></code></td></tr><tr><td>89</td><td><code><pre>        blacklistedHTTPSettings, _ := er.GetBlacklistedHTTPSettings()</pre></code></td></tr><tr><td>90</td><td><code><pre>        blacklistedProbesSet := make(map[probeName]interface{})</pre></code></td></tr><tr><td>91</td><td><code><pre>        for _, setting := range blacklistedHTTPSettings {</pre></code></td></tr><tr><td>92</td><td><code><pre>                if setting.Probe != nil &amp;&amp; setting.Probe.ID != nil {</pre></code></td></tr><tr><td>93</td><td><code><pre>                        probeName := probeName(utils.GetLastChunkOfSlashed(*setting.Probe.ID))</pre></code></td></tr><tr><td>94</td><td><code><pre>                        blacklistedProbesSet[probeName] = nil</pre></code></td></tr><tr><td>95</td><td><code><pre>                }</pre></code></td></tr><tr><td>96</td><td><code><pre>        }</pre></code></td></tr><tr><td>97</td><td><code><pre>        return blacklistedProbesSet</pre></code></td></tr><tr><td>98</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@35:19">func @35:19</div><div class="info"><a href="#s_fn_@35:19">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>35</td><td><code><pre>func(rule n.ApplicationGatewayRequestRoutingRule) bool {</pre></code></td></tr><tr><td>36</td><td><code><pre>                targetsForRule := ruleToTargets[ruleName(*rule.Name)]</pre></code></td></tr><tr><td>37</td><td><code><pre>                for _, target := range targetsForRule {</pre></code></td></tr><tr><td>38</td><td><code><pre>                        if target.IsBlacklisted(blacklist) {</pre></code></td></tr><tr><td>39</td><td><code><pre>                                klog.V(5).Infof(&#34;[brownfield] Routing Rule %s is blacklisted&#34;, *rule.Name)</pre></code></td></tr><tr><td>40</td><td><code><pre>                                return true</pre></code></td></tr><tr><td>41</td><td><code><pre>                        }</pre></code></td></tr><tr><td>42</td><td><code><pre>                }</pre></code></td></tr><tr><td>43</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Routing Rule %s is NOT blacklisted&#34;, *rule.Name)</pre></code></td></tr><tr><td>44</td><td><code><pre>                return false</pre></code></td></tr><tr><td>45</td><td><code><pre>        }</pre></code></td></tr></table>

<div class="funcname" id="fn_GetTargetBlacklist">func GetTargetBlacklist</div><div class="info"><a href="#s_fn_GetTargetBlacklist">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code>:</p></div><table class="listing">
<tr><td>54</td><td><code><pre>func GetTargetBlacklist(prohibitedTargets []*ptv1.AzureIngressProhibitedTarget) TargetBlacklist {</pre></code></td></tr><tr><td>55</td><td><code><pre>        // TODO(draychev): make this a method of ExistingResources and memoize it.</pre></code></td></tr><tr><td>56</td><td><code><pre>        var target []Target</pre></code></td></tr><tr><td>57</td><td><code><pre>        for _, prohibitedTarget := range prohibitedTargets {</pre></code></td></tr><tr><td>58</td><td><code><pre>                if len(prohibitedTarget.Spec.Paths) == 0 {</pre></code></td></tr><tr><td>59</td><td><code><pre>                        target = append(target, Target{</pre></code></td></tr><tr><td>60</td><td><code><pre>                                Hostname: prohibitedTarget.Spec.Hostname,</pre></code></td></tr><tr><td>61</td><td><code><pre>                        })</pre></code></td></tr><tr><td>62</td><td><code><pre>                }</pre></code></td></tr><tr><td>63</td><td><code><pre>                for _, path := range prohibitedTarget.Spec.Paths {</pre></code></td></tr><tr><td>64</td><td><code><pre>                        target = append(target, Target{</pre></code></td></tr><tr><td>65</td><td><code><pre>                                Hostname: prohibitedTarget.Spec.Hostname,</pre></code></td></tr><tr><td>66</td><td><code><pre>                                Path:     TargetPath(strings.ToLower(path)),</pre></code></td></tr><tr><td>67</td><td><code><pre>                        })</pre></code></td></tr><tr><td>68</td><td><code><pre>                }</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr><td>70</td><td><code><pre>        return &amp;target</pre></code></td></tr><tr><td>71</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@33:19">func @33:19</div><div class="info"><a href="#s_fn_@33:19">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>33</td><td><code><pre>func(pathMap n.ApplicationGatewayURLPathMap) bool {</pre></code></td></tr><tr><td>34</td><td><code><pre>                targetsForPathMap := pathMapToTargets[urlPathMapName(*pathMap.Name)]</pre></code></td></tr><tr><td>35</td><td><code><pre>                for _, target := range targetsForPathMap {</pre></code></td></tr><tr><td>36</td><td><code><pre>                        if target.IsBlacklisted(blacklist) {</pre></code></td></tr><tr><td>37</td><td><code><pre>                                klog.V(5).Infof(&#34;[brownfield] Routing PathMap %s is blacklisted&#34;, *pathMap.Name)</pre></code></td></tr><tr><td>38</td><td><code><pre>                                return true</pre></code></td></tr><tr><td>39</td><td><code><pre>                        }</pre></code></td></tr><tr><td>40</td><td><code><pre>                }</pre></code></td></tr><tr><td>41</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Routing PathMap %s is NOT blacklisted&#34;, *pathMap.Name)</pre></code></td></tr><tr><td>42</td><td><code><pre>                return false</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getProhibitedHostNames">func ExistingResources.getProhibitedHostNames</div><div class="info"><a href="#s_fn_ExistingResources.getProhibitedHostNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/types.go</code>:</p></div><table class="listing">
<tr><td>106</td><td><code><pre>func (er ExistingResources) getProhibitedHostNames() map[string]interface{} {</pre></code></td></tr><tr><td>107</td><td><code><pre>        prohibitedHostNames := make(map[string]interface{})</pre></code></td></tr><tr><td>108</td><td><code><pre>        for _, pt := range er.ProhibitedTargets {</pre></code></td></tr><tr><td>109</td><td><code><pre>                if len(pt.Spec.Hostname) == 0 {</pre></code></td></tr><tr><td>110</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>111</td><td><code><pre>                }</pre></code></td></tr><tr><td>112</td><td><code><pre>                prohibitedHostNames[pt.Spec.Hostname] = nil</pre></code></td></tr><tr><td>113</td><td><code><pre>        }</pre></code></td></tr><tr><td>114</td><td><code><pre>        return prohibitedHostNames</pre></code></td></tr><tr><td>115</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexProbesByName">func indexProbesByName</div><div class="info"><a href="#s_fn_indexProbesByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code>:</p></div><table class="listing">
<tr><td>72</td><td><code><pre>func indexProbesByName(probes []n.ApplicationGatewayProbe) probesByName {</pre></code></td></tr><tr><td>73</td><td><code><pre>        probesByName := make(probesByName)</pre></code></td></tr><tr><td>74</td><td><code><pre>        for _, probe := range probes {</pre></code></td></tr><tr><td>75</td><td><code><pre>                probesByName[probeName(*probe.Name)] = probe</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre>        return probesByName</pre></code></td></tr><tr><td>78</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexRedirectsByName">func indexRedirectsByName</div><div class="info"><a href="#s_fn_indexRedirectsByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code>:</p></div><table class="listing">
<tr><td>83</td><td><code><pre>func indexRedirectsByName(redirects []n.ApplicationGatewayRedirectConfiguration) redirectsByName {</pre></code></td></tr><tr><td>84</td><td><code><pre>        indexed := make(redirectsByName)</pre></code></td></tr><tr><td>85</td><td><code><pre>        for _, redirect := range redirects {</pre></code></td></tr><tr><td>86</td><td><code><pre>                indexed[redirectName(*redirect.Name)] = redirect</pre></code></td></tr><tr><td>87</td><td><code><pre>        }</pre></code></td></tr><tr><td>88</td><td><code><pre>        return indexed</pre></code></td></tr><tr><td>89</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getProbeNames">func getProbeNames</div><div class="info"><a href="#s_fn_getProbeNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code>:</p></div><table class="listing">
<tr><td>80</td><td><code><pre>func getProbeNames(Probe []n.ApplicationGatewayProbe) string {</pre></code></td></tr><tr><td>81</td><td><code><pre>        var names []string</pre></code></td></tr><tr><td>82</td><td><code><pre>        for _, p := range Probe {</pre></code></td></tr><tr><td>83</td><td><code><pre>                names = append(names, *p.Name)</pre></code></td></tr><tr><td>84</td><td><code><pre>        }</pre></code></td></tr><tr><td>85</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>86</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getSettingNames">func getSettingNames</div><div class="info"><a href="#s_fn_getSettingNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code>:</p></div><table class="listing">
<tr><td>81</td><td><code><pre>func getSettingNames(settings []n.ApplicationGatewayBackendHTTPSettings) string {</pre></code></td></tr><tr><td>82</td><td><code><pre>        var names []string</pre></code></td></tr><tr><td>83</td><td><code><pre>        for _, setting := range settings {</pre></code></td></tr><tr><td>84</td><td><code><pre>                names = append(names, *setting.Name)</pre></code></td></tr><tr><td>85</td><td><code><pre>        }</pre></code></td></tr><tr><td>86</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>87</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexSettingsByName">func indexSettingsByName</div><div class="info"><a href="#s_fn_indexSettingsByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code>:</p></div><table class="listing">
<tr><td>73</td><td><code><pre>func indexSettingsByName(settings []n.ApplicationGatewayBackendHTTPSettings) settingsByName {</pre></code></td></tr><tr><td>74</td><td><code><pre>        settingsByName := make(settingsByName)</pre></code></td></tr><tr><td>75</td><td><code><pre>        for _, setting := range settings {</pre></code></td></tr><tr><td>76</td><td><code><pre>                settingsByName[settingName(*setting.Name)] = setting</pre></code></td></tr><tr><td>77</td><td><code><pre>        }</pre></code></td></tr><tr><td>78</td><td><code><pre>        return settingsByName</pre></code></td></tr><tr><td>79</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_TargetPath.lower">func TargetPath.lower</div><div class="info"><a href="#s_fn_TargetPath.lower">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code>:</p></div><table class="listing">
<tr><td>73</td><td><code><pre>func (p TargetPath) lower() string {</pre></code></td></tr><tr><td>74</td><td><code><pre>        return strings.ToLower(string(p))</pre></code></td></tr><tr><td>75</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewExistingResources">func NewExistingResources</div><div class="info"><a href="#s_fn_NewExistingResources">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/types.go</code>:</p></div><table class="listing">
<tr><td>45</td><td><code><pre>func NewExistingResources(appGw n.ApplicationGateway, prohibitedTargets []*ptv1.AzureIngressProhibitedTarget, defaultPool *n.ApplicationGatewayBackendAddressPool) ExistingResources {</pre></code></td></tr><tr><td>46</td><td><code><pre>        var allExistingSettings []n.ApplicationGatewayBackendHTTPSettings</pre></code></td></tr><tr><td>47</td><td><code><pre>        if appGw.BackendHTTPSettingsCollection != nil {</pre></code></td></tr><tr><td>48</td><td><code><pre>                allExistingSettings = *appGw.BackendHTTPSettingsCollection</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>        var allExistingRequestRoutingRules []n.ApplicationGatewayRequestRoutingRule</pre></code></td></tr><tr><td>52</td><td><code><pre>        if appGw.RequestRoutingRules != nil {</pre></code></td></tr><tr><td>53</td><td><code><pre>                allExistingRequestRoutingRules = *appGw.RequestRoutingRules</pre></code></td></tr><tr><td>54</td><td><code><pre>        }</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>        var allExistingListeners []n.ApplicationGatewayHTTPListener</pre></code></td></tr><tr><td>57</td><td><code><pre>        if appGw.HTTPListeners != nil {</pre></code></td></tr><tr><td>58</td><td><code><pre>                allExistingListeners = *appGw.HTTPListeners</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>        var allExistingURLPathMap []n.ApplicationGatewayURLPathMap</pre></code></td></tr><tr><td>62</td><td><code><pre>        if appGw.URLPathMaps != nil {</pre></code></td></tr><tr><td>63</td><td><code><pre>                allExistingURLPathMap = *appGw.URLPathMaps</pre></code></td></tr><tr><td>64</td><td><code><pre>        }</pre></code></td></tr><tr><td>65</td><td><code><pre></pre></code></td></tr><tr><td>66</td><td><code><pre>        var allExistingPorts []n.ApplicationGatewayFrontendPort</pre></code></td></tr><tr><td>67</td><td><code><pre>        if appGw.FrontendPorts != nil {</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                allExistingPorts = *appGw.FrontendPorts</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr><td>70</td><td><code><pre></pre></code></td></tr><tr><td>71</td><td><code><pre>        var allExistingCertificates []n.ApplicationGatewaySslCertificate</pre></code></td></tr><tr><td>72</td><td><code><pre>        if appGw.SslCertificates != nil {</pre></code></td></tr><tr><td>73</td><td><code><pre>                allExistingCertificates = *appGw.SslCertificates</pre></code></td></tr><tr><td>74</td><td><code><pre>        }</pre></code></td></tr><tr><td>75</td><td><code><pre></pre></code></td></tr><tr><td>76</td><td><code><pre>        var allExistingHealthProbes []n.ApplicationGatewayProbe</pre></code></td></tr><tr><td>77</td><td><code><pre>        if appGw.Probes != nil {</pre></code></td></tr><tr><td>78</td><td><code><pre>                allExistingHealthProbes = *appGw.Probes</pre></code></td></tr><tr><td>79</td><td><code><pre>        }</pre></code></td></tr><tr><td>80</td><td><code><pre></pre></code></td></tr><tr><td>81</td><td><code><pre>        var allExistingBackendPools []n.ApplicationGatewayBackendAddressPool</pre></code></td></tr><tr><td>82</td><td><code><pre>        if appGw.BackendAddressPools != nil {</pre></code></td></tr><tr><td>83</td><td><code><pre>                allExistingBackendPools = *appGw.BackendAddressPools</pre></code></td></tr><tr><td>84</td><td><code><pre>        }</pre></code></td></tr><tr><td>85</td><td><code><pre></pre></code></td></tr><tr><td>86</td><td><code><pre>        var allExistingRedirects []n.ApplicationGatewayRedirectConfiguration</pre></code></td></tr><tr><td>87</td><td><code><pre>        if appGw.RedirectConfigurations != nil {</pre></code></td></tr><tr><td>88</td><td><code><pre>                allExistingRedirects = *appGw.RedirectConfigurations</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr><td>90</td><td><code><pre></pre></code></td></tr><tr><td>91</td><td><code><pre>        return ExistingResources{</pre></code></td></tr><tr><td>92</td><td><code><pre>                BackendPools:       allExistingBackendPools,</pre></code></td></tr><tr><td>93</td><td><code><pre>                Certificates:       allExistingCertificates,</pre></code></td></tr><tr><td>94</td><td><code><pre>                RoutingRules:       allExistingRequestRoutingRules,</pre></code></td></tr><tr><td>95</td><td><code><pre>                Listeners:          allExistingListeners,</pre></code></td></tr><tr><td>96</td><td><code><pre>                URLPathMaps:        allExistingURLPathMap,</pre></code></td></tr><tr><td>97</td><td><code><pre>                HTTPSettings:       allExistingSettings,</pre></code></td></tr><tr><td>98</td><td><code><pre>                Ports:              allExistingPorts,</pre></code></td></tr><tr><td>99</td><td><code><pre>                Probes:             allExistingHealthProbes,</pre></code></td></tr><tr><td>100</td><td><code><pre>                Redirects:          allExistingRedirects,</pre></code></td></tr><tr><td>101</td><td><code><pre>                ProhibitedTargets:  prohibitedTargets,</pre></code></td></tr><tr><td>102</td><td><code><pre>                DefaultBackendPool: defaultPool,</pre></code></td></tr><tr><td>103</td><td><code><pre>        }</pre></code></td></tr><tr><td>104</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_TargetPath.contains">func TargetPath.contains</div><div class="info"><a href="#s_fn_TargetPath.contains">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/targets.go</code>:</p></div><table class="listing">
<tr><td>77</td><td><code><pre>func (p TargetPath) contains(otherPath TargetPath) bool {</pre></code></td></tr><tr><td>78</td><td><code><pre>        if p == &#34;&#34; || p == &#34;*&#34; || p == &#34;/*&#34; {</pre></code></td></tr><tr><td>79</td><td><code><pre>                return true</pre></code></td></tr><tr><td>80</td><td><code><pre>        }</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>        // For strings that do not end with a * - do exact match</pre></code></td></tr><tr><td>83</td><td><code><pre>        if !strings.HasSuffix(p.lower(), &#34;*&#34;) {</pre></code></td></tr><tr><td>84</td><td><code><pre>                return p.lower() == otherPath.lower()</pre></code></td></tr><tr><td>85</td><td><code><pre>        }</pre></code></td></tr><tr><td>86</td><td><code><pre></pre></code></td></tr><tr><td>87</td><td><code><pre>        // &#34;/x/*&#34; contains &#34;/x&#34;</pre></code></td></tr><tr><td>88</td><td><code><pre>        if strings.TrimRight(p.lower(), &#34;/*&#34;) == strings.TrimRight(otherPath.lower(), &#34;/*&#34;) {</pre></code></td></tr><tr><td>89</td><td><code><pre>                return true</pre></code></td></tr><tr><td>90</td><td><code><pre>        }</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr><td>92</td><td><code><pre>        if len(p) &gt; len(otherPath) {</pre></code></td></tr><tr><td>93</td><td><code><pre>                return false</pre></code></td></tr><tr><td>94</td><td><code><pre>        }</pre></code></td></tr><tr><td>95</td><td><code><pre></pre></code></td></tr><tr><td>96</td><td><code><pre>        thisPathChunks := strings.Split(p.lower(), &#34;/&#34;)</pre></code></td></tr><tr><td>97</td><td><code><pre>        otherPathChunks := strings.Split(otherPath.lower(), &#34;/&#34;)</pre></code></td></tr><tr><td>98</td><td><code><pre>        for idx := range thisPathChunks {</pre></code></td></tr><tr><td>99</td><td><code><pre>                if thisPathChunks[idx] == &#34;*&#34; {</pre></code></td></tr><tr><td>100</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>101</td><td><code><pre>                }</pre></code></td></tr><tr><td>102</td><td><code><pre>                if thisPathChunks[idx] != otherPathChunks[idx] {</pre></code></td></tr><tr><td>103</td><td><code><pre>                        return false</pre></code></td></tr><tr><td>104</td><td><code><pre>                }</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>        return false</pre></code></td></tr><tr><td>107</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedPathMaps">func ExistingResources.GetBlacklistedPathMaps</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedPathMaps">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>22</td><td><code><pre>func (er ExistingResources) GetBlacklistedPathMaps() ([]n.ApplicationGatewayURLPathMap, []n.ApplicationGatewayURLPathMap) {</pre></code></td></tr><tr><td>23</td><td><code><pre></pre></code></td></tr><tr><td>24</td><td><code><pre>        blacklist := GetTargetBlacklist(er.ProhibitedTargets)</pre></code></td></tr><tr><td>25</td><td><code><pre>        if blacklist == nil {</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                return nil, er.URLPathMaps</pre></code></td></tr><tr><td>27</td><td><code><pre>        }</pre></code></td></tr><tr><td>28</td><td><code><pre>        _, pathMapToTargets := er.getRuleToTargets()</pre></code></td></tr><tr><td>29</td><td><code><pre>        klog.V(5).Infof(&#34;[brownfield] PathMap to Targets map: %+v&#34;, pathMapToTargets)</pre></code></td></tr><tr><td>30</td><td><code><pre></pre></code></td></tr><tr><td>31</td><td><code><pre>        // Figure out if the given BackendAddressPathMap is blacklisted. It will be if it has a host/path that</pre></code></td></tr><tr><td>32</td><td><code><pre>        // has been referenced in a AzureIngressProhibitedTarget CRD (even if it has some other paths that are not)</pre></code></td></tr><tr><td>33</td><td><code><pre>        isBlacklisted := func(pathMap n.ApplicationGatewayURLPathMap) bool {</pre></code></td></tr><tr><td>34</td><td><code><pre>                targetsForPathMap := pathMapToTargets[urlPathMapName(*pathMap.Name)]</pre></code></td></tr><tr><td>35</td><td><code><pre>                for _, target := range targetsForPathMap {</pre></code></td></tr><tr><td>36</td><td><code><pre>                        if target.IsBlacklisted(blacklist) {</pre></code></td></tr><tr><td>37</td><td><code><pre>                                klog.V(5).Infof(&#34;[brownfield] Routing PathMap %s is blacklisted&#34;, *pathMap.Name)</pre></code></td></tr><tr><td>38</td><td><code><pre>                                return true</pre></code></td></tr><tr><td>39</td><td><code><pre>                        }</pre></code></td></tr><tr><td>40</td><td><code><pre>                }</pre></code></td></tr><tr><td>41</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Routing PathMap %s is NOT blacklisted&#34;, *pathMap.Name)</pre></code></td></tr><tr><td>42</td><td><code><pre>                return false</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr><td>45</td><td><code><pre>        var blacklistedPathMaps []n.ApplicationGatewayURLPathMap</pre></code></td></tr><tr><td>46</td><td><code><pre>        var nonBlacklistedPathMaps []n.ApplicationGatewayURLPathMap</pre></code></td></tr><tr><td>47</td><td><code><pre>        for _, pathMap := range er.URLPathMaps {</pre></code></td></tr><tr><td>48</td><td><code><pre>                if isBlacklisted(pathMap) {</pre></code></td></tr><tr><td>49</td><td><code><pre>                        blacklistedPathMaps = append(blacklistedPathMaps, pathMap)</pre></code></td></tr><tr><td>50</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>51</td><td><code><pre>                }</pre></code></td></tr><tr><td>52</td><td><code><pre>                nonBlacklistedPathMaps = append(nonBlacklistedPathMaps, pathMap)</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr><td>54</td><td><code><pre>        return blacklistedPathMaps, nonBlacklistedPathMaps</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedRoutingRules">func ExistingResources.GetBlacklistedRoutingRules</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedRoutingRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>23</td><td><code><pre>func (er ExistingResources) GetBlacklistedRoutingRules() ([]n.ApplicationGatewayRequestRoutingRule, []n.ApplicationGatewayRequestRoutingRule) {</pre></code></td></tr><tr><td>24</td><td><code><pre></pre></code></td></tr><tr><td>25</td><td><code><pre>        // TODO(draychev): make a method of ExistingResources</pre></code></td></tr><tr><td>26</td><td><code><pre>        blacklist := GetTargetBlacklist(er.ProhibitedTargets)</pre></code></td></tr><tr><td>27</td><td><code><pre>        if blacklist == nil {</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                return nil, er.RoutingRules</pre></code></td></tr><tr><td>29</td><td><code><pre>        }</pre></code></td></tr><tr><td>30</td><td><code><pre>        ruleToTargets, _ := er.getRuleToTargets()</pre></code></td></tr><tr><td>31</td><td><code><pre>        klog.V(5).Infof(&#34;[brownfield] Rule to Targets map: %+v&#34;, ruleToTargets)</pre></code></td></tr><tr><td>32</td><td><code><pre></pre></code></td></tr><tr><td>33</td><td><code><pre>        // Figure out if the given routing rule is blacklisted. It will be if it has a host/path that</pre></code></td></tr><tr><td>34</td><td><code><pre>        // has been referenced in a AzureIngressProhibitedTarget CRD (even if it has some other paths that are not)</pre></code></td></tr><tr><td>35</td><td><code><pre>        isBlacklisted := func(rule n.ApplicationGatewayRequestRoutingRule) bool {</pre></code></td></tr><tr><td>36</td><td><code><pre>                targetsForRule := ruleToTargets[ruleName(*rule.Name)]</pre></code></td></tr><tr><td>37</td><td><code><pre>                for _, target := range targetsForRule {</pre></code></td></tr><tr><td>38</td><td><code><pre>                        if target.IsBlacklisted(blacklist) {</pre></code></td></tr><tr><td>39</td><td><code><pre>                                klog.V(5).Infof(&#34;[brownfield] Routing Rule %s is blacklisted&#34;, *rule.Name)</pre></code></td></tr><tr><td>40</td><td><code><pre>                                return true</pre></code></td></tr><tr><td>41</td><td><code><pre>                        }</pre></code></td></tr><tr><td>42</td><td><code><pre>                }</pre></code></td></tr><tr><td>43</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Routing Rule %s is NOT blacklisted&#34;, *rule.Name)</pre></code></td></tr><tr><td>44</td><td><code><pre>                return false</pre></code></td></tr><tr><td>45</td><td><code><pre>        }</pre></code></td></tr><tr><td>46</td><td><code><pre></pre></code></td></tr><tr><td>47</td><td><code><pre>        var blacklistedRules []n.ApplicationGatewayRequestRoutingRule</pre></code></td></tr><tr><td>48</td><td><code><pre>        var nonBlacklistedRules []n.ApplicationGatewayRequestRoutingRule</pre></code></td></tr><tr><td>49</td><td><code><pre>        for _, rule := range er.RoutingRules {</pre></code></td></tr><tr><td>50</td><td><code><pre>                if isBlacklisted(rule) {</pre></code></td></tr><tr><td>51</td><td><code><pre>                        blacklistedRules = append(blacklistedRules, rule)</pre></code></td></tr><tr><td>52</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>53</td><td><code><pre>                }</pre></code></td></tr><tr><td>54</td><td><code><pre>                nonBlacklistedRules = append(nonBlacklistedRules, rule)</pre></code></td></tr><tr><td>55</td><td><code><pre>        }</pre></code></td></tr><tr><td>56</td><td><code><pre>        return blacklistedRules, nonBlacklistedRules</pre></code></td></tr><tr><td>57</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogProbes">func LogProbes</div><div class="info"><a href="#s_fn_LogProbes">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/health_probes.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func LogProbes(logger Logger, existingBlacklisted []n.ApplicationGatewayProbe, existingNonBlacklisted []n.ApplicationGatewayProbe, managedProbes []n.ApplicationGatewayProbe) {</pre></code></td></tr><tr><td>54</td><td><code><pre>        var garbage []n.ApplicationGatewayProbe</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>        blacklistedSet := indexProbesByName(existingBlacklisted)</pre></code></td></tr><tr><td>57</td><td><code><pre>        managedSet := indexProbesByName(managedProbes)</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>        for probeName, probe := range indexProbesByName(existingNonBlacklisted) {</pre></code></td></tr><tr><td>60</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[probeName]</pre></code></td></tr><tr><td>61</td><td><code><pre>                _, existsInNewProbes := managedSet[probeName]</pre></code></td></tr><tr><td>62</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewProbes {</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                        garbage = append(garbage, probe)</pre></code></td></tr><tr><td>64</td><td><code><pre>                }</pre></code></td></tr><tr><td>65</td><td><code><pre>        }</pre></code></td></tr><tr><td>66</td><td><code><pre></pre></code></td></tr><tr><td>67</td><td><code><pre>        logger.Info(&#34;[brownfield] Probes AGIC created: &#34;, getProbeNames(managedProbes))</pre></code></td></tr><tr><td>68</td><td><code><pre>        logger.Info(&#34;[brownfield] Existing Blacklisted Probes AGIC will retain: &#34;, getProbeNames(existingBlacklisted))</pre></code></td></tr><tr><td>69</td><td><code><pre>        logger.Info(&#34;[brownfield] Existing Probes AGIC will remove: &#34;, getProbeNames(garbage))</pre></code></td></tr><tr><td>70</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_mergePathRules">func mergePathRules</div><div class="info"><a href="#s_fn_mergePathRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>109</td><td><code><pre>func mergePathRules(pathRulesBucket ...*[]n.ApplicationGatewayPathRule) *[]n.ApplicationGatewayPathRule {</pre></code></td></tr><tr><td>110</td><td><code><pre>        uniq := make(pathRulesByName)</pre></code></td></tr><tr><td>111</td><td><code><pre>        for _, bucket := range pathRulesBucket {</pre></code></td></tr><tr><td>112</td><td><code><pre>                if bucket == nil {</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>114</td><td><code><pre>                }</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>                for _, pathRule := range *bucket {</pre></code></td></tr><tr><td>117</td><td><code><pre>                        uniq[pathRuleName(*pathRule.Name)] = pathRule</pre></code></td></tr><tr><td>118</td><td><code><pre>                }</pre></code></td></tr><tr><td>119</td><td><code><pre>        }</pre></code></td></tr><tr><td>120</td><td><code><pre>        var merged []n.ApplicationGatewayPathRule</pre></code></td></tr><tr><td>121</td><td><code><pre>        for _, pathRule := range uniq {</pre></code></td></tr><tr><td>122</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Appending %s with paths %v&#34;, *pathRule.Name, pathRule.Paths)</pre></code></td></tr><tr><td>123</td><td><code><pre>                merged = append(merged, pathRule)</pre></code></td></tr><tr><td>124</td><td><code><pre>        }</pre></code></td></tr><tr><td>125</td><td><code><pre>        return &amp;merged</pre></code></td></tr><tr><td>126</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogHTTPSettings">func LogHTTPSettings</div><div class="info"><a href="#s_fn_LogHTTPSettings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code>:</p></div><table class="listing">
<tr><td>54</td><td><code><pre>func LogHTTPSettings(logger Logger, existingBlacklisted []n.ApplicationGatewayBackendHTTPSettings, existingNonBlacklisted []n.ApplicationGatewayBackendHTTPSettings, managedSettings []n.ApplicationGatewayBackendHTTPSettings) {</pre></code></td></tr><tr><td>55</td><td><code><pre>        var garbage []n.ApplicationGatewayBackendHTTPSettings</pre></code></td></tr><tr><td>56</td><td><code><pre></pre></code></td></tr><tr><td>57</td><td><code><pre>        blacklistedSet := indexSettingsByName(existingBlacklisted)</pre></code></td></tr><tr><td>58</td><td><code><pre>        managedSet := indexSettingsByName(managedSettings)</pre></code></td></tr><tr><td>59</td><td><code><pre></pre></code></td></tr><tr><td>60</td><td><code><pre>        for settingName, setting := range indexSettingsByName(existingNonBlacklisted) {</pre></code></td></tr><tr><td>61</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[settingName]</pre></code></td></tr><tr><td>62</td><td><code><pre>                _, existsInNewSettings := managedSet[settingName]</pre></code></td></tr><tr><td>63</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewSettings {</pre></code></td></tr><tr class="miss"><td>64</td><td><code><pre>                        garbage = append(garbage, setting)</pre></code></td></tr><tr><td>65</td><td><code><pre>                }</pre></code></td></tr><tr><td>66</td><td><code><pre>        }</pre></code></td></tr><tr><td>67</td><td><code><pre></pre></code></td></tr><tr><td>68</td><td><code><pre>        logger.Info(&#34;[brownfield] HTTP Settings AGIC created: &#34;, getSettingNames(managedSettings))</pre></code></td></tr><tr><td>69</td><td><code><pre>        logger.Info(&#34;[brownfield] Existing Blacklisted HTTP Settings AGIC will retain: &#34;, getSettingNames(existingBlacklisted))</pre></code></td></tr><tr><td>70</td><td><code><pre>        logger.Info(&#34;[brownfield] Existing HTTP Settings AGIC will remove: &#34;, getSettingNames(garbage))</pre></code></td></tr><tr><td>71</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getBlacklistedPoolsSet">func ExistingResources.getBlacklistedPoolsSet</div><div class="info"><a href="#s_fn_ExistingResources.getBlacklistedPoolsSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code>:</p></div><table class="listing">
<tr><td>91</td><td><code><pre>func (er ExistingResources) getBlacklistedPoolsSet() map[backendPoolName]interface{} {</pre></code></td></tr><tr><td>92</td><td><code><pre>        blacklistedRoutingRules, _ := er.GetBlacklistedRoutingRules()</pre></code></td></tr><tr><td>93</td><td><code><pre>        blacklistedPoolsSet := make(map[backendPoolName]interface{})</pre></code></td></tr><tr><td>94</td><td><code><pre>        for _, rule := range blacklistedRoutingRules {</pre></code></td></tr><tr><td>95</td><td><code><pre>                if rule.BackendAddressPool != nil &amp;&amp; rule.BackendAddressPool.ID != nil {</pre></code></td></tr><tr><td>96</td><td><code><pre>                        poolName := backendPoolName(utils.GetLastChunkOfSlashed(*rule.BackendAddressPool.ID))</pre></code></td></tr><tr><td>97</td><td><code><pre>                        blacklistedPoolsSet[poolName] = nil</pre></code></td></tr><tr><td>98</td><td><code><pre>                }</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        blacklistedPathMaps, _ := er.GetBlacklistedPathMaps()</pre></code></td></tr><tr><td>102</td><td><code><pre>        for _, pathMap := range blacklistedPathMaps {</pre></code></td></tr><tr><td>103</td><td><code><pre>                if pathMap.DefaultBackendAddressPool != nil &amp;&amp; pathMap.DefaultBackendAddressPool.ID != nil {</pre></code></td></tr><tr><td>104</td><td><code><pre>                        poolName := backendPoolName(utils.GetLastChunkOfSlashed(*pathMap.DefaultBackendAddressPool.ID))</pre></code></td></tr><tr><td>105</td><td><code><pre>                        blacklistedPoolsSet[poolName] = nil</pre></code></td></tr><tr><td>106</td><td><code><pre>                }</pre></code></td></tr><tr><td>107</td><td><code><pre>                if pathMap.PathRules == nil {</pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>                        klog.Errorf(&#34;PathMap %s does not have PathRules&#34;, *pathMap.Name)</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>110</td><td><code><pre>                }</pre></code></td></tr><tr><td>111</td><td><code><pre>                for _, rule := range *pathMap.PathRules {</pre></code></td></tr><tr><td>112</td><td><code><pre>                        if rule.BackendAddressPool != nil &amp;&amp; rule.BackendAddressPool.ID != nil {</pre></code></td></tr><tr><td>113</td><td><code><pre>                                poolName := backendPoolName(utils.GetLastChunkOfSlashed(*rule.BackendAddressPool.ID))</pre></code></td></tr><tr><td>114</td><td><code><pre>                                blacklistedPoolsSet[poolName] = nil</pre></code></td></tr><tr><td>115</td><td><code><pre>                        }</pre></code></td></tr><tr><td>116</td><td><code><pre>                }</pre></code></td></tr><tr><td>117</td><td><code><pre>        }</pre></code></td></tr><tr><td>118</td><td><code><pre></pre></code></td></tr><tr><td>119</td><td><code><pre>        return blacklistedPoolsSet</pre></code></td></tr><tr><td>120</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getBlacklistedSettingsSet">func ExistingResources.getBlacklistedSettingsSet</div><div class="info"><a href="#s_fn_ExistingResources.getBlacklistedSettingsSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/http_settings.go</code>:</p></div><table class="listing">
<tr><td>89</td><td><code><pre>func (er ExistingResources) getBlacklistedSettingsSet() map[settingName]interface{} {</pre></code></td></tr><tr><td>90</td><td><code><pre>        blacklistedRoutingRules, _ := er.GetBlacklistedRoutingRules()</pre></code></td></tr><tr><td>91</td><td><code><pre>        blacklistedSettingsSet := make(map[settingName]interface{})</pre></code></td></tr><tr><td>92</td><td><code><pre>        for _, rule := range blacklistedRoutingRules {</pre></code></td></tr><tr><td>93</td><td><code><pre>                if rule.BackendHTTPSettings != nil &amp;&amp; rule.BackendHTTPSettings.ID != nil {</pre></code></td></tr><tr><td>94</td><td><code><pre>                        settingName := settingName(utils.GetLastChunkOfSlashed(*rule.BackendHTTPSettings.ID))</pre></code></td></tr><tr><td>95</td><td><code><pre>                        blacklistedSettingsSet[settingName] = nil</pre></code></td></tr><tr><td>96</td><td><code><pre>                }</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr><td>98</td><td><code><pre></pre></code></td></tr><tr><td>99</td><td><code><pre>        blacklistedPathMaps, _ := er.GetBlacklistedPathMaps()</pre></code></td></tr><tr><td>100</td><td><code><pre>        for _, pathMap := range blacklistedPathMaps {</pre></code></td></tr><tr><td>101</td><td><code><pre>                if pathMap.DefaultBackendAddressPool != nil &amp;&amp; pathMap.DefaultBackendAddressPool.ID != nil {</pre></code></td></tr><tr><td>102</td><td><code><pre>                        settingName := settingName(utils.GetLastChunkOfSlashed(*pathMap.DefaultBackendHTTPSettings.ID))</pre></code></td></tr><tr><td>103</td><td><code><pre>                        blacklistedSettingsSet[settingName] = nil</pre></code></td></tr><tr><td>104</td><td><code><pre>                }</pre></code></td></tr><tr><td>105</td><td><code><pre>                if pathMap.PathRules == nil {</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>                        klog.Errorf(&#34;PathMap %s does not have PathRules&#34;, *pathMap.Name)</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>108</td><td><code><pre>                }</pre></code></td></tr><tr><td>109</td><td><code><pre>                for _, rule := range *pathMap.PathRules {</pre></code></td></tr><tr><td>110</td><td><code><pre>                        if rule.BackendAddressPool != nil &amp;&amp; rule.BackendAddressPool.ID != nil {</pre></code></td></tr><tr><td>111</td><td><code><pre>                                settingName := settingName(utils.GetLastChunkOfSlashed(*rule.BackendHTTPSettings.ID))</pre></code></td></tr><tr><td>112</td><td><code><pre>                                blacklistedSettingsSet[settingName] = nil</pre></code></td></tr><tr><td>113</td><td><code><pre>                        }</pre></code></td></tr><tr><td>114</td><td><code><pre>                }</pre></code></td></tr><tr><td>115</td><td><code><pre>        }</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr><td>117</td><td><code><pre>        return blacklistedSettingsSet</pre></code></td></tr><tr><td>118</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getBlacklistedRedirectsSet">func ExistingResources.getBlacklistedRedirectsSet</div><div class="info"><a href="#s_fn_ExistingResources.getBlacklistedRedirectsSet">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code>:</p></div><table class="listing">
<tr><td>91</td><td><code><pre>func (er ExistingResources) getBlacklistedRedirectsSet() map[redirectName]interface{} {</pre></code></td></tr><tr><td>92</td><td><code><pre>        blacklistedRoutingRules, _ := er.GetBlacklistedRoutingRules()</pre></code></td></tr><tr><td>93</td><td><code><pre>        blacklisted := make(map[redirectName]interface{})</pre></code></td></tr><tr><td>94</td><td><code><pre>        for _, rule := range blacklistedRoutingRules {</pre></code></td></tr><tr><td>95</td><td><code><pre>                if rule.RedirectConfiguration != nil &amp;&amp; rule.RedirectConfiguration.ID != nil {</pre></code></td></tr><tr><td>96</td><td><code><pre>                        redirectName := redirectName(utils.GetLastChunkOfSlashed(*rule.RedirectConfiguration.ID))</pre></code></td></tr><tr><td>97</td><td><code><pre>                        blacklisted[redirectName] = nil</pre></code></td></tr><tr><td>98</td><td><code><pre>                }</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        blacklistedPathMaps, _ := er.GetBlacklistedPathMaps()</pre></code></td></tr><tr><td>102</td><td><code><pre>        for _, pathMap := range blacklistedPathMaps {</pre></code></td></tr><tr><td>103</td><td><code><pre>                if pathMap.DefaultRedirectConfiguration != nil &amp;&amp; pathMap.DefaultRedirectConfiguration.ID != nil {</pre></code></td></tr><tr><td>104</td><td><code><pre>                        redirectName := redirectName(utils.GetLastChunkOfSlashed(*pathMap.DefaultRedirectConfiguration.ID))</pre></code></td></tr><tr><td>105</td><td><code><pre>                        blacklisted[redirectName] = nil</pre></code></td></tr><tr><td>106</td><td><code><pre>                }</pre></code></td></tr><tr><td>107</td><td><code><pre>                if pathMap.PathRules == nil {</pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>                        klog.Errorf(&#34;PathMap %s does not have PathRules&#34;, *pathMap.Name)</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>110</td><td><code><pre>                }</pre></code></td></tr><tr><td>111</td><td><code><pre>                for _, rule := range *pathMap.PathRules {</pre></code></td></tr><tr><td>112</td><td><code><pre>                        if rule.RedirectConfiguration != nil &amp;&amp; rule.RedirectConfiguration.ID != nil {</pre></code></td></tr><tr><td>113</td><td><code><pre>                                redirectName := redirectName(utils.GetLastChunkOfSlashed(*rule.RedirectConfiguration.ID))</pre></code></td></tr><tr><td>114</td><td><code><pre>                                blacklisted[redirectName] = nil</pre></code></td></tr><tr><td>115</td><td><code><pre>                        }</pre></code></td></tr><tr><td>116</td><td><code><pre>                }</pre></code></td></tr><tr><td>117</td><td><code><pre>        }</pre></code></td></tr><tr><td>118</td><td><code><pre></pre></code></td></tr><tr><td>119</td><td><code><pre>        return blacklisted</pre></code></td></tr><tr><td>120</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getRuleToTargets">func ExistingResources.getRuleToTargets</div><div class="info"><a href="#s_fn_ExistingResources.getRuleToTargets">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>180</td><td><code><pre>func (er ExistingResources) getRuleToTargets() (ruleToTargets, pathmapToTargets) {</pre></code></td></tr><tr><td>181</td><td><code><pre>        ruleToTargets := make(ruleToTargets)</pre></code></td></tr><tr><td>182</td><td><code><pre>        pathMapToTargets := make(pathmapToTargets)</pre></code></td></tr><tr><td>183</td><td><code><pre>        for _, rule := range er.RoutingRules {</pre></code></td></tr><tr><td>184</td><td><code><pre>                if rule.HTTPListener == nil || rule.HTTPListener.ID == nil {</pre></code></td></tr><tr class="miss"><td>185</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>186</td><td><code><pre>                }</pre></code></td></tr><tr><td>187</td><td><code><pre>                HostNames, err := er.getHostNamesForRoutingRule(rule)</pre></code></td></tr><tr><td>188</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>189</td><td><code><pre>                        klog.Errorf(&#34;[brownfield] Could not obtain hostname for rule %s; Skipping rule&#34;, ruleName(*rule.Name))</pre></code></td></tr><tr class="miss"><td>190</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>191</td><td><code><pre>                }</pre></code></td></tr><tr><td>192</td><td><code><pre></pre></code></td></tr><tr><td>193</td><td><code><pre>                for _, hostName := range HostNames {</pre></code></td></tr><tr><td>194</td><td><code><pre>                        // Regardless of whether we have a URL PathMap or not. This matches the default backend pool.</pre></code></td></tr><tr><td>195</td><td><code><pre>                        ruleToTargets[ruleName(*rule.Name)] = append(ruleToTargets[ruleName(*rule.Name)], Target{</pre></code></td></tr><tr><td>196</td><td><code><pre>                                Hostname: hostName,</pre></code></td></tr><tr><td>197</td><td><code><pre>                                // Path deliberately omitted</pre></code></td></tr><tr><td>198</td><td><code><pre>                        })</pre></code></td></tr><tr><td>199</td><td><code><pre>                }</pre></code></td></tr><tr><td>200</td><td><code><pre></pre></code></td></tr><tr><td>201</td><td><code><pre>                // SSL Redirects do not have BackendAddressPool</pre></code></td></tr><tr><td>202</td><td><code><pre>                if rule.URLPathMap != nil {</pre></code></td></tr><tr><td>203</td><td><code><pre>                        // Follow the path map</pre></code></td></tr><tr><td>204</td><td><code><pre>                        pathMapName, pathRules := er.getPathRules(rule)</pre></code></td></tr><tr><td>205</td><td><code><pre>                        for _, pathRule := range pathRules {</pre></code></td></tr><tr><td>206</td><td><code><pre>                                if pathRule.Paths == nil {</pre></code></td></tr><tr><td>207</td><td><code><pre>                                        klog.V(5).Infof(&#34;[brownfield] Path Rule %+v does not have paths list&#34;, *pathRule.Name)</pre></code></td></tr><tr><td>208</td><td><code><pre>                                        continue</pre></code></td></tr><tr><td>209</td><td><code><pre>                                }</pre></code></td></tr><tr><td>210</td><td><code><pre>                                for _, path := range *pathRule.Paths {</pre></code></td></tr><tr><td>211</td><td><code><pre>                                        for _, hostName := range HostNames {</pre></code></td></tr><tr><td>212</td><td><code><pre>                                                target := Target{hostName, TargetPath(path)}</pre></code></td></tr><tr><td>213</td><td><code><pre>                                                ruleToTargets[ruleName(*rule.Name)] = append(ruleToTargets[ruleName(*rule.Name)], target)</pre></code></td></tr><tr><td>214</td><td><code><pre>                                                pathMapToTargets[pathMapName] = append(pathMapToTargets[pathMapName], target)</pre></code></td></tr><tr><td>215</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>216</td><td><code><pre>                                }</pre></code></td></tr><tr><td>217</td><td><code><pre>                        }</pre></code></td></tr><tr><td>218</td><td><code><pre>                }</pre></code></td></tr><tr><td>219</td><td><code><pre>        }</pre></code></td></tr><tr><td>220</td><td><code><pre>        return ruleToTargets, pathMapToTargets</pre></code></td></tr><tr><td>221</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getListenersByName">func ExistingResources.getListenersByName</div><div class="info"><a href="#s_fn_ExistingResources.getListenersByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>128</td><td><code><pre>func (er *ExistingResources) getListenersByName() listenersByName {</pre></code></td></tr><tr><td>129</td><td><code><pre>        if er.listenersByName != nil {</pre></code></td></tr><tr class="miss"><td>130</td><td><code><pre>                return er.listenersByName</pre></code></td></tr><tr><td>131</td><td><code><pre>        }</pre></code></td></tr><tr><td>132</td><td><code><pre>        listenersByName := make(listenersByName)</pre></code></td></tr><tr><td>133</td><td><code><pre>        for _, listener := range er.Listeners {</pre></code></td></tr><tr><td>134</td><td><code><pre>                listenersByName[listenerName(listenerName(*listener.Name))] = listener</pre></code></td></tr><tr><td>135</td><td><code><pre>        }</pre></code></td></tr><tr><td>136</td><td><code><pre>        er.listenersByName = listenersByName</pre></code></td></tr><tr><td>137</td><td><code><pre>        return listenersByName</pre></code></td></tr><tr><td>138</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getURLPathMapsByName">func ExistingResources.getURLPathMapsByName</div><div class="info"><a href="#s_fn_ExistingResources.getURLPathMapsByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>177</td><td><code><pre>func (er ExistingResources) getURLPathMapsByName() pathMapsByName {</pre></code></td></tr><tr><td>178</td><td><code><pre>        if er.urlPathMapsByName != nil {</pre></code></td></tr><tr class="miss"><td>179</td><td><code><pre>                return er.urlPathMapsByName</pre></code></td></tr><tr><td>180</td><td><code><pre>        }</pre></code></td></tr><tr><td>181</td><td><code><pre>        // Index URLPathMaps by the path map name</pre></code></td></tr><tr><td>182</td><td><code><pre>        urlpathMapsByName := make(pathMapsByName)</pre></code></td></tr><tr><td>183</td><td><code><pre>        for _, pm := range er.URLPathMaps {</pre></code></td></tr><tr><td>184</td><td><code><pre>                urlpathMapsByName[urlPathMapName(*pm.Name)] = pm</pre></code></td></tr><tr><td>185</td><td><code><pre>        }</pre></code></td></tr><tr><td>186</td><td><code><pre></pre></code></td></tr><tr><td>187</td><td><code><pre>        er.urlPathMapsByName = urlpathMapsByName</pre></code></td></tr><tr><td>188</td><td><code><pre>        return urlpathMapsByName</pre></code></td></tr><tr><td>189</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_PruneIngressRules">func PruneIngressRules</div><div class="info"><a href="#s_fn_PruneIngressRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/ingress.go</code>:</p></div><table class="listing">
<tr><td>15</td><td><code><pre>func PruneIngressRules(ing *networking.Ingress, prohibitedTargets []*ptv1.AzureIngressProhibitedTarget) []networking.IngressRule {</pre></code></td></tr><tr><td>16</td><td><code><pre></pre></code></td></tr><tr><td>17</td><td><code><pre>        if ing.Spec.Rules == nil || len(ing.Spec.Rules) == 0 {</pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>                return ing.Spec.Rules</pre></code></td></tr><tr><td>19</td><td><code><pre>        }</pre></code></td></tr><tr><td>20</td><td><code><pre></pre></code></td></tr><tr><td>21</td><td><code><pre>        blacklist := GetTargetBlacklist(prohibitedTargets)</pre></code></td></tr><tr><td>22</td><td><code><pre></pre></code></td></tr><tr><td>23</td><td><code><pre>        if blacklist == nil || len(*blacklist) == 0 {</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>                return ing.Spec.Rules</pre></code></td></tr><tr><td>25</td><td><code><pre>        }</pre></code></td></tr><tr><td>26</td><td><code><pre></pre></code></td></tr><tr><td>27</td><td><code><pre>        var rules []networking.IngressRule</pre></code></td></tr><tr><td>28</td><td><code><pre></pre></code></td></tr><tr><td>29</td><td><code><pre>        for _, rule := range ing.Spec.Rules {</pre></code></td></tr><tr><td>30</td><td><code><pre>                if rule.HTTP == nil {</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>32</td><td><code><pre>                }</pre></code></td></tr><tr><td>33</td><td><code><pre>                target := Target{</pre></code></td></tr><tr><td>34</td><td><code><pre>                        Hostname: rule.Host,</pre></code></td></tr><tr><td>35</td><td><code><pre>                }</pre></code></td></tr><tr><td>36</td><td><code><pre>                if rule.HTTP.Paths == nil {</pre></code></td></tr><tr><td>37</td><td><code><pre>                        if target.IsBlacklisted(blacklist) {</pre></code></td></tr><tr><td>38</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>39</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>                        rules = append(rules, rule)</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                        continue // to next rule</pre></code></td></tr><tr><td>42</td><td><code><pre>                }</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr><td>44</td><td><code><pre>                newRule := networking.IngressRule{</pre></code></td></tr><tr><td>45</td><td><code><pre>                        Host: rule.Host,</pre></code></td></tr><tr><td>46</td><td><code><pre>                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>47</td><td><code><pre>                                HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>48</td><td><code><pre>                                        Paths: []networking.HTTPIngressPath{},</pre></code></td></tr><tr><td>49</td><td><code><pre>                                },</pre></code></td></tr><tr><td>50</td><td><code><pre>                        },</pre></code></td></tr><tr><td>51</td><td><code><pre>                }</pre></code></td></tr><tr><td>52</td><td><code><pre>                for _, path := range rule.HTTP.Paths {</pre></code></td></tr><tr><td>53</td><td><code><pre>                        target.Path = TargetPath(path.Path)</pre></code></td></tr><tr><td>54</td><td><code><pre>                        if target.IsBlacklisted(blacklist) {</pre></code></td></tr><tr><td>55</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>56</td><td><code><pre>                        }</pre></code></td></tr><tr><td>57</td><td><code><pre>                        newRule.HTTP.Paths = append(newRule.HTTP.Paths, path)</pre></code></td></tr><tr><td>58</td><td><code><pre>                }</pre></code></td></tr><tr><td>59</td><td><code><pre>                if len(newRule.HTTP.Paths) &gt; 0 {</pre></code></td></tr><tr><td>60</td><td><code><pre>                        rules = append(rules, newRule)</pre></code></td></tr><tr><td>61</td><td><code><pre>                }</pre></code></td></tr><tr><td>62</td><td><code><pre>        }</pre></code></td></tr><tr><td>63</td><td><code><pre></pre></code></td></tr><tr><td>64</td><td><code><pre>        return rules</pre></code></td></tr><tr><td>65</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_mergeRoutingRules">func mergeRoutingRules</div><div class="info"><a href="#s_fn_mergeRoutingRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>101</td><td><code><pre>func mergeRoutingRules(appGw *n.ApplicationGateway, firstRoutingRule *n.ApplicationGatewayRequestRoutingRule, secondRoutingRule *n.ApplicationGatewayRequestRoutingRule) *n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>102</td><td><code><pre>        if firstRoutingRule.RuleType == n.ApplicationGatewayRequestRoutingRuleTypeBasic &amp;&amp;</pre></code></td></tr><tr><td>103</td><td><code><pre>                secondRoutingRule.RuleType == n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting {</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                return mergeRoutingRules(appGw, secondRoutingRule, firstRoutingRule)</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr><td>106</td><td><code><pre></pre></code></td></tr><tr><td>107</td><td><code><pre>        if firstRoutingRule.RuleType == n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting {</pre></code></td></tr><tr><td>108</td><td><code><pre>                // Get the url path map of the first rule</pre></code></td></tr><tr><td>109</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Merging path based rule %s with rule %s&#34;, *firstRoutingRule.Name, *secondRoutingRule.Name)</pre></code></td></tr><tr><td>110</td><td><code><pre>                firstPathMap := lookupPathMap(appGw.URLPathMaps, firstRoutingRule.URLPathMap.ID)</pre></code></td></tr><tr><td>111</td><td><code><pre></pre></code></td></tr><tr><td>112</td><td><code><pre>                if secondRoutingRule.RuleType == n.ApplicationGatewayRequestRoutingRuleTypeBasic {</pre></code></td></tr><tr><td>113</td><td><code><pre>                        // Replace the default values from the second rule</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Merging path map %s with rule %s&#34;, *firstPathMap.Name, *secondRoutingRule.Name)</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>                        mergePathMapsWithBasicRule(firstPathMap, secondRoutingRule)</pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>                        return firstRoutingRule</pre></code></td></tr><tr><td>117</td><td><code><pre>                }</pre></code></td></tr><tr><td>118</td><td><code><pre></pre></code></td></tr><tr><td>119</td><td><code><pre>                if *firstRoutingRule.URLPathMap.ID == *secondRoutingRule.URLPathMap.ID {</pre></code></td></tr><tr><td>120</td><td><code><pre>                        // No merge needed as both routing rule point to the same URL Path map</pre></code></td></tr><tr><td>121</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Rule %s and rule %s share the same path map %s; Skipping merge&#34;, *firstRoutingRule.Name, *secondRoutingRule.Name, *firstPathMap.Name)</pre></code></td></tr><tr><td>122</td><td><code><pre>                        return firstRoutingRule</pre></code></td></tr><tr><td>123</td><td><code><pre>                }</pre></code></td></tr><tr><td>124</td><td><code><pre></pre></code></td></tr><tr><td>125</td><td><code><pre>                // Get the url path map for the second rule</pre></code></td></tr><tr><td>126</td><td><code><pre>                secondPathMap := lookupPathMap(appGw.URLPathMaps, secondRoutingRule.URLPathMap.ID)</pre></code></td></tr><tr><td>127</td><td><code><pre></pre></code></td></tr><tr><td>128</td><td><code><pre>                // Merge the path rules from second path map to first path map</pre></code></td></tr><tr><td>129</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Merging path map %s with path map %s&#34;, *firstPathMap.Name, *secondPathMap.Name)</pre></code></td></tr><tr><td>130</td><td><code><pre>                firstPathMap.PathRules = mergePathRules(firstPathMap.PathRules, secondPathMap.PathRules)</pre></code></td></tr><tr><td>131</td><td><code><pre></pre></code></td></tr><tr><td>132</td><td><code><pre>                // Delete the second path map</pre></code></td></tr><tr><td>133</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Deleting path map %s&#34;, *secondPathMap.Name)</pre></code></td></tr><tr><td>134</td><td><code><pre>                appGw.URLPathMaps = deletePathMap(appGw.URLPathMaps, secondPathMap.ID)</pre></code></td></tr><tr><td>135</td><td><code><pre>        }</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr><td>137</td><td><code><pre>        return firstRoutingRule</pre></code></td></tr><tr><td>138</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_lookupPathMap">func lookupPathMap</div><div class="info"><a href="#s_fn_lookupPathMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>129</td><td><code><pre>func lookupPathMap(pathMaps *[]n.ApplicationGatewayURLPathMap, resourceID *string) *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>130</td><td><code><pre>        for idx, pathMap := range *pathMaps {</pre></code></td></tr><tr><td>131</td><td><code><pre>                if *pathMap.ID == *resourceID {</pre></code></td></tr><tr><td>132</td><td><code><pre>                        return &amp;(*pathMaps)[idx]</pre></code></td></tr><tr><td>133</td><td><code><pre>                }</pre></code></td></tr><tr><td>134</td><td><code><pre>        }</pre></code></td></tr><tr><td>135</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>136</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>137</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.GetBlacklistedRedirects">func ExistingResources.GetBlacklistedRedirects</div><div class="info"><a href="#s_fn_ExistingResources.GetBlacklistedRedirects">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code>:</p></div><table class="listing">
<tr><td>21</td><td><code><pre>func (er ExistingResources) GetBlacklistedRedirects() ([]n.ApplicationGatewayRedirectConfiguration, []n.ApplicationGatewayRedirectConfiguration) {</pre></code></td></tr><tr><td>22</td><td><code><pre>        blacklisted := er.getBlacklistedRedirectsSet()</pre></code></td></tr><tr><td>23</td><td><code><pre>        var blacklistedRedirects []n.ApplicationGatewayRedirectConfiguration</pre></code></td></tr><tr><td>24</td><td><code><pre>        var nonBlacklistedRedirects []n.ApplicationGatewayRedirectConfiguration</pre></code></td></tr><tr><td>25</td><td><code><pre>        for _, redirect := range er.Redirects {</pre></code></td></tr><tr><td>26</td><td><code><pre>                if _, isBlacklisted := blacklisted[redirectName(*redirect.Name)]; isBlacklisted {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                        blacklistedRedirects = append(blacklistedRedirects, redirect)</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                        klog.V(5).Infof(&#34;[brownfield] Redirect %s is blacklisted&#34;, *redirect.Name)</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr><td>31</td><td><code><pre>                klog.V(5).Infof(&#34;[brownfield] Redirect %s is not blacklisted&#34;, *redirect.Name)</pre></code></td></tr><tr><td>32</td><td><code><pre>                nonBlacklistedRedirects = append(nonBlacklistedRedirects, redirect)</pre></code></td></tr><tr><td>33</td><td><code><pre>        }</pre></code></td></tr><tr><td>34</td><td><code><pre>        return blacklistedRedirects, nonBlacklistedRedirects</pre></code></td></tr><tr><td>35</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getHostNamesForRoutingRule">func ExistingResources.getHostNamesForRoutingRule</div><div class="info"><a href="#s_fn_ExistingResources.getHostNamesForRoutingRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>159</td><td><code><pre>func (er ExistingResources) getHostNamesForRoutingRule(rule n.ApplicationGatewayRequestRoutingRule) ([]string, error) {</pre></code></td></tr><tr><td>160</td><td><code><pre>        listenerName := listenerName(utils.GetLastChunkOfSlashed(*rule.HTTPListener.ID))</pre></code></td></tr><tr><td>161</td><td><code><pre>        if listener, found := er.getListenersByName()[listenerName]; !found {</pre></code></td></tr><tr class="miss"><td>162</td><td><code><pre>                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>163</td><td><code><pre>                        controllererrors.ErrorGeneratingListeners,</pre></code></td></tr><tr><td>164</td><td><code><pre>                        &#34;[brownfield] Could not find listener %s in index&#34;, listenerName,</pre></code></td></tr><tr><td>165</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>166</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>167</td><td><code><pre>                return []string{&#34;&#34;}, e</pre></code></td></tr><tr><td>168</td><td><code><pre>        } else if listener.HostName != nil {</pre></code></td></tr><tr><td>169</td><td><code><pre>                return []string{*listener.HostName}, nil</pre></code></td></tr><tr><td>170</td><td><code><pre>        } else if listener.HostNames != nil &amp;&amp; len(*listener.HostNames) &gt; 0 {</pre></code></td></tr><tr><td>171</td><td><code><pre>                return *listener.HostNames, nil</pre></code></td></tr><tr><td>172</td><td><code><pre>        }</pre></code></td></tr><tr><td>173</td><td><code><pre></pre></code></td></tr><tr><td>174</td><td><code><pre>        return []string{&#34;&#34;}, nil</pre></code></td></tr><tr><td>175</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ExistingResources.getPathRules">func ExistingResources.getPathRules</div><div class="info"><a href="#s_fn_ExistingResources.getPathRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>223</td><td><code><pre>func (er ExistingResources) getPathRules(rule n.ApplicationGatewayRequestRoutingRule) (urlPathMapName, []n.ApplicationGatewayPathRule) {</pre></code></td></tr><tr><td>224</td><td><code><pre>        pathMapName := urlPathMapName(utils.GetLastChunkOfSlashed(*rule.URLPathMap.ID))</pre></code></td></tr><tr><td>225</td><td><code><pre>        pathMapsByName := er.getURLPathMapsByName()</pre></code></td></tr><tr><td>226</td><td><code><pre>        if pathMap, ok := pathMapsByName[pathMapName]; ok {</pre></code></td></tr><tr><td>227</td><td><code><pre>                return pathMapName, *pathMap.PathRules</pre></code></td></tr><tr><td>228</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>229</td><td><code><pre>        klog.Errorf(&#34;[brownfield] Did not find URLPathMap with ID %s&#34;, pathMapName)</pre></code></td></tr><tr class="miss"><td>230</td><td><code><pre>        return pathMapName, []n.ApplicationGatewayPathRule{}</pre></code></td></tr><tr><td>231</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergeListeners">func MergeListeners</div><div class="info"><a href="#s_fn_MergeListeners">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>57</td><td><code><pre>func MergeListeners(listenerBuckets ...[]n.ApplicationGatewayHTTPListener) []n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>        uniq := make(map[uniqueListenerConfig]n.ApplicationGatewayHTTPListener)</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>        for _, bucket := range listenerBuckets {</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                for _, listener := range bucket {</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                        listenerConfig := uniqueListenerConfig{</pre></code></td></tr><tr><td>62</td><td><code><pre>                                Protocol: listener.Protocol,</pre></code></td></tr><tr><td>63</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>64</td><td><code><pre>                        if listener.HostName != nil {</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>                                listenerConfig.setHostNames([]string{*listener.HostName})</pre></code></td></tr><tr><td>66</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                        if listener.HostNames != nil &amp;&amp; len(*listener.HostNames) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                                listenerConfig.setHostNames(*listener.HostNames)</pre></code></td></tr><tr><td>69</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>                        if listener.FrontendIPConfiguration != nil &amp;&amp; listener.FrontendIPConfiguration.ID != nil {</pre></code></td></tr><tr class="miss"><td>71</td><td><code><pre>                                listenerConfig.FrontendIPConfiguration = *listener.FrontendIPConfiguration.ID</pre></code></td></tr><tr><td>72</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>                        if listener.FrontendPort != nil &amp;&amp; listener.FrontendPort.ID != nil {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                                listenerConfig.FrontendPortID = *listener.FrontendPort.ID</pre></code></td></tr><tr><td>75</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>                        if _, exists := uniq[listenerConfig]; !exists {</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>                                uniq[listenerConfig] = listener</pre></code></td></tr><tr><td>78</td><td><code><pre>                        }</pre></code></td></tr><tr><td>79</td><td><code><pre>                }</pre></code></td></tr><tr><td>80</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>        var merged []n.ApplicationGatewayHTTPListener</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>        for _, listener := range uniq {</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                merged = append(merged, listener)</pre></code></td></tr><tr><td>84</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>86</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergePathMaps">func MergePathMaps</div><div class="info"><a href="#s_fn_MergePathMaps">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>58</td><td><code><pre>func MergePathMaps(pathMapBuckets ...[]n.ApplicationGatewayURLPathMap) []n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>        uniq := make(pathMapsByName)</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>        for _, bucket := range pathMapBuckets {</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                for _, pathMap := range bucket {</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                        if existingPathMap, exists := uniq[urlPathMapName(*pathMap.Name)]; exists {</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                                klog.V(5).Infof(&#34;[brownfield] Merging urlpath %s in existing blacklist and AGIC list&#34;, *existingPathMap.Name)</pre></code></td></tr><tr class="miss"><td>64</td><td><code><pre>                                uniq[urlPathMapName(*pathMap.Name)].PathRules = mergePathRules(existingPathMap.PathRules, pathMap.PathRules)</pre></code></td></tr><tr><td>65</td><td><code><pre>                        } else {</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>                                klog.V(5).Infof(&#34;[brownfield] Adding urlpath %s to the uniq map&#34;, *pathMap.Name)</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                                uniq[urlPathMapName(*pathMap.Name)] = pathMap</pre></code></td></tr><tr><td>68</td><td><code><pre>                        }</pre></code></td></tr><tr><td>69</td><td><code><pre>                }</pre></code></td></tr><tr><td>70</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>71</td><td><code><pre>        var merged []n.ApplicationGatewayURLPathMap</pre></code></td></tr><tr class="miss"><td>72</td><td><code><pre>        for _, pathMap := range uniq {</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>                merged = append(merged, pathMap)</pre></code></td></tr><tr><td>74</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>75</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>76</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogRedirects">func LogRedirects</div><div class="info"><a href="#s_fn_LogRedirects">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code>:</p></div><table class="listing">
<tr><td>38</td><td><code><pre>func LogRedirects(existingBlacklisted []n.ApplicationGatewayRedirectConfiguration, existingNonBlacklisted []n.ApplicationGatewayRedirectConfiguration, managedRedirects []n.ApplicationGatewayRedirectConfiguration) {</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>        var garbage []n.ApplicationGatewayRedirectConfiguration</pre></code></td></tr><tr><td>40</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>        blacklistedSet := indexRedirectsByName(existingBlacklisted)</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>        managedSet := indexRedirectsByName(managedRedirects)</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>        for redirectName, redirect := range indexRedirectsByName(existingNonBlacklisted) {</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[redirectName]</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                _, existsInNewRedirects := managedSet[redirectName]</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewRedirects {</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>                        garbage = append(garbage, redirect)</pre></code></td></tr><tr><td>49</td><td><code><pre>                }</pre></code></td></tr><tr><td>50</td><td><code><pre>        }</pre></code></td></tr><tr><td>51</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Redirects AGIC created: &#34;, getRedirectNames(managedRedirects))</pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Blacklisted Redirects AGIC will retain: &#34;, getRedirectNames(existingBlacklisted))</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Redirects AGIC will remove: &#34;, getRedirectNames(garbage))</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogListeners">func LogListeners</div><div class="info"><a href="#s_fn_LogListeners">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>89</td><td><code><pre>func LogListeners(existingBlacklisted []n.ApplicationGatewayHTTPListener, existingNonBlacklisted []n.ApplicationGatewayHTTPListener, managedListeners []n.ApplicationGatewayHTTPListener) {</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>        var garbage []n.ApplicationGatewayHTTPListener</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>        blacklistedSet := indexListenersByName(existingBlacklisted)</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>        managedSet := indexListenersByName(managedListeners)</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>        for listenerName, listener := range indexListenersByName(existingNonBlacklisted) {</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[listenerName]</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>                _, existsInNewListeners := managedSet[listenerName]</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewListeners {</pre></code></td></tr><tr class="miss"><td>99</td><td><code><pre>                        garbage = append(garbage, listener)</pre></code></td></tr><tr><td>100</td><td><code><pre>                }</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Listeners AGIC created: &#34;, getListenerNames(managedListeners))</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Blacklisted Listeners AGIC will retain: &#34;, getListenerNames(existingBlacklisted))</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Listeners AGIC will remove: &#34;, getListenerNames(garbage))</pre></code></td></tr><tr><td>106</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogPools">func LogPools</div><div class="info"><a href="#s_fn_LogPools">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func LogPools(existingBlacklisted []n.ApplicationGatewayBackendAddressPool, existingNonBlacklisted []n.ApplicationGatewayBackendAddressPool, managedPools []n.ApplicationGatewayBackendAddressPool) {</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>        var garbage []n.ApplicationGatewayBackendAddressPool</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>        blacklistedSet := indexPoolsByName(existingBlacklisted)</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>        managedSet := indexPoolsByName(managedPools)</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>        for poolName, pool := range indexPoolsByName(existingNonBlacklisted) {</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[poolName]</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                _, existsInNewPools := managedSet[poolName]</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewPools {</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                        garbage = append(garbage, pool)</pre></code></td></tr><tr><td>64</td><td><code><pre>                }</pre></code></td></tr><tr><td>65</td><td><code><pre>        }</pre></code></td></tr><tr><td>66</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Pools AGIC created: &#34;, getPoolNames(managedPools))</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Blacklisted Pools AGIC will retain: &#34;, getPoolNames(existingBlacklisted))</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Pools AGIC will remove: &#34;, getPoolNames(garbage))</pre></code></td></tr><tr><td>70</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogRules">func LogRules</div><div class="info"><a href="#s_fn_LogRules">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>81</td><td><code><pre>func LogRules(existingBlacklisted []n.ApplicationGatewayRequestRoutingRule, existingNonBlacklisted []n.ApplicationGatewayRequestRoutingRule, managedRules []n.ApplicationGatewayRequestRoutingRule) {</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>        var garbage []n.ApplicationGatewayRequestRoutingRule</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>        blacklistedSet := indexRulesByName(existingBlacklisted)</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>        managedSet := indexRulesByName(managedRules)</pre></code></td></tr><tr><td>86</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>        for ruleName, rule := range indexRulesByName(existingNonBlacklisted) {</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[ruleName]</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                _, existsInNewRules := managedSet[ruleName]</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewRules {</pre></code></td></tr><tr class="miss"><td>91</td><td><code><pre>                        garbage = append(garbage, rule)</pre></code></td></tr><tr><td>92</td><td><code><pre>                }</pre></code></td></tr><tr><td>93</td><td><code><pre>        }</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Rules AGIC created: &#34;, getRuleNames(managedRules))</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Blacklisted Rules AGIC will retain: &#34;, getRuleNames(existingBlacklisted))</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Rules AGIC will remove: &#34;, getRuleNames(garbage))</pre></code></td></tr><tr><td>98</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_LogPathMaps">func LogPathMaps</div><div class="info"><a href="#s_fn_LogPathMaps">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>79</td><td><code><pre>func LogPathMaps(existingBlacklisted []n.ApplicationGatewayURLPathMap, existingNonBlacklisted []n.ApplicationGatewayURLPathMap, managedPathMaps []n.ApplicationGatewayURLPathMap) {</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>        var garbage []n.ApplicationGatewayURLPathMap</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>        blacklistedSet := indexPathMapsByName(existingBlacklisted)</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>        managedSet := indexPathMapsByName(managedPathMaps)</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>        for pathMapName, pathMap := range indexPathMapsByName(existingNonBlacklisted) {</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                _, existsInBlacklist := blacklistedSet[pathMapName]</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>                _, existsInNewPathMaps := managedSet[pathMapName]</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>                if !existsInBlacklist &amp;&amp; !existsInNewPathMaps {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                        garbage = append(garbage, pathMap)</pre></code></td></tr><tr><td>90</td><td><code><pre>                }</pre></code></td></tr><tr><td>91</td><td><code><pre>        }</pre></code></td></tr><tr><td>92</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] PathMaps AGIC created: &#34;, getPathMapNames(managedPathMaps))</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing Blacklisted PathMaps AGIC will retain: &#34;, getPathMapNames(existingBlacklisted))</pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>        klog.V(3).Info(&#34;[brownfield] Existing PathMaps AGIC will remove: &#34;, getPathMapNames(garbage))</pre></code></td></tr><tr><td>96</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_MergeRedirects">func MergeRedirects</div><div class="info"><a href="#s_fn_MergeRedirects">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code>:</p></div><table class="listing">
<tr><td>58</td><td><code><pre>func MergeRedirects(redirectBuckets ...[]n.ApplicationGatewayRedirectConfiguration) []n.ApplicationGatewayRedirectConfiguration {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>        uniqRedirects := make(redirectsByName)</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>        for _, bucket := range redirectBuckets {</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                for _, redirect := range bucket {</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                        uniqRedirects[redirectName(*redirect.Name)] = redirect</pre></code></td></tr><tr><td>63</td><td><code><pre>                }</pre></code></td></tr><tr><td>64</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>        var merged []n.ApplicationGatewayRedirectConfiguration</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>        for _, redirect := range uniqRedirects {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                merged = append(merged, redirect)</pre></code></td></tr><tr><td>68</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>        return merged</pre></code></td></tr><tr><td>70</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getRuleNames">func getRuleNames</div><div class="info"><a href="#s_fn_getRuleNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>140</td><td><code><pre>func getRuleNames(cert []n.ApplicationGatewayRequestRoutingRule) string {</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>        var names []string</pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>        for _, p := range cert {</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                names = append(names, *p.Name)</pre></code></td></tr><tr><td>144</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>145</td><td><code><pre>        if len(names) == 0 {</pre></code></td></tr><tr class="miss"><td>146</td><td><code><pre>                return &#34;n/a&#34;</pre></code></td></tr><tr><td>147</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>148</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>149</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getRedirectNames">func getRedirectNames</div><div class="info"><a href="#s_fn_getRedirectNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/redirects.go</code>:</p></div><table class="listing">
<tr><td>72</td><td><code><pre>func getRedirectNames(redirects []n.ApplicationGatewayRedirectConfiguration) string {</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>        var names []string</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>        for _, redirect := range redirects {</pre></code></td></tr><tr class="miss"><td>75</td><td><code><pre>                names = append(names, *redirect.Name)</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>        if len(names) == 0 {</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>                return &#34;n/a&#34;</pre></code></td></tr><tr><td>79</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>81</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getPoolNames">func getPoolNames</div><div class="info"><a href="#s_fn_getPoolNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code>:</p></div><table class="listing">
<tr><td>80</td><td><code><pre>func getPoolNames(pool []n.ApplicationGatewayBackendAddressPool) string {</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>        var names []string</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>        for _, p := range pool {</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                names = append(names, *p.Name)</pre></code></td></tr><tr><td>84</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>        if len(names) == 0 {</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                return &#34;n/a&#34;</pre></code></td></tr><tr><td>87</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>88</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>89</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getListenerNames">func getListenerNames</div><div class="info"><a href="#s_fn_getListenerNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>108</td><td><code><pre>func getListenerNames(listeners []n.ApplicationGatewayHTTPListener) string {</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>        var names []string</pre></code></td></tr><tr class="miss"><td>110</td><td><code><pre>        for _, p := range listeners {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                names = append(names, *p.Name)</pre></code></td></tr><tr><td>112</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>        if len(names) == 0 {</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>                return &#34;n/a&#34;</pre></code></td></tr><tr><td>115</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>117</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getPathMapNames">func getPathMapNames</div><div class="info"><a href="#s_fn_getPathMapNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>158</td><td><code><pre>func getPathMapNames(pathMaps []n.ApplicationGatewayURLPathMap) string {</pre></code></td></tr><tr class="miss"><td>159</td><td><code><pre>        var names []string</pre></code></td></tr><tr class="miss"><td>160</td><td><code><pre>        for _, pathMap := range pathMaps {</pre></code></td></tr><tr class="miss"><td>161</td><td><code><pre>                names = append(names, *pathMap.Name)</pre></code></td></tr><tr><td>162</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>163</td><td><code><pre>        if len(names) == 0 {</pre></code></td></tr><tr class="miss"><td>164</td><td><code><pre>                return &#34;n/a&#34;</pre></code></td></tr><tr><td>165</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>166</td><td><code><pre>        return strings.Join(names, &#34;, &#34;)</pre></code></td></tr><tr><td>167</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_mergePathMapsWithBasicRule">func mergePathMapsWithBasicRule</div><div class="info"><a href="#s_fn_mergePathMapsWithBasicRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>99</td><td><code><pre>func mergePathMapsWithBasicRule(pathMap *n.ApplicationGatewayURLPathMap, rule *n.ApplicationGatewayRequestRoutingRule) *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>100</td><td><code><pre>        // Replace the default values in the path map with values from the routing rule</pre></code></td></tr><tr class="miss"><td>101</td><td><code><pre>        pathMap.DefaultBackendAddressPool = rule.BackendAddressPool</pre></code></td></tr><tr class="miss"><td>102</td><td><code><pre>        pathMap.DefaultBackendHTTPSettings = rule.BackendHTTPSettings</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        pathMap.DefaultRedirectConfiguration = rule.RedirectConfiguration</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>        pathMap.DefaultRewriteRuleSet = rule.RewriteRuleSet</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>        return pathMap</pre></code></td></tr><tr><td>106</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexRulesByName">func indexRulesByName</div><div class="info"><a href="#s_fn_indexRulesByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>151</td><td><code><pre>func indexRulesByName(rules []n.ApplicationGatewayRequestRoutingRule) rulesByName {</pre></code></td></tr><tr class="miss"><td>152</td><td><code><pre>        indexed := make(rulesByName)</pre></code></td></tr><tr class="miss"><td>153</td><td><code><pre>        for _, rule := range rules {</pre></code></td></tr><tr class="miss"><td>154</td><td><code><pre>                indexed[ruleName(*rule.Name)] = rule</pre></code></td></tr><tr><td>155</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>156</td><td><code><pre>        return indexed</pre></code></td></tr><tr><td>157</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexPoolsByName">func indexPoolsByName</div><div class="info"><a href="#s_fn_indexPoolsByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pools.go</code>:</p></div><table class="listing">
<tr><td>72</td><td><code><pre>func indexPoolsByName(pools []n.ApplicationGatewayBackendAddressPool) poolsByName {</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>        indexed := make(poolsByName)</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>        for _, pool := range pools {</pre></code></td></tr><tr class="miss"><td>75</td><td><code><pre>                indexed[backendPoolName(*pool.Name)] = pool</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>        return indexed</pre></code></td></tr><tr><td>78</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexPathMapsByName">func indexPathMapsByName</div><div class="info"><a href="#s_fn_indexPathMapsByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/pathmaps.go</code>:</p></div><table class="listing">
<tr><td>169</td><td><code><pre>func indexPathMapsByName(pathMaps []n.ApplicationGatewayURLPathMap) pathMapsByName {</pre></code></td></tr><tr class="miss"><td>170</td><td><code><pre>        indexed := make(pathMapsByName)</pre></code></td></tr><tr class="miss"><td>171</td><td><code><pre>        for _, pathMap := range pathMaps {</pre></code></td></tr><tr class="miss"><td>172</td><td><code><pre>                indexed[urlPathMapName(*pathMap.Name)] = pathMap</pre></code></td></tr><tr><td>173</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>174</td><td><code><pre>        return indexed</pre></code></td></tr><tr><td>175</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_indexListenersByName">func indexListenersByName</div><div class="info"><a href="#s_fn_indexListenersByName">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>119</td><td><code><pre>func indexListenersByName(listeners []n.ApplicationGatewayHTTPListener) listenersByName {</pre></code></td></tr><tr class="miss"><td>120</td><td><code><pre>        indexed := make(listenersByName)</pre></code></td></tr><tr class="miss"><td>121</td><td><code><pre>        for _, listener := range listeners {</pre></code></td></tr><tr class="miss"><td>122</td><td><code><pre>                indexed[listenerName(*listener.Name)] = listener</pre></code></td></tr><tr><td>123</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>124</td><td><code><pre>        return indexed</pre></code></td></tr><tr><td>125</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_uniqueListenerConfig.setHostNames">func uniqueListenerConfig.setHostNames</div><div class="info"><a href="#s_fn_uniqueListenerConfig.setHostNames">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/brownfield/listeners.go</code>:</p></div><table class="listing">
<tr><td>49</td><td><code><pre>func (config *uniqueListenerConfig) setHostNames(hostNames []string) {</pre></code></td></tr><tr class="miss"><td>50</td><td><code><pre>        hostnameCount := int(math.Min(float64(len(hostNames)), float64(MaxAllowedHostNames)))</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>        for i := 0; i &lt; hostnameCount; i++ {</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                config.HostNames[i] = hostNames[i]</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr><td>54</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/brownfield DONE:69.40
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller <span class="packageTotal">42.74%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_deleteKey"><td><code><a href="#fn_deleteKey">deleteKey(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>14/14</code></td></tr>
<tr id="s_fn_reconcilerTickerTask"><td><code><a href="#fn_reconcilerTickerTask">reconcilerTickerTask(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_AppGwIngressController.Start"><td><code><a href="#fn_AppGwIngressController.Start">AppGwIngressController.Start(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_pruneProhibitedIngress"><td><code><a href="#fn_pruneProhibitedIngress">pruneProhibitedIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_resetBackReference"><td><code><a href="#fn_resetBackReference">resetBackReference(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_NewAppGwIngressController"><td><code><a href="#fn_NewAppGwIngressController">NewAppGwIngressController(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_AppGwIngressController.Stop"><td><code><a href="#fn_AppGwIngressController.Stop">AppGwIngressController.Stop(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_isSlice"><td><code><a href="#fn_isSlice">isSlice(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_isMap"><td><code><a href="#fn_isMap">isMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_AppGwIngressController.isApplicationGatewayMutable"><td><code><a href="#fn_AppGwIngressController.isApplicationGatewayMutable">AppGwIngressController.isApplicationGatewayMutable(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_pruneNoTrustedRootCertificate"><td><code><a href="#fn_pruneNoTrustedRootCertificate">pruneNoTrustedRootCertificate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>95.24%</code></td><td class="linecount"><code>20/21</code></td></tr>
<tr id="s_fn_pruneNoSslCertificate"><td><code><a href="#fn_pruneNoSslCertificate">pruneNoSslCertificate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>94.12%</code></td><td class="linecount"><code>16/17</code></td></tr>
<tr id="s_fn_pruneRedirectWithNoTLS"><td><code><a href="#fn_pruneRedirectWithNoTLS">pruneRedirectWithNoTLS(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>92.31%</code></td><td class="linecount"><code>12/13</code></td></tr>
<tr id="s_fn_pruneNoSslProfile"><td><code><a href="#fn_pruneNoSslProfile">pruneNoSslProfile(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>88.24%</code></td><td class="linecount"><code>15/17</code></td></tr>
<tr id="s_fn_pruneNoPrivateIP"><td><code><a href="#fn_pruneNoPrivateIP">pruneNoPrivateIP(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>86.67%</code></td><td class="linecount"><code>13/15</code></td></tr>
<tr id="s_fn_deleteKeyFromJSON"><td><code><a href="#fn_deleteKeyFromJSON">deleteKeyFromJSON(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>71.43%</code></td><td class="linecount"><code>5/7</code></td></tr>
<tr id="s_fn_AppGwIngressController.configIsSame"><td><code><a href="#fn_AppGwIngressController.configIsSame">AppGwIngressController.configIsSame(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>64.29%</code></td><td class="linecount"><code>9/14</code></td></tr>
<tr id="s_fn_AppGwIngressController.ResetAllIngress"><td><code><a href="#fn_AppGwIngressController.ResetAllIngress">AppGwIngressController.ResetAllIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code></td><td class="percent"><code>62.50%</code></td><td class="linecount"><code>5/8</code></td></tr>
<tr id="s_fn_AppGwIngressController.updateIngressStatus"><td><code><a href="#fn_AppGwIngressController.updateIngressStatus">AppGwIngressController.updateIngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code></td><td class="percent"><code>61.54%</code></td><td class="linecount"><code>8/13</code></td></tr>
<tr id="s_fn_AppGwIngressController.updateCache"><td><code><a href="#fn_AppGwIngressController.updateCache">AppGwIngressController.updateCache(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>45.45%</code></td><td class="linecount"><code>5/11</code></td></tr>
<tr id="s_fn_AppGwIngressController.MutateAppGateway"><td><code><a href="#fn_AppGwIngressController.MutateAppGateway">AppGwIngressController.MutateAppGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_app_gateway.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/71</code></td></tr>
<tr id="s_fn_AppGwIngressController.ProcessEvent"><td><code><a href="#fn_AppGwIngressController.ProcessEvent">AppGwIngressController.ProcessEvent(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/26</code></td></tr>
<tr id="s_fn_AppGwIngressController.ShouldProcess"><td><code><a href="#fn_AppGwIngressController.ShouldProcess">AppGwIngressController.ShouldProcess(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/should_process.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/20</code></td></tr>
<tr id="s_fn_dumpSanitizedJSON"><td><code><a href="#fn_dumpSanitizedJSON">dumpSanitizedJSON(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/16</code></td></tr>
<tr id="s_fn_AppGwIngressController.GetAppGw"><td><code><a href="#fn_AppGwIngressController.GetAppGw">AppGwIngressController.GetAppGw(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_app_gateway.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_getIPsFromAppGateway"><td><code><a href="#fn_getIPsFromAppGateway">getIPsFromAppGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_@27:10"><td><code><a href="#fn_@27:10">@27:10(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_getPublicIPAddress"><td><code><a href="#fn_getPublicIPAddress">getPublicIPAddress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/6</code></td></tr>
<tr id="s_fn_AppGwIngressController.PruneIngress"><td><code><a href="#fn_AppGwIngressController.PruneIngress">AppGwIngressController.PruneIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_AppGwIngressController.MutateAllIngress"><td><code><a href="#fn_AppGwIngressController.MutateAllIngress">AppGwIngressController.MutateAllIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_AppGwIngressController.Readiness"><td><code><a href="#fn_AppGwIngressController.Readiness">AppGwIngressController.Readiness(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_AppGwIngressController.Liveness"><td><code><a href="#fn_AppGwIngressController.Liveness">AppGwIngressController.Liveness(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_realClock.Now"><td><code><a href="#fn_realClock.Now">realClock.Now(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller/mutate_app_gateway.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller</code></td><td class="percent"><code>42.74%</code></td><td class="linecount"><code>159/372</code></td></tr>
</table>

<div class="funcname" id="fn_deleteKey">func deleteKey</div><div class="info"><a href="#s_fn_deleteKey">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>136</td><td><code><pre>func deleteKey(m *map[string]interface{}, keyToDelete string) {</pre></code></td></tr><tr><td>137</td><td><code><pre>        // Recursively search for the given keyToDelete</pre></code></td></tr><tr><td>138</td><td><code><pre>        for k, v := range *m {</pre></code></td></tr><tr><td>139</td><td><code><pre>                if strings.ToLower(k) == strings.ToLower(keyToDelete) {</pre></code></td></tr><tr><td>140</td><td><code><pre>                        delete(*m, k)</pre></code></td></tr><tr><td>141</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>142</td><td><code><pre>                }</pre></code></td></tr><tr><td>143</td><td><code><pre></pre></code></td></tr><tr><td>144</td><td><code><pre>                // Recurse into other maps we find</pre></code></td></tr><tr><td>145</td><td><code><pre>                if isMap(v) {</pre></code></td></tr><tr><td>146</td><td><code><pre>                        subMap := v.(map[string]interface{})</pre></code></td></tr><tr><td>147</td><td><code><pre>                        deleteKey(&amp;subMap, keyToDelete)</pre></code></td></tr><tr><td>148</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>149</td><td><code><pre>                }</pre></code></td></tr><tr><td>150</td><td><code><pre></pre></code></td></tr><tr><td>151</td><td><code><pre>                // JSON blob could have a list for a value; Iterate and  find maps; Delete matching keys</pre></code></td></tr><tr><td>152</td><td><code><pre>                if isSlice(v) {</pre></code></td></tr><tr><td>153</td><td><code><pre>                        slice := v.([]interface{})</pre></code></td></tr><tr><td>154</td><td><code><pre>                        for idx := range slice {</pre></code></td></tr><tr><td>155</td><td><code><pre>                                // We are not interested in any other element type but maps</pre></code></td></tr><tr><td>156</td><td><code><pre>                                if isMap(slice[idx]) {</pre></code></td></tr><tr><td>157</td><td><code><pre>                                        subMap := slice[idx].(map[string]interface{})</pre></code></td></tr><tr><td>158</td><td><code><pre>                                        deleteKey(&amp;subMap, keyToDelete)</pre></code></td></tr><tr><td>159</td><td><code><pre>                                }</pre></code></td></tr><tr><td>160</td><td><code><pre>                        }</pre></code></td></tr><tr><td>161</td><td><code><pre>                }</pre></code></td></tr><tr><td>162</td><td><code><pre>        }</pre></code></td></tr><tr><td>163</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_reconcilerTickerTask">func reconcilerTickerTask</div><div class="info"><a href="#s_fn_reconcilerTickerTask">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>157</td><td><code><pre>func reconcilerTickerTask(work chan events.Event, stopChannel chan struct{}, reconcilePeriodSecondsStr string) {</pre></code></td></tr><tr><td>158</td><td><code><pre>        klog.V(5).Info(&#34;Reconciler Ticker task started with period: &#34;, reconcilePeriodSecondsStr)</pre></code></td></tr><tr><td>159</td><td><code><pre></pre></code></td></tr><tr><td>160</td><td><code><pre>        reconcilePeriodSeconds, _ := strconv.Atoi(reconcilePeriodSecondsStr)</pre></code></td></tr><tr><td>161</td><td><code><pre>        reconcileTicker := time.NewTicker(time.Duration(reconcilePeriodSeconds) * time.Second)</pre></code></td></tr><tr><td>162</td><td><code><pre>        for {</pre></code></td></tr><tr><td>163</td><td><code><pre>                select {</pre></code></td></tr><tr><td>164</td><td><code><pre>                case tickedTime := &lt;-reconcileTicker.C:</pre></code></td></tr><tr><td>165</td><td><code><pre>                        klog.V(9).Info(&#34;Reconciling ticker ticked at &#34;, tickedTime)</pre></code></td></tr><tr><td>166</td><td><code><pre>                        work &lt;- events.Event{</pre></code></td></tr><tr><td>167</td><td><code><pre>                                Type: events.PeriodicReconcile,</pre></code></td></tr><tr><td>168</td><td><code><pre>                        }</pre></code></td></tr><tr><td>169</td><td><code><pre>                case &lt;-stopChannel:</pre></code></td></tr><tr><td>170</td><td><code><pre>                        break</pre></code></td></tr><tr><td>171</td><td><code><pre>                }</pre></code></td></tr><tr><td>172</td><td><code><pre>        }</pre></code></td></tr><tr><td>173</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.Start">func AppGwIngressController.Start</div><div class="info"><a href="#s_fn_AppGwIngressController.Start">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>69</td><td><code><pre>func (c *AppGwIngressController) Start(envVariables environment.EnvVariables) error {</pre></code></td></tr><tr><td>70</td><td><code><pre>        // Starts k8scontext which contains all the informers</pre></code></td></tr><tr><td>71</td><td><code><pre>        // This will start individual go routines for informers</pre></code></td></tr><tr><td>72</td><td><code><pre>        if err := c.k8sContext.Run(c.stopChannel, false, envVariables); err != nil {</pre></code></td></tr><tr><td>73</td><td><code><pre>                klog.Error(&#34;Could not start Kubernetes Context: &#34;, err)</pre></code></td></tr><tr><td>74</td><td><code><pre>                return err</pre></code></td></tr><tr><td>75</td><td><code><pre>        }</pre></code></td></tr><tr><td>76</td><td><code><pre></pre></code></td></tr><tr><td>77</td><td><code><pre>        // initilize reconcilerTickerTask</pre></code></td></tr><tr><td>78</td><td><code><pre>        if envVariables.ReconcilePeriodSeconds != &#34;&#34; {</pre></code></td></tr><tr><td>79</td><td><code><pre>                go reconcilerTickerTask(c.k8sContext.Work, c.stopChannel, envVariables.ReconcilePeriodSeconds)</pre></code></td></tr><tr><td>80</td><td><code><pre>        }</pre></code></td></tr><tr><td>81</td><td><code><pre></pre></code></td></tr><tr><td>82</td><td><code><pre>        // Starts Worker processing events from k8sContext</pre></code></td></tr><tr><td>83</td><td><code><pre>        go c.worker.Run(c.k8sContext.Work, c.stopChannel)</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr><td>85</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>86</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_pruneProhibitedIngress">func pruneProhibitedIngress</div><div class="info"><a href="#s_fn_pruneProhibitedIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>46</td><td><code><pre>func pruneProhibitedIngress(c *AppGwIngressController, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingressList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>47</td><td><code><pre>        // Mutate the list of Ingresses by removing ones that AGIC should not be creating configuration.</pre></code></td></tr><tr><td>48</td><td><code><pre>        for idx, ingress := range ingressList {</pre></code></td></tr><tr><td>49</td><td><code><pre>                klog.V(5).Infof(&#34;Original Ingress[%d] Rules: %+v&#34;, idx, ingress.Spec.Rules)</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>                ingressClone := ingressList[idx].DeepCopy()</pre></code></td></tr><tr><td>52</td><td><code><pre>                ingressClone.Spec.Rules = brownfield.PruneIngressRules(ingress, cbCtx.ProhibitedTargets)</pre></code></td></tr><tr><td>53</td><td><code><pre>                ingressList[idx] = ingressClone</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr><td>55</td><td><code><pre>                klog.V(5).Infof(&#34;Sanitized Ingress[%d] Rules: %+v&#34;, idx, ingressList[idx].Spec.Rules)</pre></code></td></tr><tr><td>56</td><td><code><pre>        }</pre></code></td></tr><tr><td>57</td><td><code><pre></pre></code></td></tr><tr><td>58</td><td><code><pre>        return ingressList</pre></code></td></tr><tr><td>59</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_resetBackReference">func resetBackReference</div><div class="info"><a href="#s_fn_resetBackReference">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>78</td><td><code><pre>func resetBackReference(appGw *n.ApplicationGateway) *n.ApplicationGateway {</pre></code></td></tr><tr><td>79</td><td><code><pre>        if appGw != nil &amp;&amp; appGw.ApplicationGatewayPropertiesFormat != nil {</pre></code></td></tr><tr><td>80</td><td><code><pre>                if appGw.RedirectConfigurations != nil {</pre></code></td></tr><tr><td>81</td><td><code><pre>                        for idx := range *appGw.RedirectConfigurations {</pre></code></td></tr><tr><td>82</td><td><code><pre>                                (*appGw.RedirectConfigurations)[idx].RequestRoutingRules = nil</pre></code></td></tr><tr><td>83</td><td><code><pre>                                (*appGw.RedirectConfigurations)[idx].URLPathMaps = nil</pre></code></td></tr><tr><td>84</td><td><code><pre>                                (*appGw.RedirectConfigurations)[idx].PathRules = nil</pre></code></td></tr><tr><td>85</td><td><code><pre>                        }</pre></code></td></tr><tr><td>86</td><td><code><pre>                }</pre></code></td></tr><tr><td>87</td><td><code><pre>        }</pre></code></td></tr><tr><td>88</td><td><code><pre>        return appGw</pre></code></td></tr><tr><td>89</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewAppGwIngressController">func NewAppGwIngressController</div><div class="info"><a href="#s_fn_NewAppGwIngressController">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>47</td><td><code><pre>func NewAppGwIngressController(azClient azure.AzClient, appGwIdentifier appgw.Identifier, k8sContext *k8scontext.Context, recorder record.EventRecorder, metricStore metricstore.MetricStore, agicPod *v1.Pod, hostedOnUnderlay bool) *AppGwIngressController {</pre></code></td></tr><tr><td>48</td><td><code><pre>        controller := &amp;AppGwIngressController{</pre></code></td></tr><tr><td>49</td><td><code><pre>                azClient:         azClient,</pre></code></td></tr><tr><td>50</td><td><code><pre>                appGwIdentifier:  appGwIdentifier,</pre></code></td></tr><tr><td>51</td><td><code><pre>                k8sContext:       k8sContext,</pre></code></td></tr><tr><td>52</td><td><code><pre>                recorder:         recorder,</pre></code></td></tr><tr><td>53</td><td><code><pre>                configCache:      to.ByteSlicePtr([]byte{}),</pre></code></td></tr><tr><td>54</td><td><code><pre>                ipAddressMap:     map[string]k8scontext.IPAddress{},</pre></code></td></tr><tr><td>55</td><td><code><pre>                stopChannel:      make(chan struct{}),</pre></code></td></tr><tr><td>56</td><td><code><pre>                agicPod:          agicPod,</pre></code></td></tr><tr><td>57</td><td><code><pre>                MetricStore:      metricStore,</pre></code></td></tr><tr><td>58</td><td><code><pre>                hostedOnUnderlay: hostedOnUnderlay,</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>        controller.worker = &amp;worker.Worker{</pre></code></td></tr><tr><td>62</td><td><code><pre>                EventProcessor: controller,</pre></code></td></tr><tr><td>63</td><td><code><pre>        }</pre></code></td></tr><tr><td>64</td><td><code><pre>        return controller</pre></code></td></tr><tr><td>65</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.Stop">func AppGwIngressController.Stop</div><div class="info"><a href="#s_fn_AppGwIngressController.Stop">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>89</td><td><code><pre>func (c *AppGwIngressController) Stop() {</pre></code></td></tr><tr><td>90</td><td><code><pre>        c.MetricStore.Stop()</pre></code></td></tr><tr><td>91</td><td><code><pre>        close(c.stopChannel)</pre></code></td></tr><tr><td>92</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_isSlice">func isSlice</div><div class="info"><a href="#s_fn_isSlice">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>131</td><td><code><pre>func isSlice(v interface{}) bool {</pre></code></td></tr><tr><td>132</td><td><code><pre>        return v != nil &amp;&amp; reflect.ValueOf(v).Type().Kind() == reflect.Slice</pre></code></td></tr><tr><td>133</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_isMap">func isMap</div><div class="info"><a href="#s_fn_isMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>127</td><td><code><pre>func isMap(v interface{}) bool {</pre></code></td></tr><tr><td>128</td><td><code><pre>        return v != nil &amp;&amp; reflect.ValueOf(v).Type().Kind() == reflect.Map</pre></code></td></tr><tr><td>129</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.isApplicationGatewayMutable">func AppGwIngressController.isApplicationGatewayMutable</div><div class="info"><a href="#s_fn_AppGwIngressController.isApplicationGatewayMutable">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>123</td><td><code><pre>func (c *AppGwIngressController) isApplicationGatewayMutable(appGw *n.ApplicationGateway) bool {</pre></code></td></tr><tr><td>124</td><td><code><pre>        return appGw.OperationalState == &#34;Running&#34; || appGw.OperationalState == &#34;Starting&#34;</pre></code></td></tr><tr><td>125</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_pruneNoTrustedRootCertificate">func pruneNoTrustedRootCertificate</div><div class="info"><a href="#s_fn_pruneNoTrustedRootCertificate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>152</td><td><code><pre>func pruneNoTrustedRootCertificate(c *AppGwIngressController, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingressList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>153</td><td><code><pre>        var prunedIngresses []*networking.Ingress</pre></code></td></tr><tr><td>154</td><td><code><pre>        set := make(map[string]bool)</pre></code></td></tr><tr><td>155</td><td><code><pre>        for _, installedTrustedRootCertificate := range *appGw.TrustedRootCertificates {</pre></code></td></tr><tr><td>156</td><td><code><pre>                set[*installedTrustedRootCertificate.Name] = true</pre></code></td></tr><tr><td>157</td><td><code><pre>        }</pre></code></td></tr><tr><td>158</td><td><code><pre></pre></code></td></tr><tr><td>159</td><td><code><pre>        for _, ingress := range ingressList {</pre></code></td></tr><tr><td>160</td><td><code><pre>                installed := true</pre></code></td></tr><tr><td>161</td><td><code><pre>                trustedRootCertificates, err := annotations.GetAppGwTrustedRootCertificate(ingress)</pre></code></td></tr><tr><td>162</td><td><code><pre>                // if annotation is not specified</pre></code></td></tr><tr><td>163</td><td><code><pre>                if err != nil &amp;&amp; controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr><td>164</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>165</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>166</td><td><code><pre>                }</pre></code></td></tr><tr><td>167</td><td><code><pre></pre></code></td></tr><tr><td>168</td><td><code><pre>                for _, rootCert := range strings.Split(trustedRootCertificates, &#34;,&#34;) {</pre></code></td></tr><tr><td>169</td><td><code><pre>                        if _, exists := set[rootCert]; !exists {</pre></code></td></tr><tr><td>170</td><td><code><pre>                                installed = false</pre></code></td></tr><tr><td>171</td><td><code><pre>                                errorLine := fmt.Sprintf(&#34;ignoring Ingress %s/%s as it requires Application Gateway %s to have pre-installed root certificate &#39;%s&#39;&#34;, ingress.Namespace, ingress.Name, c.appGwIdentifier.AppGwName, rootCert)</pre></code></td></tr><tr><td>172</td><td><code><pre>                                klog.Error(errorLine)</pre></code></td></tr><tr><td>173</td><td><code><pre>                                c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonNoPreInstalledRootCertificate, errorLine)</pre></code></td></tr><tr><td>174</td><td><code><pre>                                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>175</td><td><code><pre>                                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonNoPreInstalledRootCertificate, errorLine)</pre></code></td></tr><tr><td>176</td><td><code><pre>                                }</pre></code></td></tr><tr><td>177</td><td><code><pre>                        }</pre></code></td></tr><tr><td>178</td><td><code><pre>                }</pre></code></td></tr><tr><td>179</td><td><code><pre>                if installed {</pre></code></td></tr><tr><td>180</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>181</td><td><code><pre>                }</pre></code></td></tr><tr><td>182</td><td><code><pre>        }</pre></code></td></tr><tr><td>183</td><td><code><pre></pre></code></td></tr><tr><td>184</td><td><code><pre>        return prunedIngresses</pre></code></td></tr><tr><td>185</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_pruneNoSslCertificate">func pruneNoSslCertificate</div><div class="info"><a href="#s_fn_pruneNoSslCertificate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>88</td><td><code><pre>func pruneNoSslCertificate(c *AppGwIngressController, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingressList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>89</td><td><code><pre>        var prunedIngresses []*networking.Ingress</pre></code></td></tr><tr><td>90</td><td><code><pre>        set := make(map[string]bool)</pre></code></td></tr><tr><td>91</td><td><code><pre>        for _, installedSslCertificate := range *appGw.SslCertificates {</pre></code></td></tr><tr><td>92</td><td><code><pre>                set[*installedSslCertificate.Name] = true</pre></code></td></tr><tr><td>93</td><td><code><pre>        }</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr><td>95</td><td><code><pre>        for _, ingress := range ingressList {</pre></code></td></tr><tr><td>96</td><td><code><pre>                annotatedSslCertificate, err := annotations.GetAppGwSslCertificate(ingress)</pre></code></td></tr><tr><td>97</td><td><code><pre>                // if annotation is not specified, add the ingress and go check next</pre></code></td></tr><tr><td>98</td><td><code><pre>                if err != nil &amp;&amp; controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr><td>99</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>100</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>101</td><td><code><pre>                }</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr><td>103</td><td><code><pre>                // given empty string is a valid annotation value, we error out with a message if no match</pre></code></td></tr><tr><td>104</td><td><code><pre>                if _, exists := set[annotatedSslCertificate]; !exists {</pre></code></td></tr><tr><td>105</td><td><code><pre>                        errorLine := fmt.Sprintf(&#34;ignoring Ingress %s/%s as it requires Application Gateway %s to have pre-installed ssl certificate &#39;%s&#39;&#34;, ingress.Namespace, ingress.Name, c.appGwIdentifier.AppGwName, annotatedSslCertificate)</pre></code></td></tr><tr><td>106</td><td><code><pre>                        klog.Error(errorLine)</pre></code></td></tr><tr><td>107</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonNoPreInstalledSslCertificate, errorLine)</pre></code></td></tr><tr><td>108</td><td><code><pre>                        if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                                c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonNoPreInstalledSslCertificate, errorLine)</pre></code></td></tr><tr><td>110</td><td><code><pre>                        }</pre></code></td></tr><tr><td>111</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>112</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>113</td><td><code><pre>                }</pre></code></td></tr><tr><td>114</td><td><code><pre>        }</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>        return prunedIngresses</pre></code></td></tr><tr><td>117</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_pruneRedirectWithNoTLS">func pruneRedirectWithNoTLS</div><div class="info"><a href="#s_fn_pruneRedirectWithNoTLS">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>188</td><td><code><pre>func pruneRedirectWithNoTLS(c *AppGwIngressController, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingressList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>189</td><td><code><pre>        var prunedIngresses []*networking.Ingress</pre></code></td></tr><tr><td>190</td><td><code><pre>        for _, ingress := range ingressList {</pre></code></td></tr><tr><td>191</td><td><code><pre>                appgwCertName, _ := annotations.GetAppGwSslCertificate(ingress)</pre></code></td></tr><tr><td>192</td><td><code><pre>                hasTLS := (ingress.Spec.TLS != nil &amp;&amp; len(ingress.Spec.TLS) &gt; 0) || len(appgwCertName) &gt; 0</pre></code></td></tr><tr><td>193</td><td><code><pre>                sslRedirect, _ := annotations.IsSslRedirect(ingress)</pre></code></td></tr><tr><td>194</td><td><code><pre>                if !hasTLS &amp;&amp; sslRedirect {</pre></code></td></tr><tr><td>195</td><td><code><pre>                        errorLine := fmt.Sprintf(&#34;ignoring Ingress %s/%s as it has an invalid spec. It is annotated with ssl-redirect: true but is missing a TLS secret or &#39;%s&#39; annotation. Please add a TLS secret/annotation or remove ssl-redirect annotation&#34;, ingress.Namespace, ingress.Name, annotations.AppGwSslCertificate)</pre></code></td></tr><tr><td>196</td><td><code><pre>                        klog.Error(errorLine)</pre></code></td></tr><tr><td>197</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonRedirectWithNoTLS, errorLine)</pre></code></td></tr><tr><td>198</td><td><code><pre>                        if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>199</td><td><code><pre>                                c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonRedirectWithNoTLS, errorLine)</pre></code></td></tr><tr><td>200</td><td><code><pre>                        }</pre></code></td></tr><tr><td>201</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>202</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>203</td><td><code><pre>                }</pre></code></td></tr><tr><td>204</td><td><code><pre>        }</pre></code></td></tr><tr><td>205</td><td><code><pre></pre></code></td></tr><tr><td>206</td><td><code><pre>        return prunedIngresses</pre></code></td></tr><tr><td>207</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_pruneNoSslProfile">func pruneNoSslProfile</div><div class="info"><a href="#s_fn_pruneNoSslProfile">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>120</td><td><code><pre>func pruneNoSslProfile(c *AppGwIngressController, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingressList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>121</td><td><code><pre>        var prunedIngresses []*networking.Ingress</pre></code></td></tr><tr><td>122</td><td><code><pre>        set := make(map[string]bool)</pre></code></td></tr><tr><td>123</td><td><code><pre>        for _, installedSslProfile := range *appGw.SslProfiles {</pre></code></td></tr><tr><td>124</td><td><code><pre>                set[*installedSslProfile.Name] = true</pre></code></td></tr><tr><td>125</td><td><code><pre>        }</pre></code></td></tr><tr><td>126</td><td><code><pre></pre></code></td></tr><tr><td>127</td><td><code><pre>        for _, ingress := range ingressList {</pre></code></td></tr><tr><td>128</td><td><code><pre>                annotatedSslProfile, err := annotations.GetAppGwSslProfile(ingress)</pre></code></td></tr><tr><td>129</td><td><code><pre>                // if annotation is not specified, add the ingress and go check next</pre></code></td></tr><tr><td>130</td><td><code><pre>                if err != nil &amp;&amp; controllererrors.IsErrorCode(err, controllererrors.ErrorMissingAnnotation) {</pre></code></td></tr><tr><td>131</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>132</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>133</td><td><code><pre>                }</pre></code></td></tr><tr><td>134</td><td><code><pre></pre></code></td></tr><tr><td>135</td><td><code><pre>                // given empty string is a valid annotation value, we error out with a message if no match</pre></code></td></tr><tr><td>136</td><td><code><pre>                if _, exists := set[annotatedSslProfile]; !exists {</pre></code></td></tr><tr><td>137</td><td><code><pre>                        errorLine := fmt.Sprintf(&#34;ignoring Ingress %s/%s as it requires Application Gateway %s to have pre-installed ssl profile &#39;%s&#39;&#34;, ingress.Namespace, ingress.Name, c.appGwIdentifier.AppGwName, annotatedSslProfile)</pre></code></td></tr><tr><td>138</td><td><code><pre>                        klog.Error(errorLine)</pre></code></td></tr><tr><td>139</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonNoPreInstalledSslProfile, errorLine)</pre></code></td></tr><tr><td>140</td><td><code><pre>                        if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>                                c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonNoPreInstalledSslProfile, errorLine)</pre></code></td></tr><tr><td>142</td><td><code><pre>                        }</pre></code></td></tr><tr><td>143</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>144</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>145</td><td><code><pre>                }</pre></code></td></tr><tr><td>146</td><td><code><pre>        }</pre></code></td></tr><tr><td>147</td><td><code><pre></pre></code></td></tr><tr><td>148</td><td><code><pre>        return prunedIngresses</pre></code></td></tr><tr><td>149</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_pruneNoPrivateIP">func pruneNoPrivateIP</div><div class="info"><a href="#s_fn_pruneNoPrivateIP">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>62</td><td><code><pre>func pruneNoPrivateIP(c *AppGwIngressController, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingressList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>63</td><td><code><pre>        var prunedIngresses []*networking.Ingress</pre></code></td></tr><tr><td>64</td><td><code><pre>        appGwHasPrivateIP := appgw.LookupIPConfigurationByType(appGw.FrontendIPConfigurations, true) != nil</pre></code></td></tr><tr><td>65</td><td><code><pre>        for _, ingress := range ingressList {</pre></code></td></tr><tr><td>66</td><td><code><pre>                usePrivateIP, err := annotations.UsePrivateIP(ingress)</pre></code></td></tr><tr><td>67</td><td><code><pre>                if err != nil &amp;&amp; controllererrors.IsErrorCode(err, controllererrors.ErrorInvalidContent) {</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                        klog.Errorf(&#34;Ingress %s/%s has invalid value for annotation %s&#34;, ingress.Namespace, ingress.Name, annotations.UsePrivateIPKey)</pre></code></td></tr><tr><td>69</td><td><code><pre>                }</pre></code></td></tr><tr><td>70</td><td><code><pre></pre></code></td></tr><tr><td>71</td><td><code><pre>                usePrivateIP = usePrivateIP || cbCtx.EnvVariables.UsePrivateIP</pre></code></td></tr><tr><td>72</td><td><code><pre>                if usePrivateIP &amp;&amp; !appGwHasPrivateIP {</pre></code></td></tr><tr><td>73</td><td><code><pre>                        errorLine := fmt.Sprintf(&#34;ignoring Ingress %s/%s as it requires Application Gateway %s has a private IP address&#34;, ingress.Namespace, ingress.Name, c.appGwIdentifier.AppGwName)</pre></code></td></tr><tr><td>74</td><td><code><pre>                        klog.Error(errorLine)</pre></code></td></tr><tr><td>75</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonNoPrivateIPError, errorLine)</pre></code></td></tr><tr><td>76</td><td><code><pre>                        if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>                                c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonNoPrivateIPError, errorLine)</pre></code></td></tr><tr><td>78</td><td><code><pre>                        }</pre></code></td></tr><tr><td>79</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>80</td><td><code><pre>                        prunedIngresses = append(prunedIngresses, ingress)</pre></code></td></tr><tr><td>81</td><td><code><pre>                }</pre></code></td></tr><tr><td>82</td><td><code><pre>        }</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr><td>84</td><td><code><pre>        return prunedIngresses</pre></code></td></tr><tr><td>85</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_deleteKeyFromJSON">func deleteKeyFromJSON</div><div class="info"><a href="#s_fn_deleteKeyFromJSON">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>166</td><td><code><pre>func deleteKeyFromJSON(jsonWithEtag []byte, keysToDelete ...string) ([]byte, error) {</pre></code></td></tr><tr><td>167</td><td><code><pre>        var m map[string]interface{}</pre></code></td></tr><tr><td>168</td><td><code><pre>        if err := json.Unmarshal([]byte(jsonWithEtag), &amp;m); err != nil {</pre></code></td></tr><tr class="miss"><td>169</td><td><code><pre>                klog.Error(&#34;Could not unmarshal config App Gwy JSON to delete Etag.&#34;, err)</pre></code></td></tr><tr class="miss"><td>170</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>171</td><td><code><pre>        }</pre></code></td></tr><tr><td>172</td><td><code><pre>        for _, keyToDelete := range keysToDelete {</pre></code></td></tr><tr><td>173</td><td><code><pre>                deleteKey(&amp;m, keyToDelete)</pre></code></td></tr><tr><td>174</td><td><code><pre>        }</pre></code></td></tr><tr><td>175</td><td><code><pre>        return json.Marshal(m)</pre></code></td></tr><tr><td>176</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.configIsSame">func AppGwIngressController.configIsSame</div><div class="info"><a href="#s_fn_AppGwIngressController.configIsSame">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>49</td><td><code><pre>func (c *AppGwIngressController) configIsSame(appGw *n.ApplicationGateway) bool {</pre></code></td></tr><tr><td>50</td><td><code><pre>        if c.configCache == nil {</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>                return false</pre></code></td></tr><tr><td>52</td><td><code><pre>        }</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr><td>54</td><td><code><pre>        sanitizedInput := resetBackReference(appGw)</pre></code></td></tr><tr><td>55</td><td><code><pre>        jsonConfig, err := sanitizedInput.MarshalJSON()</pre></code></td></tr><tr><td>56</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>                klog.Error(&#34;Could not marshal App Gwy to compare w/ cache; Will not use cache.&#34;, err)</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                return false</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre>        // The JSON stored in the cache and the newly marshaled JSON will have different ETags even if configs are the same.</pre></code></td></tr><tr><td>61</td><td><code><pre>        // We need to strip ETags from all nested structures in order to have a fair comparison.</pre></code></td></tr><tr><td>62</td><td><code><pre>        var sanitized []byte</pre></code></td></tr><tr><td>63</td><td><code><pre>        if sanitized, err = deleteKeyFromJSON(jsonConfig, keysToDeleteForCache...); err != nil {</pre></code></td></tr><tr><td>64</td><td><code><pre>                // Ran into an error; Don&#39;t use cache; Refresh cache w/ new JSON</pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>                klog.Error(&#34;Failed stripping ETag key from App Gwy config. Will not use cache.&#34;, err)</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>                return false</pre></code></td></tr><tr><td>67</td><td><code><pre>        }</pre></code></td></tr><tr><td>68</td><td><code><pre></pre></code></td></tr><tr><td>69</td><td><code><pre>        klog.V(9).Info(&#34;input state = &#34;, string(sanitized))</pre></code></td></tr><tr><td>70</td><td><code><pre>        klog.V(9).Info(&#34;cached state = &#34;, string(*c.configCache))</pre></code></td></tr><tr><td>71</td><td><code><pre></pre></code></td></tr><tr><td>72</td><td><code><pre>        // The result will be 0 if a==b, -1 if a &lt; b, and +1 if a &gt; b.</pre></code></td></tr><tr><td>73</td><td><code><pre>        return c.configCache != nil &amp;&amp; bytes.Compare(*c.configCache, sanitized) == 0</pre></code></td></tr><tr><td>74</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.ResetAllIngress">func AppGwIngressController.ResetAllIngress</div><div class="info"><a href="#s_fn_AppGwIngressController.ResetAllIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code>:</p></div><table class="listing">
<tr><td>39</td><td><code><pre>func (c AppGwIngressController) ResetAllIngress(appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext) {</pre></code></td></tr><tr><td>40</td><td><code><pre>        for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr><td>41</td><td><code><pre>                if err := c.k8sContext.UpdateIngressStatus(*ingress, k8scontext.IPAddress(&#34;&#34;)); err != nil {</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonUnableToResetIngressStatus, err.Error())</pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>                        klog.Errorf(&#34;[mutate_aks] Error resetting ingress %s/%s IP&#34;, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>45</td><td><code><pre>                }</pre></code></td></tr><tr><td>46</td><td><code><pre></pre></code></td></tr><tr><td>47</td><td><code><pre>                msg := fmt.Sprintf(&#34;Reset IP for Ingress %s/%s. Application Gateway %s is in stopped state&#34;, ingress.Namespace, ingress.Name, *appGw.ID)</pre></code></td></tr><tr><td>48</td><td><code><pre>                c.recorder.Event(ingress, v1.EventTypeNormal, events.ReasonResetIngressStatus, msg)</pre></code></td></tr><tr><td>49</td><td><code><pre>                klog.V(5).Infof(msg)</pre></code></td></tr><tr><td>50</td><td><code><pre>        }</pre></code></td></tr><tr><td>51</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.updateIngressStatus">func AppGwIngressController.updateIngressStatus</div><div class="info"><a href="#s_fn_AppGwIngressController.updateIngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code>:</p></div><table class="listing">
<tr><td>53</td><td><code><pre>func (c AppGwIngressController) updateIngressStatus(appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext, ingress *networking.Ingress, ips map[ipResource]ipAddress) {</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr><td>55</td><td><code><pre>        // determine what ipAddress to attach</pre></code></td></tr><tr><td>56</td><td><code><pre>        usePrivateIP, _ := annotations.UsePrivateIP(ingress)</pre></code></td></tr><tr><td>57</td><td><code><pre>        usePrivateIP = usePrivateIP || cbCtx.EnvVariables.UsePrivateIP</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>        ipConf := appgw.LookupIPConfigurationByType(appGw.FrontendIPConfigurations, usePrivateIP)</pre></code></td></tr><tr><td>60</td><td><code><pre>        if ipConf == nil {</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>                klog.V(9).Info(&#34;[mutate_aks] No IP config for App Gwy: &#34;, appGw.Name)</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                return</pre></code></td></tr><tr><td>63</td><td><code><pre>        }</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr><td>65</td><td><code><pre>        klog.V(5).Infof(&#34;[mutate_aks] Resolving IP for ID (%s)&#34;, *ipConf.ID)</pre></code></td></tr><tr><td>66</td><td><code><pre>        if newIP, found := ips[ipResource(*ipConf.ID)]; found {</pre></code></td></tr><tr><td>67</td><td><code><pre>                if err := c.k8sContext.UpdateIngressStatus(*ingress, k8scontext.IPAddress(newIP)); err != nil {</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                        c.recorder.Event(ingress, v1.EventTypeWarning, events.ReasonUnableToUpdateIngressStatus, err.Error())</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>                        klog.Errorf(&#34;[mutate_aks] Error updating ingress %s/%s IP to %+v&#34;, ingress.Namespace, ingress.Name, newIP)</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>                        return</pre></code></td></tr><tr><td>71</td><td><code><pre>                }</pre></code></td></tr><tr><td>72</td><td><code><pre>                klog.V(5).Infof(&#34;[mutate_aks] Updated Ingress %s/%s IP to %+v&#34;, ingress.Namespace, ingress.Name, newIP)</pre></code></td></tr><tr><td>73</td><td><code><pre>        }</pre></code></td></tr><tr><td>74</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.updateCache">func AppGwIngressController.updateCache</div><div class="info"><a href="#s_fn_AppGwIngressController.updateCache">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func (c *AppGwIngressController) updateCache(appGw *n.ApplicationGateway) {</pre></code></td></tr><tr><td>32</td><td><code><pre>        jsonConfig, err := appGw.MarshalJSON()</pre></code></td></tr><tr><td>33</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                klog.Error(&#34;Could not marshal App Gwy to update cache; Wiping cache.&#34;, err)</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                c.configCache = nil</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>                return</pre></code></td></tr><tr><td>37</td><td><code><pre>        }</pre></code></td></tr><tr><td>38</td><td><code><pre>        var sanitized []byte</pre></code></td></tr><tr><td>39</td><td><code><pre>        if sanitized, err = deleteKeyFromJSON(jsonConfig, keysToDeleteForCache...); err != nil {</pre></code></td></tr><tr><td>40</td><td><code><pre>                // Ran into an error; Wipe the existing cache</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                klog.Error(&#34;Failed stripping ETag key from App Gwy config. Wiping cache.&#34;, err)</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                c.configCache = nil</pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>                return</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre>        *c.configCache = sanitized</pre></code></td></tr><tr><td>46</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.MutateAppGateway">func AppGwIngressController.MutateAppGateway</div><div class="info"><a href="#s_fn_AppGwIngressController.MutateAppGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_app_gateway.go</code>:</p></div><table class="listing">
<tr><td>67</td><td><code><pre>func (c AppGwIngressController) MutateAppGateway(event events.Event, appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext) error {</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>        var err error</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>        existingConfigJSON, _ := dumpSanitizedJSON(appGw, false, to.StringPtr(&#34;-- Existing App Gwy Config --&#34;))</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>        klog.V(5).Info(&#34;Existing App Gateway config: &#34;, string(existingConfigJSON))</pre></code></td></tr><tr><td>71</td><td><code><pre></pre></code></td></tr><tr><td>72</td><td><code><pre>        // Prepare k8s resources Phase //</pre></code></td></tr><tr><td>73</td><td><code><pre>        // --------------------------- //</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>        if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>75</td><td><code><pre>                prohibitedTargets := c.k8sContext.ListAzureProhibitedTargets()</pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>                if len(prohibitedTargets) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>                        cbCtx.ProhibitedTargets = prohibitedTargets</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>                        var prohibitedTargetsList []string</pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>                        for _, target := range *brownfield.GetTargetBlacklist(prohibitedTargets) {</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>                                targetJSON, _ := json.Marshal(target)</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>                                prohibitedTargetsList = append(prohibitedTargetsList, string(targetJSON))</pre></code></td></tr><tr><td>82</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                        klog.V(3).Infof(&#34;[brownfield] Prohibited targets: %s&#34;, strings.Join(prohibitedTargetsList, &#34;, &#34;))</pre></code></td></tr><tr><td>84</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>                        klog.Warning(&#34;Brownfield Deployment is enabled, but AGIC did not find any AzureProhibitedTarget CRDs; Disabling brownfield deployment feature.&#34;)</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                        cbCtx.EnvVariables.EnableBrownfieldDeployment = false</pre></code></td></tr><tr><td>87</td><td><code><pre>                }</pre></code></td></tr><tr><td>88</td><td><code><pre>        }</pre></code></td></tr><tr><td>89</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>91</td><td><code><pre>                istioServices := c.k8sContext.ListIstioVirtualServices()</pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>                istioGateways := c.k8sContext.ListIstioGateways()</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>                if len(istioGateways) &gt; 0 &amp;&amp; len(istioServices) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>                        cbCtx.IstioGateways = istioGateways</pre></code></td></tr><tr class="miss"><td>95</td><td><code><pre>                        cbCtx.IstioVirtualServices = istioServices</pre></code></td></tr><tr><td>96</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>                        klog.Warning(&#34;Istio Integration is enabled, but AGIC needs Istio Gateways and Virtual Services; Disabling Istio integration.&#34;)</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>                        cbCtx.EnvVariables.EnableIstioIntegration = false</pre></code></td></tr><tr><td>99</td><td><code><pre>                }</pre></code></td></tr><tr><td>100</td><td><code><pre>        }</pre></code></td></tr><tr><td>101</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>102</td><td><code><pre>        cbCtx.IngressList = c.PruneIngress(appGw, cbCtx)</pre></code></td></tr><tr><td>103</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>        if cbCtx.EnvVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                var gatewaysInfo []string</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>                for _, gateway := range cbCtx.IstioGateways {</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>                        gatewaysInfo = append(gatewaysInfo, fmt.Sprintf(&#34;%s/%s&#34;, gateway.Namespace, gateway.Name))</pre></code></td></tr><tr><td>108</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                klog.V(5).Infof(&#34;Istio Gateways: %+v&#34;, strings.Join(gatewaysInfo, &#34;,&#34;))</pre></code></td></tr><tr><td>110</td><td><code><pre>        }</pre></code></td></tr><tr><td>111</td><td><code><pre></pre></code></td></tr><tr><td>112</td><td><code><pre>        // Run fatal validations on the existing config of the Application Gateway.</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>        if err := appgw.FatalValidateOnExistingConfig(c.recorder, appGw.ApplicationGatewayPropertiesFormat, cbCtx.EnvVariables); err != nil {</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>                errorLine := fmt.Sprint(&#34;Got a fatal validation error on existing Application Gateway config. Will retry getting Application Gateway until error is resolved:&#34;, err)</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>                klog.Error(errorLine)</pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>117</td><td><code><pre>                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonInvalidAppGwConfig, errorLine)</pre></code></td></tr><tr><td>118</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>119</td><td><code><pre>                return err</pre></code></td></tr><tr><td>120</td><td><code><pre>        }</pre></code></td></tr><tr><td>121</td><td><code><pre>        // -------------------------- //</pre></code></td></tr><tr><td>122</td><td><code><pre></pre></code></td></tr><tr><td>123</td><td><code><pre>        // Generate App Gateway Phase //</pre></code></td></tr><tr><td>124</td><td><code><pre>        // -------------------------- //</pre></code></td></tr><tr><td>125</td><td><code><pre>        // Create a configbuilder based on current appgw config</pre></code></td></tr><tr class="miss"><td>126</td><td><code><pre>        configBuilder := appgw.NewConfigBuilder(c.k8sContext, &amp;c.appGwIdentifier, appGw, c.recorder, realClock{})</pre></code></td></tr><tr><td>127</td><td><code><pre></pre></code></td></tr><tr><td>128</td><td><code><pre>        // Run validations on the Kubernetes resources which can suggest misconfiguration.</pre></code></td></tr><tr class="miss"><td>129</td><td><code><pre>        if err = configBuilder.PreBuildValidate(cbCtx); err != nil {</pre></code></td></tr><tr class="miss"><td>130</td><td><code><pre>                errorLine := fmt.Sprint(&#34;ConfigBuilder PostBuildValidate returned error:&#34;, err)</pre></code></td></tr><tr class="miss"><td>131</td><td><code><pre>                klog.Error(errorLine)</pre></code></td></tr><tr class="miss"><td>132</td><td><code><pre>                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>133</td><td><code><pre>                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonValidatonError, errorLine)</pre></code></td></tr><tr><td>134</td><td><code><pre>                }</pre></code></td></tr><tr><td>135</td><td><code><pre>        }</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>137</td><td><code><pre>        var generatedAppGw *n.ApplicationGateway</pre></code></td></tr><tr><td>138</td><td><code><pre>        // Replace the current appgw config with the generated one</pre></code></td></tr><tr class="miss"><td>139</td><td><code><pre>        if generatedAppGw, err = configBuilder.Build(cbCtx); err != nil {</pre></code></td></tr><tr class="miss"><td>140</td><td><code><pre>                errorLine := fmt.Sprint(&#34;ConfigBuilder Build returned error:&#34;, err)</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>                klog.Error(errorLine)</pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonValidatonError, errorLine)</pre></code></td></tr><tr><td>144</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>145</td><td><code><pre>                return err</pre></code></td></tr><tr><td>146</td><td><code><pre>        }</pre></code></td></tr><tr><td>147</td><td><code><pre></pre></code></td></tr><tr><td>148</td><td><code><pre>        // Run post validations to report errors in the config generation.</pre></code></td></tr><tr class="miss"><td>149</td><td><code><pre>        if err = configBuilder.PostBuildValidate(cbCtx); err != nil {</pre></code></td></tr><tr class="miss"><td>150</td><td><code><pre>                errorLine := fmt.Sprint(&#34;ConfigBuilder PostBuildValidate returned error:&#34;, err)</pre></code></td></tr><tr class="miss"><td>151</td><td><code><pre>                klog.Error(errorLine)</pre></code></td></tr><tr class="miss"><td>152</td><td><code><pre>                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>153</td><td><code><pre>                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonValidatonError, errorLine)</pre></code></td></tr><tr><td>154</td><td><code><pre>                }</pre></code></td></tr><tr><td>155</td><td><code><pre>        }</pre></code></td></tr><tr><td>156</td><td><code><pre>        // -------------------------- //</pre></code></td></tr><tr><td>157</td><td><code><pre></pre></code></td></tr><tr><td>158</td><td><code><pre>        // Post Compare Phase //</pre></code></td></tr><tr><td>159</td><td><code><pre>        // ------------------ //</pre></code></td></tr><tr><td>160</td><td><code><pre>        // if this is not a reconciliation task</pre></code></td></tr><tr><td>161</td><td><code><pre>        // then compare the generated state with cached state</pre></code></td></tr><tr class="miss"><td>162</td><td><code><pre>        if event.Type != events.PeriodicReconcile {</pre></code></td></tr><tr class="miss"><td>163</td><td><code><pre>                if c.configIsSame(appGw) {</pre></code></td></tr><tr class="miss"><td>164</td><td><code><pre>                        klog.V(3).Info(&#34;cache: Config has NOT changed! No need to connect to ARM.&#34;)</pre></code></td></tr><tr class="miss"><td>165</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>166</td><td><code><pre>                }</pre></code></td></tr><tr><td>167</td><td><code><pre>        }</pre></code></td></tr><tr><td>168</td><td><code><pre>        // ------------------ //</pre></code></td></tr><tr><td>169</td><td><code><pre></pre></code></td></tr><tr><td>170</td><td><code><pre>        // Deployment Phase //</pre></code></td></tr><tr><td>171</td><td><code><pre>        // ---------------- //</pre></code></td></tr><tr><td>172</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>173</td><td><code><pre>        configJSON, _ := dumpSanitizedJSON(appGw, cbCtx.EnvVariables.EnableSaveConfigToFile, nil)</pre></code></td></tr><tr class="miss"><td>174</td><td><code><pre>        klog.V(5).Infof(&#34;Generated config:\n%s&#34;, string(configJSON))</pre></code></td></tr><tr><td>175</td><td><code><pre></pre></code></td></tr><tr><td>176</td><td><code><pre>        // Initiate deployment</pre></code></td></tr><tr class="miss"><td>177</td><td><code><pre>        klog.V(3).Info(&#34;BEGIN AppGateway deployment&#34;)</pre></code></td></tr><tr class="miss"><td>178</td><td><code><pre>        defer klog.V(3).Info(&#34;END AppGateway deployment&#34;)</pre></code></td></tr><tr class="miss"><td>179</td><td><code><pre>        err = c.azClient.UpdateGateway(generatedAppGw)</pre></code></td></tr><tr class="miss"><td>180</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>181</td><td><code><pre>                // Reset cache</pre></code></td></tr><tr class="miss"><td>182</td><td><code><pre>                c.configCache = nil</pre></code></td></tr><tr class="miss"><td>183</td><td><code><pre>                return err</pre></code></td></tr><tr><td>184</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>185</td><td><code><pre>        klog.V(1).Infof(&#34;Applied generated Application Gateway configuration&#34;)</pre></code></td></tr><tr><td>186</td><td><code><pre>        // ----------------- //</pre></code></td></tr><tr><td>187</td><td><code><pre></pre></code></td></tr><tr><td>188</td><td><code><pre>        // Cache Phase //</pre></code></td></tr><tr><td>189</td><td><code><pre>        // ----------- //</pre></code></td></tr><tr class="miss"><td>190</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>191</td><td><code><pre>                // Reset cache</pre></code></td></tr><tr class="miss"><td>192</td><td><code><pre>                c.configCache = nil</pre></code></td></tr><tr class="miss"><td>193</td><td><code><pre>                return controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>194</td><td><code><pre>                        controllererrors.ErrorDeployingAppGatewayConfig,</pre></code></td></tr><tr><td>195</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>196</td><td><code><pre>                        &#34;unable to get specified AppGateway %s&#34;, c.appGwIdentifier.AppGwName,</pre></code></td></tr><tr><td>197</td><td><code><pre>                )</pre></code></td></tr><tr><td>198</td><td><code><pre>        }</pre></code></td></tr><tr><td>199</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>200</td><td><code><pre>        klog.V(3).Info(&#34;cache: Updated with latest applied config.&#34;)</pre></code></td></tr><tr class="miss"><td>201</td><td><code><pre>        c.updateCache(appGw)</pre></code></td></tr><tr><td>202</td><td><code><pre>        // ----------- //</pre></code></td></tr><tr><td>203</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>204</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>205</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.ProcessEvent">func AppGwIngressController.ProcessEvent</div><div class="info"><a href="#s_fn_AppGwIngressController.ProcessEvent">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>112</td><td><code><pre>func (c *AppGwIngressController) ProcessEvent(event events.Event) error {</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>        processEventStart := time.Now()</pre></code></td></tr><tr><td>114</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>        appGw, cbCtx, err := c.GetAppGw()</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>117</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>118</td><td><code><pre>                klog.Error(&#34;Error Retrieving AppGw for k8s event. &#34;, err)</pre></code></td></tr><tr class="miss"><td>119</td><td><code><pre>                return err</pre></code></td></tr><tr><td>120</td><td><code><pre>        }</pre></code></td></tr><tr><td>121</td><td><code><pre></pre></code></td></tr><tr><td>122</td><td><code><pre>        // Reset all ingress Ips and ignore mutating appgw if gateway is in stopped state</pre></code></td></tr><tr class="miss"><td>123</td><td><code><pre>        if !c.isApplicationGatewayMutable(appGw) {</pre></code></td></tr><tr class="miss"><td>124</td><td><code><pre>                klog.Info(&#34;Reset all ingress ip&#34;)</pre></code></td></tr><tr class="miss"><td>125</td><td><code><pre>                c.ResetAllIngress(appGw, cbCtx)</pre></code></td></tr><tr class="miss"><td>126</td><td><code><pre>                klog.Info(&#34;Ignore mutating App Gateway as it is not mutable&#34;)</pre></code></td></tr><tr class="miss"><td>127</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>128</td><td><code><pre>        }</pre></code></td></tr><tr><td>129</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>130</td><td><code><pre>        if err := c.MutateAllIngress(appGw, cbCtx); err != nil {</pre></code></td></tr><tr class="miss"><td>131</td><td><code><pre>                klog.Error(&#34;Error mutating AKS from k8s event. &#34;, err)</pre></code></td></tr><tr><td>132</td><td><code><pre>        }</pre></code></td></tr><tr><td>133</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>134</td><td><code><pre>        if err := c.MutateAppGateway(event, appGw, cbCtx); err != nil {</pre></code></td></tr><tr class="miss"><td>135</td><td><code><pre>                klogIt := klog.Errorf</pre></code></td></tr><tr class="miss"><td>136</td><td><code><pre>                if cbCtx.EnvVariables.EnablePanicOnPutError {</pre></code></td></tr><tr class="miss"><td>137</td><td><code><pre>                        klogIt = klog.Fatalf</pre></code></td></tr><tr><td>138</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>139</td><td><code><pre>                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>140</td><td><code><pre>                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonFailedApplyingAppGwConfig, err.Error())</pre></code></td></tr><tr><td>141</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>                klogIt(err.Error())</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                c.MetricStore.IncArmAPIUpdateCallFailureCounter()</pre></code></td></tr><tr class="miss"><td>144</td><td><code><pre>                return err</pre></code></td></tr><tr><td>145</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>146</td><td><code><pre>        c.MetricStore.IncArmAPIUpdateCallSuccessCounter()</pre></code></td></tr><tr><td>147</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>148</td><td><code><pre>        duration := time.Now().Sub(processEventStart)</pre></code></td></tr><tr class="miss"><td>149</td><td><code><pre>        c.MetricStore.SetUpdateLatencySec(duration)</pre></code></td></tr><tr><td>150</td><td><code><pre></pre></code></td></tr><tr><td>151</td><td><code><pre>        // We keep this at log level 1 to show some heartbeat in the logs. Without this it is way too quiet.</pre></code></td></tr><tr class="miss"><td>152</td><td><code><pre>        klog.V(1).Infof(&#34;Completed last event loop run in: %+v&#34;, duration)</pre></code></td></tr><tr><td>153</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>154</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>155</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.ShouldProcess">func AppGwIngressController.ShouldProcess</div><div class="info"><a href="#s_fn_AppGwIngressController.ShouldProcess">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/should_process.go</code>:</p></div><table class="listing">
<tr><td>19</td><td><code><pre>func (c AppGwIngressController) ShouldProcess(event events.Event) (bool, *string) {</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>        if pod, ok := event.Value.(*v1.Pod); ok {</pre></code></td></tr><tr><td>21</td><td><code><pre>                // this pod is not used by any ingress, skip any event for this</pre></code></td></tr><tr class="miss"><td>22</td><td><code><pre>                reason := fmt.Sprintf(&#34;pod %s/%s is not used by any Ingress&#34;, pod.Namespace, pod.Name)</pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>                return c.k8sContext.IsPodReferencedByAnyIngress(pod), to.StringPtr(reason)</pre></code></td></tr><tr><td>24</td><td><code><pre>        }</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>        if endpoints, ok := event.Value.(*v1.Endpoints); ok {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                if endpoints.Namespace == &#34;default&#34; &amp;&amp; endpoints.Name == &#34;aad-pod-identity-mic&#34; {</pre></code></td></tr><tr><td>28</td><td><code><pre>                        // Ignore AAD Pod Identity</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                        return false, nil</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr><td>31</td><td><code><pre></pre></code></td></tr><tr><td>32</td><td><code><pre>                // this pod is not used by any ingress, skip any event for this</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                reason := fmt.Sprintf(&#34;endpoint %s/%s is not used by any Ingress&#34;, endpoints.Namespace, endpoints.Name)</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                return c.k8sContext.IsEndpointReferencedByAnyIngress(endpoints), to.StringPtr(reason)</pre></code></td></tr><tr><td>35</td><td><code><pre>        }</pre></code></td></tr><tr><td>36</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>        if event.Type == events.PeriodicReconcile {</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>                appGw, _, err := c.GetAppGw()</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>                        klog.Error(&#34;Error Retrieving AppGw for k8s event. &#34;, err)</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                        reason := err.Error()</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                        return false, to.StringPtr(reason)</pre></code></td></tr><tr><td>43</td><td><code><pre>                }</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>                if c.configIsSame(appGw) {</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>                        reason := &#34;Reconciler NoOp: current gateway state == cached gateway state&#34;</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                        klog.V(9).Info(reason)</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>                        return false, to.StringPtr(reason)</pre></code></td></tr><tr><td>49</td><td><code><pre>                }</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>                klog.V(5).Info(&#34;Triggered by reconciler event&#34;)</pre></code></td></tr><tr><td>52</td><td><code><pre>        }</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>        return true, nil</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_dumpSanitizedJSON">func dumpSanitizedJSON</div><div class="info"><a href="#s_fn_dumpSanitizedJSON">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/helpers.go</code>:</p></div><table class="listing">
<tr><td>91</td><td><code><pre>func dumpSanitizedJSON(appGw *n.ApplicationGateway, logToFile bool, overwritePrefix *string) ([]byte, error) {</pre></code></td></tr><tr class="miss"><td>92</td><td><code><pre>        jsonConfig, err := appGw.MarshalJSON()</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>94</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>95</td><td><code><pre>        }</pre></code></td></tr><tr><td>96</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>        prefix := &#34;-- App Gwy config --&#34;</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>        if overwritePrefix != nil {</pre></code></td></tr><tr class="miss"><td>99</td><td><code><pre>                prefix = *overwritePrefix</pre></code></td></tr><tr><td>100</td><td><code><pre>        }</pre></code></td></tr><tr><td>101</td><td><code><pre></pre></code></td></tr><tr><td>102</td><td><code><pre>        // Remove sensitive data from the JSON config to be logged</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        keysToDelete := []string{</pre></code></td></tr><tr><td>104</td><td><code><pre>                &#34;sslCertificates&#34;,</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>        var sanitized []byte</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>        if sanitized, err = deleteKeyFromJSON(jsonConfig, keysToDelete...); err != nil {</pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>109</td><td><code><pre>        }</pre></code></td></tr><tr><td>110</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>        prettyJSON, err := utils.PrettyJSON(sanitized, prefix)</pre></code></td></tr><tr><td>112</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>        if logToFile {</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>                fileName := fmt.Sprintf(&#34;app-gateway-config-%d.json&#34;, time.Now().UnixNano())</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>                if filePath, err := utils.SaveToFile(fileName, prettyJSON); err != nil {</pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>                        klog.Error(&#34;Could not log to file: &#34;, filePath, err)</pre></code></td></tr><tr><td>117</td><td><code><pre>                }</pre></code></td></tr><tr><td>118</td><td><code><pre>        }</pre></code></td></tr><tr><td>119</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>120</td><td><code><pre>        return prettyJSON, err</pre></code></td></tr><tr><td>121</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.GetAppGw">func AppGwIngressController.GetAppGw</div><div class="info"><a href="#s_fn_AppGwIngressController.GetAppGw">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_app_gateway.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func (c AppGwIngressController) GetAppGw() (*n.ApplicationGateway, *appgw.ConfigBuilderContext, error) {</pre></code></td></tr><tr><td>32</td><td><code><pre>        // Get current application gateway config</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>        appGw, err := c.azClient.GetGateway()</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>        c.MetricStore.IncArmAPICallCounter()</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>37</td><td><code><pre>                        controllererrors.ErrorFetchingAppGatewayConfig,</pre></code></td></tr><tr><td>38</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>39</td><td><code><pre>                        &#34;unable to get specified AppGateway [%v], check AppGateway identifier&#34;, c.appGwIdentifier.AppGwName,</pre></code></td></tr><tr><td>40</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                klog.Errorf(e.Error())</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                if c.agicPod != nil {</pre></code></td></tr><tr class="miss"><td>43</td><td><code><pre>                        c.recorder.Event(c.agicPod, v1.EventTypeWarning, events.ReasonUnableToFetchAppGw, e.Error())</pre></code></td></tr><tr><td>44</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>45</td><td><code><pre>                return nil, nil, e</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>        cbCtx := &amp;appgw.ConfigBuilderContext{</pre></code></td></tr><tr><td>49</td><td><code><pre>                ServiceList:  c.k8sContext.ListServices(),</pre></code></td></tr><tr><td>50</td><td><code><pre>                IngressList:  c.k8sContext.ListHTTPIngresses(),</pre></code></td></tr><tr><td>51</td><td><code><pre>                EnvVariables: environment.GetEnv(),</pre></code></td></tr><tr><td>52</td><td><code><pre></pre></code></td></tr><tr><td>53</td><td><code><pre>                DefaultAddressPoolID:  to.StringPtr(c.appGwIdentifier.AddressPoolID(appgw.DefaultBackendAddressPoolName)),</pre></code></td></tr><tr><td>54</td><td><code><pre>                DefaultHTTPSettingsID: to.StringPtr(c.appGwIdentifier.HTTPSettingsID(appgw.DefaultBackendHTTPSettingsName)),</pre></code></td></tr><tr><td>55</td><td><code><pre></pre></code></td></tr><tr><td>56</td><td><code><pre>                ExistingPortsByNumber: make(map[appgw.Port]n.ApplicationGatewayFrontendPort),</pre></code></td></tr><tr><td>57</td><td><code><pre>        }</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>        for _, port := range *appGw.FrontendPorts {</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                cbCtx.ExistingPortsByNumber[appgw.Port(*port.Port)] = port</pre></code></td></tr><tr><td>61</td><td><code><pre>        }</pre></code></td></tr><tr><td>62</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>        return &amp;appGw, cbCtx, nil</pre></code></td></tr><tr><td>64</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getIPsFromAppGateway">func getIPsFromAppGateway</div><div class="info"><a href="#s_fn_getIPsFromAppGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code>:</p></div><table class="listing">
<tr><td>76</td><td><code><pre>func getIPsFromAppGateway(appGw *n.ApplicationGateway, azClient azure.AzClient) map[ipResource]ipAddress {</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>        ips := make(map[ipResource]ipAddress)</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>        for _, ipConf := range *appGw.FrontendIPConfigurations {</pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>                ipID := ipResource(*ipConf.ID)</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>                if _, ok := ips[ipID]; ok {</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>82</td><td><code><pre>                }</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>                if ipConf.PrivateIPAddress != nil {</pre></code></td></tr><tr class="miss"><td>85</td><td><code><pre>                        ips[ipID] = ipAddress(*ipConf.PrivateIPAddress)</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                } else if ipAddress := getPublicIPAddress(*ipConf.PublicIPAddress.ID, azClient); ipAddress != nil {</pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>                        ips[ipID] = *ipAddress</pre></code></td></tr><tr><td>88</td><td><code><pre>                }</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>90</td><td><code><pre>        klog.V(5).Infof(&#34;[mutate_aks] Found IPs: %+v&#34;, ips)</pre></code></td></tr><tr class="miss"><td>91</td><td><code><pre>        return ips</pre></code></td></tr><tr><td>92</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@27:10">func @27:10</div><div class="info"><a href="#s_fn_@27:10">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>27</td><td><code><pre>func() {</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                        pruneFuncList = append(pruneFuncList, pruneProhibitedIngress)</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoPrivateIP)</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneRedirectWithNoTLS)</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoSslCertificate)</pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoSslProfile)</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoTrustedRootCertificate)</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr></table>

<div class="funcname" id="fn_getPublicIPAddress">func getPublicIPAddress</div><div class="info"><a href="#s_fn_getPublicIPAddress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code>:</p></div><table class="listing">
<tr><td>95</td><td><code><pre>func getPublicIPAddress(publicIPID string, azClient azure.AzClient) *ipAddress {</pre></code></td></tr><tr><td>96</td><td><code><pre>        // get public ipAddress</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>        publicIP, err := azClient.GetPublicIP(publicIPID)</pre></code></td></tr><tr class="miss"><td>98</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>99</td><td><code><pre>                klog.Errorf(&#34;[mutate_aks] Unable to get Public IP Address %s. Error %s&#34;, publicIPID, err)</pre></code></td></tr><tr class="miss"><td>100</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr><td>102</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        ipAddress := ipAddress(*publicIP.IPAddress)</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>        return &amp;ipAddress</pre></code></td></tr><tr><td>105</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.PruneIngress">func AppGwIngressController.PruneIngress</div><div class="info"><a href="#s_fn_AppGwIngressController.PruneIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/prune.go</code>:</p></div><table class="listing">
<tr><td>26</td><td><code><pre>func (c *AppGwIngressController) PruneIngress(appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext) []*networking.Ingress {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>        once.Do(func() {</pre></code></td></tr><tr><td>28</td><td><code><pre>                if cbCtx.EnvVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr><td>29</td><td><code><pre>                        pruneFuncList = append(pruneFuncList, pruneProhibitedIngress)</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr><td>31</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoPrivateIP)</pre></code></td></tr><tr><td>32</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneRedirectWithNoTLS)</pre></code></td></tr><tr><td>33</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoSslCertificate)</pre></code></td></tr><tr><td>34</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoSslProfile)</pre></code></td></tr><tr><td>35</td><td><code><pre>                pruneFuncList = append(pruneFuncList, pruneNoTrustedRootCertificate)</pre></code></td></tr><tr><td>36</td><td><code><pre>        })</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>        prunedIngresses := cbCtx.IngressList</pre></code></td></tr><tr class="miss"><td>38</td><td><code><pre>        for _, prune := range pruneFuncList {</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>                prunedIngresses = prune(c, appGw, cbCtx, prunedIngresses)</pre></code></td></tr><tr><td>40</td><td><code><pre>        }</pre></code></td></tr><tr><td>41</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>        return prunedIngresses</pre></code></td></tr><tr><td>43</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.MutateAllIngress">func AppGwIngressController.MutateAllIngress</div><div class="info"><a href="#s_fn_AppGwIngressController.MutateAllIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_aks.go</code>:</p></div><table class="listing">
<tr><td>27</td><td><code><pre>func (c AppGwIngressController) MutateAllIngress(appGw *n.ApplicationGateway, cbCtx *appgw.ConfigBuilderContext) error {</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>        ips := getIPsFromAppGateway(appGw, c.azClient)</pre></code></td></tr><tr><td>29</td><td><code><pre></pre></code></td></tr><tr><td>30</td><td><code><pre>        // update all relevant ingresses with IP address obtained from existing App Gateway configuration</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>        cbCtx.IngressList = c.PruneIngress(appGw, cbCtx)</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>        for _, ingress := range cbCtx.IngressList {</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                c.updateIngressStatus(appGw, cbCtx, ingress, ips)</pre></code></td></tr><tr><td>34</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>36</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.Readiness">func AppGwIngressController.Readiness</div><div class="info"><a href="#s_fn_AppGwIngressController.Readiness">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>101</td><td><code><pre>func (c *AppGwIngressController) Readiness() bool {</pre></code></td></tr><tr class="miss"><td>102</td><td><code><pre>        if !c.hostedOnUnderlay {</pre></code></td></tr><tr><td>103</td><td><code><pre>                // When the channel is CLOSED we have synced cache and are READY!</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                _, isOpen := &lt;-c.k8sContext.CacheSynced</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                return !isOpen</pre></code></td></tr><tr><td>106</td><td><code><pre>        }</pre></code></td></tr><tr><td>107</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>        return true</pre></code></td></tr><tr><td>109</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_AppGwIngressController.Liveness">func AppGwIngressController.Liveness</div><div class="info"><a href="#s_fn_AppGwIngressController.Liveness">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/controller.go</code>:</p></div><table class="listing">
<tr><td>95</td><td><code><pre>func (c *AppGwIngressController) Liveness() bool {</pre></code></td></tr><tr><td>96</td><td><code><pre>        // TODO(draychev): implement</pre></code></td></tr><tr class="miss"><td>97</td><td><code><pre>        return true</pre></code></td></tr><tr><td>98</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_realClock.Now">func realClock.Now</div><div class="info"><a href="#s_fn_realClock.Now">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/controller/mutate_app_gateway.go</code>:</p></div><table class="listing">
<tr class="miss"><td>28</td><td><code><pre>func (realClock) Now() time.Time { return time.Now() }</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/controller DONE:42.74
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment <span class="packageTotal">59.18%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_ValidateEnv"><td><code><a href="#fn_ValidateEnv">ValidateEnv(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>18/18</code></td></tr>
<tr id="s_fn_GetEnvironmentVariable"><td><code><a href="#fn_GetEnvironmentVariable">GetEnvironmentVariable(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_GetEnv"><td><code><a href="#fn_GetEnv">GetEnv(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_EnvVariables.Consolidate"><td><code><a href="#fn_EnvVariables.Consolidate">EnvVariables.Consolidate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/18</code></td></tr>
<tr id="s_fn_GetFakeEnv"><td><code><a href="#fn_GetFakeEnv">GetFakeEnv(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment/fake.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment</code></td><td class="percent"><code>59.18%</code></td><td class="linecount"><code>29/49</code></td></tr>
</table>

<div class="funcname" id="fn_ValidateEnv">func ValidateEnv</div><div class="info"><a href="#s_fn_ValidateEnv">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code>:</p></div><table class="listing">
<tr><td>250</td><td><code><pre>func ValidateEnv(env EnvVariables) error {</pre></code></td></tr><tr><td>251</td><td><code><pre>        if env.EnableDeployAppGateway {</pre></code></td></tr><tr><td>252</td><td><code><pre>                // we should not allow applicationGatewayID in create case</pre></code></td></tr><tr><td>253</td><td><code><pre>                if len(env.AppGwResourceID) != 0 {</pre></code></td></tr><tr><td>254</td><td><code><pre>                        return controllererrors.NewError(</pre></code></td></tr><tr><td>255</td><td><code><pre>                                controllererrors.ErrorNotAllowedApplicationGatewayID,</pre></code></td></tr><tr><td>256</td><td><code><pre>                                &#34;Please provide provide APPGW_NAME (helm var name: .appgw.name) instead of APPGW_RESOURCE_ID (helm var name: .appgw.applicationGatewayID). &#34;+</pre></code></td></tr><tr><td>257</td><td><code><pre>                                        &#34;You can also provided APPGW_SUBSCRIPTION_ID and APPGW_RESOURCE_GROUP&#34;,</pre></code></td></tr><tr><td>258</td><td><code><pre>                        )</pre></code></td></tr><tr><td>259</td><td><code><pre>                }</pre></code></td></tr><tr><td>260</td><td><code><pre></pre></code></td></tr><tr><td>261</td><td><code><pre>                // if deploy is true, we need applicationGatewayName</pre></code></td></tr><tr><td>262</td><td><code><pre>                if len(env.AppGwName) == 0 {</pre></code></td></tr><tr><td>263</td><td><code><pre>                        return controllererrors.NewError(</pre></code></td></tr><tr><td>264</td><td><code><pre>                                controllererrors.ErrorMissingApplicationGatewayName,</pre></code></td></tr><tr><td>265</td><td><code><pre>                                &#34;Missing required Environment variables: AGIC requires APPGW_NAME (helm var name: appgw.name) to deploy Application Gateway&#34;,</pre></code></td></tr><tr><td>266</td><td><code><pre>                        )</pre></code></td></tr><tr><td>267</td><td><code><pre>                }</pre></code></td></tr><tr><td>268</td><td><code><pre></pre></code></td></tr><tr><td>269</td><td><code><pre>                // we need one of subnetID and subnetPrefix. We generate a subnetName if it is not provided.</pre></code></td></tr><tr><td>270</td><td><code><pre>                if len(env.AppGwSubnetID) == 0 &amp;&amp; len(env.AppGwSubnetPrefix) == 0 {</pre></code></td></tr><tr><td>271</td><td><code><pre>                        // when create is true, then either we should have env.AppGwSubnetID or env.AppGwSubnetPrefix</pre></code></td></tr><tr><td>272</td><td><code><pre>                        return controllererrors.NewError(</pre></code></td></tr><tr><td>273</td><td><code><pre>                                controllererrors.ErrorMissingSubnetInfo,</pre></code></td></tr><tr><td>274</td><td><code><pre>                                &#34;Missing required Environment variables: &#34;+</pre></code></td></tr><tr><td>275</td><td><code><pre>                                        &#34;AGIC requires APPGW_SUBNET_PREFIX (helm var name: appgw.subnetPrefix) or APPGW_SUBNET_ID (helm var name: appgw.subnetID) of an existing subnet. &#34;+</pre></code></td></tr><tr><td>276</td><td><code><pre>                                        &#34;If subnetPrefix is specified, AGIC will look up a subnet with matching address prefix in the AKS cluster vnet. &#34;+</pre></code></td></tr><tr><td>277</td><td><code><pre>                                        &#34;If a subnet is not found, then a new subnet will be created. This will be used to deploy the Application Gateway&#34;,</pre></code></td></tr><tr><td>278</td><td><code><pre>                        )</pre></code></td></tr><tr><td>279</td><td><code><pre></pre></code></td></tr><tr><td>280</td><td><code><pre>                }</pre></code></td></tr><tr><td>281</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>282</td><td><code><pre>                // if deploy is false, we need one of appgw name or resource id</pre></code></td></tr><tr><td>283</td><td><code><pre>                if len(env.AppGwName) == 0 &amp;&amp; len(env.AppGwResourceID) == 0 {</pre></code></td></tr><tr><td>284</td><td><code><pre>                        return controllererrors.NewError(</pre></code></td></tr><tr><td>285</td><td><code><pre>                                controllererrors.ErrorMissingApplicationGatewayNameOrApplicationGatewayID,</pre></code></td></tr><tr><td>286</td><td><code><pre>                                &#34;Missing required Environment variables: &#34;+</pre></code></td></tr><tr><td>287</td><td><code><pre>                                        &#34;Provide atleast provide APPGW_NAME (helm var name: .appgw.name) or APPGW_RESOURCE_ID (helm var name: .appgw.applicationGatewayID). &#34;+</pre></code></td></tr><tr><td>288</td><td><code><pre>                                        &#34;If providing APPGW_NAME, You can also provided APPGW_SUBSCRIPTION_ID (helm var name: .appgw.subscriptionId) and APPGW_RESOURCE_GROUP (helm var name: .appgw.resourceGroup)&#34;,</pre></code></td></tr><tr><td>289</td><td><code><pre>                        )</pre></code></td></tr><tr><td>290</td><td><code><pre>                }</pre></code></td></tr><tr><td>291</td><td><code><pre>        }</pre></code></td></tr><tr><td>292</td><td><code><pre></pre></code></td></tr><tr><td>293</td><td><code><pre>        if env.WatchNamespace == &#34;&#34; {</pre></code></td></tr><tr><td>294</td><td><code><pre>                klog.V(1).Infof(&#34;%s is not set. Watching all available namespaces.&#34;, WatchNamespaceVarName)</pre></code></td></tr><tr><td>295</td><td><code><pre>        }</pre></code></td></tr><tr><td>296</td><td><code><pre></pre></code></td></tr><tr><td>297</td><td><code><pre>        if env.ReconcilePeriodSeconds != &#34;&#34; {</pre></code></td></tr><tr><td>298</td><td><code><pre>                reconcilePeriodSeconds, err := strconv.Atoi(env.ReconcilePeriodSeconds)</pre></code></td></tr><tr><td>299</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr><td>300</td><td><code><pre>                        return controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>301</td><td><code><pre>                                controllererrors.ErrorInvalidReconcilePeriod,</pre></code></td></tr><tr><td>302</td><td><code><pre>                                err,</pre></code></td></tr><tr><td>303</td><td><code><pre>                                &#34;Please make sure that RECONCILE_PERIOD_SECONDS (helm var name: .reconcilePeriodSeconds) is an integer. Range: (30 - 300)&#34;,</pre></code></td></tr><tr><td>304</td><td><code><pre>                        )</pre></code></td></tr><tr><td>305</td><td><code><pre>                }</pre></code></td></tr><tr><td>306</td><td><code><pre></pre></code></td></tr><tr><td>307</td><td><code><pre>                if reconcilePeriodSeconds &lt; 30 || reconcilePeriodSeconds &gt; 300 {</pre></code></td></tr><tr><td>308</td><td><code><pre>                        return controllererrors.NewError(</pre></code></td></tr><tr><td>309</td><td><code><pre>                                controllererrors.ErrorInvalidReconcilePeriod,</pre></code></td></tr><tr><td>310</td><td><code><pre>                                &#34;Please make sure that RECONCILE_PERIOD_SECONDS (helm var name: .reconcilePeriodSeconds) is an integer. Range: (30 - 300)&#34;,</pre></code></td></tr><tr><td>311</td><td><code><pre>                        )</pre></code></td></tr><tr><td>312</td><td><code><pre>                }</pre></code></td></tr><tr><td>313</td><td><code><pre>        }</pre></code></td></tr><tr><td>314</td><td><code><pre></pre></code></td></tr><tr><td>315</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>316</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetEnvironmentVariable">func GetEnvironmentVariable</div><div class="info"><a href="#s_fn_GetEnvironmentVariable">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code>:</p></div><table class="listing">
<tr><td>319</td><td><code><pre>func GetEnvironmentVariable(environmentVariable, defaultValue string, validator *regexp.Regexp) string {</pre></code></td></tr><tr><td>320</td><td><code><pre>        if value, ok := os.LookupEnv(environmentVariable); ok {</pre></code></td></tr><tr><td>321</td><td><code><pre>                if validator == nil {</pre></code></td></tr><tr><td>322</td><td><code><pre>                        return value</pre></code></td></tr><tr><td>323</td><td><code><pre>                }</pre></code></td></tr><tr><td>324</td><td><code><pre>                if validator.MatchString(value) {</pre></code></td></tr><tr><td>325</td><td><code><pre>                        return value</pre></code></td></tr><tr><td>326</td><td><code><pre>                }</pre></code></td></tr><tr><td>327</td><td><code><pre>                klog.Errorf(&#34;Environment variable %s contains a value which does not pass validation filter; Using default value: %s&#34;, environmentVariable, defaultValue)</pre></code></td></tr><tr><td>328</td><td><code><pre>        }</pre></code></td></tr><tr><td>329</td><td><code><pre>        return defaultValue</pre></code></td></tr><tr><td>330</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetEnv">func GetEnv</div><div class="info"><a href="#s_fn_GetEnv">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code>:</p></div><table class="listing">
<tr><td>207</td><td><code><pre>func GetEnv() EnvVariables {</pre></code></td></tr><tr><td>208</td><td><code><pre>        usePrivateIP, _ := strconv.ParseBool(os.Getenv(UsePrivateIPVarName))</pre></code></td></tr><tr><td>209</td><td><code><pre>        multiClusterMode, _ := strconv.ParseBool(os.Getenv(MultiClusterModeVarName))</pre></code></td></tr><tr><td>210</td><td><code><pre></pre></code></td></tr><tr><td>211</td><td><code><pre>        env := EnvVariables{</pre></code></td></tr><tr><td>212</td><td><code><pre>                CloudProviderConfigLocation: os.Getenv(CloudProviderConfigLocationVarName),</pre></code></td></tr><tr><td>213</td><td><code><pre>                ClientID:                    os.Getenv(ClientIDVarName),</pre></code></td></tr><tr><td>214</td><td><code><pre>                SubscriptionID:              os.Getenv(SubscriptionIDVarName),</pre></code></td></tr><tr><td>215</td><td><code><pre>                ResourceGroupName:           os.Getenv(ResourceGroupNameVarName),</pre></code></td></tr><tr><td>216</td><td><code><pre>                AppGwName:                   os.Getenv(AppGwNameVarName),</pre></code></td></tr><tr><td>217</td><td><code><pre>                AppGwSubnetName:             os.Getenv(AppGwSubnetNameVarName),</pre></code></td></tr><tr><td>218</td><td><code><pre>                AppGwSubnetPrefix:           os.Getenv(AppGwSubnetPrefixVarName),</pre></code></td></tr><tr><td>219</td><td><code><pre>                AppGwResourceID:             os.Getenv(AppGwResourceIDVarName),</pre></code></td></tr><tr><td>220</td><td><code><pre>                AppGwSubnetID:               os.Getenv(AppGwSubnetIDVarName),</pre></code></td></tr><tr><td>221</td><td><code><pre>                AppGwSkuName:                GetEnvironmentVariable(AppGwSkuVarName, &#34;Standard_v2&#34;, skuValidator),</pre></code></td></tr><tr><td>222</td><td><code><pre>                AuthLocation:                os.Getenv(AuthLocationVarName),</pre></code></td></tr><tr><td>223</td><td><code><pre>                IngressClass:                os.Getenv(IngressClassVarName),</pre></code></td></tr><tr><td>224</td><td><code><pre>                IngressClassResourceEnabled: GetEnvironmentVariable(IngressClassResourceEnabledVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>225</td><td><code><pre>                IngressClassResourceName:    os.Getenv(IngressClassResourceNameVarName),</pre></code></td></tr><tr><td>226</td><td><code><pre>                IngressClassResourceDefault: GetEnvironmentVariable(IngressClassResourceDefaultVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>227</td><td><code><pre>                IngressClassControllerName:  os.Getenv(IngressClassControllerNameVarName),</pre></code></td></tr><tr><td>228</td><td><code><pre>                WatchNamespace:              os.Getenv(WatchNamespaceVarName),</pre></code></td></tr><tr><td>229</td><td><code><pre>                UsePrivateIP:                usePrivateIP,</pre></code></td></tr><tr><td>230</td><td><code><pre>                VerbosityLevel:              os.Getenv(VerbosityLevelVarName),</pre></code></td></tr><tr><td>231</td><td><code><pre>                AGICPodName:                 os.Getenv(AGICPodNameVarName),</pre></code></td></tr><tr><td>232</td><td><code><pre>                AGICPodNamespace:            os.Getenv(AGICPodNamespaceVarName),</pre></code></td></tr><tr><td>233</td><td><code><pre>                EnableBrownfieldDeployment:  GetEnvironmentVariable(EnableBrownfieldDeploymentVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>234</td><td><code><pre>                EnableIstioIntegration:      GetEnvironmentVariable(EnableIstioIntegrationVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>235</td><td><code><pre>                EnableSaveConfigToFile:      GetEnvironmentVariable(EnableSaveConfigToFileVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>236</td><td><code><pre>                EnablePanicOnPutError:       GetEnvironmentVariable(EnablePanicOnPutErrorVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>237</td><td><code><pre>                EnableDeployAppGateway:      GetEnvironmentVariable(EnableDeployAppGatewayVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>238</td><td><code><pre>                UseManagedIdentityForPod:    GetEnvironmentVariable(UseManagedIdentityForPodVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>239</td><td><code><pre>                HTTPServicePort:             GetEnvironmentVariable(HTTPServicePortVarName, &#34;8123&#34;, portNumberValidator),</pre></code></td></tr><tr><td>240</td><td><code><pre>                AttachWAFPolicyToListener:   GetEnvironmentVariable(AttachWAFPolicyToListenerVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>241</td><td><code><pre>                HostedOnUnderlay:            GetEnvironmentVariable(HostedOnUnderlayVarName, &#34;false&#34;, boolValidator) == &#34;true&#34;,</pre></code></td></tr><tr><td>242</td><td><code><pre>                ReconcilePeriodSeconds:      os.Getenv(ReconcilePeriodSecondsVarName),</pre></code></td></tr><tr><td>243</td><td><code><pre>                MultiClusterMode:            multiClusterMode,</pre></code></td></tr><tr><td>244</td><td><code><pre>        }</pre></code></td></tr><tr><td>245</td><td><code><pre></pre></code></td></tr><tr><td>246</td><td><code><pre>        return env</pre></code></td></tr><tr><td>247</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_EnvVariables.Consolidate">func EnvVariables.Consolidate</div><div class="info"><a href="#s_fn_EnvVariables.Consolidate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/environment/environment.go</code>:</p></div><table class="listing">
<tr><td>168</td><td><code><pre>func (env *EnvVariables) Consolidate(cpConfig *azure.CloudProviderConfig) {</pre></code></td></tr><tr><td>169</td><td><code><pre>        // adjust env variable</pre></code></td></tr><tr class="miss"><td>170</td><td><code><pre>        if env.AppGwResourceID != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>171</td><td><code><pre>                subscriptionID, resourceGroupName, applicationGatewayName := azure.ParseResourceID(env.AppGwResourceID)</pre></code></td></tr><tr class="miss"><td>172</td><td><code><pre>                env.SubscriptionID = string(subscriptionID)</pre></code></td></tr><tr class="miss"><td>173</td><td><code><pre>                env.ResourceGroupName = string(resourceGroupName)</pre></code></td></tr><tr class="miss"><td>174</td><td><code><pre>                env.AppGwName = string(applicationGatewayName)</pre></code></td></tr><tr><td>175</td><td><code><pre>        }</pre></code></td></tr><tr><td>176</td><td><code><pre></pre></code></td></tr><tr><td>177</td><td><code><pre>        // Set using cloud provider config</pre></code></td></tr><tr class="miss"><td>178</td><td><code><pre>        if cpConfig != nil {</pre></code></td></tr><tr class="miss"><td>179</td><td><code><pre>                if env.SubscriptionID == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>180</td><td><code><pre>                        env.SubscriptionID = string(cpConfig.SubscriptionID)</pre></code></td></tr><tr><td>181</td><td><code><pre>                }</pre></code></td></tr><tr><td>182</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>183</td><td><code><pre>                if env.ResourceGroupName == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>184</td><td><code><pre>                        env.ResourceGroupName = string(cpConfig.ResourceGroup)</pre></code></td></tr><tr><td>185</td><td><code><pre>                }</pre></code></td></tr><tr><td>186</td><td><code><pre>        }</pre></code></td></tr><tr><td>187</td><td><code><pre></pre></code></td></tr><tr><td>188</td><td><code><pre>        // Set defaults</pre></code></td></tr><tr class="miss"><td>189</td><td><code><pre>        if env.AppGwSubnetName == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>190</td><td><code><pre>                env.AppGwSubnetName = env.AppGwName + &#34;-subnet&#34;</pre></code></td></tr><tr><td>191</td><td><code><pre>        }</pre></code></td></tr><tr><td>192</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>193</td><td><code><pre>        if env.IngressClass != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>194</td><td><code><pre>                env.IngressClassControllerName = env.IngressClass</pre></code></td></tr><tr><td>195</td><td><code><pre>        }</pre></code></td></tr><tr><td>196</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>197</td><td><code><pre>        if env.IngressClassControllerName == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>198</td><td><code><pre>                env.IngressClassControllerName = DefaultIngressClassController</pre></code></td></tr><tr><td>199</td><td><code><pre>        }</pre></code></td></tr><tr><td>200</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>201</td><td><code><pre>        if env.IngressClassResourceName == &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>202</td><td><code><pre>                env.IngressClassResourceName = DefaultIngressClassResourceName</pre></code></td></tr><tr><td>203</td><td><code><pre>        }</pre></code></td></tr><tr><td>204</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetFakeEnv">func GetFakeEnv</div><div class="info"><a href="#s_fn_GetFakeEnv">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/environment/fake.go</code>:</p></div><table class="listing">
<tr><td>9</td><td><code><pre>func GetFakeEnv() EnvVariables {</pre></code></td></tr><tr class="miss"><td>10</td><td><code><pre>        env := EnvVariables{</pre></code></td></tr><tr><td>11</td><td><code><pre>                SubscriptionID:             &#34;--SubscriptionID--&#34;,</pre></code></td></tr><tr><td>12</td><td><code><pre>                ResourceGroupName:          &#34;--ResourceGroupName--&#34;,</pre></code></td></tr><tr><td>13</td><td><code><pre>                AppGwName:                  &#34;--AppGwName--&#34;,</pre></code></td></tr><tr><td>14</td><td><code><pre>                AuthLocation:               &#34;--AuthLocation--&#34;,</pre></code></td></tr><tr><td>15</td><td><code><pre>                WatchNamespace:             &#34;--WatchNamespace--&#34;,</pre></code></td></tr><tr><td>16</td><td><code><pre>                UsePrivateIP:               false,</pre></code></td></tr><tr><td>17</td><td><code><pre>                VerbosityLevel:             &#34;123456789&#34;,</pre></code></td></tr><tr><td>18</td><td><code><pre>                IngressClassControllerName: DefaultIngressClassController,</pre></code></td></tr><tr><td>19</td><td><code><pre>        }</pre></code></td></tr><tr><td>20</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>21</td><td><code><pre>        return env</pre></code></td></tr><tr><td>22</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/environment DONE:59.18
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext <span class="packageTotal">45.20%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_NewContext"><td><code><a href="#fn_NewContext">NewContext(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>32/32</code></td></tr>
<tr id="s_fn_Context.listServicesByPodSelector"><td><code><a href="#fn_Context.listServicesByPodSelector">Context.listServicesByPodSelector(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>11/11</code></td></tr>
<tr id="s_fn_Context.IsIngressClass"><td><code><a href="#fn_Context.IsIngressClass">Context.IsIngressClass(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_Context.IsPodReferencedByAnyIngress"><td><code><a href="#fn_Context.IsPodReferencedByAnyIngress">Context.IsPodReferencedByAnyIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_Context.IsIstioGatewayIngress"><td><code><a href="#fn_Context.IsIstioGatewayIngress">Context.IsIstioGatewayIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_SecretsStore.delete"><td><code><a href="#fn_SecretsStore.delete">SecretsStore.delete(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_init"><td><code><a href="#fn_init">init(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/supported_apiversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_Context.IsEndpointReferencedByAnyIngress"><td><code><a href="#fn_Context.IsEndpointReferencedByAnyIngress">Context.IsEndpointReferencedByAnyIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_getNamespace"><td><code><a href="#fn_getNamespace">getNamespace(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewSecretStore"><td><code><a href="#fn_NewSecretStore">NewSecretStore(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_handlers.ingressAdd"><td><code><a href="#fn_handlers.ingressAdd">handlers.ingressAdd(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/ingress_handlers.go</code></td><td class="percent"><code>95.00%</code></td><td class="linecount"><code>19/20</code></td></tr>
<tr id="s_fn_Context.ListPodsByServiceSelector"><td><code><a href="#fn_Context.ListPodsByServiceSelector">Context.ListPodsByServiceSelector(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>92.86%</code></td><td class="linecount"><code>13/14</code></td></tr>
<tr id="s_fn_Context.filterAndSort"><td><code><a href="#fn_Context.filterAndSort">Context.filterAndSort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>88.89%</code></td><td class="linecount"><code>8/9</code></td></tr>
<tr id="s_fn_handlers.deleteFunc"><td><code><a href="#fn_handlers.deleteFunc">handlers.deleteFunc(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code></td><td class="percent"><code>85.71%</code></td><td class="linecount"><code>6/7</code></td></tr>
<tr id="s_fn_handlers.addFunc"><td><code><a href="#fn_handlers.addFunc">handlers.addFunc(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code></td><td class="percent"><code>85.71%</code></td><td class="linecount"><code>6/7</code></td></tr>
<tr id="s_fn_SecretsStore.ConvertSecret"><td><code><a href="#fn_SecretsStore.ConvertSecret">SecretsStore.ConvertSecret(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code></td><td class="percent"><code>83.33%</code></td><td class="linecount"><code>25/30</code></td></tr>
<tr id="s_fn_handlers.secretAdd"><td><code><a href="#fn_handlers.secretAdd">handlers.secretAdd(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secrets_handlers.go</code></td><td class="percent"><code>81.82%</code></td><td class="linecount"><code>9/11</code></td></tr>
<tr id="s_fn_Context.isServiceReferencedByAnyIngress"><td><code><a href="#fn_Context.isServiceReferencedByAnyIngress">Context.isServiceReferencedByAnyIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>6/8</code></td></tr>
<tr id="s_fn_SecretsStore.GetPfxCertificate"><td><code><a href="#fn_SecretsStore.GetPfxCertificate">SecretsStore.GetPfxCertificate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_hasTCPPort"><td><code><a href="#fn_hasTCPPort">hasTCPPort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_hasHTTPRule"><td><code><a href="#fn_hasHTTPRule">hasHTTPRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_Context.updateV1IngressStatus"><td><code><a href="#fn_Context.updateV1IngressStatus">Context.updateV1IngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>70.00%</code></td><td class="linecount"><code>14/20</code></td></tr>
<tr id="s_fn_handlers.updateFunc"><td><code><a href="#fn_handlers.updateFunc">handlers.updateFunc(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>6/9</code></td></tr>
<tr id="s_fn_Context.Run"><td><code><a href="#fn_Context.Run">Context.Run(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>65.62%</code></td><td class="linecount"><code>21/32</code></td></tr>
<tr id="s_fn_handlers.secretDelete"><td><code><a href="#fn_handlers.secretDelete">handlers.secretDelete(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secrets_handlers.go</code></td><td class="percent"><code>64.71%</code></td><td class="linecount"><code>11/17</code></td></tr>
<tr id="s_fn_Context.getIngressClassResource"><td><code><a href="#fn_Context.getIngressClassResource">Context.getIngressClassResource(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>62.50%</code></td><td class="linecount"><code>5/8</code></td></tr>
<tr id="s_fn_handlers.ingressDelete"><td><code><a href="#fn_handlers.ingressDelete">handlers.ingressDelete(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/ingress_handlers.go</code></td><td class="percent"><code>61.11%</code></td><td class="linecount"><code>11/18</code></td></tr>
<tr id="s_fn_writeFileDecode"><td><code><a href="#fn_writeFileDecode">writeFileDecode(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code></td><td class="percent"><code>60.00%</code></td><td class="linecount"><code>3/5</code></td></tr>
<tr id="s_fn_handlers.secretUpdate"><td><code><a href="#fn_handlers.secretUpdate">handlers.secretUpdate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/secrets_handlers.go</code></td><td class="percent"><code>46.15%</code></td><td class="linecount"><code>6/13</code></td></tr>
<tr id="s_fn_Context.ListServices"><td><code><a href="#fn_Context.ListServices">Context.ListServices(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>42.11%</code></td><td class="linecount"><code>8/19</code></td></tr>
<tr id="s_fn_Context.UpdateIngressStatus"><td><code><a href="#fn_Context.UpdateIngressStatus">Context.UpdateIngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>40.00%</code></td><td class="linecount"><code>2/5</code></td></tr>
<tr id="s_fn_Context.ListHTTPIngresses"><td><code><a href="#fn_Context.ListHTTPIngresses">Context.ListHTTPIngresses(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>38.89%</code></td><td class="linecount"><code>7/18</code></td></tr>
<tr id="s_fn_Context.GetService"><td><code><a href="#fn_Context.GetService">Context.GetService(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>34.78%</code></td><td class="linecount"><code>8/23</code></td></tr>
<tr id="s_fn_handlers.ingressUpdate"><td><code><a href="#fn_handlers.ingressUpdate">handlers.ingressUpdate(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/ingress_handlers.go</code></td><td class="percent"><code>25.00%</code></td><td class="linecount"><code>6/24</code></td></tr>
<tr id="s_fn_Context.generateEndpointsFromMultiClusterService"><td><code><a href="#fn_Context.generateEndpointsFromMultiClusterService">Context.generateEndpointsFromMultiClusterService(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/22</code></td></tr>
<tr id="s_fn_Context.updateV1beta1IngressStatus"><td><code><a href="#fn_Context.updateV1beta1IngressStatus">Context.updateV1beta1IngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/20</code></td></tr>
<tr id="s_fn_Context.updateMultiClusterIngressStatus"><td><code><a href="#fn_Context.updateMultiClusterIngressStatus">Context.updateMultiClusterIngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/20</code></td></tr>
<tr id="s_fn_Context.GetVirtualServicesForGateway"><td><code><a href="#fn_Context.GetVirtualServicesForGateway">Context.GetVirtualServicesForGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/15</code></td></tr>
<tr id="s_fn_Context.GetInfrastructureResourceGroupID"><td><code><a href="#fn_Context.GetInfrastructureResourceGroupID">Context.GetInfrastructureResourceGroupID(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/15</code></td></tr>
<tr id="s_fn_Context.GetEndpointsByService"><td><code><a href="#fn_Context.GetEndpointsByService">Context.GetEndpointsByService(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/14</code></td></tr>
<tr id="s_fn_Context.GetBackendPool"><td><code><a href="#fn_Context.GetBackendPool">Context.GetBackendPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_SupportsNetworkingPackage"><td><code><a href="#fn_SupportsNetworkingPackage">SupportsNetworkingPackage(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/supported_apiversion.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_Context.GetInstanceUpdateStatus"><td><code><a href="#fn_Context.GetInstanceUpdateStatus">Context.GetInstanceUpdateStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_Context.GetRewriteRuleSetCustomResource"><td><code><a href="#fn_Context.GetRewriteRuleSetCustomResource">Context.GetRewriteRuleSetCustomResource(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/12</code></td></tr>
<tr id="s_fn_Context.ListAzureProhibitedTargets"><td><code><a href="#fn_Context.ListAzureProhibitedTargets">Context.ListAzureProhibitedTargets(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/11</code></td></tr>
<tr id="s_fn_Context.GetSecret"><td><code><a href="#fn_Context.GetSecret">Context.GetSecret(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/9</code></td></tr>
<tr id="s_fn_Context.GetEndpointsForVirtualService"><td><code><a href="#fn_Context.GetEndpointsForVirtualService">Context.GetEndpointsForVirtualService(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/9</code></td></tr>
<tr id="s_fn_Context.ListIstioGateways"><td><code><a href="#fn_Context.ListIstioGateways">Context.ListIstioGateways(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/istio_context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_Context.ListIstioVirtualServices"><td><code><a href="#fn_Context.ListIstioVirtualServices">Context.ListIstioVirtualServices(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/istio_context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_Context.GetAGICPod"><td><code><a href="#fn_Context.GetAGICPod">Context.GetAGICPod(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_Context.GetGateways"><td><code><a href="#fn_Context.GetGateways">Context.GetGateways(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_Context.GetProhibitedTarget"><td><code><a href="#fn_Context.GetProhibitedTarget">Context.GetProhibitedTarget(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr id="s_fn_@52:41"><td><code><a href="#fn_@52:41">@52:41(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/supported_apiversion.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/5</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext</code></td><td class="percent"><code>45.20%</code></td><td class="linecount"><code>278/615</code></td></tr>
</table>

<div class="funcname" id="fn_NewContext">func NewContext</div><div class="info"><a href="#s_fn_NewContext">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>57</td><td><code><pre>func NewContext(kubeClient kubernetes.Interface, crdClient versioned.Interface, multiClusterCrdClient multicluster_versioned.Interface, istioCrdClient istio_versioned.Interface, namespaces []string, resyncPeriod time.Duration, metricStore metricstore.MetricStore, envVariables environment.EnvVariables) *Context {</pre></code></td></tr><tr><td>58</td><td><code><pre>        informerFactory := informers.NewSharedInformerFactory(kubeClient, resyncPeriod)</pre></code></td></tr><tr><td>59</td><td><code><pre>        crdInformerFactory := externalversions.NewSharedInformerFactory(crdClient, resyncPeriod)</pre></code></td></tr><tr><td>60</td><td><code><pre>        multiClusterCrdInformerFactory := multicluster_externalversions.NewSharedInformerFactory(multiClusterCrdClient, resyncPeriod)</pre></code></td></tr><tr><td>61</td><td><code><pre>        istioCrdInformerFactory := istio_externalversions.NewSharedInformerFactoryWithOptions(istioCrdClient, resyncPeriod)</pre></code></td></tr><tr><td>62</td><td><code><pre></pre></code></td></tr><tr><td>63</td><td><code><pre>        informerCollection := InformerCollection{</pre></code></td></tr><tr><td>64</td><td><code><pre>                Endpoints: informerFactory.Core().V1().Endpoints().Informer(),</pre></code></td></tr><tr><td>65</td><td><code><pre>                Pods:      informerFactory.Core().V1().Pods().Informer(),</pre></code></td></tr><tr><td>66</td><td><code><pre>                Secret:    informerFactory.Core().V1().Secrets().Informer(),</pre></code></td></tr><tr><td>67</td><td><code><pre>                Service:   informerFactory.Core().V1().Services().Informer(),</pre></code></td></tr><tr><td>68</td><td><code><pre></pre></code></td></tr><tr><td>69</td><td><code><pre>                AzureIngressProhibitedTarget:                crdInformerFactory.Azureingressprohibitedtargets().V1().AzureIngressProhibitedTargets().Informer(),</pre></code></td></tr><tr><td>70</td><td><code><pre>                AzureApplicationGatewayBackendPool:          crdInformerFactory.Azureapplicationgatewaybackendpools().V1beta1().AzureApplicationGatewayBackendPools().Informer(),</pre></code></td></tr><tr><td>71</td><td><code><pre>                AzureApplicationGatewayRewrite:              crdInformerFactory.Azureapplicationgatewayrewrites().V1beta1().AzureApplicationGatewayRewrites().Informer(),</pre></code></td></tr><tr><td>72</td><td><code><pre>                AzureApplicationGatewayInstanceUpdateStatus: crdInformerFactory.Azureapplicationgatewayinstanceupdatestatus().V1beta1().AzureApplicationGatewayInstanceUpdateStatuses().Informer(),</pre></code></td></tr><tr><td>73</td><td><code><pre>                MultiClusterService:                         multiClusterCrdInformerFactory.Multiclusterservices().V1alpha1().MultiClusterServices().Informer(),</pre></code></td></tr><tr><td>74</td><td><code><pre>                MultiClusterIngress:                         multiClusterCrdInformerFactory.Multiclusteringresses().V1alpha1().MultiClusterIngresses().Informer(),</pre></code></td></tr><tr><td>75</td><td><code><pre>                IstioGateway:                                istioCrdInformerFactory.Networking().V1alpha3().Gateways().Informer(),</pre></code></td></tr><tr><td>76</td><td><code><pre>                IstioVirtualService:                         istioCrdInformerFactory.Networking().V1alpha3().VirtualServices().Informer(),</pre></code></td></tr><tr><td>77</td><td><code><pre>        }</pre></code></td></tr><tr><td>78</td><td><code><pre></pre></code></td></tr><tr><td>79</td><td><code><pre>        if IsNetworkingV1PackageSupported {</pre></code></td></tr><tr><td>80</td><td><code><pre>                informerCollection.Ingress = informerFactory.Networking().V1().Ingresses().Informer()</pre></code></td></tr><tr><td>81</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>82</td><td><code><pre>                informerCollection.Ingress = informerFactory.Extensions().V1beta1().Ingresses().Informer()</pre></code></td></tr><tr><td>83</td><td><code><pre>        }</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr><td>85</td><td><code><pre>        cacheCollection := CacheCollection{</pre></code></td></tr><tr><td>86</td><td><code><pre>                Endpoints:                          informerCollection.Endpoints.GetStore(),</pre></code></td></tr><tr><td>87</td><td><code><pre>                Ingress:                            informerCollection.Ingress.GetStore(),</pre></code></td></tr><tr><td>88</td><td><code><pre>                Pods:                               informerCollection.Pods.GetStore(),</pre></code></td></tr><tr><td>89</td><td><code><pre>                Secret:                             informerCollection.Secret.GetStore(),</pre></code></td></tr><tr><td>90</td><td><code><pre>                Service:                            informerCollection.Service.GetStore(),</pre></code></td></tr><tr><td>91</td><td><code><pre>                AzureIngressProhibitedTarget:       informerCollection.AzureIngressProhibitedTarget.GetStore(),</pre></code></td></tr><tr><td>92</td><td><code><pre>                AzureApplicationGatewayBackendPool: informerCollection.AzureApplicationGatewayBackendPool.GetStore(),</pre></code></td></tr><tr><td>93</td><td><code><pre>                AzureApplicationGatewayRewrite:     informerCollection.AzureApplicationGatewayRewrite.GetStore(),</pre></code></td></tr><tr><td>94</td><td><code><pre>                AzureApplicationGatewayInstanceUpdateStatus: informerCollection.AzureApplicationGatewayInstanceUpdateStatus.GetStore(),</pre></code></td></tr><tr><td>95</td><td><code><pre>                MultiClusterService:                         informerCollection.MultiClusterService.GetStore(),</pre></code></td></tr><tr><td>96</td><td><code><pre>                MultiClusterIngress:                         informerCollection.MultiClusterIngress.GetStore(),</pre></code></td></tr><tr><td>97</td><td><code><pre>                IstioGateway:                                informerCollection.IstioGateway.GetStore(),</pre></code></td></tr><tr><td>98</td><td><code><pre>                IstioVirtualService:                         informerCollection.IstioVirtualService.GetStore(),</pre></code></td></tr><tr><td>99</td><td><code><pre>        }</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>        context := &amp;Context{</pre></code></td></tr><tr><td>102</td><td><code><pre>                kubeClient:            kubeClient,</pre></code></td></tr><tr><td>103</td><td><code><pre>                crdClient:             crdClient,</pre></code></td></tr><tr><td>104</td><td><code><pre>                multiClusterCrdClient: multiClusterCrdClient,</pre></code></td></tr><tr><td>105</td><td><code><pre>                istioCrdClient:        istioCrdClient,</pre></code></td></tr><tr><td>106</td><td><code><pre></pre></code></td></tr><tr><td>107</td><td><code><pre>                informers:              &amp;informerCollection,</pre></code></td></tr><tr><td>108</td><td><code><pre>                ingressSecretsMap:      utils.NewThreadsafeMultimap(),</pre></code></td></tr><tr><td>109</td><td><code><pre>                Caches:                 &amp;cacheCollection,</pre></code></td></tr><tr><td>110</td><td><code><pre>                CertificateSecretStore: NewSecretStore(),</pre></code></td></tr><tr><td>111</td><td><code><pre>                Work:                   make(chan events.Event, workBuffer),</pre></code></td></tr><tr><td>112</td><td><code><pre>                CacheSynced:            make(chan interface{}),</pre></code></td></tr><tr><td>113</td><td><code><pre></pre></code></td></tr><tr><td>114</td><td><code><pre>                MetricStore: metricStore,</pre></code></td></tr><tr><td>115</td><td><code><pre>                namespaces:  make(map[string]interface{}),</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr><td>117</td><td><code><pre>                ingressClassControllerName:  envVariables.IngressClassControllerName,</pre></code></td></tr><tr><td>118</td><td><code><pre>                ingressClassResourceName:    envVariables.IngressClassResourceName,</pre></code></td></tr><tr><td>119</td><td><code><pre>                ingressClassResourceEnabled: envVariables.IngressClassResourceEnabled,</pre></code></td></tr><tr><td>120</td><td><code><pre>                ingressClassResourceDefault: envVariables.IngressClassResourceDefault,</pre></code></td></tr><tr><td>121</td><td><code><pre>        }</pre></code></td></tr><tr><td>122</td><td><code><pre></pre></code></td></tr><tr><td>123</td><td><code><pre>        for _, ns := range namespaces {</pre></code></td></tr><tr><td>124</td><td><code><pre>                context.namespaces[ns] = nil</pre></code></td></tr><tr><td>125</td><td><code><pre>        }</pre></code></td></tr><tr><td>126</td><td><code><pre></pre></code></td></tr><tr><td>127</td><td><code><pre>        h := handlers{context}</pre></code></td></tr><tr><td>128</td><td><code><pre></pre></code></td></tr><tr><td>129</td><td><code><pre>        resourceHandler := cache.ResourceEventHandlerFuncs{</pre></code></td></tr><tr><td>130</td><td><code><pre>                AddFunc:    h.addFunc,</pre></code></td></tr><tr><td>131</td><td><code><pre>                UpdateFunc: h.updateFunc,</pre></code></td></tr><tr><td>132</td><td><code><pre>                DeleteFunc: h.deleteFunc,</pre></code></td></tr><tr><td>133</td><td><code><pre>        }</pre></code></td></tr><tr><td>134</td><td><code><pre></pre></code></td></tr><tr><td>135</td><td><code><pre>        ingressResourceHandler := cache.ResourceEventHandlerFuncs{</pre></code></td></tr><tr><td>136</td><td><code><pre>                AddFunc:    h.ingressAdd,</pre></code></td></tr><tr><td>137</td><td><code><pre>                UpdateFunc: h.ingressUpdate,</pre></code></td></tr><tr><td>138</td><td><code><pre>                DeleteFunc: h.ingressDelete,</pre></code></td></tr><tr><td>139</td><td><code><pre>        }</pre></code></td></tr><tr><td>140</td><td><code><pre></pre></code></td></tr><tr><td>141</td><td><code><pre>        secretResourceHandler := cache.ResourceEventHandlerFuncs{</pre></code></td></tr><tr><td>142</td><td><code><pre>                AddFunc:    h.secretAdd,</pre></code></td></tr><tr><td>143</td><td><code><pre>                UpdateFunc: h.secretUpdate,</pre></code></td></tr><tr><td>144</td><td><code><pre>                DeleteFunc: h.secretDelete,</pre></code></td></tr><tr><td>145</td><td><code><pre>        }</pre></code></td></tr><tr><td>146</td><td><code><pre></pre></code></td></tr><tr><td>147</td><td><code><pre>        // Register event handlers.</pre></code></td></tr><tr><td>148</td><td><code><pre>        informerCollection.Endpoints.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>149</td><td><code><pre>        informerCollection.Ingress.AddEventHandler(ingressResourceHandler)</pre></code></td></tr><tr><td>150</td><td><code><pre>        informerCollection.Pods.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>151</td><td><code><pre>        informerCollection.Secret.AddEventHandler(secretResourceHandler)</pre></code></td></tr><tr><td>152</td><td><code><pre>        informerCollection.Service.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>153</td><td><code><pre>        informerCollection.AzureIngressProhibitedTarget.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>154</td><td><code><pre>        informerCollection.AzureApplicationGatewayRewrite.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>155</td><td><code><pre>        informerCollection.AzureApplicationGatewayBackendPool.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>156</td><td><code><pre>        informerCollection.AzureApplicationGatewayInstanceUpdateStatus.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>157</td><td><code><pre>        informerCollection.MultiClusterService.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>158</td><td><code><pre>        informerCollection.MultiClusterIngress.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>159</td><td><code><pre></pre></code></td></tr><tr><td>160</td><td><code><pre>        if IsNetworkingV1PackageSupported {</pre></code></td></tr><tr><td>161</td><td><code><pre>                informerCollection.IngressClass = informerFactory.Networking().V1().IngressClasses().Informer()</pre></code></td></tr><tr><td>162</td><td><code><pre>                informerCollection.IngressClass.AddEventHandler(resourceHandler)</pre></code></td></tr><tr><td>163</td><td><code><pre>                cacheCollection.IngressClass = informerCollection.IngressClass.GetStore()</pre></code></td></tr><tr><td>164</td><td><code><pre>        }</pre></code></td></tr><tr><td>165</td><td><code><pre></pre></code></td></tr><tr><td>166</td><td><code><pre>        return context</pre></code></td></tr><tr><td>167</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.listServicesByPodSelector">func Context.listServicesByPodSelector</div><div class="info"><a href="#s_fn_Context.listServicesByPodSelector">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>874</td><td><code><pre>func (c *Context) listServicesByPodSelector(pod *v1.Pod) []*v1.Service {</pre></code></td></tr><tr><td>875</td><td><code><pre>        labelSet := mapset.NewSet()</pre></code></td></tr><tr><td>876</td><td><code><pre>        for k, v := range pod.Labels {</pre></code></td></tr><tr><td>877</td><td><code><pre>                labelSet.Add(k + &#34;:&#34; + v)</pre></code></td></tr><tr><td>878</td><td><code><pre>        }</pre></code></td></tr><tr><td>879</td><td><code><pre></pre></code></td></tr><tr><td>880</td><td><code><pre>        var serviceList []*v1.Service</pre></code></td></tr><tr><td>881</td><td><code><pre>        for _, service := range c.ListServices() {</pre></code></td></tr><tr><td>882</td><td><code><pre>                serviceLabelSet := mapset.NewSet()</pre></code></td></tr><tr><td>883</td><td><code><pre>                for k, v := range service.Spec.Selector {</pre></code></td></tr><tr><td>884</td><td><code><pre>                        serviceLabelSet.Add(k + &#34;:&#34; + v)</pre></code></td></tr><tr><td>885</td><td><code><pre>                }</pre></code></td></tr><tr><td>886</td><td><code><pre></pre></code></td></tr><tr><td>887</td><td><code><pre>                if serviceLabelSet.IsSubset(labelSet) {</pre></code></td></tr><tr><td>888</td><td><code><pre>                        serviceList = append(serviceList, service)</pre></code></td></tr><tr><td>889</td><td><code><pre>                }</pre></code></td></tr><tr><td>890</td><td><code><pre>        }</pre></code></td></tr><tr><td>891</td><td><code><pre></pre></code></td></tr><tr><td>892</td><td><code><pre>        return serviceList</pre></code></td></tr><tr><td>893</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.IsIngressClass">func Context.IsIngressClass</div><div class="info"><a href="#s_fn_Context.IsIngressClass">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>932</td><td><code><pre>func (c *Context) IsIngressClass(ing *networking.Ingress) bool {</pre></code></td></tr><tr><td>933</td><td><code><pre></pre></code></td></tr><tr><td>934</td><td><code><pre>        // match by annotation (for Backward compatibility)</pre></code></td></tr><tr><td>935</td><td><code><pre>        if className, err := annotations.IngressClass(ing); err == nil &amp;&amp; className != &#34;&#34; {</pre></code></td></tr><tr><td>936</td><td><code><pre>                return className == c.ingressClassControllerName</pre></code></td></tr><tr><td>937</td><td><code><pre>        }</pre></code></td></tr><tr><td>938</td><td><code><pre></pre></code></td></tr><tr><td>939</td><td><code><pre>        // match by ingress class resource</pre></code></td></tr><tr><td>940</td><td><code><pre>        if c.ingressClassResourceEnabled {</pre></code></td></tr><tr><td>941</td><td><code><pre>                // if IngressClassName in ingress that compare it with the controller type</pre></code></td></tr><tr><td>942</td><td><code><pre>                if ing.Spec.IngressClassName != nil {</pre></code></td></tr><tr><td>943</td><td><code><pre>                        ingressClass := c.getIngressClassResource(*ing.Spec.IngressClassName)</pre></code></td></tr><tr><td>944</td><td><code><pre>                        return ingressClass != nil &amp;&amp; ingressClass.Spec.Controller == c.ingressClassControllerName &amp;&amp;</pre></code></td></tr><tr><td>945</td><td><code><pre>                                c.ingressClassResourceName == *ing.Spec.IngressClassName</pre></code></td></tr><tr><td>946</td><td><code><pre>                }</pre></code></td></tr><tr><td>947</td><td><code><pre></pre></code></td></tr><tr><td>948</td><td><code><pre>                // if IngressClassName is nil, then match if AGIC is default ingress</pre></code></td></tr><tr><td>949</td><td><code><pre>                return c.ingressClassResourceDefault</pre></code></td></tr><tr><td>950</td><td><code><pre>        }</pre></code></td></tr><tr><td>951</td><td><code><pre></pre></code></td></tr><tr><td>952</td><td><code><pre>        return false</pre></code></td></tr><tr><td>953</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.IsPodReferencedByAnyIngress">func Context.IsPodReferencedByAnyIngress</div><div class="info"><a href="#s_fn_Context.IsPodReferencedByAnyIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>490</td><td><code><pre>func (c *Context) IsPodReferencedByAnyIngress(pod *v1.Pod) bool {</pre></code></td></tr><tr><td>491</td><td><code><pre>        // first find all the services</pre></code></td></tr><tr><td>492</td><td><code><pre>        services := c.listServicesByPodSelector(pod)</pre></code></td></tr><tr><td>493</td><td><code><pre>        for _, service := range services {</pre></code></td></tr><tr><td>494</td><td><code><pre>                if c.isServiceReferencedByAnyIngress(service) {</pre></code></td></tr><tr><td>495</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>496</td><td><code><pre>                }</pre></code></td></tr><tr><td>497</td><td><code><pre>        }</pre></code></td></tr><tr><td>498</td><td><code><pre></pre></code></td></tr><tr><td>499</td><td><code><pre>        return false</pre></code></td></tr><tr><td>500</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.IsIstioGatewayIngress">func Context.IsIstioGatewayIngress</div><div class="info"><a href="#s_fn_Context.IsIstioGatewayIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>956</td><td><code><pre>func (c *Context) IsIstioGatewayIngress(gateway *v1alpha3.Gateway) bool {</pre></code></td></tr><tr><td>957</td><td><code><pre>        className, err := annotations.IstioGatewayIngressClass(gateway)</pre></code></td></tr><tr><td>958</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>959</td><td><code><pre>                return false</pre></code></td></tr><tr><td>960</td><td><code><pre>        }</pre></code></td></tr><tr><td>961</td><td><code><pre></pre></code></td></tr><tr><td>962</td><td><code><pre>        return className == c.ingressClassControllerName</pre></code></td></tr><tr><td>963</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_SecretsStore.delete">func SecretsStore.delete</div><div class="info"><a href="#s_fn_SecretsStore.delete">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code>:</p></div><table class="listing">
<tr><td>57</td><td><code><pre>func (s *SecretsStore) delete(secretKey string) {</pre></code></td></tr><tr><td>58</td><td><code><pre>        s.conversionSync.Lock()</pre></code></td></tr><tr><td>59</td><td><code><pre>        defer s.conversionSync.Unlock()</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>        s.Cache.Delete(secretKey)</pre></code></td></tr><tr><td>62</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_init">func init</div><div class="info"><a href="#s_fn_init">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/supported_apiversion.go</code>:</p></div><table class="listing">
<tr><td>38</td><td><code><pre>func init() {</pre></code></td></tr><tr><td>39</td><td><code><pre>        extensionsv1beta1.AddToScheme(runtimeScheme)</pre></code></td></tr><tr><td>40</td><td><code><pre>        networkingv1.AddToScheme(runtimeScheme)</pre></code></td></tr><tr><td>41</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.IsEndpointReferencedByAnyIngress">func Context.IsEndpointReferencedByAnyIngress</div><div class="info"><a href="#s_fn_Context.IsEndpointReferencedByAnyIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>503</td><td><code><pre>func (c *Context) IsEndpointReferencedByAnyIngress(endpoints *v1.Endpoints) bool {</pre></code></td></tr><tr><td>504</td><td><code><pre>        service := c.GetService(fmt.Sprintf(&#34;%v/%v&#34;, endpoints.Namespace, endpoints.Name))</pre></code></td></tr><tr><td>505</td><td><code><pre>        return service != nil &amp;&amp; c.isServiceReferencedByAnyIngress(service)</pre></code></td></tr><tr><td>506</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_getNamespace">func getNamespace</div><div class="info"><a href="#s_fn_getNamespace">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code>:</p></div><table class="listing">
<tr><td>65</td><td><code><pre>func getNamespace(obj interface{}) string {</pre></code></td></tr><tr><td>66</td><td><code><pre>        return reflect.ValueOf(obj).Elem().FieldByName(&#34;ObjectMeta&#34;).FieldByName(&#34;Namespace&#34;).String()</pre></code></td></tr><tr><td>67</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewSecretStore">func NewSecretStore</div><div class="info"><a href="#s_fn_NewSecretStore">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code>:</p></div><table class="listing">
<tr><td>41</td><td><code><pre>func NewSecretStore() SecretsKeeper {</pre></code></td></tr><tr><td>42</td><td><code><pre>        return &amp;SecretsStore{</pre></code></td></tr><tr><td>43</td><td><code><pre>                Cache: cache.NewThreadSafeStore(cache.Indexers{}, cache.Indices{}),</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.ingressAdd">func handlers.ingressAdd</div><div class="info"><a href="#s_fn_handlers.ingressAdd">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/ingress_handlers.go</code>:</p></div><table class="listing">
<tr><td>17</td><td><code><pre>func (h handlers) ingressAdd(obj interface{}) {</pre></code></td></tr><tr><td>18</td><td><code><pre>        ing, _ := convert.ToIngressV1(obj)</pre></code></td></tr><tr><td>19</td><td><code><pre>        if _, exists := namespacesToIgnore[ing.Namespace]; exists {</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>                return</pre></code></td></tr><tr><td>21</td><td><code><pre>        }</pre></code></td></tr><tr><td>22</td><td><code><pre>        if _, exists := h.context.namespaces[ing.Namespace]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>23</td><td><code><pre>                return</pre></code></td></tr><tr><td>24</td><td><code><pre>        }</pre></code></td></tr><tr><td>25</td><td><code><pre></pre></code></td></tr><tr><td>26</td><td><code><pre>        if !h.context.IsIngressClass(ing) {</pre></code></td></tr><tr><td>27</td><td><code><pre>                return</pre></code></td></tr><tr><td>28</td><td><code><pre>        }</pre></code></td></tr><tr><td>29</td><td><code><pre></pre></code></td></tr><tr><td>30</td><td><code><pre>        if ing.Spec.TLS != nil &amp;&amp; len(ing.Spec.TLS) &gt; 0 {</pre></code></td></tr><tr><td>31</td><td><code><pre>                ingKey := utils.GetResourceKey(ing.Namespace, ing.Name)</pre></code></td></tr><tr><td>32</td><td><code><pre>                for _, tls := range ing.Spec.TLS {</pre></code></td></tr><tr><td>33</td><td><code><pre>                        secKey := utils.GetResourceKey(ing.Namespace, tls.SecretName)</pre></code></td></tr><tr><td>34</td><td><code><pre></pre></code></td></tr><tr><td>35</td><td><code><pre>                        if h.context.ingressSecretsMap.ContainsPair(ingKey, secKey) {</pre></code></td></tr><tr><td>36</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>37</td><td><code><pre>                        }</pre></code></td></tr><tr><td>38</td><td><code><pre></pre></code></td></tr><tr><td>39</td><td><code><pre>                        if secret, exists, err := h.context.Caches.Secret.GetByKey(secKey); exists &amp;&amp; err == nil {</pre></code></td></tr><tr><td>40</td><td><code><pre>                                if !h.context.ingressSecretsMap.ContainsValue(secKey) {</pre></code></td></tr><tr><td>41</td><td><code><pre>                                        if err := h.context.CertificateSecretStore.ConvertSecret(secKey, secret.(*v1.Secret)); err != nil {</pre></code></td></tr><tr><td>42</td><td><code><pre>                                                klog.Error(err.Error())</pre></code></td></tr><tr><td>43</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>44</td><td><code><pre>                                }</pre></code></td></tr><tr><td>45</td><td><code><pre>                        }</pre></code></td></tr><tr><td>46</td><td><code><pre></pre></code></td></tr><tr><td>47</td><td><code><pre>                        h.context.ingressSecretsMap.Insert(ingKey, secKey)</pre></code></td></tr><tr><td>48</td><td><code><pre>                }</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre>        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>51</td><td><code><pre>                Type:  events.Create,</pre></code></td></tr><tr><td>52</td><td><code><pre>                Value: obj,</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr><td>54</td><td><code><pre>        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.ListPodsByServiceSelector">func Context.ListPodsByServiceSelector</div><div class="info"><a href="#s_fn_Context.ListPodsByServiceSelector">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>464</td><td><code><pre>func (c *Context) ListPodsByServiceSelector(service *v1.Service) []*v1.Pod {</pre></code></td></tr><tr><td>465</td><td><code><pre>        selectorSet := mapset.NewSet()</pre></code></td></tr><tr><td>466</td><td><code><pre>        for k, v := range service.Spec.Selector {</pre></code></td></tr><tr><td>467</td><td><code><pre>                selectorSet.Add(k + &#34;:&#34; + v)</pre></code></td></tr><tr><td>468</td><td><code><pre>        }</pre></code></td></tr><tr><td>469</td><td><code><pre></pre></code></td></tr><tr><td>470</td><td><code><pre>        var podList []*v1.Pod</pre></code></td></tr><tr><td>471</td><td><code><pre>        for _, podInterface := range c.Caches.Pods.List() {</pre></code></td></tr><tr><td>472</td><td><code><pre>                pod := podInterface.(*v1.Pod)</pre></code></td></tr><tr><td>473</td><td><code><pre>                if _, exists := c.namespaces[pod.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>474</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>475</td><td><code><pre>                }</pre></code></td></tr><tr><td>476</td><td><code><pre>                podLabelSet := mapset.NewSet()</pre></code></td></tr><tr><td>477</td><td><code><pre>                for k, v := range pod.Labels {</pre></code></td></tr><tr><td>478</td><td><code><pre>                        podLabelSet.Add(k + &#34;:&#34; + v)</pre></code></td></tr><tr><td>479</td><td><code><pre>                }</pre></code></td></tr><tr><td>480</td><td><code><pre></pre></code></td></tr><tr><td>481</td><td><code><pre>                if selectorSet.IsSubset(podLabelSet) &amp;&amp; pod.Namespace == service.Namespace {</pre></code></td></tr><tr><td>482</td><td><code><pre>                        podList = append(podList, pod)</pre></code></td></tr><tr><td>483</td><td><code><pre>                }</pre></code></td></tr><tr><td>484</td><td><code><pre>        }</pre></code></td></tr><tr><td>485</td><td><code><pre></pre></code></td></tr><tr><td>486</td><td><code><pre>        return podList</pre></code></td></tr><tr><td>487</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.filterAndSort">func Context.filterAndSort</div><div class="info"><a href="#s_fn_Context.filterAndSort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>537</td><td><code><pre>func (c *Context) filterAndSort(ingList []*networking.Ingress) []*networking.Ingress {</pre></code></td></tr><tr><td>538</td><td><code><pre>        var ingressList []*networking.Ingress</pre></code></td></tr><tr><td>539</td><td><code><pre>        for _, ingress := range ingList {</pre></code></td></tr><tr><td>540</td><td><code><pre>                if !c.IsIngressClass(ingress) {</pre></code></td></tr><tr><td>541</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>542</td><td><code><pre>                }</pre></code></td></tr><tr><td>543</td><td><code><pre>                if len(ingress.Spec.Rules) &gt; 0 &amp;&amp; !hasHTTPRule(ingress) {</pre></code></td></tr><tr class="miss"><td>544</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>545</td><td><code><pre>                }</pre></code></td></tr><tr><td>546</td><td><code><pre>                ingressList = append(ingressList, ingress)</pre></code></td></tr><tr><td>547</td><td><code><pre>        }</pre></code></td></tr><tr><td>548</td><td><code><pre>        // Sorting the return list ensures that the iterations over this list and</pre></code></td></tr><tr><td>549</td><td><code><pre>        // subsequently created structs have deterministic order. This increases</pre></code></td></tr><tr><td>550</td><td><code><pre>        // cache hits, and lowers the load on ARM.</pre></code></td></tr><tr><td>551</td><td><code><pre>        sort.Sort(sorter.ByIngressName(ingressList))</pre></code></td></tr><tr><td>552</td><td><code><pre>        return ingressList</pre></code></td></tr><tr><td>553</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.deleteFunc">func handlers.deleteFunc</div><div class="info"><a href="#s_fn_handlers.deleteFunc">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code>:</p></div><table class="listing">
<tr><td>49</td><td><code><pre>func (h handlers) deleteFunc(obj interface{}) {</pre></code></td></tr><tr><td>50</td><td><code><pre>        ns := getNamespace(obj)</pre></code></td></tr><tr><td>51</td><td><code><pre>        if _, exists := namespacesToIgnore[ns]; exists {</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                return</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr><td>54</td><td><code><pre>        if _, exists := h.context.namespaces[ns]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>55</td><td><code><pre>                return</pre></code></td></tr><tr><td>56</td><td><code><pre>        }</pre></code></td></tr><tr><td>57</td><td><code><pre></pre></code></td></tr><tr><td>58</td><td><code><pre>        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>59</td><td><code><pre>                Type:  events.Delete,</pre></code></td></tr><tr><td>60</td><td><code><pre>                Value: obj,</pre></code></td></tr><tr><td>61</td><td><code><pre>        }</pre></code></td></tr><tr><td>62</td><td><code><pre>        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>63</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.addFunc">func handlers.addFunc</div><div class="info"><a href="#s_fn_handlers.addFunc">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code>:</p></div><table class="listing">
<tr><td>14</td><td><code><pre>func (h handlers) addFunc(obj interface{}) {</pre></code></td></tr><tr><td>15</td><td><code><pre>        ns := getNamespace(obj)</pre></code></td></tr><tr><td>16</td><td><code><pre>        if _, exists := namespacesToIgnore[ns]; exists {</pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>                return</pre></code></td></tr><tr><td>18</td><td><code><pre>        }</pre></code></td></tr><tr><td>19</td><td><code><pre>        if _, exists := h.context.namespaces[ns]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>20</td><td><code><pre>                return</pre></code></td></tr><tr><td>21</td><td><code><pre>        }</pre></code></td></tr><tr><td>22</td><td><code><pre></pre></code></td></tr><tr><td>23</td><td><code><pre>        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>24</td><td><code><pre>                Type:  events.Create,</pre></code></td></tr><tr><td>25</td><td><code><pre>                Value: obj,</pre></code></td></tr><tr><td>26</td><td><code><pre>        }</pre></code></td></tr><tr><td>27</td><td><code><pre>        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>28</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_SecretsStore.ConvertSecret">func SecretsStore.ConvertSecret</div><div class="info"><a href="#s_fn_SecretsStore.ConvertSecret">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code>:</p></div><table class="listing">
<tr><td>65</td><td><code><pre>func (s *SecretsStore) ConvertSecret(secretKey string, secret *v1.Secret) error {</pre></code></td></tr><tr><td>66</td><td><code><pre>        s.conversionSync.Lock()</pre></code></td></tr><tr><td>67</td><td><code><pre>        defer s.conversionSync.Unlock()</pre></code></td></tr><tr><td>68</td><td><code><pre></pre></code></td></tr><tr><td>69</td><td><code><pre>        // check if this is a secret with the correct type</pre></code></td></tr><tr><td>70</td><td><code><pre>        if secret.Type != recognizedSecretType {</pre></code></td></tr><tr><td>71</td><td><code><pre>                return controllererrors.NewErrorf(</pre></code></td></tr><tr><td>72</td><td><code><pre>                        controllererrors.ErrorUnknownSecretType,</pre></code></td></tr><tr><td>73</td><td><code><pre>                        &#34;secret [%v] is not type kubernetes.io/tls&#34;, secretKey,</pre></code></td></tr><tr><td>74</td><td><code><pre>                )</pre></code></td></tr><tr><td>75</td><td><code><pre>        }</pre></code></td></tr><tr><td>76</td><td><code><pre></pre></code></td></tr><tr><td>77</td><td><code><pre>        if len(secret.Data[tlsKey]) == 0 || len(secret.Data[tlsCrt]) == 0 {</pre></code></td></tr><tr><td>78</td><td><code><pre>                return controllererrors.NewErrorf(</pre></code></td></tr><tr><td>79</td><td><code><pre>                        controllererrors.ErrorMalformedSecret,</pre></code></td></tr><tr><td>80</td><td><code><pre>                        &#34;secret [%v] is malformed, tls.key or tls.crt is not defined&#34;, secretKey,</pre></code></td></tr><tr><td>81</td><td><code><pre>                )</pre></code></td></tr><tr><td>82</td><td><code><pre>        }</pre></code></td></tr><tr><td>83</td><td><code><pre></pre></code></td></tr><tr><td>84</td><td><code><pre>        tempfileCert, err := ioutil.TempFile(&#34;&#34;, &#34;appgw-ingress-cert&#34;)</pre></code></td></tr><tr><td>85</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                return controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>87</td><td><code><pre>                        controllererrors.ErrorCreatingFile,</pre></code></td></tr><tr><td>88</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>89</td><td><code><pre>                        &#34;unable to create temporary file for certificate conversion&#34;,</pre></code></td></tr><tr><td>90</td><td><code><pre>                )</pre></code></td></tr><tr><td>91</td><td><code><pre>        }</pre></code></td></tr><tr><td>92</td><td><code><pre>        defer os.Remove(tempfileCert.Name())</pre></code></td></tr><tr><td>93</td><td><code><pre></pre></code></td></tr><tr><td>94</td><td><code><pre>        tempfileKey, err := ioutil.TempFile(&#34;&#34;, &#34;appgw-ingress-key&#34;)</pre></code></td></tr><tr><td>95</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>96</td><td><code><pre>                return controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>97</td><td><code><pre>                        controllererrors.ErrorCreatingFile,</pre></code></td></tr><tr><td>98</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>99</td><td><code><pre>                        &#34;unable to create temporary file for certificate conversion&#34;,</pre></code></td></tr><tr><td>100</td><td><code><pre>                )</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr><td>102</td><td><code><pre>        defer os.Remove(tempfileKey.Name())</pre></code></td></tr><tr><td>103</td><td><code><pre></pre></code></td></tr><tr><td>104</td><td><code><pre>        if err := writeFileDecode(secret.Data[&#34;tls.crt&#34;], tempfileCert); err != nil {</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>                return controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>106</td><td><code><pre>                        controllererrors.ErrorWritingToFile,</pre></code></td></tr><tr><td>107</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>108</td><td><code><pre>                        &#34;unable to write secret [%v].tls.crt to temporary file&#34;, secretKey,</pre></code></td></tr><tr><td>109</td><td><code><pre>                )</pre></code></td></tr><tr><td>110</td><td><code><pre>        }</pre></code></td></tr><tr><td>111</td><td><code><pre></pre></code></td></tr><tr><td>112</td><td><code><pre>        if err := writeFileDecode(secret.Data[&#34;tls.key&#34;], tempfileKey); err != nil {</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>                return controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>114</td><td><code><pre>                        controllererrors.ErrorWritingToFile,</pre></code></td></tr><tr><td>115</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>116</td><td><code><pre>                        &#34;unable to write secret [%v].tls.key to temporary file&#34;, secretKey,</pre></code></td></tr><tr><td>117</td><td><code><pre>                )</pre></code></td></tr><tr><td>118</td><td><code><pre>        }</pre></code></td></tr><tr><td>119</td><td><code><pre></pre></code></td></tr><tr><td>120</td><td><code><pre>        // both cert and key are in temp file now, call openssl</pre></code></td></tr><tr><td>121</td><td><code><pre>        var cout, cerr bytes.Buffer</pre></code></td></tr><tr><td>122</td><td><code><pre>        cmd := exec.Command(&#34;openssl&#34;, &#34;pkcs12&#34;, &#34;-export&#34;, &#34;-in&#34;, tempfileCert.Name(), &#34;-inkey&#34;, tempfileKey.Name(), &#34;-password&#34;, &#34;pass:msazure&#34;)</pre></code></td></tr><tr><td>123</td><td><code><pre>        cmd.Stderr = &amp;cerr</pre></code></td></tr><tr><td>124</td><td><code><pre>        cmd.Stdout = &amp;cout</pre></code></td></tr><tr><td>125</td><td><code><pre></pre></code></td></tr><tr><td>126</td><td><code><pre>        // if openssl exited with an error or the output is empty, report error</pre></code></td></tr><tr><td>127</td><td><code><pre>        if err := cmd.Run(); err != nil || len(cout.Bytes()) == 0 {</pre></code></td></tr><tr><td>128</td><td><code><pre>                return controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>129</td><td><code><pre>                        controllererrors.ErrorExportingWithOpenSSL,</pre></code></td></tr><tr><td>130</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>131</td><td><code><pre>                        &#34;unable to export using openssl, error=[%v], stderr=[%v]&#34;, err, cerr.String(),</pre></code></td></tr><tr><td>132</td><td><code><pre>                )</pre></code></td></tr><tr><td>133</td><td><code><pre>        }</pre></code></td></tr><tr><td>134</td><td><code><pre></pre></code></td></tr><tr><td>135</td><td><code><pre>        pfxCert := cout.Bytes()</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr><td>137</td><td><code><pre>        // TODO i&#39;m not sure if comparison against existing certificate can help</pre></code></td></tr><tr><td>138</td><td><code><pre>        // us optimize by eliminating some events</pre></code></td></tr><tr><td>139</td><td><code><pre>        _, exists := s.Cache.Get(secretKey)</pre></code></td></tr><tr><td>140</td><td><code><pre>        if exists {</pre></code></td></tr><tr class="miss"><td>141</td><td><code><pre>                s.Cache.Update(secretKey, pfxCert)</pre></code></td></tr><tr><td>142</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>143</td><td><code><pre>                s.Cache.Add(secretKey, pfxCert)</pre></code></td></tr><tr><td>144</td><td><code><pre>        }</pre></code></td></tr><tr><td>145</td><td><code><pre></pre></code></td></tr><tr><td>146</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>147</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.secretAdd">func handlers.secretAdd</div><div class="info"><a href="#s_fn_handlers.secretAdd">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secrets_handlers.go</code>:</p></div><table class="listing">
<tr><td>20</td><td><code><pre>func (h handlers) secretAdd(obj interface{}) {</pre></code></td></tr><tr><td>21</td><td><code><pre>        sec := obj.(*v1.Secret)</pre></code></td></tr><tr><td>22</td><td><code><pre>        if _, exists := namespacesToIgnore[sec.Namespace]; exists {</pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>                return</pre></code></td></tr><tr><td>24</td><td><code><pre>        }</pre></code></td></tr><tr><td>25</td><td><code><pre>        if _, exists := h.context.namespaces[sec.Namespace]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>26</td><td><code><pre>                return</pre></code></td></tr><tr><td>27</td><td><code><pre>        }</pre></code></td></tr><tr><td>28</td><td><code><pre></pre></code></td></tr><tr><td>29</td><td><code><pre>        secKey := utils.GetResourceKey(sec.Namespace, sec.Name)</pre></code></td></tr><tr><td>30</td><td><code><pre>        if h.context.ingressSecretsMap.ContainsValue(secKey) {</pre></code></td></tr><tr><td>31</td><td><code><pre>                // find if this secKey exists in the map[string]UnorderedSets</pre></code></td></tr><tr><td>32</td><td><code><pre>                if err := h.context.CertificateSecretStore.ConvertSecret(secKey, sec); err == nil {</pre></code></td></tr><tr><td>33</td><td><code><pre>                        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>34</td><td><code><pre>                                Type:  events.Create,</pre></code></td></tr><tr><td>35</td><td><code><pre>                                Value: obj,</pre></code></td></tr><tr><td>36</td><td><code><pre>                        }</pre></code></td></tr><tr><td>37</td><td><code><pre>                        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>38</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>39</td><td><code><pre>                        klog.Error(err.Error())</pre></code></td></tr><tr><td>40</td><td><code><pre>                }</pre></code></td></tr><tr><td>41</td><td><code><pre>        }</pre></code></td></tr><tr><td>42</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.isServiceReferencedByAnyIngress">func Context.isServiceReferencedByAnyIngress</div><div class="info"><a href="#s_fn_Context.isServiceReferencedByAnyIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>895</td><td><code><pre>func (c *Context) isServiceReferencedByAnyIngress(service *v1.Service) bool {</pre></code></td></tr><tr><td>896</td><td><code><pre>        for _, ingress := range c.ListHTTPIngresses() {</pre></code></td></tr><tr><td>897</td><td><code><pre>                for _, rule := range ingress.Spec.Rules {</pre></code></td></tr><tr><td>898</td><td><code><pre>                        if rule.HTTP == nil {</pre></code></td></tr><tr class="miss"><td>899</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>900</td><td><code><pre>                        }</pre></code></td></tr><tr><td>901</td><td><code><pre>                        for _, path := range rule.HTTP.Paths {</pre></code></td></tr><tr><td>902</td><td><code><pre>                                // TODO(akshaysngupta) Use service ports</pre></code></td></tr><tr><td>903</td><td><code><pre>                                if path.Backend.Service.Name == service.Name {</pre></code></td></tr><tr><td>904</td><td><code><pre>                                        return true</pre></code></td></tr><tr><td>905</td><td><code><pre>                                }</pre></code></td></tr><tr><td>906</td><td><code><pre>                        }</pre></code></td></tr><tr><td>907</td><td><code><pre>                }</pre></code></td></tr><tr><td>908</td><td><code><pre>        }</pre></code></td></tr><tr><td>909</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>910</td><td><code><pre>        return false</pre></code></td></tr><tr><td>911</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_SecretsStore.GetPfxCertificate">func SecretsStore.GetPfxCertificate</div><div class="info"><a href="#s_fn_SecretsStore.GetPfxCertificate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code>:</p></div><table class="listing">
<tr><td>48</td><td><code><pre>func (s *SecretsStore) GetPfxCertificate(secretKey string) []byte {</pre></code></td></tr><tr><td>49</td><td><code><pre>        if certInterface, exists := s.Cache.Get(secretKey); exists {</pre></code></td></tr><tr><td>50</td><td><code><pre>                if cert, ok := certInterface.([]byte); ok {</pre></code></td></tr><tr><td>51</td><td><code><pre>                        return cert</pre></code></td></tr><tr><td>52</td><td><code><pre>                }</pre></code></td></tr><tr><td>53</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>55</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_hasTCPPort">func hasTCPPort</div><div class="info"><a href="#s_fn_hasTCPPort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>865</td><td><code><pre>func hasTCPPort(service *v1.Service) bool {</pre></code></td></tr><tr><td>866</td><td><code><pre>        for _, port := range service.Spec.Ports {</pre></code></td></tr><tr><td>867</td><td><code><pre>                if port.Protocol == v1.ProtocolTCP {</pre></code></td></tr><tr><td>868</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>869</td><td><code><pre>                }</pre></code></td></tr><tr><td>870</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>871</td><td><code><pre>        return false</pre></code></td></tr><tr><td>872</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_hasHTTPRule">func hasHTTPRule</div><div class="info"><a href="#s_fn_hasHTTPRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>856</td><td><code><pre>func hasHTTPRule(ingress *networking.Ingress) bool {</pre></code></td></tr><tr><td>857</td><td><code><pre>        for _, rule := range ingress.Spec.Rules {</pre></code></td></tr><tr><td>858</td><td><code><pre>                if rule.HTTP != nil {</pre></code></td></tr><tr><td>859</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>860</td><td><code><pre>                }</pre></code></td></tr><tr><td>861</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>862</td><td><code><pre>        return false</pre></code></td></tr><tr><td>863</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.updateV1IngressStatus">func Context.updateV1IngressStatus</div><div class="info"><a href="#s_fn_Context.updateV1IngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>732</td><td><code><pre>func (c *Context) updateV1IngressStatus(ingressToUpdate networking.Ingress, newIP IPAddress) error {</pre></code></td></tr><tr><td>733</td><td><code><pre>        ingressClient := c.kubeClient.NetworkingV1().Ingresses(ingressToUpdate.Namespace)</pre></code></td></tr><tr><td>734</td><td><code><pre>        ingress, err := ingressClient.Get(context.TODO(), ingressToUpdate.Name, metav1.GetOptions{})</pre></code></td></tr><tr><td>735</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>736</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>737</td><td><code><pre>                        controllererrors.ErrorUpdatingIngressStatus,</pre></code></td></tr><tr><td>738</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>739</td><td><code><pre>                        &#34;Unable to get ingress %s/%s&#34;, ingressToUpdate.Namespace, ingressToUpdate.Name,</pre></code></td></tr><tr><td>740</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>741</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>742</td><td><code><pre>                return e</pre></code></td></tr><tr><td>743</td><td><code><pre>        }</pre></code></td></tr><tr><td>744</td><td><code><pre></pre></code></td></tr><tr><td>745</td><td><code><pre>        for _, lbi := range ingress.Status.LoadBalancer.Ingress {</pre></code></td></tr><tr><td>746</td><td><code><pre>                existingIP := lbi.IP</pre></code></td></tr><tr><td>747</td><td><code><pre>                if existingIP == string(newIP) {</pre></code></td></tr><tr><td>748</td><td><code><pre>                        klog.Infof(&#34;IP %s already set on Ingress %s/%s&#34;, lbi.IP, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr><td>749</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>750</td><td><code><pre>                }</pre></code></td></tr><tr><td>751</td><td><code><pre>        }</pre></code></td></tr><tr><td>752</td><td><code><pre></pre></code></td></tr><tr><td>753</td><td><code><pre>        loadBalancerIngresses := []v1.LoadBalancerIngress{}</pre></code></td></tr><tr><td>754</td><td><code><pre>        if newIP != &#34;&#34; {</pre></code></td></tr><tr><td>755</td><td><code><pre>                loadBalancerIngresses = append(loadBalancerIngresses, v1.LoadBalancerIngress{</pre></code></td></tr><tr><td>756</td><td><code><pre>                        IP: string(newIP),</pre></code></td></tr><tr><td>757</td><td><code><pre>                })</pre></code></td></tr><tr><td>758</td><td><code><pre>        }</pre></code></td></tr><tr><td>759</td><td><code><pre>        ingress.Status.LoadBalancer.Ingress = loadBalancerIngresses</pre></code></td></tr><tr><td>760</td><td><code><pre></pre></code></td></tr><tr><td>761</td><td><code><pre>        if _, err := ingressClient.UpdateStatus(context.TODO(), ingress, metav1.UpdateOptions{}); err != nil {</pre></code></td></tr><tr class="miss"><td>762</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>763</td><td><code><pre>                        controllererrors.ErrorUpdatingIngressStatus,</pre></code></td></tr><tr><td>764</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>765</td><td><code><pre>                        &#34;Unable to update ingress %s/%s status&#34;, ingress.Namespace, ingress.Name,</pre></code></td></tr><tr><td>766</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>767</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>768</td><td><code><pre>                return e</pre></code></td></tr><tr><td>769</td><td><code><pre>        }</pre></code></td></tr><tr><td>770</td><td><code><pre></pre></code></td></tr><tr><td>771</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>772</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.updateFunc">func handlers.updateFunc</div><div class="info"><a href="#s_fn_handlers.updateFunc">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/handlers.go</code>:</p></div><table class="listing">
<tr><td>30</td><td><code><pre>func (h handlers) updateFunc(oldObj, newObj interface{}) {</pre></code></td></tr><tr><td>31</td><td><code><pre>        ns := getNamespace(newObj)</pre></code></td></tr><tr><td>32</td><td><code><pre>        if _, exists := namespacesToIgnore[ns]; exists {</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>                return</pre></code></td></tr><tr><td>34</td><td><code><pre>        }</pre></code></td></tr><tr><td>35</td><td><code><pre>        if _, exists := h.context.namespaces[ns]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>36</td><td><code><pre>                return</pre></code></td></tr><tr><td>37</td><td><code><pre>        }</pre></code></td></tr><tr><td>38</td><td><code><pre></pre></code></td></tr><tr><td>39</td><td><code><pre>        if reflect.DeepEqual(oldObj, newObj) {</pre></code></td></tr><tr><td>40</td><td><code><pre>                return</pre></code></td></tr><tr><td>41</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>43</td><td><code><pre>                Type:  events.Update,</pre></code></td></tr><tr><td>44</td><td><code><pre>                Value: newObj,</pre></code></td></tr><tr><td>45</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>47</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.Run">func Context.Run</div><div class="info"><a href="#s_fn_Context.Run">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>170</td><td><code><pre>func (c *Context) Run(stopChannel chan struct{}, omitCRDs bool, envVariables environment.EnvVariables) error {</pre></code></td></tr><tr><td>171</td><td><code><pre>        klog.V(1).Infoln(&#34;k8s context run started&#34;)</pre></code></td></tr><tr><td>172</td><td><code><pre>        var hasSynced []cache.InformerSynced</pre></code></td></tr><tr><td>173</td><td><code><pre></pre></code></td></tr><tr><td>174</td><td><code><pre>        if c.informers == nil {</pre></code></td></tr><tr class="miss"><td>175</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>176</td><td><code><pre>                        controllererrors.ErrorInformersNotInitialized,</pre></code></td></tr><tr><td>177</td><td><code><pre>                        &#34;informers are not initialized&#34;,</pre></code></td></tr><tr><td>178</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>179</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>180</td><td><code><pre>                return e</pre></code></td></tr><tr><td>181</td><td><code><pre>        }</pre></code></td></tr><tr><td>182</td><td><code><pre>        crds := map[cache.SharedInformer]interface{}{</pre></code></td></tr><tr><td>183</td><td><code><pre>                c.informers.AzureIngressProhibitedTarget: nil,</pre></code></td></tr><tr><td>184</td><td><code><pre>                c.informers.IstioGateway:                 nil,</pre></code></td></tr><tr><td>185</td><td><code><pre>                c.informers.IstioVirtualService:          nil,</pre></code></td></tr><tr><td>186</td><td><code><pre>                c.informers.MultiClusterService:          nil,</pre></code></td></tr><tr><td>187</td><td><code><pre>                c.informers.MultiClusterIngress:          nil,</pre></code></td></tr><tr><td>188</td><td><code><pre></pre></code></td></tr><tr><td>189</td><td><code><pre>                c.informers.AzureApplicationGatewayRewrite: nil,</pre></code></td></tr><tr><td>190</td><td><code><pre>                // c.informers.AzureApplicationGatewayBackendPool:          nil,</pre></code></td></tr><tr><td>191</td><td><code><pre>                // c.informers.AzureApplicationGatewayInstanceUpdateStatus: nil,</pre></code></td></tr><tr><td>192</td><td><code><pre>        }</pre></code></td></tr><tr><td>193</td><td><code><pre></pre></code></td></tr><tr><td>194</td><td><code><pre>        sharedInformers := []cache.SharedInformer{</pre></code></td></tr><tr><td>195</td><td><code><pre>                c.informers.Endpoints,</pre></code></td></tr><tr><td>196</td><td><code><pre>                c.informers.Pods,</pre></code></td></tr><tr><td>197</td><td><code><pre>                c.informers.Service,</pre></code></td></tr><tr><td>198</td><td><code><pre>                c.informers.Secret,</pre></code></td></tr><tr><td>199</td><td><code><pre>                c.informers.Ingress,</pre></code></td></tr><tr><td>200</td><td><code><pre></pre></code></td></tr><tr><td>201</td><td><code><pre>                c.informers.AzureApplicationGatewayRewrite,</pre></code></td></tr><tr><td>202</td><td><code><pre></pre></code></td></tr><tr><td>203</td><td><code><pre>                //TODO: enabled by ccp feature flag</pre></code></td></tr><tr><td>204</td><td><code><pre>                // c.informers.AzureApplicationGatewayBackendPool,</pre></code></td></tr><tr><td>205</td><td><code><pre>                // c.informers.AzureApplicationGatewayInstanceUpdateStatus,</pre></code></td></tr><tr><td>206</td><td><code><pre>        }</pre></code></td></tr><tr><td>207</td><td><code><pre></pre></code></td></tr><tr><td>208</td><td><code><pre>        if IsNetworkingV1PackageSupported {</pre></code></td></tr><tr><td>209</td><td><code><pre>                sharedInformers = append(sharedInformers, c.informers.IngressClass)</pre></code></td></tr><tr><td>210</td><td><code><pre>        }</pre></code></td></tr><tr><td>211</td><td><code><pre></pre></code></td></tr><tr><td>212</td><td><code><pre>        // For AGIC to watch for these CRDs the EnableBrownfieldDeploymentVarName env variable must be set to true</pre></code></td></tr><tr><td>213</td><td><code><pre>        if envVariables.EnableBrownfieldDeployment {</pre></code></td></tr><tr class="miss"><td>214</td><td><code><pre>                sharedInformers = append(sharedInformers, c.informers.AzureIngressProhibitedTarget)</pre></code></td></tr><tr><td>215</td><td><code><pre>        }</pre></code></td></tr><tr><td>216</td><td><code><pre></pre></code></td></tr><tr><td>217</td><td><code><pre>        // For AGIC to watch for these CRDs the MultiClusterMode env variable must be set to true</pre></code></td></tr><tr><td>218</td><td><code><pre>        if envVariables.MultiClusterMode {</pre></code></td></tr><tr class="miss"><td>219</td><td><code><pre>                sharedInformers = []cache.SharedInformer{} //only need to monitor 3 resources</pre></code></td></tr><tr class="miss"><td>220</td><td><code><pre>                sharedInformers = append(sharedInformers, c.informers.MultiClusterIngress)</pre></code></td></tr><tr class="miss"><td>221</td><td><code><pre>                sharedInformers = append(sharedInformers, c.informers.MultiClusterService)</pre></code></td></tr><tr><td>222</td><td><code><pre>        }</pre></code></td></tr><tr><td>223</td><td><code><pre></pre></code></td></tr><tr><td>224</td><td><code><pre>        if envVariables.EnableIstioIntegration {</pre></code></td></tr><tr class="miss"><td>225</td><td><code><pre>                sharedInformers = append(sharedInformers, c.informers.IstioGateway, c.informers.IstioVirtualService)</pre></code></td></tr><tr><td>226</td><td><code><pre>        }</pre></code></td></tr><tr><td>227</td><td><code><pre></pre></code></td></tr><tr><td>228</td><td><code><pre>        for _, informer := range sharedInformers {</pre></code></td></tr><tr><td>229</td><td><code><pre>                go informer.Run(stopChannel)</pre></code></td></tr><tr><td>230</td><td><code><pre>                // NOTE: Delyan could not figure out how to make informer.HasSynced == true for the CRDs in unit tests</pre></code></td></tr><tr><td>231</td><td><code><pre>                // so until we do that - we omit WaitForCacheSync for CRDs in unit testing</pre></code></td></tr><tr><td>232</td><td><code><pre>                if _, isCRD := crds[informer]; isCRD {</pre></code></td></tr><tr><td>233</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>234</td><td><code><pre>                }</pre></code></td></tr><tr><td>235</td><td><code><pre>                hasSynced = append(hasSynced, informer.HasSynced)</pre></code></td></tr><tr><td>236</td><td><code><pre>        }</pre></code></td></tr><tr><td>237</td><td><code><pre></pre></code></td></tr><tr><td>238</td><td><code><pre>        klog.V(1).Infoln(&#34;Waiting for initial cache sync&#34;)</pre></code></td></tr><tr><td>239</td><td><code><pre>        if !cache.WaitForCacheSync(stopChannel, hasSynced...) {</pre></code></td></tr><tr class="miss"><td>240</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>241</td><td><code><pre>                        controllererrors.ErrorFailedInitialCacheSync,</pre></code></td></tr><tr><td>242</td><td><code><pre>                        &#34;failed initial sync of resources required for ingress&#34;,</pre></code></td></tr><tr><td>243</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>244</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>245</td><td><code><pre>                return e</pre></code></td></tr><tr><td>246</td><td><code><pre>        }</pre></code></td></tr><tr><td>247</td><td><code><pre></pre></code></td></tr><tr><td>248</td><td><code><pre>        // Closing the cacheSynced channel signals to the rest of the system that... caches have been synced.</pre></code></td></tr><tr><td>249</td><td><code><pre>        close(c.CacheSynced)</pre></code></td></tr><tr><td>250</td><td><code><pre></pre></code></td></tr><tr><td>251</td><td><code><pre>        klog.V(1).Infoln(&#34;Initial cache sync done&#34;)</pre></code></td></tr><tr><td>252</td><td><code><pre>        klog.V(1).Infoln(&#34;k8s context run finished&#34;)</pre></code></td></tr><tr><td>253</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>254</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.secretDelete">func handlers.secretDelete</div><div class="info"><a href="#s_fn_handlers.secretDelete">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secrets_handlers.go</code>:</p></div><table class="listing">
<tr><td>71</td><td><code><pre>func (h handlers) secretDelete(obj interface{}) {</pre></code></td></tr><tr><td>72</td><td><code><pre>        sec, ok := obj.(*v1.Secret)</pre></code></td></tr><tr><td>73</td><td><code><pre>        if _, exists := namespacesToIgnore[sec.Namespace]; exists {</pre></code></td></tr><tr class="miss"><td>74</td><td><code><pre>                return</pre></code></td></tr><tr><td>75</td><td><code><pre>        }</pre></code></td></tr><tr><td>76</td><td><code><pre>        if _, exists := h.context.namespaces[sec.Namespace]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>77</td><td><code><pre>                return</pre></code></td></tr><tr><td>78</td><td><code><pre>        }</pre></code></td></tr><tr><td>79</td><td><code><pre></pre></code></td></tr><tr><td>80</td><td><code><pre>        if !ok {</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>                tombstone, ok := obj.(cache.DeletedFinalStateUnknown)</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>                if !ok {</pre></code></td></tr><tr><td>83</td><td><code><pre>                        // unable to get from tombstone</pre></code></td></tr><tr class="miss"><td>84</td><td><code><pre>                        return</pre></code></td></tr><tr><td>85</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>                sec, _ = tombstone.Obj.(*v1.Secret)</pre></code></td></tr><tr><td>87</td><td><code><pre>        }</pre></code></td></tr><tr><td>88</td><td><code><pre>        if sec == nil {</pre></code></td></tr><tr class="miss"><td>89</td><td><code><pre>                return</pre></code></td></tr><tr><td>90</td><td><code><pre>        }</pre></code></td></tr><tr><td>91</td><td><code><pre></pre></code></td></tr><tr><td>92</td><td><code><pre>        secKey := utils.GetResourceKey(sec.Namespace, sec.Name)</pre></code></td></tr><tr><td>93</td><td><code><pre>        h.context.CertificateSecretStore.delete(secKey)</pre></code></td></tr><tr><td>94</td><td><code><pre>        if h.context.ingressSecretsMap.ContainsValue(secKey) {</pre></code></td></tr><tr><td>95</td><td><code><pre>                h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>96</td><td><code><pre>                        Type:  events.Delete,</pre></code></td></tr><tr><td>97</td><td><code><pre>                        Value: obj,</pre></code></td></tr><tr><td>98</td><td><code><pre>                }</pre></code></td></tr><tr><td>99</td><td><code><pre>                h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>100</td><td><code><pre>        }</pre></code></td></tr><tr><td>101</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.getIngressClassResource">func Context.getIngressClassResource</div><div class="info"><a href="#s_fn_Context.getIngressClassResource">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>914</td><td><code><pre>func (c *Context) getIngressClassResource(ingressClassName string) *networking.IngressClass {</pre></code></td></tr><tr><td>915</td><td><code><pre>        if c.Caches.IngressClass == nil {</pre></code></td></tr><tr class="miss"><td>916</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>917</td><td><code><pre>        }</pre></code></td></tr><tr><td>918</td><td><code><pre></pre></code></td></tr><tr><td>919</td><td><code><pre>        ingressClassInterface, exist, err := c.Caches.IngressClass.GetByKey(ingressClassName)</pre></code></td></tr><tr><td>920</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>921</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>922</td><td><code><pre>        }</pre></code></td></tr><tr><td>923</td><td><code><pre></pre></code></td></tr><tr><td>924</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>925</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>926</td><td><code><pre>        }</pre></code></td></tr><tr><td>927</td><td><code><pre></pre></code></td></tr><tr><td>928</td><td><code><pre>        return ingressClassInterface.(*networking.IngressClass)</pre></code></td></tr><tr><td>929</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.ingressDelete">func handlers.ingressDelete</div><div class="info"><a href="#s_fn_handlers.ingressDelete">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/ingress_handlers.go</code>:</p></div><table class="listing">
<tr><td>57</td><td><code><pre>func (h handlers) ingressDelete(obj interface{}) {</pre></code></td></tr><tr><td>58</td><td><code><pre>        ing, ok := convert.ToIngressV1(obj)</pre></code></td></tr><tr><td>59</td><td><code><pre>        if _, exists := namespacesToIgnore[ing.Namespace]; exists {</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                return</pre></code></td></tr><tr><td>61</td><td><code><pre>        }</pre></code></td></tr><tr><td>62</td><td><code><pre>        if _, exists := h.context.namespaces[ing.Namespace]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>63</td><td><code><pre>                return</pre></code></td></tr><tr><td>64</td><td><code><pre>        }</pre></code></td></tr><tr><td>65</td><td><code><pre></pre></code></td></tr><tr><td>66</td><td><code><pre>        if !ok {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                tombstone, ok := obj.(cache.DeletedFinalStateUnknown)</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                if !ok {</pre></code></td></tr><tr><td>69</td><td><code><pre>                        // unable to get from tombstone</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>                        return</pre></code></td></tr><tr><td>71</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>72</td><td><code><pre>                ing, _ = tombstone.Obj.(*networking.Ingress)</pre></code></td></tr><tr><td>73</td><td><code><pre>        }</pre></code></td></tr><tr><td>74</td><td><code><pre>        if ing == nil {</pre></code></td></tr><tr class="miss"><td>75</td><td><code><pre>                return</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre>        if !h.context.IsIngressClass(ing) {</pre></code></td></tr><tr class="miss"><td>78</td><td><code><pre>                return</pre></code></td></tr><tr><td>79</td><td><code><pre>        }</pre></code></td></tr><tr><td>80</td><td><code><pre>        ingKey := utils.GetResourceKey(ing.Namespace, ing.Name)</pre></code></td></tr><tr><td>81</td><td><code><pre>        h.context.ingressSecretsMap.Erase(ingKey)</pre></code></td></tr><tr><td>82</td><td><code><pre></pre></code></td></tr><tr><td>83</td><td><code><pre>        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>84</td><td><code><pre>                Type:  events.Delete,</pre></code></td></tr><tr><td>85</td><td><code><pre>                Value: obj,</pre></code></td></tr><tr><td>86</td><td><code><pre>        }</pre></code></td></tr><tr><td>87</td><td><code><pre>        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>88</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_writeFileDecode">func writeFileDecode</div><div class="info"><a href="#s_fn_writeFileDecode">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secretstore.go</code>:</p></div><table class="listing">
<tr><td>149</td><td><code><pre>func writeFileDecode(data []byte, fileHandle *os.File) error {</pre></code></td></tr><tr><td>150</td><td><code><pre>        if _, err := fileHandle.Write(data); err != nil {</pre></code></td></tr><tr class="miss"><td>151</td><td><code><pre>                return err</pre></code></td></tr><tr><td>152</td><td><code><pre>        }</pre></code></td></tr><tr><td>153</td><td><code><pre>        if err := fileHandle.Close(); err != nil {</pre></code></td></tr><tr class="miss"><td>154</td><td><code><pre>                return err</pre></code></td></tr><tr><td>155</td><td><code><pre>        }</pre></code></td></tr><tr><td>156</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>157</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.secretUpdate">func handlers.secretUpdate</div><div class="info"><a href="#s_fn_handlers.secretUpdate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/secrets_handlers.go</code>:</p></div><table class="listing">
<tr><td>44</td><td><code><pre>func (h handlers) secretUpdate(oldObj, newObj interface{}) {</pre></code></td></tr><tr><td>45</td><td><code><pre>        sec := newObj.(*v1.Secret)</pre></code></td></tr><tr><td>46</td><td><code><pre>        if _, exists := namespacesToIgnore[sec.Namespace]; exists {</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                return</pre></code></td></tr><tr><td>48</td><td><code><pre>        }</pre></code></td></tr><tr><td>49</td><td><code><pre>        if _, exists := h.context.namespaces[sec.Namespace]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>50</td><td><code><pre>                return</pre></code></td></tr><tr><td>51</td><td><code><pre>        }</pre></code></td></tr><tr><td>52</td><td><code><pre></pre></code></td></tr><tr><td>53</td><td><code><pre>        if reflect.DeepEqual(oldObj, newObj) {</pre></code></td></tr><tr><td>54</td><td><code><pre>                return</pre></code></td></tr><tr><td>55</td><td><code><pre>        }</pre></code></td></tr><tr><td>56</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>        secKey := utils.GetResourceKey(sec.Namespace, sec.Name)</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>        if h.context.ingressSecretsMap.ContainsValue(secKey) {</pre></code></td></tr><tr class="miss"><td>59</td><td><code><pre>                if err := h.context.CertificateSecretStore.ConvertSecret(secKey, sec); err == nil {</pre></code></td></tr><tr class="miss"><td>60</td><td><code><pre>                        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>61</td><td><code><pre>                                Type:  events.Update,</pre></code></td></tr><tr><td>62</td><td><code><pre>                                Value: newObj,</pre></code></td></tr><tr><td>63</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>64</td><td><code><pre>                        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>65</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>                        klog.Error(err.Error())</pre></code></td></tr><tr><td>67</td><td><code><pre>                }</pre></code></td></tr><tr><td>68</td><td><code><pre>        }</pre></code></td></tr><tr><td>69</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.ListServices">func Context.ListServices</div><div class="info"><a href="#s_fn_Context.ListServices">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>359</td><td><code><pre>func (c *Context) ListServices() []*v1.Service {</pre></code></td></tr><tr><td>360</td><td><code><pre>        var serviceList []*v1.Service</pre></code></td></tr><tr><td>361</td><td><code><pre>        if IsInMultiClusterMode {</pre></code></td></tr><tr class="miss"><td>362</td><td><code><pre>                for _, multiClusterServiceInterface := range c.Caches.MultiClusterService.List() {</pre></code></td></tr><tr class="miss"><td>363</td><td><code><pre>                        multiClusterService := multiClusterServiceInterface.(*multiClusterService.MultiClusterService)</pre></code></td></tr><tr class="miss"><td>364</td><td><code><pre>                        service, exists := convert.FromMultiClusterService(multiClusterService)</pre></code></td></tr><tr class="miss"><td>365</td><td><code><pre>                        if !exists {</pre></code></td></tr><tr class="miss"><td>366</td><td><code><pre>                                klog.Error(&#34;Unable to convert MultiClusterService to Service&#34;)</pre></code></td></tr><tr class="miss"><td>367</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>368</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>369</td><td><code><pre>                        if _, exists := c.namespaces[service.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>370</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>371</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>372</td><td><code><pre>                        if hasTCPPort(service) {</pre></code></td></tr><tr class="miss"><td>373</td><td><code><pre>                                serviceList = append(serviceList, service)</pre></code></td></tr><tr><td>374</td><td><code><pre>                        }</pre></code></td></tr><tr><td>375</td><td><code><pre>                }</pre></code></td></tr><tr><td>376</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>377</td><td><code><pre>                for _, serviceInterface := range c.Caches.Service.List() {</pre></code></td></tr><tr><td>378</td><td><code><pre>                        service := serviceInterface.(*v1.Service)</pre></code></td></tr><tr><td>379</td><td><code><pre>                        if _, exists := c.namespaces[service.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>380</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>381</td><td><code><pre>                        }</pre></code></td></tr><tr><td>382</td><td><code><pre>                        if hasTCPPort(service) {</pre></code></td></tr><tr><td>383</td><td><code><pre>                                serviceList = append(serviceList, service)</pre></code></td></tr><tr><td>384</td><td><code><pre>                        }</pre></code></td></tr><tr><td>385</td><td><code><pre>                }</pre></code></td></tr><tr><td>386</td><td><code><pre>        }</pre></code></td></tr><tr><td>387</td><td><code><pre>        return serviceList</pre></code></td></tr><tr><td>388</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.UpdateIngressStatus">func Context.UpdateIngressStatus</div><div class="info"><a href="#s_fn_Context.UpdateIngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>721</td><td><code><pre>func (c *Context) UpdateIngressStatus(ingressToUpdate networking.Ingress, newIP IPAddress) error {</pre></code></td></tr><tr><td>722</td><td><code><pre>        if IsNetworkingV1PackageSupported &amp;&amp; !IsInMultiClusterMode {</pre></code></td></tr><tr><td>723</td><td><code><pre>                return c.updateV1IngressStatus(ingressToUpdate, newIP)</pre></code></td></tr><tr class="miss"><td>724</td><td><code><pre>        } else if IsInMultiClusterMode {</pre></code></td></tr><tr class="miss"><td>725</td><td><code><pre>                return c.updateMultiClusterIngressStatus(ingressToUpdate, newIP)</pre></code></td></tr><tr><td>726</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>727</td><td><code><pre>                return c.updateV1beta1IngressStatus(ingressToUpdate, newIP)</pre></code></td></tr><tr><td>728</td><td><code><pre>        }</pre></code></td></tr><tr><td>729</td><td><code><pre></pre></code></td></tr><tr><td>730</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.ListHTTPIngresses">func Context.ListHTTPIngresses</div><div class="info"><a href="#s_fn_Context.ListHTTPIngresses">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>509</td><td><code><pre>func (c *Context) ListHTTPIngresses() []*networking.Ingress {</pre></code></td></tr><tr><td>510</td><td><code><pre>        var ingressList []*networking.Ingress</pre></code></td></tr><tr><td>511</td><td><code><pre>        if IsInMultiClusterMode {</pre></code></td></tr><tr class="miss"><td>512</td><td><code><pre>                klog.V(9).Infof(&#34;Fetching MultiCluster Ingresses&#34;)</pre></code></td></tr><tr class="miss"><td>513</td><td><code><pre>                for _, mciInterface := range c.Caches.MultiClusterIngress.List() {</pre></code></td></tr><tr class="miss"><td>514</td><td><code><pre>                        mci := mciInterface.(*multiClusterIngress.MultiClusterIngress)</pre></code></td></tr><tr class="miss"><td>515</td><td><code><pre>                        ingress, exists := convert.FromMultiClusterIngress(mci)</pre></code></td></tr><tr class="miss"><td>516</td><td><code><pre>                        if !exists {</pre></code></td></tr><tr class="miss"><td>517</td><td><code><pre>                                klog.Error(&#34;Unable to convert MultiClusterIngress to Ingress&#34;)</pre></code></td></tr><tr class="miss"><td>518</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>519</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>520</td><td><code><pre>                        if _, exists := c.namespaces[ingress.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>521</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>522</td><td><code><pre>                        }</pre></code></td></tr><tr class="miss"><td>523</td><td><code><pre>                        ingressList = append(ingressList, ingress)</pre></code></td></tr><tr><td>524</td><td><code><pre>                }</pre></code></td></tr><tr><td>525</td><td><code><pre>        } else {</pre></code></td></tr><tr><td>526</td><td><code><pre>                for _, ingressInterface := range c.Caches.Ingress.List() {</pre></code></td></tr><tr><td>527</td><td><code><pre>                        ingress, _ := convert.ToIngressV1(ingressInterface)</pre></code></td></tr><tr><td>528</td><td><code><pre>                        if _, exists := c.namespaces[ingress.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>529</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>530</td><td><code><pre>                        }</pre></code></td></tr><tr><td>531</td><td><code><pre>                        ingressList = append(ingressList, ingress)</pre></code></td></tr><tr><td>532</td><td><code><pre>                }</pre></code></td></tr><tr><td>533</td><td><code><pre>        }</pre></code></td></tr><tr><td>534</td><td><code><pre>        return c.filterAndSort(ingressList)</pre></code></td></tr><tr><td>535</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetService">func Context.GetService</div><div class="info"><a href="#s_fn_Context.GetService">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>577</td><td><code><pre>func (c *Context) GetService(serviceKey string) *v1.Service {</pre></code></td></tr><tr><td>578</td><td><code><pre>        if IsInMultiClusterMode {</pre></code></td></tr><tr class="miss"><td>579</td><td><code><pre>                serviceInterface, exist, err := c.Caches.MultiClusterService.GetByKey(serviceKey)</pre></code></td></tr><tr><td>580</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>581</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>582</td><td><code><pre>                        klog.V(3).Infof(&#34;unable to get multicluster service from store, error occurred %s&#34;, err)</pre></code></td></tr><tr class="miss"><td>583</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>584</td><td><code><pre>                }</pre></code></td></tr><tr><td>585</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>586</td><td><code><pre>                if !exist {</pre></code></td></tr><tr class="miss"><td>587</td><td><code><pre>                        klog.V(9).Infof(&#34;MultiCluster Service %s does not exist&#34;, serviceKey)</pre></code></td></tr><tr class="miss"><td>588</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>589</td><td><code><pre>                }</pre></code></td></tr><tr><td>590</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>591</td><td><code><pre>                multiClusterService := serviceInterface.(*multiClusterService.MultiClusterService)</pre></code></td></tr><tr class="miss"><td>592</td><td><code><pre>                service, exists := convert.FromMultiClusterService(multiClusterService)</pre></code></td></tr><tr><td>593</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>594</td><td><code><pre>                if !exists {</pre></code></td></tr><tr class="miss"><td>595</td><td><code><pre>                        klog.V(3).Infof(&#34;unable to convert multicluster service from store to service&#34;)</pre></code></td></tr><tr class="miss"><td>596</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>597</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>598</td><td><code><pre>                return service</pre></code></td></tr><tr><td>599</td><td><code><pre>        }</pre></code></td></tr><tr><td>600</td><td><code><pre>        serviceInterface, exist, err := c.Caches.Service.GetByKey(serviceKey)</pre></code></td></tr><tr><td>601</td><td><code><pre></pre></code></td></tr><tr><td>602</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>603</td><td><code><pre>                klog.V(3).Infof(&#34;unable to get service from store, error occurred %s&#34;, err)</pre></code></td></tr><tr class="miss"><td>604</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>605</td><td><code><pre>        }</pre></code></td></tr><tr><td>606</td><td><code><pre></pre></code></td></tr><tr><td>607</td><td><code><pre>        if !exist {</pre></code></td></tr><tr><td>608</td><td><code><pre>                klog.V(9).Infof(&#34;Service %s does not exist&#34;, serviceKey)</pre></code></td></tr><tr><td>609</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>610</td><td><code><pre>        }</pre></code></td></tr><tr><td>611</td><td><code><pre></pre></code></td></tr><tr><td>612</td><td><code><pre>        service := serviceInterface.(*v1.Service)</pre></code></td></tr><tr><td>613</td><td><code><pre>        return service</pre></code></td></tr><tr><td>614</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_handlers.ingressUpdate">func handlers.ingressUpdate</div><div class="info"><a href="#s_fn_handlers.ingressUpdate">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/ingress_handlers.go</code>:</p></div><table class="listing">
<tr><td>90</td><td><code><pre>func (h handlers) ingressUpdate(oldObj, newObj interface{}) {</pre></code></td></tr><tr><td>91</td><td><code><pre>        ing, _ := convert.ToIngressV1(newObj)</pre></code></td></tr><tr><td>92</td><td><code><pre>        if _, exists := namespacesToIgnore[ing.Namespace]; exists {</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>                return</pre></code></td></tr><tr><td>94</td><td><code><pre>        }</pre></code></td></tr><tr><td>95</td><td><code><pre>        if _, exists := h.context.namespaces[ing.Namespace]; len(h.context.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr><td>96</td><td><code><pre>                return</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr><td>98</td><td><code><pre></pre></code></td></tr><tr><td>99</td><td><code><pre>        if reflect.DeepEqual(oldObj, newObj) {</pre></code></td></tr><tr><td>100</td><td><code><pre>                return</pre></code></td></tr><tr><td>101</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>102</td><td><code><pre>        oldIng, _ := convert.ToIngressV1(oldObj)</pre></code></td></tr><tr class="miss"><td>103</td><td><code><pre>        if !h.context.IsIngressClass(ing) &amp;&amp; !h.context.IsIngressClass(oldIng) {</pre></code></td></tr><tr class="miss"><td>104</td><td><code><pre>                return</pre></code></td></tr><tr><td>105</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>        if ing.Spec.TLS != nil &amp;&amp; len(ing.Spec.TLS) &gt; 0 {</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>                ingKey := utils.GetResourceKey(ing.Namespace, ing.Name)</pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>                h.context.ingressSecretsMap.Clear(ingKey)</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                for _, tls := range ing.Spec.TLS {</pre></code></td></tr><tr class="miss"><td>110</td><td><code><pre>                        secKey := utils.GetResourceKey(ing.Namespace, tls.SecretName)</pre></code></td></tr><tr><td>111</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>112</td><td><code><pre>                        if h.context.ingressSecretsMap.ContainsPair(ingKey, secKey) {</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>114</td><td><code><pre>                        }</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>116</td><td><code><pre>                        if secret, exists, err := h.context.Caches.Secret.GetByKey(secKey); exists &amp;&amp; err == nil {</pre></code></td></tr><tr class="miss"><td>117</td><td><code><pre>                                if !h.context.ingressSecretsMap.ContainsValue(secKey) {</pre></code></td></tr><tr class="miss"><td>118</td><td><code><pre>                                        if err := h.context.CertificateSecretStore.ConvertSecret(secKey, secret.(*v1.Secret)); err != nil {</pre></code></td></tr><tr class="miss"><td>119</td><td><code><pre>                                                klog.Error(err.Error())</pre></code></td></tr><tr><td>120</td><td><code><pre>                                        }</pre></code></td></tr><tr><td>121</td><td><code><pre>                                }</pre></code></td></tr><tr><td>122</td><td><code><pre>                        }</pre></code></td></tr><tr><td>123</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>124</td><td><code><pre>                        h.context.ingressSecretsMap.Insert(ingKey, secKey)</pre></code></td></tr><tr><td>125</td><td><code><pre>                }</pre></code></td></tr><tr><td>126</td><td><code><pre>        }</pre></code></td></tr><tr><td>127</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>128</td><td><code><pre>        h.context.Work &lt;- events.Event{</pre></code></td></tr><tr><td>129</td><td><code><pre>                Type:  events.Update,</pre></code></td></tr><tr><td>130</td><td><code><pre>                Value: newObj,</pre></code></td></tr><tr><td>131</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>132</td><td><code><pre>        h.context.MetricStore.IncK8sAPIEventCounter()</pre></code></td></tr><tr><td>133</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.generateEndpointsFromMultiClusterService">func Context.generateEndpointsFromMultiClusterService</div><div class="info"><a href="#s_fn_Context.generateEndpointsFromMultiClusterService">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>421</td><td><code><pre>func (c *Context) generateEndpointsFromMultiClusterService(serviceKey string) (*v1.Endpoints, error) {</pre></code></td></tr><tr class="miss"><td>422</td><td><code><pre>        multiClusterServiceInterface, exist, err := c.Caches.MultiClusterService.GetByKey(serviceKey)</pre></code></td></tr><tr><td>423</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>424</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>425</td><td><code><pre>                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>426</td><td><code><pre>                        controllererrors.ErrorFetchingMultiClusterService,</pre></code></td></tr><tr><td>427</td><td><code><pre>                        &#34;MultiCluster service not found for %s&#34;,</pre></code></td></tr><tr><td>428</td><td><code><pre>                        serviceKey)</pre></code></td></tr><tr class="miss"><td>429</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>430</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>431</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>432</td><td><code><pre>        }</pre></code></td></tr><tr><td>433</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>434</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>435</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>436</td><td><code><pre>                        controllererrors.ErrorFetchingMultiClusterService,</pre></code></td></tr><tr><td>437</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>438</td><td><code><pre>                        &#34;Error fetching MultiCluster service from store for %s&#34;,</pre></code></td></tr><tr><td>439</td><td><code><pre>                        serviceKey)</pre></code></td></tr><tr class="miss"><td>440</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>441</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>442</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>443</td><td><code><pre>        }</pre></code></td></tr><tr><td>444</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>445</td><td><code><pre>        multiClusterService := multiClusterServiceInterface.(*multiClusterService.MultiClusterService)</pre></code></td></tr><tr class="miss"><td>446</td><td><code><pre>        endpoints := &amp;v1.Endpoints{}</pre></code></td></tr><tr class="miss"><td>447</td><td><code><pre>        subset := v1.EndpointSubset{}</pre></code></td></tr><tr><td>448</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>449</td><td><code><pre>        for _, multiClusterEndpoint := range multiClusterService.Status.Endpoints {</pre></code></td></tr><tr class="miss"><td>450</td><td><code><pre>                address := v1.EndpointAddress{IP: multiClusterEndpoint.IP}</pre></code></td></tr><tr class="miss"><td>451</td><td><code><pre>                subset.Addresses = append(subset.Addresses, address)</pre></code></td></tr><tr><td>452</td><td><code><pre>        }</pre></code></td></tr><tr><td>453</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>454</td><td><code><pre>        for _, ports := range multiClusterService.Spec.Ports {</pre></code></td></tr><tr class="miss"><td>455</td><td><code><pre>                v1Port := v1.EndpointPort{Port: int32(ports.Port), Protocol: v1.Protocol(ports.Protocol)}</pre></code></td></tr><tr class="miss"><td>456</td><td><code><pre>                subset.Ports = append(subset.Ports, v1Port)</pre></code></td></tr><tr><td>457</td><td><code><pre>        }</pre></code></td></tr><tr><td>458</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>459</td><td><code><pre>        endpoints.Subsets = []v1.EndpointSubset{subset}</pre></code></td></tr><tr class="miss"><td>460</td><td><code><pre>        return endpoints, nil</pre></code></td></tr><tr><td>461</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.updateV1beta1IngressStatus">func Context.updateV1beta1IngressStatus</div><div class="info"><a href="#s_fn_Context.updateV1beta1IngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>774</td><td><code><pre>func (c *Context) updateV1beta1IngressStatus(ingressToUpdate networking.Ingress, newIP IPAddress) error {</pre></code></td></tr><tr class="miss"><td>775</td><td><code><pre>        ingressClient := c.kubeClient.ExtensionsV1beta1().Ingresses(ingressToUpdate.Namespace)</pre></code></td></tr><tr class="miss"><td>776</td><td><code><pre>        ingress, err := ingressClient.Get(context.TODO(), ingressToUpdate.Name, metav1.GetOptions{})</pre></code></td></tr><tr class="miss"><td>777</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>778</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>779</td><td><code><pre>                        controllererrors.ErrorUpdatingIngressStatus,</pre></code></td></tr><tr><td>780</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>781</td><td><code><pre>                        &#34;Unable to get ingress %s/%s&#34;, ingressToUpdate.Namespace, ingressToUpdate.Name,</pre></code></td></tr><tr><td>782</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>783</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>784</td><td><code><pre>                return e</pre></code></td></tr><tr><td>785</td><td><code><pre>        }</pre></code></td></tr><tr><td>786</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>787</td><td><code><pre>        for _, lbi := range ingress.Status.LoadBalancer.Ingress {</pre></code></td></tr><tr class="miss"><td>788</td><td><code><pre>                existingIP := lbi.IP</pre></code></td></tr><tr class="miss"><td>789</td><td><code><pre>                if existingIP == string(newIP) {</pre></code></td></tr><tr class="miss"><td>790</td><td><code><pre>                        klog.Infof(&#34;IP %s already set on Ingress %s/%s&#34;, lbi.IP, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr class="miss"><td>791</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>792</td><td><code><pre>                }</pre></code></td></tr><tr><td>793</td><td><code><pre>        }</pre></code></td></tr><tr><td>794</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>795</td><td><code><pre>        loadBalancerIngresses := []v1.LoadBalancerIngress{}</pre></code></td></tr><tr class="miss"><td>796</td><td><code><pre>        if newIP != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>797</td><td><code><pre>                loadBalancerIngresses = append(loadBalancerIngresses, v1.LoadBalancerIngress{</pre></code></td></tr><tr><td>798</td><td><code><pre>                        IP: string(newIP),</pre></code></td></tr><tr><td>799</td><td><code><pre>                })</pre></code></td></tr><tr><td>800</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>801</td><td><code><pre>        ingress.Status.LoadBalancer.Ingress = loadBalancerIngresses</pre></code></td></tr><tr><td>802</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>803</td><td><code><pre>        if _, err := ingressClient.UpdateStatus(context.TODO(), ingress, metav1.UpdateOptions{}); err != nil {</pre></code></td></tr><tr class="miss"><td>804</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>805</td><td><code><pre>                        controllererrors.ErrorUpdatingIngressStatus,</pre></code></td></tr><tr><td>806</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>807</td><td><code><pre>                        &#34;Unable to update ingress %s/%s status&#34;, ingress.Namespace, ingress.Name,</pre></code></td></tr><tr><td>808</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>809</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>810</td><td><code><pre>                return e</pre></code></td></tr><tr><td>811</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>812</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>813</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.updateMultiClusterIngressStatus">func Context.updateMultiClusterIngressStatus</div><div class="info"><a href="#s_fn_Context.updateMultiClusterIngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>815</td><td><code><pre>func (c *Context) updateMultiClusterIngressStatus(ingressToUpdate networking.Ingress, newIP IPAddress) error {</pre></code></td></tr><tr class="miss"><td>816</td><td><code><pre>        ingressClient := c.multiClusterCrdClient.MulticlusteringressesV1alpha1().MultiClusterIngresses(ingressToUpdate.Namespace)</pre></code></td></tr><tr class="miss"><td>817</td><td><code><pre>        ingress, err := ingressClient.Get(context.TODO(), ingressToUpdate.Name, metav1.GetOptions{})</pre></code></td></tr><tr class="miss"><td>818</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>819</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>820</td><td><code><pre>                        controllererrors.ErrorUpdatingIngressStatus,</pre></code></td></tr><tr><td>821</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>822</td><td><code><pre>                        &#34;Unable to get ingress %s/%s&#34;, ingressToUpdate.Namespace, ingressToUpdate.Name,</pre></code></td></tr><tr><td>823</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>824</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>825</td><td><code><pre>                return e</pre></code></td></tr><tr><td>826</td><td><code><pre>        }</pre></code></td></tr><tr><td>827</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>828</td><td><code><pre>        for _, lbi := range ingress.Status.LoadBalancer.Ingress {</pre></code></td></tr><tr class="miss"><td>829</td><td><code><pre>                existingIP := lbi.IP</pre></code></td></tr><tr class="miss"><td>830</td><td><code><pre>                if existingIP == string(newIP) {</pre></code></td></tr><tr class="miss"><td>831</td><td><code><pre>                        klog.Infof(&#34;IP %s already set on Ingress %s/%s&#34;, lbi.IP, ingress.Namespace, ingress.Name)</pre></code></td></tr><tr class="miss"><td>832</td><td><code><pre>                        return nil</pre></code></td></tr><tr><td>833</td><td><code><pre>                }</pre></code></td></tr><tr><td>834</td><td><code><pre>        }</pre></code></td></tr><tr><td>835</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>836</td><td><code><pre>        loadBalancerIngresses := []v1.LoadBalancerIngress{}</pre></code></td></tr><tr class="miss"><td>837</td><td><code><pre>        if newIP != &#34;&#34; {</pre></code></td></tr><tr class="miss"><td>838</td><td><code><pre>                loadBalancerIngresses = append(loadBalancerIngresses, v1.LoadBalancerIngress{</pre></code></td></tr><tr><td>839</td><td><code><pre>                        IP: string(newIP),</pre></code></td></tr><tr><td>840</td><td><code><pre>                })</pre></code></td></tr><tr><td>841</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>842</td><td><code><pre>        ingress.Status.LoadBalancer.Ingress = loadBalancerIngresses</pre></code></td></tr><tr><td>843</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>844</td><td><code><pre>        if _, err := ingressClient.UpdateStatus(context.TODO(), ingress, metav1.UpdateOptions{}); err != nil {</pre></code></td></tr><tr class="miss"><td>845</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>846</td><td><code><pre>                        controllererrors.ErrorUpdatingIngressStatus,</pre></code></td></tr><tr><td>847</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>848</td><td><code><pre>                        &#34;Unable to update ingress %s/%s status&#34;, ingress.Namespace, ingress.Name,</pre></code></td></tr><tr><td>849</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>850</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>851</td><td><code><pre>                return e</pre></code></td></tr><tr><td>852</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>853</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>854</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetVirtualServicesForGateway">func Context.GetVirtualServicesForGateway</div><div class="info"><a href="#s_fn_Context.GetVirtualServicesForGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>635</td><td><code><pre>func (c *Context) GetVirtualServicesForGateway(gateway v1alpha3.Gateway) []*v1alpha3.VirtualService {</pre></code></td></tr><tr class="miss"><td>636</td><td><code><pre>        virtualServices := make([]*v1alpha3.VirtualService, 0)</pre></code></td></tr><tr class="miss"><td>637</td><td><code><pre>        allVirtualServices := c.ListIstioVirtualServices()</pre></code></td></tr><tr class="miss"><td>638</td><td><code><pre>        gatewayName := gateway.Name</pre></code></td></tr><tr class="miss"><td>639</td><td><code><pre>        for _, service := range allVirtualServices {</pre></code></td></tr><tr class="miss"><td>640</td><td><code><pre>                hasGateway := false</pre></code></td></tr><tr class="miss"><td>641</td><td><code><pre>                for _, serviceGateway := range service.Spec.Gateways {</pre></code></td></tr><tr class="miss"><td>642</td><td><code><pre>                        if gatewayName == serviceGateway {</pre></code></td></tr><tr class="miss"><td>643</td><td><code><pre>                                hasGateway = true</pre></code></td></tr><tr><td>644</td><td><code><pre>                        }</pre></code></td></tr><tr><td>645</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>646</td><td><code><pre>                if hasGateway {</pre></code></td></tr><tr class="miss"><td>647</td><td><code><pre>                        virtualServices = append(virtualServices, service)</pre></code></td></tr><tr><td>648</td><td><code><pre>                }</pre></code></td></tr><tr><td>649</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>650</td><td><code><pre>        var virtualServiceLogging []string</pre></code></td></tr><tr class="miss"><td>651</td><td><code><pre>        for _, virtualService := range virtualServices {</pre></code></td></tr><tr class="miss"><td>652</td><td><code><pre>                virtualServiceLogging = append(virtualServiceLogging, fmt.Sprintf(&#34;%s/%s&#34;, virtualService.Namespace, virtualService.Name))</pre></code></td></tr><tr><td>653</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>654</td><td><code><pre>        klog.V(5).Infof(&#34;Found Virtual Services: %+v&#34;, strings.Join(virtualServiceLogging, &#34;,&#34;))</pre></code></td></tr><tr class="miss"><td>655</td><td><code><pre>        return virtualServices</pre></code></td></tr><tr><td>656</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetInfrastructureResourceGroupID">func Context.GetInfrastructureResourceGroupID</div><div class="info"><a href="#s_fn_Context.GetInfrastructureResourceGroupID">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>689</td><td><code><pre>func (c *Context) GetInfrastructureResourceGroupID() (azure.SubscriptionID, azure.ResourceGroup, error) {</pre></code></td></tr><tr class="miss"><td>690</td><td><code><pre>        nodes, err := c.kubeClient.CoreV1().Nodes().List(context.TODO(), metav1.ListOptions{})</pre></code></td></tr><tr class="miss"><td>691</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>692</td><td><code><pre>                e := controllererrors.NewErrorWithInnerError(</pre></code></td></tr><tr><td>693</td><td><code><pre>                        controllererrors.ErrorFetchingNodes,</pre></code></td></tr><tr><td>694</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>695</td><td><code><pre>                        &#34;no nodes were found in the node list&#34;,</pre></code></td></tr><tr><td>696</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>697</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>698</td><td><code><pre>                return azure.SubscriptionID(&#34;&#34;), azure.ResourceGroup(&#34;&#34;), e</pre></code></td></tr><tr><td>699</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>700</td><td><code><pre>        if nodes == nil || len(nodes.Items) == 0 {</pre></code></td></tr><tr class="miss"><td>701</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>702</td><td><code><pre>                        controllererrors.ErrorNoNodesFound,</pre></code></td></tr><tr><td>703</td><td><code><pre>                        &#34;no nodes were found in the node list&#34;,</pre></code></td></tr><tr><td>704</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>705</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>706</td><td><code><pre>                return azure.SubscriptionID(&#34;&#34;), azure.ResourceGroup(&#34;&#34;), e</pre></code></td></tr><tr><td>707</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>708</td><td><code><pre>        if !strings.HasPrefix(nodes.Items[0].Spec.ProviderID, providerPrefix) {</pre></code></td></tr><tr class="miss"><td>709</td><td><code><pre>                e := controllererrors.NewError(</pre></code></td></tr><tr><td>710</td><td><code><pre>                        controllererrors.ErrorUnrecognizedNodeProviderPrefix,</pre></code></td></tr><tr><td>711</td><td><code><pre>                        &#34;providerID is not prefixed with azure://&#34;,</pre></code></td></tr><tr><td>712</td><td><code><pre>                )</pre></code></td></tr><tr class="miss"><td>713</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>714</td><td><code><pre>                return azure.SubscriptionID(&#34;&#34;), azure.ResourceGroup(&#34;&#34;), e</pre></code></td></tr><tr><td>715</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>716</td><td><code><pre>        subscriptionID, resourceGroup, _ := azure.ParseResourceID(strings.TrimPrefix(nodes.Items[0].Spec.ProviderID, providerPrefix))</pre></code></td></tr><tr class="miss"><td>717</td><td><code><pre>        return subscriptionID, resourceGroup, nil</pre></code></td></tr><tr><td>718</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetEndpointsByService">func Context.GetEndpointsByService</div><div class="info"><a href="#s_fn_Context.GetEndpointsByService">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>391</td><td><code><pre>func (c *Context) GetEndpointsByService(serviceKey string) (*v1.Endpoints, error) {</pre></code></td></tr><tr class="miss"><td>392</td><td><code><pre>        if IsInMultiClusterMode {</pre></code></td></tr><tr class="miss"><td>393</td><td><code><pre>                return c.generateEndpointsFromMultiClusterService(serviceKey)</pre></code></td></tr><tr><td>394</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>395</td><td><code><pre>        endpointsInterface, exist, err := c.Caches.Endpoints.GetByKey(serviceKey)</pre></code></td></tr><tr><td>396</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>397</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>398</td><td><code><pre>                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>399</td><td><code><pre>                        controllererrors.ErrorFetchingEndpoints,</pre></code></td></tr><tr><td>400</td><td><code><pre>                        &#34;Endpoint not found for %s&#34;,</pre></code></td></tr><tr><td>401</td><td><code><pre>                        serviceKey)</pre></code></td></tr><tr class="miss"><td>402</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>403</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>404</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>405</td><td><code><pre>        }</pre></code></td></tr><tr><td>406</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>407</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>408</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>409</td><td><code><pre>                        controllererrors.ErrorFetchingEndpoints,</pre></code></td></tr><tr><td>410</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>411</td><td><code><pre>                        &#34;Error fetching endpoints from store for %s&#34;,</pre></code></td></tr><tr><td>412</td><td><code><pre>                        serviceKey)</pre></code></td></tr><tr class="miss"><td>413</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>414</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>415</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>416</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>417</td><td><code><pre>        return endpointsInterface.(*v1.Endpoints), nil</pre></code></td></tr><tr><td>418</td><td><code><pre></pre></code></td></tr><tr><td>419</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetBackendPool">func Context.GetBackendPool</div><div class="info"><a href="#s_fn_Context.GetBackendPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>267</td><td><code><pre>func (c *Context) GetBackendPool(backendPoolName string) (*agpoolv1beta1.AzureApplicationGatewayBackendPool, error) {</pre></code></td></tr><tr class="miss"><td>268</td><td><code><pre>        agpool, exist, err := c.Caches.AzureApplicationGatewayBackendPool.GetByKey(backendPoolName)</pre></code></td></tr><tr class="miss"><td>269</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>270</td><td><code><pre>                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>271</td><td><code><pre>                        controllererrors.ErrorFetchingBackendAddressPool,</pre></code></td></tr><tr><td>272</td><td><code><pre>                        &#34;Backend pool CRD object not found for %s&#34;,</pre></code></td></tr><tr><td>273</td><td><code><pre>                        backendPoolName)</pre></code></td></tr><tr class="miss"><td>274</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>275</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>276</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>277</td><td><code><pre>        }</pre></code></td></tr><tr><td>278</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>279</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>280</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>281</td><td><code><pre>                        controllererrors.ErrorFetchingBackendAddressPool,</pre></code></td></tr><tr><td>282</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>283</td><td><code><pre>                        &#34;Error fetching backend pool CRD object from store for %s&#34;,</pre></code></td></tr><tr><td>284</td><td><code><pre>                        backendPoolName)</pre></code></td></tr><tr class="miss"><td>285</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>286</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>287</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>288</td><td><code><pre>        }</pre></code></td></tr><tr><td>289</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>290</td><td><code><pre>        return agpool.(*agpoolv1beta1.AzureApplicationGatewayBackendPool), nil</pre></code></td></tr><tr><td>291</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_SupportsNetworkingPackage">func SupportsNetworkingPackage</div><div class="info"><a href="#s_fn_SupportsNetworkingPackage">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/supported_apiversion.go</code>:</p></div><table class="listing">
<tr><td>46</td><td><code><pre>func SupportsNetworkingPackage(client clientset.Interface) bool {</pre></code></td></tr><tr><td>47</td><td><code><pre>        // check kubernetes version to use new ingress package or not</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>        version119, _ := version.ParseGeneric(&#34;v1.19.0&#34;)</pre></code></td></tr><tr><td>49</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>50</td><td><code><pre>        var serverVersion *serverversion.Info</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>        var err error</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>        utils.Retry(maxRetryCount, retryPause, func() (utils.Retriable, error) {</pre></code></td></tr><tr><td>53</td><td><code><pre>                serverVersion, err = client.Discovery().ServerVersion()</pre></code></td></tr><tr><td>54</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr><td>55</td><td><code><pre>                        klog.Warningf(&#34;Failed to get server version of the cluster: %s&#34;, err)</pre></code></td></tr><tr><td>56</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>57</td><td><code><pre>                } else {</pre></code></td></tr><tr><td>58</td><td><code><pre>                        return false, err</pre></code></td></tr><tr><td>59</td><td><code><pre>                }</pre></code></td></tr><tr><td>60</td><td><code><pre>        })</pre></code></td></tr><tr class="miss"><td>61</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                klog.Fatalf(&#34;Failed to get server version of the cluster: %s&#34;, err)</pre></code></td></tr><tr><td>63</td><td><code><pre>        }</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>65</td><td><code><pre>        runningVersion, err := version.ParseGeneric(serverVersion.String())</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                klog.Errorf(&#34;unexpected error parsing running Kubernetes version: %v&#34;, err)</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                return false</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>        klog.V(1).Infof(&#34;server version is: %s&#34;, runningVersion.String())</pre></code></td></tr><tr class="miss"><td>71</td><td><code><pre>        return runningVersion.AtLeast(version119)</pre></code></td></tr><tr><td>72</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetInstanceUpdateStatus">func Context.GetInstanceUpdateStatus</div><div class="info"><a href="#s_fn_Context.GetInstanceUpdateStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>322</td><td><code><pre>func (c *Context) GetInstanceUpdateStatus(instanceUpdateStatusName string) (*aginstv1beta1.AzureApplicationGatewayInstanceUpdateStatus, error) {</pre></code></td></tr><tr class="miss"><td>323</td><td><code><pre>        agpool, exist, err := c.Caches.AzureApplicationGatewayInstanceUpdateStatus.GetByKey(instanceUpdateStatusName)</pre></code></td></tr><tr class="miss"><td>324</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>325</td><td><code><pre>                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>326</td><td><code><pre>                        controllererrors.ErrorFetchingInstanceUpdateStatus,</pre></code></td></tr><tr><td>327</td><td><code><pre>                        &#34;Instance update status CRD object not found for %s&#34;,</pre></code></td></tr><tr><td>328</td><td><code><pre>                        instanceUpdateStatusName)</pre></code></td></tr><tr class="miss"><td>329</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>330</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>331</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>332</td><td><code><pre>        }</pre></code></td></tr><tr><td>333</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>334</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>335</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>336</td><td><code><pre>                        controllererrors.ErrorFetchingInstanceUpdateStatus,</pre></code></td></tr><tr><td>337</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>338</td><td><code><pre>                        &#34;Error fetching instance update status CRD object from store for %s&#34;,</pre></code></td></tr><tr><td>339</td><td><code><pre>                        instanceUpdateStatusName)</pre></code></td></tr><tr class="miss"><td>340</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>341</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>342</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>343</td><td><code><pre>        }</pre></code></td></tr><tr><td>344</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>345</td><td><code><pre>        return agpool.(*aginstv1beta1.AzureApplicationGatewayInstanceUpdateStatus), nil</pre></code></td></tr><tr><td>346</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetRewriteRuleSetCustomResource">func Context.GetRewriteRuleSetCustomResource</div><div class="info"><a href="#s_fn_Context.GetRewriteRuleSetCustomResource">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>294</td><td><code><pre>func (c *Context) GetRewriteRuleSetCustomResource(namespace string, name string) (*agrewritev1beta1.AzureApplicationGatewayRewrite, error) {</pre></code></td></tr><tr><td>295</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>296</td><td><code><pre>        agrewrite, exist, err := c.Caches.AzureApplicationGatewayRewrite.GetByKey(namespace + &#34;/&#34; + name)</pre></code></td></tr><tr class="miss"><td>297</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>298</td><td><code><pre>                e := controllererrors.NewErrorf(</pre></code></td></tr><tr><td>299</td><td><code><pre>                        controllererrors.ErrorFetchingRewrite,</pre></code></td></tr><tr><td>300</td><td><code><pre>                        &#34;Rewrite rule set custom resource object not found for %s&#34;,</pre></code></td></tr><tr><td>301</td><td><code><pre>                        name)</pre></code></td></tr><tr class="miss"><td>302</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>303</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>304</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>305</td><td><code><pre>        }</pre></code></td></tr><tr><td>306</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>307</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>308</td><td><code><pre>                e := controllererrors.NewErrorWithInnerErrorf(</pre></code></td></tr><tr><td>309</td><td><code><pre>                        controllererrors.ErrorFetchingRewrite,</pre></code></td></tr><tr><td>310</td><td><code><pre>                        err,</pre></code></td></tr><tr><td>311</td><td><code><pre>                        &#34;Error fetching rewrite rule set custom resource object from store for %s&#34;,</pre></code></td></tr><tr><td>312</td><td><code><pre>                        name)</pre></code></td></tr><tr class="miss"><td>313</td><td><code><pre>                klog.Error(e.Error())</pre></code></td></tr><tr class="miss"><td>314</td><td><code><pre>                c.MetricStore.IncErrorCount(e.Code)</pre></code></td></tr><tr class="miss"><td>315</td><td><code><pre>                return nil, e</pre></code></td></tr><tr><td>316</td><td><code><pre>        }</pre></code></td></tr><tr><td>317</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>318</td><td><code><pre>        return agrewrite.(*agrewritev1beta1.AzureApplicationGatewayRewrite), nil</pre></code></td></tr><tr><td>319</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.ListAzureProhibitedTargets">func Context.ListAzureProhibitedTargets</div><div class="info"><a href="#s_fn_Context.ListAzureProhibitedTargets">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>556</td><td><code><pre>func (c *Context) ListAzureProhibitedTargets() []*prohibitedv1.AzureIngressProhibitedTarget {</pre></code></td></tr><tr class="miss"><td>557</td><td><code><pre>        var targets []*prohibitedv1.AzureIngressProhibitedTarget</pre></code></td></tr><tr class="miss"><td>558</td><td><code><pre>        for _, obj := range c.Caches.AzureIngressProhibitedTarget.List() {</pre></code></td></tr><tr class="miss"><td>559</td><td><code><pre>                prohibitedTarget := obj.(*prohibitedv1.AzureIngressProhibitedTarget)</pre></code></td></tr><tr class="miss"><td>560</td><td><code><pre>                if _, exists := c.namespaces[prohibitedTarget.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>561</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>562</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>563</td><td><code><pre>                targets = append(targets, prohibitedTarget)</pre></code></td></tr><tr><td>564</td><td><code><pre>        }</pre></code></td></tr><tr><td>565</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>566</td><td><code><pre>        var prohibitedTargets []string</pre></code></td></tr><tr class="miss"><td>567</td><td><code><pre>        for _, target := range targets {</pre></code></td></tr><tr class="miss"><td>568</td><td><code><pre>                prohibitedTargets = append(prohibitedTargets, fmt.Sprintf(&#34;%s/%s&#34;, target.Namespace, target.Name))</pre></code></td></tr><tr><td>569</td><td><code><pre>        }</pre></code></td></tr><tr><td>570</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>571</td><td><code><pre>        klog.V(5).Infof(&#34;AzureIngressProhibitedTargets: %+v&#34;, strings.Join(prohibitedTargets, &#34;,&#34;))</pre></code></td></tr><tr><td>572</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>573</td><td><code><pre>        return targets</pre></code></td></tr><tr><td>574</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetSecret">func Context.GetSecret</div><div class="info"><a href="#s_fn_Context.GetSecret">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>617</td><td><code><pre>func (c *Context) GetSecret(secretKey string) *v1.Secret {</pre></code></td></tr><tr class="miss"><td>618</td><td><code><pre>        secretInterface, exist, err := c.Caches.Secret.GetByKey(secretKey)</pre></code></td></tr><tr><td>619</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>620</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>621</td><td><code><pre>                klog.Error(&#34;Error fetching secret from store:&#34;, err)</pre></code></td></tr><tr class="miss"><td>622</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>623</td><td><code><pre>        }</pre></code></td></tr><tr><td>624</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>625</td><td><code><pre>        if !exist {</pre></code></td></tr><tr class="miss"><td>626</td><td><code><pre>                klog.Error(&#34;Error fetching secret from store! Service does not exist:&#34;, secretKey)</pre></code></td></tr><tr class="miss"><td>627</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>628</td><td><code><pre>        }</pre></code></td></tr><tr><td>629</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>630</td><td><code><pre>        secret := secretInterface.(*v1.Secret)</pre></code></td></tr><tr class="miss"><td>631</td><td><code><pre>        return secret</pre></code></td></tr><tr><td>632</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetEndpointsForVirtualService">func Context.GetEndpointsForVirtualService</div><div class="info"><a href="#s_fn_Context.GetEndpointsForVirtualService">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>659</td><td><code><pre>func (c *Context) GetEndpointsForVirtualService(virtualService v1alpha3.VirtualService) v1.EndpointsList {</pre></code></td></tr><tr class="miss"><td>660</td><td><code><pre>        endpointList := make([]v1.Endpoints, 0)</pre></code></td></tr><tr class="miss"><td>661</td><td><code><pre>        namespace := virtualService.Namespace</pre></code></td></tr><tr class="miss"><td>662</td><td><code><pre>        for _, httpRouteRule := range virtualService.Spec.HTTP {</pre></code></td></tr><tr class="miss"><td>663</td><td><code><pre>                for _, route := range httpRouteRule.Route {</pre></code></td></tr><tr class="miss"><td>664</td><td><code><pre>                        serviceKey := fmt.Sprintf(&#34;%v/%v&#34;, namespace, route.Destination.Host)</pre></code></td></tr><tr class="miss"><td>665</td><td><code><pre>                        endpoint, err := c.GetEndpointsByService(serviceKey)</pre></code></td></tr><tr class="miss"><td>666</td><td><code><pre>                        if err == nil {</pre></code></td></tr><tr class="miss"><td>667</td><td><code><pre>                                endpointList = append(endpointList, *endpoint)</pre></code></td></tr><tr><td>668</td><td><code><pre>                        }</pre></code></td></tr><tr><td>669</td><td><code><pre>                }</pre></code></td></tr><tr><td>670</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>671</td><td><code><pre>        return v1.EndpointsList{</pre></code></td></tr><tr><td>672</td><td><code><pre>                Items: endpointList,</pre></code></td></tr><tr><td>673</td><td><code><pre>        }</pre></code></td></tr><tr><td>674</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.ListIstioGateways">func Context.ListIstioGateways</div><div class="info"><a href="#s_fn_Context.ListIstioGateways">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/istio_context.go</code>:</p></div><table class="listing">
<tr><td>11</td><td><code><pre>func (c *Context) ListIstioGateways() []*v1alpha3.Gateway {</pre></code></td></tr><tr class="miss"><td>12</td><td><code><pre>        var gateways []*v1alpha3.Gateway</pre></code></td></tr><tr class="miss"><td>13</td><td><code><pre>        for _, gateway := range c.Caches.IstioGateway.List() {</pre></code></td></tr><tr class="miss"><td>14</td><td><code><pre>                gway := gateway.(*v1alpha3.Gateway)</pre></code></td></tr><tr class="miss"><td>15</td><td><code><pre>                if _, exists := c.namespaces[gway.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>16</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>17</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>                gateways = append(gateways, gway)</pre></code></td></tr><tr><td>19</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>20</td><td><code><pre>        return gateways</pre></code></td></tr><tr><td>21</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.ListIstioVirtualServices">func Context.ListIstioVirtualServices</div><div class="info"><a href="#s_fn_Context.ListIstioVirtualServices">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/istio_context.go</code>:</p></div><table class="listing">
<tr><td>24</td><td><code><pre>func (c *Context) ListIstioVirtualServices() []*v1alpha3.VirtualService {</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>        var virtualServices []*v1alpha3.VirtualService</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>        for _, virtualService := range c.Caches.IstioVirtualService.List() {</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                vsvc := virtualService.(*v1alpha3.VirtualService)</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                if _, exists := c.namespaces[vsvc.Namespace]; len(c.namespaces) &gt; 0 &amp;&amp; !exists {</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>                        continue</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                virtualServices = append(virtualServices, vsvc)</pre></code></td></tr><tr><td>32</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>33</td><td><code><pre>        return virtualServices</pre></code></td></tr><tr><td>34</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetAGICPod">func Context.GetAGICPod</div><div class="info"><a href="#s_fn_Context.GetAGICPod">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>257</td><td><code><pre>func (c *Context) GetAGICPod(envVariables environment.EnvVariables) *v1.Pod {</pre></code></td></tr><tr class="miss"><td>258</td><td><code><pre>        pod, err := c.kubeClient.CoreV1().Pods(envVariables.AGICPodNamespace).Get(context.TODO(), envVariables.AGICPodName, metav1.GetOptions{})</pre></code></td></tr><tr class="miss"><td>259</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>260</td><td><code><pre>                klog.Error(&#34;Error fetching AGIC Pod (This may happen if AGIC is running in a test environment). Error: &#34;, err)</pre></code></td></tr><tr class="miss"><td>261</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>262</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>263</td><td><code><pre>        return pod</pre></code></td></tr><tr><td>264</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetGateways">func Context.GetGateways</div><div class="info"><a href="#s_fn_Context.GetGateways">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>677</td><td><code><pre>func (c *Context) GetGateways() []*v1alpha3.Gateway {</pre></code></td></tr><tr class="miss"><td>678</td><td><code><pre>        annotatedGateways := make([]*v1alpha3.Gateway, 0)</pre></code></td></tr><tr class="miss"><td>679</td><td><code><pre>        for _, gateway := range c.ListIstioGateways() {</pre></code></td></tr><tr class="miss"><td>680</td><td><code><pre>                if annotated := c.IsIstioGatewayIngress(gateway); annotated {</pre></code></td></tr><tr class="miss"><td>681</td><td><code><pre>                        annotatedGateways = append(annotatedGateways, gateway)</pre></code></td></tr><tr><td>682</td><td><code><pre>                }</pre></code></td></tr><tr><td>683</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>684</td><td><code><pre>        return annotatedGateways</pre></code></td></tr><tr><td>685</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Context.GetProhibitedTarget">func Context.GetProhibitedTarget</div><div class="info"><a href="#s_fn_Context.GetProhibitedTarget">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/context.go</code>:</p></div><table class="listing">
<tr><td>349</td><td><code><pre>func (c *Context) GetProhibitedTarget(namespace string, targetName string) *prohibitedv1.AzureIngressProhibitedTarget {</pre></code></td></tr><tr class="miss"><td>350</td><td><code><pre>        target, err := c.crdClient.AzureingressprohibitedtargetsV1().AzureIngressProhibitedTargets(namespace).Get(context.TODO(), targetName, metav1.GetOptions{})</pre></code></td></tr><tr class="miss"><td>351</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>352</td><td><code><pre>                klog.Error(&#34;Error fetching Azure ingress prohibired target resource, Error: &#34;, err)</pre></code></td></tr><tr class="miss"><td>353</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>354</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>355</td><td><code><pre>        return target</pre></code></td></tr><tr><td>356</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_@52:41">func @52:41</div><div class="info"><a href="#s_fn_@52:41">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/supported_apiversion.go</code>:</p></div><table class="listing">
<tr><td>52</td><td><code><pre>func() (utils.Retriable, error) {</pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>                serverVersion, err = client.Discovery().ServerVersion()</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>55</td><td><code><pre>                        klog.Warningf(&#34;Failed to get server version of the cluster: %s&#34;, err)</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                        return utils.Retriable(true), err</pre></code></td></tr><tr><td>57</td><td><code><pre>                } else {</pre></code></td></tr><tr class="miss"><td>58</td><td><code><pre>                        return false, err</pre></code></td></tr><tr><td>59</td><td><code><pre>                }</pre></code></td></tr><tr><td>60</td><td><code><pre>        }</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext DONE:45.20
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert <span class="packageTotal">50.39%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_fromExtensions"><td><code><a href="#fn_fromExtensions">fromExtensions(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_ingress.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend"><td><code><a href="#fn_autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend">autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus"><td><code><a href="#fn_autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus">autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_Convert_v1beta1_Ingress_To_networking_Ingress"><td><code><a href="#fn_Convert_v1beta1_Ingress_To_networking_Ingress">Convert_v1beta1_Ingress_To_networking_Ingress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue"><td><code><a href="#fn_Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue">Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath"><td><code><a href="#fn_Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath">Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressRule_To_networking_IngressRule"><td><code><a href="#fn_Convert_v1beta1_IngressRule_To_networking_IngressRule">Convert_v1beta1_IngressRule_To_networking_IngressRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue"><td><code><a href="#fn_Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue">Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressStatus_To_networking_IngressStatus"><td><code><a href="#fn_Convert_v1beta1_IngressStatus_To_networking_IngressStatus">Convert_v1beta1_IngressStatus_To_networking_IngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus"><td><code><a href="#fn_Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus">Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressBackend_To_networking_IngressBackend"><td><code><a href="#fn_Convert_v1beta1_IngressBackend_To_networking_IngressBackend">Convert_v1beta1_IngressBackend_To_networking_IngressBackend(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>87.50%</code></td><td class="linecount"><code>7/8</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec"><td><code><a href="#fn_autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec">autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>8/10</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath"><td><code><a href="#fn_autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath">autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>4/5</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue"><td><code><a href="#fn_autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue">autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>6/8</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressRule_To_networking_IngressRule"><td><code><a href="#fn_autoConvert_v1beta1_IngressRule_To_networking_IngressRule">autoConvert_v1beta1_IngressRule_To_networking_IngressRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressSpec_To_networking_IngressSpec"><td><code><a href="#fn_Convert_v1beta1_IngressSpec_To_networking_IngressSpec">Convert_v1beta1_IngressSpec_To_networking_IngressSpec(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>71.43%</code></td><td class="linecount"><code>5/7</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue"><td><code><a href="#fn_autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue">autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>71.43%</code></td><td class="linecount"><code>5/7</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_Ingress_To_networking_Ingress"><td><code><a href="#fn_autoConvert_v1beta1_Ingress_To_networking_Ingress">autoConvert_v1beta1_Ingress_To_networking_Ingress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>4/6</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus"><td><code><a href="#fn_autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus">autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>66.67%</code></td><td class="linecount"><code>2/3</code></td></tr>
<tr id="s_fn_ToIngressV1"><td><code><a href="#fn_ToIngressV1">ToIngressV1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_ingress.go</code></td><td class="percent"><code>50.00%</code></td><td class="linecount"><code>5/10</code></td></tr>
<tr id="s_fn_FromMultiClusterService"><td><code><a href="#fn_FromMultiClusterService">FromMultiClusterService(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_service.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/18</code></td></tr>
<tr id="s_fn_FromMultiClusterIngress"><td><code><a href="#fn_FromMultiClusterIngress">FromMultiClusterIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_ingress.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/13</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressList_To_networking_IngressList"><td><code><a href="#fn_autoConvert_v1beta1_IngressList_To_networking_IngressList">autoConvert_v1beta1_IngressList_To_networking_IngressList(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/9</code></td></tr>
<tr id="s_fn_autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS"><td><code><a href="#fn_autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS">autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressTLS_To_networking_IngressTLS"><td><code><a href="#fn_Convert_v1beta1_IngressTLS_To_networking_IngressTLS">Convert_v1beta1_IngressTLS_To_networking_IngressTLS(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_Convert_v1beta1_IngressList_To_networking_IngressList"><td><code><a href="#fn_Convert_v1beta1_IngressList_To_networking_IngressList">Convert_v1beta1_IngressList_To_networking_IngressList(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert</code></td><td class="percent"><code>50.39%</code></td><td class="linecount"><code>65/129</code></td></tr>
</table>

<div class="funcname" id="fn_fromExtensions">func fromExtensions</div><div class="info"><a href="#s_fn_fromExtensions">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_ingress.go</code>:</p></div><table class="listing">
<tr><td>10</td><td><code><pre>func fromExtensions(old *extensionsv1beta1.Ingress) (*networkingv1.Ingress, error) {</pre></code></td></tr><tr><td>11</td><td><code><pre>        v1Ing := &amp;networkingv1.Ingress{}</pre></code></td></tr><tr><td>12</td><td><code><pre>        err := Convert_v1beta1_Ingress_To_networking_Ingress(old, v1Ing, nil)</pre></code></td></tr><tr><td>13</td><td><code><pre>        v1Ing.APIVersion = networkingv1.SchemeGroupVersion.String()</pre></code></td></tr><tr><td>14</td><td><code><pre>        v1Ing.Kind = &#34;Ingress&#34;</pre></code></td></tr><tr><td>15</td><td><code><pre>        return v1Ing, err</pre></code></td></tr><tr><td>16</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend">func autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>83</td><td><code><pre>func autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend(in *v1beta1.IngressBackend, out *networking.IngressBackend, s conversion.Scope) error {</pre></code></td></tr><tr><td>84</td><td><code><pre>        // WARNING: in.ServiceName requires manual conversion: does not exist in peer-type</pre></code></td></tr><tr><td>85</td><td><code><pre>        // WARNING: in.ServicePort requires manual conversion: does not exist in peer-type</pre></code></td></tr><tr><td>86</td><td><code><pre>        out.Resource = (*core.TypedLocalObjectReference)(unsafe.Pointer(in.Resource))</pre></code></td></tr><tr><td>87</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>88</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus">func autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus</div><div class="info"><a href="#s_fn_autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>216</td><td><code><pre>func autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus(in *core.LoadBalancerStatus, out *core.LoadBalancerStatus, s conversion.Scope) error {</pre></code></td></tr><tr><td>217</td><td><code><pre>        out.Ingress = *(*[]core.LoadBalancerIngress)(unsafe.Pointer(&amp;in.Ingress))</pre></code></td></tr><tr><td>218</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>219</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_Ingress_To_networking_Ingress">func Convert_v1beta1_Ingress_To_networking_Ingress</div><div class="info"><a href="#s_fn_Convert_v1beta1_Ingress_To_networking_Ingress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>79</td><td><code><pre>func Convert_v1beta1_Ingress_To_networking_Ingress(in *v1beta1.Ingress, out *networking.Ingress, s conversion.Scope) error {</pre></code></td></tr><tr><td>80</td><td><code><pre>        return autoConvert_v1beta1_Ingress_To_networking_Ingress(in, out, s)</pre></code></td></tr><tr><td>81</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue">func Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>152</td><td><code><pre>func Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue(in *v1beta1.IngressRuleValue, out *networking.IngressRuleValue, s conversion.Scope) error {</pre></code></td></tr><tr><td>153</td><td><code><pre>        return autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue(in, out, s)</pre></code></td></tr><tr><td>154</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath">func Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath</div><div class="info"><a href="#s_fn_Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>43</td><td><code><pre>func Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath(in *v1beta1.HTTPIngressPath, out *networking.HTTPIngressPath, s conversion.Scope) error {</pre></code></td></tr><tr><td>44</td><td><code><pre>        return autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath(in, out, s)</pre></code></td></tr><tr><td>45</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressRule_To_networking_IngressRule">func Convert_v1beta1_IngressRule_To_networking_IngressRule</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressRule_To_networking_IngressRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>134</td><td><code><pre>func Convert_v1beta1_IngressRule_To_networking_IngressRule(in *v1beta1.IngressRule, out *networking.IngressRule, s conversion.Scope) error {</pre></code></td></tr><tr><td>135</td><td><code><pre>        return autoConvert_v1beta1_IngressRule_To_networking_IngressRule(in, out, s)</pre></code></td></tr><tr><td>136</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue">func Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue</div><div class="info"><a href="#s_fn_Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>63</td><td><code><pre>func Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue(in *v1beta1.HTTPIngressRuleValue, out *networking.HTTPIngressRuleValue, s conversion.Scope) error {</pre></code></td></tr><tr><td>64</td><td><code><pre>        return autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue(in, out, s)</pre></code></td></tr><tr><td>65</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressStatus_To_networking_IngressStatus">func Convert_v1beta1_IngressStatus_To_networking_IngressStatus</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressStatus_To_networking_IngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>196</td><td><code><pre>func Convert_v1beta1_IngressStatus_To_networking_IngressStatus(in *v1beta1.IngressStatus, out *networking.IngressStatus, s conversion.Scope) error {</pre></code></td></tr><tr><td>197</td><td><code><pre>        return autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus(in, out, s)</pre></code></td></tr><tr><td>198</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus">func Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus</div><div class="info"><a href="#s_fn_Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>212</td><td><code><pre>func Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus(in *core.LoadBalancerStatus, out *core.LoadBalancerStatus, s conversion.Scope) error {</pre></code></td></tr><tr><td>213</td><td><code><pre>        return autoConvert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus(in, out, s)</pre></code></td></tr><tr><td>214</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressBackend_To_networking_IngressBackend">func Convert_v1beta1_IngressBackend_To_networking_IngressBackend</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressBackend_To_networking_IngressBackend">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>91</td><td><code><pre>func Convert_v1beta1_IngressBackend_To_networking_IngressBackend(in *v1beta1.IngressBackend, out *networking.IngressBackend, s conversion.Scope) error {</pre></code></td></tr><tr><td>92</td><td><code><pre>        if err := autoConvert_v1beta1_IngressBackend_To_networking_IngressBackend(in, out, s); err != nil {</pre></code></td></tr><tr class="miss"><td>93</td><td><code><pre>                return err</pre></code></td></tr><tr><td>94</td><td><code><pre>        }</pre></code></td></tr><tr><td>95</td><td><code><pre>        if len(in.ServiceName) &gt; 0 || in.ServicePort.IntVal != 0 || in.ServicePort.StrVal != &#34;&#34; || in.ServicePort.Type == intstr.String {</pre></code></td></tr><tr><td>96</td><td><code><pre>                out.Service = &amp;networking.IngressServiceBackend{}</pre></code></td></tr><tr><td>97</td><td><code><pre>                out.Service.Name = in.ServiceName</pre></code></td></tr><tr><td>98</td><td><code><pre>                out.Service.Port.Name = in.ServicePort.StrVal</pre></code></td></tr><tr><td>99</td><td><code><pre>                out.Service.Port.Number = in.ServicePort.IntVal</pre></code></td></tr><tr><td>100</td><td><code><pre>        }</pre></code></td></tr><tr><td>101</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>102</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec">func autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>170</td><td><code><pre>func autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec(in *v1beta1.IngressSpec, out *networking.IngressSpec, s conversion.Scope) error {</pre></code></td></tr><tr><td>171</td><td><code><pre>        out.IngressClassName = (*string)(unsafe.Pointer(in.IngressClassName))</pre></code></td></tr><tr><td>172</td><td><code><pre>        // WARNING: in.Backend requires manual conversion: does not exist in peer-type</pre></code></td></tr><tr><td>173</td><td><code><pre>        out.TLS = *(*[]networking.IngressTLS)(unsafe.Pointer(&amp;in.TLS))</pre></code></td></tr><tr><td>174</td><td><code><pre>        if in.Rules != nil {</pre></code></td></tr><tr><td>175</td><td><code><pre>                in, out := &amp;in.Rules, &amp;out.Rules</pre></code></td></tr><tr><td>176</td><td><code><pre>                *out = make([]networking.IngressRule, len(*in))</pre></code></td></tr><tr><td>177</td><td><code><pre>                for i := range *in {</pre></code></td></tr><tr><td>178</td><td><code><pre>                        if err := Convert_v1beta1_IngressRule_To_networking_IngressRule(&amp;(*in)[i], &amp;(*out)[i], s); err != nil {</pre></code></td></tr><tr class="miss"><td>179</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>180</td><td><code><pre>                        }</pre></code></td></tr><tr><td>181</td><td><code><pre>                }</pre></code></td></tr><tr><td>182</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>183</td><td><code><pre>                out.Rules = nil</pre></code></td></tr><tr><td>184</td><td><code><pre>        }</pre></code></td></tr><tr><td>185</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>186</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath">func autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>33</td><td><code><pre>func autoConvert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath(in *v1beta1.HTTPIngressPath, out *networking.HTTPIngressPath, s conversion.Scope) error {</pre></code></td></tr><tr><td>34</td><td><code><pre>        out.Path = in.Path</pre></code></td></tr><tr><td>35</td><td><code><pre>        out.PathType = (*networking.PathType)(unsafe.Pointer(in.PathType))</pre></code></td></tr><tr><td>36</td><td><code><pre>        if err := Convert_v1beta1_IngressBackend_To_networking_IngressBackend(&amp;in.Backend, &amp;out.Backend, s); err != nil {</pre></code></td></tr><tr class="miss"><td>37</td><td><code><pre>                return err</pre></code></td></tr><tr><td>38</td><td><code><pre>        }</pre></code></td></tr><tr><td>39</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>40</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue">func autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>47</td><td><code><pre>func autoConvert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue(in *v1beta1.HTTPIngressRuleValue, out *networking.HTTPIngressRuleValue, s conversion.Scope) error {</pre></code></td></tr><tr><td>48</td><td><code><pre>        if in.Paths != nil {</pre></code></td></tr><tr><td>49</td><td><code><pre>                in, out := &amp;in.Paths, &amp;out.Paths</pre></code></td></tr><tr><td>50</td><td><code><pre>                *out = make([]networking.HTTPIngressPath, len(*in))</pre></code></td></tr><tr><td>51</td><td><code><pre>                for i := range *in {</pre></code></td></tr><tr><td>52</td><td><code><pre>                        if err := Convert_v1beta1_HTTPIngressPath_To_networking_HTTPIngressPath(&amp;(*in)[i], &amp;(*out)[i], s); err != nil {</pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>54</td><td><code><pre>                        }</pre></code></td></tr><tr><td>55</td><td><code><pre>                }</pre></code></td></tr><tr><td>56</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>                out.Paths = nil</pre></code></td></tr><tr><td>58</td><td><code><pre>        }</pre></code></td></tr><tr><td>59</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>60</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressRule_To_networking_IngressRule">func autoConvert_v1beta1_IngressRule_To_networking_IngressRule</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressRule_To_networking_IngressRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>125</td><td><code><pre>func autoConvert_v1beta1_IngressRule_To_networking_IngressRule(in *v1beta1.IngressRule, out *networking.IngressRule, s conversion.Scope) error {</pre></code></td></tr><tr><td>126</td><td><code><pre>        out.Host = in.Host</pre></code></td></tr><tr><td>127</td><td><code><pre>        if err := Convert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue(&amp;in.IngressRuleValue, &amp;out.IngressRuleValue, s); err != nil {</pre></code></td></tr><tr class="miss"><td>128</td><td><code><pre>                return err</pre></code></td></tr><tr><td>129</td><td><code><pre>        }</pre></code></td></tr><tr><td>130</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>131</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressSpec_To_networking_IngressSpec">func Convert_v1beta1_IngressSpec_To_networking_IngressSpec</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressSpec_To_networking_IngressSpec">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>157</td><td><code><pre>func Convert_v1beta1_IngressSpec_To_networking_IngressSpec(in *v1beta1.IngressSpec, out *networking.IngressSpec, s conversion.Scope) error {</pre></code></td></tr><tr><td>158</td><td><code><pre>        if err := autoConvert_v1beta1_IngressSpec_To_networking_IngressSpec(in, out, s); err != nil {</pre></code></td></tr><tr class="miss"><td>159</td><td><code><pre>                return nil</pre></code></td></tr><tr><td>160</td><td><code><pre>        }</pre></code></td></tr><tr><td>161</td><td><code><pre>        if in.Backend != nil {</pre></code></td></tr><tr><td>162</td><td><code><pre>                out.DefaultBackend = &amp;networking.IngressBackend{}</pre></code></td></tr><tr><td>163</td><td><code><pre>                if err := Convert_v1beta1_IngressBackend_To_networking_IngressBackend(in.Backend, out.DefaultBackend, s); err != nil {</pre></code></td></tr><tr class="miss"><td>164</td><td><code><pre>                        return err</pre></code></td></tr><tr><td>165</td><td><code><pre>                }</pre></code></td></tr><tr><td>166</td><td><code><pre>        }</pre></code></td></tr><tr><td>167</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>168</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue">func autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>138</td><td><code><pre>func autoConvert_v1beta1_IngressRuleValue_To_networking_IngressRuleValue(in *v1beta1.IngressRuleValue, out *networking.IngressRuleValue, s conversion.Scope) error {</pre></code></td></tr><tr><td>139</td><td><code><pre>        if in.HTTP != nil {</pre></code></td></tr><tr><td>140</td><td><code><pre>                in, out := &amp;in.HTTP, &amp;out.HTTP</pre></code></td></tr><tr><td>141</td><td><code><pre>                *out = new(networking.HTTPIngressRuleValue)</pre></code></td></tr><tr><td>142</td><td><code><pre>                if err := Convert_v1beta1_HTTPIngressRuleValue_To_networking_HTTPIngressRuleValue(*in, *out, s); err != nil {</pre></code></td></tr><tr class="miss"><td>143</td><td><code><pre>                        return err</pre></code></td></tr><tr><td>144</td><td><code><pre>                }</pre></code></td></tr><tr><td>145</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>146</td><td><code><pre>                out.HTTP = nil</pre></code></td></tr><tr><td>147</td><td><code><pre>        }</pre></code></td></tr><tr><td>148</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>149</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_Ingress_To_networking_Ingress">func autoConvert_v1beta1_Ingress_To_networking_Ingress</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_Ingress_To_networking_Ingress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>67</td><td><code><pre>func autoConvert_v1beta1_Ingress_To_networking_Ingress(in *v1beta1.Ingress, out *networking.Ingress, s conversion.Scope) error {</pre></code></td></tr><tr><td>68</td><td><code><pre>        out.ObjectMeta = in.ObjectMeta</pre></code></td></tr><tr><td>69</td><td><code><pre>        if err := Convert_v1beta1_IngressSpec_To_networking_IngressSpec(&amp;in.Spec, &amp;out.Spec, s); err != nil {</pre></code></td></tr><tr class="miss"><td>70</td><td><code><pre>                return err</pre></code></td></tr><tr><td>71</td><td><code><pre>        }</pre></code></td></tr><tr><td>72</td><td><code><pre>        if err := Convert_v1beta1_IngressStatus_To_networking_IngressStatus(&amp;in.Status, &amp;out.Status, s); err != nil {</pre></code></td></tr><tr class="miss"><td>73</td><td><code><pre>                return err</pre></code></td></tr><tr><td>74</td><td><code><pre>        }</pre></code></td></tr><tr><td>75</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>76</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus">func autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>188</td><td><code><pre>func autoConvert_v1beta1_IngressStatus_To_networking_IngressStatus(in *v1beta1.IngressStatus, out *networking.IngressStatus, s conversion.Scope) error {</pre></code></td></tr><tr><td>189</td><td><code><pre>        if err := Convert_v1_LoadBalancerStatus_To_core_LoadBalancerStatus(&amp;in.LoadBalancer, &amp;out.LoadBalancer, s); err != nil {</pre></code></td></tr><tr class="miss"><td>190</td><td><code><pre>                return err</pre></code></td></tr><tr><td>191</td><td><code><pre>        }</pre></code></td></tr><tr><td>192</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>193</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_ToIngressV1">func ToIngressV1</div><div class="info"><a href="#s_fn_ToIngressV1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_ingress.go</code>:</p></div><table class="listing">
<tr><td>19</td><td><code><pre>func ToIngressV1(obj interface{}) (*networkingv1.Ingress, bool) {</pre></code></td></tr><tr><td>20</td><td><code><pre>        oldVersion, inExtension := obj.(*extensionsv1beta1.Ingress)</pre></code></td></tr><tr><td>21</td><td><code><pre>        if inExtension {</pre></code></td></tr><tr><td>22</td><td><code><pre>                ing, err := fromExtensions(oldVersion)</pre></code></td></tr><tr><td>23</td><td><code><pre>                if err != nil {</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>                        klog.Errorf(&#34;unexpected error converting Ingress from extensions package: %v&#34;, err)</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                        return nil, false</pre></code></td></tr><tr><td>26</td><td><code><pre>                }</pre></code></td></tr><tr><td>27</td><td><code><pre></pre></code></td></tr><tr><td>28</td><td><code><pre>                return ing, true</pre></code></td></tr><tr><td>29</td><td><code><pre>        }</pre></code></td></tr><tr><td>30</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>        if ing, ok := obj.(*networkingv1.Ingress); ok {</pre></code></td></tr><tr class="miss"><td>32</td><td><code><pre>                return ing, true</pre></code></td></tr><tr><td>33</td><td><code><pre>        }</pre></code></td></tr><tr><td>34</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>        return nil, false</pre></code></td></tr><tr><td>36</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FromMultiClusterService">func FromMultiClusterService</div><div class="info"><a href="#s_fn_FromMultiClusterService">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_service.go</code>:</p></div><table class="listing">
<tr><td>10</td><td><code><pre>func FromMultiClusterService(gs *multiclusterservice.MultiClusterService) (*v1.Service, bool) {</pre></code></td></tr><tr class="miss"><td>11</td><td><code><pre>        if gs == nil {</pre></code></td></tr><tr class="miss"><td>12</td><td><code><pre>                return nil, false</pre></code></td></tr><tr><td>13</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>14</td><td><code><pre>        v1Serv := &amp;v1.Service{}</pre></code></td></tr><tr><td>15</td><td><code><pre>        //copy over metadata</pre></code></td></tr><tr class="miss"><td>16</td><td><code><pre>        v1Serv.ObjectMeta = gs.ObjectMeta</pre></code></td></tr><tr class="miss"><td>17</td><td><code><pre>        v1Serv.ClusterName = gs.ClusterName</pre></code></td></tr><tr class="miss"><td>18</td><td><code><pre>        v1Serv.Labels = gs.Labels</pre></code></td></tr><tr class="miss"><td>19</td><td><code><pre>        v1Serv.Annotations = gs.Annotations</pre></code></td></tr><tr><td>20</td><td><code><pre></pre></code></td></tr><tr><td>21</td><td><code><pre>        //copy over spec</pre></code></td></tr><tr class="miss"><td>22</td><td><code><pre>        v1Serv.Spec.Selector = gs.Spec.Selector.MatchLabels</pre></code></td></tr><tr class="miss"><td>23</td><td><code><pre>        for _, port := range gs.Spec.Ports {</pre></code></td></tr><tr class="miss"><td>24</td><td><code><pre>                servicePort := v1.ServicePort{}</pre></code></td></tr><tr class="miss"><td>25</td><td><code><pre>                servicePort.Name = port.Name</pre></code></td></tr><tr class="miss"><td>26</td><td><code><pre>                servicePort.Protocol = v1.Protocol(port.Protocol)</pre></code></td></tr><tr class="miss"><td>27</td><td><code><pre>                servicePort.Port = int32(port.Port)</pre></code></td></tr><tr class="miss"><td>28</td><td><code><pre>                servicePort.TargetPort = intstr.IntOrString{</pre></code></td></tr><tr><td>29</td><td><code><pre>                        IntVal: int32(port.TargetPort),</pre></code></td></tr><tr><td>30</td><td><code><pre>                }</pre></code></td></tr><tr class="miss"><td>31</td><td><code><pre>                v1Serv.Spec.Ports = append(v1Serv.Spec.Ports, servicePort)</pre></code></td></tr><tr><td>32</td><td><code><pre>        }</pre></code></td></tr><tr><td>33</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>34</td><td><code><pre>        v1Serv.APIVersion = v1.SchemeGroupVersion.String()</pre></code></td></tr><tr class="miss"><td>35</td><td><code><pre>        v1Serv.Kind = &#34;Service&#34;</pre></code></td></tr><tr class="miss"><td>36</td><td><code><pre>        return v1Serv, true</pre></code></td></tr><tr><td>37</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FromMultiClusterIngress">func FromMultiClusterIngress</div><div class="info"><a href="#s_fn_FromMultiClusterIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/conversion_ingress.go</code>:</p></div><table class="listing">
<tr><td>39</td><td><code><pre>func FromMultiClusterIngress(mci *multiClusterIngress.MultiClusterIngress) (*networkingv1.Ingress, bool) {</pre></code></td></tr><tr class="miss"><td>40</td><td><code><pre>        if mci == nil {</pre></code></td></tr><tr class="miss"><td>41</td><td><code><pre>                klog.Errorf(&#34;Unexpected, attempted converting nil MultiClusterIngresss to Ingress&#34;)</pre></code></td></tr><tr class="miss"><td>42</td><td><code><pre>                return nil, false</pre></code></td></tr><tr><td>43</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>        v1Ing := &amp;networkingv1.Ingress{}</pre></code></td></tr><tr><td>45</td><td><code><pre>        // remove last applied config, object model does not match</pre></code></td></tr><tr class="miss"><td>46</td><td><code><pre>        for k := range mci.ObjectMeta.Annotations {</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                if k == &#34;kubectl.kubernetes.io/last-applied-configuration&#34; {</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>                        delete(mci.ObjectMeta.Annotations, k)</pre></code></td></tr><tr><td>49</td><td><code><pre>                }</pre></code></td></tr><tr><td>50</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>51</td><td><code><pre>        mci.ObjectMeta.DeepCopyInto(&amp;v1Ing.ObjectMeta)</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>        mci.Spec.Template.DeepCopyInto(&amp;v1Ing.Spec)</pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>        mci.Status.DeepCopyInto(&amp;v1Ing.Status)</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>55</td><td><code><pre>        v1Ing.APIVersion = networkingv1.SchemeGroupVersion.String()</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>        v1Ing.Kind = &#34;Ingress&#34;</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>        return v1Ing, true</pre></code></td></tr><tr><td>58</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressList_To_networking_IngressList">func autoConvert_v1beta1_IngressList_To_networking_IngressList</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressList_To_networking_IngressList">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>104</td><td><code><pre>func autoConvert_v1beta1_IngressList_To_networking_IngressList(in *v1beta1.IngressList, out *networking.IngressList, s conversion.Scope) error {</pre></code></td></tr><tr class="miss"><td>105</td><td><code><pre>        out.ListMeta = in.ListMeta</pre></code></td></tr><tr class="miss"><td>106</td><td><code><pre>        if in.Items != nil {</pre></code></td></tr><tr class="miss"><td>107</td><td><code><pre>                in, out := &amp;in.Items, &amp;out.Items</pre></code></td></tr><tr class="miss"><td>108</td><td><code><pre>                *out = make([]networking.Ingress, len(*in))</pre></code></td></tr><tr class="miss"><td>109</td><td><code><pre>                for i := range *in {</pre></code></td></tr><tr class="miss"><td>110</td><td><code><pre>                        if err := Convert_v1beta1_Ingress_To_networking_Ingress(&amp;(*in)[i], &amp;(*out)[i], s); err != nil {</pre></code></td></tr><tr class="miss"><td>111</td><td><code><pre>                                return err</pre></code></td></tr><tr><td>112</td><td><code><pre>                        }</pre></code></td></tr><tr><td>113</td><td><code><pre>                }</pre></code></td></tr><tr><td>114</td><td><code><pre>        } else {</pre></code></td></tr><tr class="miss"><td>115</td><td><code><pre>                out.Items = nil</pre></code></td></tr><tr><td>116</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>117</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>118</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS">func autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS</div><div class="info"><a href="#s_fn_autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>200</td><td><code><pre>func autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS(in *v1beta1.IngressTLS, out *networking.IngressTLS, s conversion.Scope) error {</pre></code></td></tr><tr class="miss"><td>201</td><td><code><pre>        out.Hosts = *(*[]string)(unsafe.Pointer(&amp;in.Hosts))</pre></code></td></tr><tr class="miss"><td>202</td><td><code><pre>        out.SecretName = in.SecretName</pre></code></td></tr><tr class="miss"><td>203</td><td><code><pre>        return nil</pre></code></td></tr><tr><td>204</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressTLS_To_networking_IngressTLS">func Convert_v1beta1_IngressTLS_To_networking_IngressTLS</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressTLS_To_networking_IngressTLS">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>207</td><td><code><pre>func Convert_v1beta1_IngressTLS_To_networking_IngressTLS(in *v1beta1.IngressTLS, out *networking.IngressTLS, s conversion.Scope) error {</pre></code></td></tr><tr class="miss"><td>208</td><td><code><pre>        return autoConvert_v1beta1_IngressTLS_To_networking_IngressTLS(in, out, s)</pre></code></td></tr><tr><td>209</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Convert_v1beta1_IngressList_To_networking_IngressList">func Convert_v1beta1_IngressList_To_networking_IngressList</div><div class="info"><a href="#s_fn_Convert_v1beta1_IngressList_To_networking_IngressList">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/k8scontext/convert/zz_generated.conversion.go</code>:</p></div><table class="listing">
<tr><td>121</td><td><code><pre>func Convert_v1beta1_IngressList_To_networking_IngressList(in *v1beta1.IngressList, out *networking.IngressList, s conversion.Scope) error {</pre></code></td></tr><tr class="miss"><td>122</td><td><code><pre>        return autoConvert_v1beta1_IngressList_To_networking_IngressList(in, out, s)</pre></code></td></tr><tr><td>123</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/k8scontext/convert DONE:50.39
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests <span class="packageTotal">60.00%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_GetIngressV1FromFile"><td><code><a href="#fn_GetIngressV1FromFile">GetIngressV1FromFile(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_NewSecretTestFixture"><td><code><a href="#fn_NewSecretTestFixture">NewSecretTestFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_NewServicePortsFixture"><td><code><a href="#fn_NewServicePortsFixture">NewServicePortsFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_NewIngressTestFixtureBasic"><td><code><a href="#fn_NewIngressTestFixtureBasic">NewIngressTestFixtureBasic(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_NewIngressFixture"><td><code><a href="#fn_NewIngressFixture">NewIngressFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_NewIngressTestFixture"><td><code><a href="#fn_NewIngressTestFixture">NewIngressTestFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewEndpointsFixture"><td><code><a href="#fn_NewEndpointsFixture">NewEndpointsFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetIngressComplex"><td><code><a href="#fn_GetIngressComplex">GetIngressComplex(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewPodTestFixture"><td><code><a href="#fn_NewPodTestFixture">NewPodTestFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetApplicationGatewayBackendAddressPool"><td><code><a href="#fn_GetApplicationGatewayBackendAddressPool">GetApplicationGatewayBackendAddressPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewIngressBackendFixture"><td><code><a href="#fn_NewIngressBackendFixture">NewIngressBackendFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewIngressRuleFixture"><td><code><a href="#fn_NewIngressRuleFixture">NewIngressRuleFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetIngress"><td><code><a href="#fn_GetIngress">GetIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewProbeFixture"><td><code><a href="#fn_NewProbeFixture">NewProbeFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewServiceFixture"><td><code><a href="#fn_NewServiceFixture">NewServiceFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewPodFixture"><td><code><a href="#fn_NewPodFixture">NewPodFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetIngressNamespaced"><td><code><a href="#fn_GetIngressNamespaced">GetIngressNamespaced(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>71.43%</code></td><td class="linecount"><code>5/7</code></td></tr>
<tr id="s_fn_GetIngressV1Beta1FromFile"><td><code><a href="#fn_GetIngressV1Beta1FromFile">GetIngressV1Beta1FromFile(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/7</code></td></tr>
<tr id="s_fn_NewIngressRuleWithPathsFixture"><td><code><a href="#fn_NewIngressRuleWithPathsFixture">NewIngressRuleWithPathsFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_NewIngressTestWithVariousPathTypeFixture"><td><code><a href="#fn_NewIngressTestWithVariousPathTypeFixture">NewIngressTestWithVariousPathTypeFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/4</code></td></tr>
<tr id="s_fn_NewIngressFixtureSingleSlashPath"><td><code><a href="#fn_NewIngressFixtureSingleSlashPath">NewIngressFixtureSingleSlashPath(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/3</code></td></tr>
<tr id="s_fn_GetIngressWithMissingServiceAndServiceWithInvalidPort"><td><code><a href="#fn_GetIngressWithMissingServiceAndServiceWithInvalidPort">GetIngressWithMissingServiceAndServiceWithInvalidPort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/2</code></td></tr>
<tr id="s_fn_NewEndpointsFixtureWithSameNameMultiplePorts"><td><code><a href="#fn_NewEndpointsFixtureWithSameNameMultiplePorts">NewEndpointsFixtureWithSameNameMultiplePorts(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_NewPodHTTPSFixture"><td><code><a href="#fn_NewPodHTTPSFixture">NewPodHTTPSFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_NewHTTPSProbeFixture"><td><code><a href="#fn_NewHTTPSProbeFixture">NewHTTPSProbeFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_NewRewriteRuleSetCustomResourceFixture"><td><code><a href="#fn_NewRewriteRuleSetCustomResourceFixture">NewRewriteRuleSetCustomResourceFixture(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_GetVerySimpleIngress"><td><code><a href="#fn_GetVerySimpleIngress">GetVerySimpleIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_GetIngressClass"><td><code><a href="#fn_GetIngressClass">GetIngressClass(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests</code></td><td class="percent"><code>60.00%</code></td><td class="linecount"><code>42/70</code></td></tr>
</table>

<div class="funcname" id="fn_GetIngressV1FromFile">func GetIngressV1FromFile</div><div class="info"><a href="#s_fn_GetIngressV1FromFile">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>152</td><td><code><pre>func GetIngressV1FromFile(fileName string) (*networking.Ingress, error) {</pre></code></td></tr><tr><td>153</td><td><code><pre>        ingr, err := ioutil.ReadFile(fileName)</pre></code></td></tr><tr><td>154</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>155</td><td><code><pre>                fmt.Print(err)</pre></code></td></tr><tr><td>156</td><td><code><pre>        }</pre></code></td></tr><tr><td>157</td><td><code><pre></pre></code></td></tr><tr><td>158</td><td><code><pre>        obj, _, err := scheme.Codecs.UniversalDeserializer().Decode(ingr, nil, nil)</pre></code></td></tr><tr><td>159</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr><td>160</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>161</td><td><code><pre>        }</pre></code></td></tr><tr><td>162</td><td><code><pre>        return obj.(*networking.Ingress), nil</pre></code></td></tr><tr><td>163</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewSecretTestFixture">func NewSecretTestFixture</div><div class="info"><a href="#s_fn_NewSecretTestFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>923</td><td><code><pre>func NewSecretTestFixture() *v1.Secret {</pre></code></td></tr><tr><td>924</td><td><code><pre>        secret := &amp;v1.Secret{</pre></code></td></tr><tr><td>925</td><td><code><pre>                Type: &#34;kubernetes.io/tls&#34;,</pre></code></td></tr><tr><td>926</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>927</td><td><code><pre>                        Name:      NameOfSecret,</pre></code></td></tr><tr><td>928</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>929</td><td><code><pre>                },</pre></code></td></tr><tr><td>930</td><td><code><pre>                Data: make(map[string][]byte),</pre></code></td></tr><tr><td>931</td><td><code><pre>        }</pre></code></td></tr><tr><td>932</td><td><code><pre></pre></code></td></tr><tr><td>933</td><td><code><pre>        tlsKey := &#34;tls.key&#34;</pre></code></td></tr><tr><td>934</td><td><code><pre>        tlsCrt := &#34;tls.crt&#34;</pre></code></td></tr><tr><td>935</td><td><code><pre></pre></code></td></tr><tr><td>936</td><td><code><pre>        secret.Data[tlsKey] = []byte(&#34;-----BEGIN PRIVATE KEY-----\n&#34; +</pre></code></td></tr><tr><td>937</td><td><code><pre>                &#34;MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDFEs4opOIMHYna\n&#34; +</pre></code></td></tr><tr><td>938</td><td><code><pre>                &#34;wMio1JHZaQWDZEP8fsL23Rozhow0vVokthPk4wGBKYpc8XYBbWFs5pUuExeOjeRW\n&#34; +</pre></code></td></tr><tr><td>939</td><td><code><pre>                &#34;jdNArwn5jCZYaxtqfdrj2kLHFHPCTwmbzn+qvPkvp/ZJyeY+4eIe7soGzO6hoj/w\n&#34; +</pre></code></td></tr><tr><td>940</td><td><code><pre>                &#34;HHdry7rPiap5R5EMfHzfl1TZ5WfixqnxKVEc33VRD9xwQIHwJTGnoI2bTGK3vK5q\n&#34; +</pre></code></td></tr><tr><td>941</td><td><code><pre>                &#34;90Glxyc4FAqo6xBguo6ZfOCqPYHXAKtaMj5hcr2dA0/7rJ/xNthDdnQwhETU2BgQ\n&#34; +</pre></code></td></tr><tr><td>942</td><td><code><pre>                &#34;9PvqfuMif+r/VM4KmYjQYu6+NN8VDVq6eSx4dxIzqWZ/NdSeoIri+6Gpa0AncMrq\n&#34; +</pre></code></td></tr><tr><td>943</td><td><code><pre>                &#34;3t7OjuQjAgMBAAECggEAKfzOtbQjgSdN9rB6UBYyGNsaVJspLQOo8EW9TlsNRjNN\n&#34; +</pre></code></td></tr><tr><td>944</td><td><code><pre>                &#34;oGK2rF59NJKwKws69CTky/n4sL9aloG+s342EyL4AhYNGWuAhNjZqRAYiCfgXfbO\n&#34; +</pre></code></td></tr><tr><td>945</td><td><code><pre>                &#34;+kYtxyfKA5BKlgARMTaZIbQIkRhag095ReQawXm/jHYtPvezfLCNPmoUpvQMhTEk\n&#34; +</pre></code></td></tr><tr><td>946</td><td><code><pre>                &#34;jzhhB7Ao5JPkw6jjnYa4raETYR3LTdFwhfU1WecEJ+Mj1hGX8ANC8cdHYxvkomcl\n&#34; +</pre></code></td></tr><tr><td>947</td><td><code><pre>                &#34;/ucl99siNJKYHZ6wWXpLRICZyTyLCcCnICj2g/+8BiV9pokrUHYW5diLDN4UBHnQ\n&#34; +</pre></code></td></tr><tr><td>948</td><td><code><pre>                &#34;Qe2LZnC+hIU8Vvq2z9Wy8tF8Z2LMmswK+kIff7tNuQKBgQDxil1AaMSCAbTecErf\n&#34; +</pre></code></td></tr><tr><td>949</td><td><code><pre>                &#34;RJkK81YvtMvM5ha2lhHOdnGvl/aVMdQ1rAkklGXMbIz/e87gOR3PfbmY67QR9aEz\n&#34; +</pre></code></td></tr><tr><td>950</td><td><code><pre>                &#34;CTXjfWG6J5Ri99kEn3af3AOrbJ6dbgaZWKwvtuDfXciuFo+0K5eQcC6r5Cr5Wjs3\n&#34; +</pre></code></td></tr><tr><td>951</td><td><code><pre>                &#34;DAnYWMGz9sUyMg0s6OWqifLMjQKBgQDQ3vqOXVzjRbvhyq/QWerl/x3jUIs/fY3e\n&#34; +</pre></code></td></tr><tr><td>952</td><td><code><pre>                &#34;6IAcf7jyihvQWAX361yjQig8n8D6XcPo1GKmKr93ra7cVdH3eQ1ICG9KzfMyG0PQ\n&#34; +</pre></code></td></tr><tr><td>953</td><td><code><pre>                &#34;H6qkft19BAwsCK687LeotTGX4qXavXG9AP8tLyq8WRGdmQPStpses7oUjOBk3rKo\n&#34; +</pre></code></td></tr><tr><td>954</td><td><code><pre>                &#34;8puKExe/bwKBgQDAupvf2fj6l2v/lXBYqH7JexLJLCT2EJ4NAL+ik2XxK3tI3qKq\n&#34; +</pre></code></td></tr><tr><td>955</td><td><code><pre>                &#34;VORSuMpljDQRY3PV/B0qQ/KE74YWUn1WoMHMDG6fQBepxIP4qVjZA5A2B4ykp3dC\n&#34; +</pre></code></td></tr><tr><td>956</td><td><code><pre>                &#34;gruZsv3JnSaUqlHt/F6KlMjYxU34+yOGr+dnJqMg+wWsIL3cmNUw97OxvQKBgCo4\n&#34; +</pre></code></td></tr><tr><td>957</td><td><code><pre>                &#34;6O1ecih/MDu0fVXg11sm9yO8ZGmxN7yXw03/g6ODx5uWL56uNUvLU9btdFUoHzIx\n&#34; +</pre></code></td></tr><tr><td>958</td><td><code><pre>                &#34;vL9aZNoMggyITKl6DvVAvz6f40l9uXeY7yXRf3SGHO/J0YjfUUEJX70UU/Kj2Rob\n&#34; +</pre></code></td></tr><tr><td>959</td><td><code><pre>                &#34;2XmIz1rDpov1IpC12SWbr0H4OGQroHIGmOqQcXyBAoGAMFJzs9K/bx6MA9lZW8Vw\n&#34; +</pre></code></td></tr><tr><td>960</td><td><code><pre>                &#34;adbuUcqFjOAryk8fNzZNBgYADRHfNz1Az3vqIi1zWcnimou0M4o2BRGUc805wy7V\n&#34; +</pre></code></td></tr><tr><td>961</td><td><code><pre>                &#34;YfkIyRQ5bIIVGNpP19dEOSsJ8pYAr+Bo/3GjXxUe6O6PxF3hbfPJNWt11refYC27\n&#34; +</pre></code></td></tr><tr><td>962</td><td><code><pre>                &#34;dZsRsRJX4pAw+BznAZodf6Q=\n&#34; +</pre></code></td></tr><tr><td>963</td><td><code><pre>                &#34;-----END PRIVATE KEY-----\n&#34;)</pre></code></td></tr><tr><td>964</td><td><code><pre>        secret.Data[tlsCrt] = []byte(&#34;-----BEGIN CERTIFICATE-----\n&#34; +</pre></code></td></tr><tr><td>965</td><td><code><pre>                &#34;MIIDazCCAlOgAwIBAgIUOX75BZ3gP92zRT89ZO34HXdi44QwDQYJKoZIhvcNAQEL\n&#34; +</pre></code></td></tr><tr><td>966</td><td><code><pre>                &#34;BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM\n&#34; +</pre></code></td></tr><tr><td>967</td><td><code><pre>                &#34;GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0xOTA4MjkwMDQ0NDdaFw0yMDA4\n&#34; +</pre></code></td></tr><tr><td>968</td><td><code><pre>                &#34;MjgwMDQ0NDdaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw\n&#34; +</pre></code></td></tr><tr><td>969</td><td><code><pre>                &#34;HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB\n&#34; +</pre></code></td></tr><tr><td>970</td><td><code><pre>                &#34;AQUAA4IBDwAwggEKAoIBAQDFEs4opOIMHYnawMio1JHZaQWDZEP8fsL23Rozhow0\n&#34; +</pre></code></td></tr><tr><td>971</td><td><code><pre>                &#34;vVokthPk4wGBKYpc8XYBbWFs5pUuExeOjeRWjdNArwn5jCZYaxtqfdrj2kLHFHPC\n&#34; +</pre></code></td></tr><tr><td>972</td><td><code><pre>                &#34;Twmbzn+qvPkvp/ZJyeY+4eIe7soGzO6hoj/wHHdry7rPiap5R5EMfHzfl1TZ5Wfi\n&#34; +</pre></code></td></tr><tr><td>973</td><td><code><pre>                &#34;xqnxKVEc33VRD9xwQIHwJTGnoI2bTGK3vK5q90Glxyc4FAqo6xBguo6ZfOCqPYHX\n&#34; +</pre></code></td></tr><tr><td>974</td><td><code><pre>                &#34;AKtaMj5hcr2dA0/7rJ/xNthDdnQwhETU2BgQ9PvqfuMif+r/VM4KmYjQYu6+NN8V\n&#34; +</pre></code></td></tr><tr><td>975</td><td><code><pre>                &#34;DVq6eSx4dxIzqWZ/NdSeoIri+6Gpa0AncMrq3t7OjuQjAgMBAAGjUzBRMB0GA1Ud\n&#34; +</pre></code></td></tr><tr><td>976</td><td><code><pre>                &#34;DgQWBBTCTeqqryPyXKMAoo28CGKvS2dvuDAfBgNVHSMEGDAWgBTCTeqqryPyXKMA\n&#34; +</pre></code></td></tr><tr><td>977</td><td><code><pre>                &#34;oo28CGKvS2dvuDAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQCp\n&#34; +</pre></code></td></tr><tr><td>978</td><td><code><pre>                &#34;e7uP6D0bU6Z/ZuWZrZUwvo054912wg7O7zNJeZ1dnV9M/3ozR5UR1LSilhRgtOLD\n&#34; +</pre></code></td></tr><tr><td>979</td><td><code><pre>                &#34;mUIQtQdoJCTnPb/FrD7ZvOL5e0CjbvKSs7UxhvsOBiE4EQCHS4Gp1HUtFRS+H60U\n&#34; +</pre></code></td></tr><tr><td>980</td><td><code><pre>                &#34;Z0cUG4CnbjJy0JmXpEq+B1McDc7QtR9p0JJiOIJN59255u/Kdg+0NWdRsB6zdZMn\n&#34; +</pre></code></td></tr><tr><td>981</td><td><code><pre>                &#34;p4gifcw3N8eErYFSs6mHhblTOROMf0kCGan6qyx08Lk/t3YI33ZAktk8T5GVSe3A\n&#34; +</pre></code></td></tr><tr><td>982</td><td><code><pre>                &#34;o1nu88fKxKLEH6kcBzx35dt3CmMsHCXgX58R+OHD8boJteLkkuc+h+mzO7G8h/Bv\n&#34; +</pre></code></td></tr><tr><td>983</td><td><code><pre>                &#34;LloWsUALcQTN0LMl33F8\n&#34; +</pre></code></td></tr><tr><td>984</td><td><code><pre>                &#34;-----END CERTIFICATE-----\n&#34;)</pre></code></td></tr><tr><td>985</td><td><code><pre></pre></code></td></tr><tr><td>986</td><td><code><pre>        return secret</pre></code></td></tr><tr><td>987</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewServicePortsFixture">func NewServicePortsFixture</div><div class="info"><a href="#s_fn_NewServicePortsFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>368</td><td><code><pre>func NewServicePortsFixture() *[]v1.ServicePort {</pre></code></td></tr><tr><td>369</td><td><code><pre>        httpPort := v1.ServicePort{</pre></code></td></tr><tr><td>370</td><td><code><pre>                // The name of this port within the service. This must be a DNS_LABEL.</pre></code></td></tr><tr><td>371</td><td><code><pre>                // All ports within a ServiceSpec must have unique names. This maps to</pre></code></td></tr><tr><td>372</td><td><code><pre>                // the &#39;Name&#39; field in EndpointPort objects.</pre></code></td></tr><tr><td>373</td><td><code><pre>                // Optional if only one ServicePort is defined on this service.</pre></code></td></tr><tr><td>374</td><td><code><pre>                Name: ServiceHTTPPort,</pre></code></td></tr><tr><td>375</td><td><code><pre></pre></code></td></tr><tr><td>376</td><td><code><pre>                // The IP protocol for this port. Supports &#34;TCP&#34;, &#34;UDP&#34;, and &#34;SCTP&#34;.</pre></code></td></tr><tr><td>377</td><td><code><pre>                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>378</td><td><code><pre></pre></code></td></tr><tr><td>379</td><td><code><pre>                // The port that will be exposed by this service.</pre></code></td></tr><tr><td>380</td><td><code><pre>                Port: 80,</pre></code></td></tr><tr><td>381</td><td><code><pre></pre></code></td></tr><tr><td>382</td><td><code><pre>                // Number or name of the port to access on the pods targeted by the service.</pre></code></td></tr><tr><td>383</td><td><code><pre>                // Number must be in the range 1 to 65535. Name must be an IANA_SVC_NAME.</pre></code></td></tr><tr><td>384</td><td><code><pre>                // If this is a string, it will be looked up as a named port in the</pre></code></td></tr><tr><td>385</td><td><code><pre>                // target Pod&#39;s container ports. If this is not specified, the value</pre></code></td></tr><tr><td>386</td><td><code><pre>                // of the &#39;port&#39; field is used (an identity map).</pre></code></td></tr><tr><td>387</td><td><code><pre>                // This field is ignored for services with clusterIP=None, and should be</pre></code></td></tr><tr><td>388</td><td><code><pre>                // omitted or set equal to the &#39;port&#39; field.</pre></code></td></tr><tr><td>389</td><td><code><pre>                TargetPort: intstr.IntOrString{</pre></code></td></tr><tr><td>390</td><td><code><pre>                        Type:   intstr.Int,</pre></code></td></tr><tr><td>391</td><td><code><pre>                        IntVal: ContainerPort,</pre></code></td></tr><tr><td>392</td><td><code><pre>                },</pre></code></td></tr><tr><td>393</td><td><code><pre>        }</pre></code></td></tr><tr><td>394</td><td><code><pre></pre></code></td></tr><tr><td>395</td><td><code><pre>        httpsPort := v1.ServicePort{</pre></code></td></tr><tr><td>396</td><td><code><pre>                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>397</td><td><code><pre>                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>398</td><td><code><pre>                Port:     443,</pre></code></td></tr><tr><td>399</td><td><code><pre>                TargetPort: intstr.IntOrString{</pre></code></td></tr><tr><td>400</td><td><code><pre>                        Type:   intstr.String,</pre></code></td></tr><tr><td>401</td><td><code><pre>                        StrVal: &#34;https-port&#34;,</pre></code></td></tr><tr><td>402</td><td><code><pre>                },</pre></code></td></tr><tr><td>403</td><td><code><pre>        }</pre></code></td></tr><tr><td>404</td><td><code><pre></pre></code></td></tr><tr><td>405</td><td><code><pre>        randomTCPPort := v1.ServicePort{</pre></code></td></tr><tr><td>406</td><td><code><pre>                Name:     &#34;other-tcp-port&#34;,</pre></code></td></tr><tr><td>407</td><td><code><pre>                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>408</td><td><code><pre>                Port:     554,</pre></code></td></tr><tr><td>409</td><td><code><pre>                TargetPort: intstr.IntOrString{</pre></code></td></tr><tr><td>410</td><td><code><pre>                        IntVal: 8181,</pre></code></td></tr><tr><td>411</td><td><code><pre>                },</pre></code></td></tr><tr><td>412</td><td><code><pre>        }</pre></code></td></tr><tr><td>413</td><td><code><pre></pre></code></td></tr><tr><td>414</td><td><code><pre>        udpPort := v1.ServicePort{</pre></code></td></tr><tr><td>415</td><td><code><pre>                Name:     &#34;other-tcp-port&#34;,</pre></code></td></tr><tr><td>416</td><td><code><pre>                Protocol: v1.ProtocolUDP,</pre></code></td></tr><tr><td>417</td><td><code><pre>                Port:     9123,</pre></code></td></tr><tr><td>418</td><td><code><pre>                TargetPort: intstr.IntOrString{</pre></code></td></tr><tr><td>419</td><td><code><pre>                        Type:   intstr.Int,</pre></code></td></tr><tr><td>420</td><td><code><pre>                        IntVal: 4566,</pre></code></td></tr><tr><td>421</td><td><code><pre>                },</pre></code></td></tr><tr><td>422</td><td><code><pre>        }</pre></code></td></tr><tr><td>423</td><td><code><pre></pre></code></td></tr><tr><td>424</td><td><code><pre>        return &amp;[]v1.ServicePort{</pre></code></td></tr><tr><td>425</td><td><code><pre>                httpPort,</pre></code></td></tr><tr><td>426</td><td><code><pre>                httpsPort,</pre></code></td></tr><tr><td>427</td><td><code><pre>                randomTCPPort,</pre></code></td></tr><tr><td>428</td><td><code><pre>                udpPort,</pre></code></td></tr><tr><td>429</td><td><code><pre>        }</pre></code></td></tr><tr><td>430</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressTestFixtureBasic">func NewIngressTestFixtureBasic</div><div class="info"><a href="#s_fn_NewIngressTestFixtureBasic">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>702</td><td><code><pre>func NewIngressTestFixtureBasic(namespace string, ingressName string, tls bool) *networking.Ingress {</pre></code></td></tr><tr><td>703</td><td><code><pre>        ingress := &amp;networking.Ingress{</pre></code></td></tr><tr><td>704</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>705</td><td><code><pre>                        Name:      ingressName,</pre></code></td></tr><tr><td>706</td><td><code><pre>                        Namespace: namespace,</pre></code></td></tr><tr><td>707</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>708</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>709</td><td><code><pre>                        },</pre></code></td></tr><tr><td>710</td><td><code><pre>                },</pre></code></td></tr><tr><td>711</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>712</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>713</td><td><code><pre>                                {</pre></code></td></tr><tr><td>714</td><td><code><pre>                                        Host: &#34;hello.com&#34;,</pre></code></td></tr><tr><td>715</td><td><code><pre>                                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>716</td><td><code><pre>                                                HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>717</td><td><code><pre>                                                        Paths: []networking.HTTPIngressPath{</pre></code></td></tr><tr><td>718</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>719</td><td><code><pre>                                                                        Path: &#34;/&#34;,</pre></code></td></tr><tr><td>720</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>721</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>722</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>723</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>724</td><td><code><pre>                                                                                                Name: &#34;http&#34;,</pre></code></td></tr><tr><td>725</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>726</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>727</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>728</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>729</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>730</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>731</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>732</td><td><code><pre>                                },</pre></code></td></tr><tr><td>733</td><td><code><pre>                        },</pre></code></td></tr><tr><td>734</td><td><code><pre>                },</pre></code></td></tr><tr><td>735</td><td><code><pre>        }</pre></code></td></tr><tr><td>736</td><td><code><pre></pre></code></td></tr><tr><td>737</td><td><code><pre>        if tls {</pre></code></td></tr><tr><td>738</td><td><code><pre>                ingress.Spec.TLS = []networking.IngressTLS{</pre></code></td></tr><tr><td>739</td><td><code><pre>                        {</pre></code></td></tr><tr><td>740</td><td><code><pre>                                SecretName: NameOfSecret,</pre></code></td></tr><tr><td>741</td><td><code><pre>                        },</pre></code></td></tr><tr><td>742</td><td><code><pre>                }</pre></code></td></tr><tr><td>743</td><td><code><pre>                ingress.Annotations[annotations.SslRedirectKey] = &#34;true&#34;</pre></code></td></tr><tr><td>744</td><td><code><pre>        }</pre></code></td></tr><tr><td>745</td><td><code><pre></pre></code></td></tr><tr><td>746</td><td><code><pre>        return ingress</pre></code></td></tr><tr><td>747</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressFixture">func NewIngressFixture</div><div class="info"><a href="#s_fn_NewIngressFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>292</td><td><code><pre>func NewIngressFixture() *networking.Ingress {</pre></code></td></tr><tr><td>293</td><td><code><pre>        be80 := NewIngressBackendFixture(ServiceName, 80)</pre></code></td></tr><tr><td>294</td><td><code><pre>        be443 := NewIngressBackendFixture(ServiceName, 443)</pre></code></td></tr><tr><td>295</td><td><code><pre></pre></code></td></tr><tr><td>296</td><td><code><pre>        return &amp;networking.Ingress{</pre></code></td></tr><tr><td>297</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>298</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>299</td><td><code><pre>                                NewIngressRuleFixture(Host, URLPath1, *be80),</pre></code></td></tr><tr><td>300</td><td><code><pre>                                NewIngressRuleFixture(Host, URLPath2, *be443),</pre></code></td></tr><tr><td>301</td><td><code><pre>                        },</pre></code></td></tr><tr><td>302</td><td><code><pre>                        TLS: []networking.IngressTLS{</pre></code></td></tr><tr><td>303</td><td><code><pre>                                {</pre></code></td></tr><tr><td>304</td><td><code><pre>                                        Hosts: []string{</pre></code></td></tr><tr><td>305</td><td><code><pre>                                                &#34;www.contoso.com&#34;,</pre></code></td></tr><tr><td>306</td><td><code><pre>                                                &#34;ftp.contoso.com&#34;,</pre></code></td></tr><tr><td>307</td><td><code><pre>                                                Host,</pre></code></td></tr><tr><td>308</td><td><code><pre>                                                &#34;&#34;,</pre></code></td></tr><tr><td>309</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>310</td><td><code><pre>                                        SecretName: NameOfSecret,</pre></code></td></tr><tr><td>311</td><td><code><pre>                                },</pre></code></td></tr><tr><td>312</td><td><code><pre>                                {</pre></code></td></tr><tr><td>313</td><td><code><pre>                                        Hosts:      []string{},</pre></code></td></tr><tr><td>314</td><td><code><pre>                                        SecretName: NameOfSecret,</pre></code></td></tr><tr><td>315</td><td><code><pre>                                },</pre></code></td></tr><tr><td>316</td><td><code><pre>                        },</pre></code></td></tr><tr><td>317</td><td><code><pre>                },</pre></code></td></tr><tr><td>318</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>319</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>320</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>321</td><td><code><pre>                                annotations.SslRedirectKey:  &#34;true&#34;,</pre></code></td></tr><tr><td>322</td><td><code><pre>                        },</pre></code></td></tr><tr><td>323</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>324</td><td><code><pre>                        Name:      Name,</pre></code></td></tr><tr><td>325</td><td><code><pre>                },</pre></code></td></tr><tr><td>326</td><td><code><pre>        }</pre></code></td></tr><tr><td>327</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressTestFixture">func NewIngressTestFixture</div><div class="info"><a href="#s_fn_NewIngressTestFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>665</td><td><code><pre>func NewIngressTestFixture(namespace string, ingressName string) networking.Ingress {</pre></code></td></tr><tr><td>666</td><td><code><pre>        return networking.Ingress{</pre></code></td></tr><tr><td>667</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>668</td><td><code><pre>                        Name:      ingressName,</pre></code></td></tr><tr><td>669</td><td><code><pre>                        Namespace: namespace,</pre></code></td></tr><tr><td>670</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>671</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>672</td><td><code><pre>                        },</pre></code></td></tr><tr><td>673</td><td><code><pre>                },</pre></code></td></tr><tr><td>674</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>675</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>676</td><td><code><pre>                                {</pre></code></td></tr><tr><td>677</td><td><code><pre>                                        Host: &#34;hello.com&#34;,</pre></code></td></tr><tr><td>678</td><td><code><pre>                                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>679</td><td><code><pre>                                                HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>680</td><td><code><pre>                                                        Paths: []networking.HTTPIngressPath{</pre></code></td></tr><tr><td>681</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>682</td><td><code><pre>                                                                        Path: &#34;/hi&#34;,</pre></code></td></tr><tr><td>683</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>684</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>685</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>686</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>687</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>688</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>689</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>690</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>691</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>692</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>693</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>694</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>695</td><td><code><pre>                                },</pre></code></td></tr><tr><td>696</td><td><code><pre>                        },</pre></code></td></tr><tr><td>697</td><td><code><pre>                },</pre></code></td></tr><tr><td>698</td><td><code><pre>        }</pre></code></td></tr><tr><td>699</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewEndpointsFixture">func NewEndpointsFixture</div><div class="info"><a href="#s_fn_NewEndpointsFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>618</td><td><code><pre>func NewEndpointsFixture() *v1.Endpoints {</pre></code></td></tr><tr><td>619</td><td><code><pre>        return &amp;v1.Endpoints{</pre></code></td></tr><tr><td>620</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>621</td><td><code><pre>                        Name:      ServiceName,</pre></code></td></tr><tr><td>622</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>623</td><td><code><pre>                },</pre></code></td></tr><tr><td>624</td><td><code><pre>                Subsets: []v1.EndpointSubset{</pre></code></td></tr><tr><td>625</td><td><code><pre>                        {</pre></code></td></tr><tr><td>626</td><td><code><pre>                                // IP addresses which offer the related ports that are marked as ready. These endpoints</pre></code></td></tr><tr><td>627</td><td><code><pre>                                // should be considered safe for load balancers and clients to utilize.</pre></code></td></tr><tr><td>628</td><td><code><pre>                                // +optional</pre></code></td></tr><tr><td>629</td><td><code><pre>                                Addresses: []v1.EndpointAddress{</pre></code></td></tr><tr><td>630</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>631</td><td><code><pre>                                                IP: &#34;10.9.8.7&#34;,</pre></code></td></tr><tr><td>632</td><td><code><pre>                                                // The Hostname of this endpoint</pre></code></td></tr><tr><td>633</td><td><code><pre>                                                // +optional</pre></code></td></tr><tr><td>634</td><td><code><pre>                                                Hostname: &#34;www.contoso.com&#34;,</pre></code></td></tr><tr><td>635</td><td><code><pre>                                                // Optional: Node hosting this endpoint. This can be used to determine endpoints local to a node.</pre></code></td></tr><tr><td>636</td><td><code><pre>                                                // +optional</pre></code></td></tr><tr><td>637</td><td><code><pre>                                                NodeName: to.StringPtr(NodeName),</pre></code></td></tr><tr><td>638</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>639</td><td><code><pre>                                },</pre></code></td></tr><tr><td>640</td><td><code><pre>                                // IP addresses which offer the related ports but are not currently marked as ready</pre></code></td></tr><tr><td>641</td><td><code><pre>                                // because they have not yet finished starting, have recently failed a readiness check,</pre></code></td></tr><tr><td>642</td><td><code><pre>                                // or have recently failed a liveness check.</pre></code></td></tr><tr><td>643</td><td><code><pre>                                // +optional</pre></code></td></tr><tr><td>644</td><td><code><pre>                                NotReadyAddresses: []v1.EndpointAddress{},</pre></code></td></tr><tr><td>645</td><td><code><pre>                                // Port numbers available on the related IP addresses.</pre></code></td></tr><tr><td>646</td><td><code><pre>                                // +optional</pre></code></td></tr><tr><td>647</td><td><code><pre>                                Ports: []v1.EndpointPort{</pre></code></td></tr><tr><td>648</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>649</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>650</td><td><code><pre>                                                Name:     ServiceHTTPPort,</pre></code></td></tr><tr><td>651</td><td><code><pre>                                                Port:     ContainerPort,</pre></code></td></tr><tr><td>652</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>653</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>654</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>655</td><td><code><pre>                                                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>656</td><td><code><pre>                                                Port:     ContainerPort,</pre></code></td></tr><tr><td>657</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>658</td><td><code><pre>                                },</pre></code></td></tr><tr><td>659</td><td><code><pre>                        },</pre></code></td></tr><tr><td>660</td><td><code><pre>                },</pre></code></td></tr><tr><td>661</td><td><code><pre>        }</pre></code></td></tr><tr><td>662</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngressComplex">func GetIngressComplex</div><div class="info"><a href="#s_fn_GetIngressComplex">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>107</td><td><code><pre>func GetIngressComplex() (*networking.Ingress, error) {</pre></code></td></tr><tr><td>108</td><td><code><pre>        return GetIngressV1FromFile(&#34;ingress-complex.yaml&#34;)</pre></code></td></tr><tr><td>109</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewPodTestFixture">func NewPodTestFixture</div><div class="info"><a href="#s_fn_NewPodTestFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>909</td><td><code><pre>func NewPodTestFixture(namespace string, podName string) v1.Pod {</pre></code></td></tr><tr><td>910</td><td><code><pre>        return v1.Pod{</pre></code></td></tr><tr><td>911</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>912</td><td><code><pre>                        Name:      podName,</pre></code></td></tr><tr><td>913</td><td><code><pre>                        Namespace: namespace,</pre></code></td></tr><tr><td>914</td><td><code><pre>                        Labels: map[string]string{</pre></code></td></tr><tr><td>915</td><td><code><pre>                                SelectorKey: SelectorValue,</pre></code></td></tr><tr><td>916</td><td><code><pre>                        },</pre></code></td></tr><tr><td>917</td><td><code><pre>                },</pre></code></td></tr><tr><td>918</td><td><code><pre>                Spec: v1.PodSpec{},</pre></code></td></tr><tr><td>919</td><td><code><pre>        }</pre></code></td></tr><tr><td>920</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetApplicationGatewayBackendAddressPool">func GetApplicationGatewayBackendAddressPool</div><div class="info"><a href="#s_fn_GetApplicationGatewayBackendAddressPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>227</td><td><code><pre>func GetApplicationGatewayBackendAddressPool() *n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>228</td><td><code><pre>        return &amp;n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>229</td><td><code><pre>                Name: to.StringPtr(&#34;defaultaddresspool&#34;),</pre></code></td></tr><tr><td>230</td><td><code><pre>                Etag: nil,</pre></code></td></tr><tr><td>231</td><td><code><pre>                Type: nil,</pre></code></td></tr><tr><td>232</td><td><code><pre>                ID:   nil,</pre></code></td></tr><tr><td>233</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>234</td><td><code><pre>                        BackendIPConfigurations: nil,</pre></code></td></tr><tr><td>235</td><td><code><pre>                        BackendAddresses:        &amp;[]n.ApplicationGatewayBackendAddress{},</pre></code></td></tr><tr><td>236</td><td><code><pre>                        ProvisioningState:       &#34;&#34;,</pre></code></td></tr><tr><td>237</td><td><code><pre>                },</pre></code></td></tr><tr><td>238</td><td><code><pre>        }</pre></code></td></tr><tr><td>239</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressBackendFixture">func NewIngressBackendFixture</div><div class="info"><a href="#s_fn_NewIngressBackendFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>242</td><td><code><pre>func NewIngressBackendFixture(serviceName string, port int32) *networking.IngressBackend {</pre></code></td></tr><tr><td>243</td><td><code><pre>        return &amp;networking.IngressBackend{</pre></code></td></tr><tr><td>244</td><td><code><pre>                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>245</td><td><code><pre>                        Name: serviceName,</pre></code></td></tr><tr><td>246</td><td><code><pre>                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>247</td><td><code><pre>                                Number: port,</pre></code></td></tr><tr><td>248</td><td><code><pre>                        },</pre></code></td></tr><tr><td>249</td><td><code><pre>                },</pre></code></td></tr><tr><td>250</td><td><code><pre>        }</pre></code></td></tr><tr><td>251</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressRuleFixture">func NewIngressRuleFixture</div><div class="info"><a href="#s_fn_NewIngressRuleFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>254</td><td><code><pre>func NewIngressRuleFixture(host string, urlPath string, be networking.IngressBackend) networking.IngressRule {</pre></code></td></tr><tr><td>255</td><td><code><pre>        return networking.IngressRule{</pre></code></td></tr><tr><td>256</td><td><code><pre>                Host: host,</pre></code></td></tr><tr><td>257</td><td><code><pre>                IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>258</td><td><code><pre>                        HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>259</td><td><code><pre>                                Paths: []networking.HTTPIngressPath{</pre></code></td></tr><tr><td>260</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>261</td><td><code><pre>                                                Path:    urlPath,</pre></code></td></tr><tr><td>262</td><td><code><pre>                                                Backend: be,</pre></code></td></tr><tr><td>263</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>264</td><td><code><pre>                                },</pre></code></td></tr><tr><td>265</td><td><code><pre>                        },</pre></code></td></tr><tr><td>266</td><td><code><pre>                },</pre></code></td></tr><tr><td>267</td><td><code><pre>        }</pre></code></td></tr><tr><td>268</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngress">func GetIngress</div><div class="info"><a href="#s_fn_GetIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>80</td><td><code><pre>func GetIngress() (*networking.Ingress, error) {</pre></code></td></tr><tr><td>81</td><td><code><pre>        return GetIngressV1FromFile(&#34;ingress.yaml&#34;)</pre></code></td></tr><tr><td>82</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewProbeFixture">func NewProbeFixture</div><div class="info"><a href="#s_fn_NewProbeFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>433</td><td><code><pre>func NewProbeFixture(containerName string) *v1.Probe {</pre></code></td></tr><tr><td>434</td><td><code><pre>        return &amp;v1.Probe{</pre></code></td></tr><tr><td>435</td><td><code><pre>                TimeoutSeconds:   5,</pre></code></td></tr><tr><td>436</td><td><code><pre>                FailureThreshold: 3,</pre></code></td></tr><tr><td>437</td><td><code><pre>                PeriodSeconds:    20,</pre></code></td></tr><tr><td>438</td><td><code><pre>                Handler: v1.Handler{</pre></code></td></tr><tr><td>439</td><td><code><pre>                        HTTPGet: &amp;v1.HTTPGetAction{</pre></code></td></tr><tr><td>440</td><td><code><pre>                                Host: Host,</pre></code></td></tr><tr><td>441</td><td><code><pre>                                Path: HealthPath,</pre></code></td></tr><tr><td>442</td><td><code><pre>                                Port: intstr.IntOrString{</pre></code></td></tr><tr><td>443</td><td><code><pre>                                        Type:   intstr.String,</pre></code></td></tr><tr><td>444</td><td><code><pre>                                        StrVal: ContainerHealthPortName,</pre></code></td></tr><tr><td>445</td><td><code><pre>                                },</pre></code></td></tr><tr><td>446</td><td><code><pre>                                Scheme: v1.URISchemeHTTP,</pre></code></td></tr><tr><td>447</td><td><code><pre>                        },</pre></code></td></tr><tr><td>448</td><td><code><pre>                },</pre></code></td></tr><tr><td>449</td><td><code><pre>        }</pre></code></td></tr><tr><td>450</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewServiceFixture">func NewServiceFixture</div><div class="info"><a href="#s_fn_NewServiceFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>533</td><td><code><pre>func NewServiceFixture(servicePorts ...v1.ServicePort) *v1.Service {</pre></code></td></tr><tr><td>534</td><td><code><pre>        return &amp;v1.Service{</pre></code></td></tr><tr><td>535</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>536</td><td><code><pre>                        Name:      ServiceName,</pre></code></td></tr><tr><td>537</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>538</td><td><code><pre>                },</pre></code></td></tr><tr><td>539</td><td><code><pre>                Spec: v1.ServiceSpec{</pre></code></td></tr><tr><td>540</td><td><code><pre>                        // The list of ports that are exposed by this service.</pre></code></td></tr><tr><td>541</td><td><code><pre>                        Ports: servicePorts,</pre></code></td></tr><tr><td>542</td><td><code><pre></pre></code></td></tr><tr><td>543</td><td><code><pre>                        // Route service traffic to pods with label keys and values matching this</pre></code></td></tr><tr><td>544</td><td><code><pre>                        // selector. If empty or not present, the service is assumed to have an</pre></code></td></tr><tr><td>545</td><td><code><pre>                        // external process managing its endpoints, which Kubernetes will not</pre></code></td></tr><tr><td>546</td><td><code><pre>                        // modify. Only applies to types ClusterIP, NodePort, and LoadBalancer.</pre></code></td></tr><tr><td>547</td><td><code><pre>                        // Ignored if type is ExternalName.</pre></code></td></tr><tr><td>548</td><td><code><pre>                        Selector: map[string]string{</pre></code></td></tr><tr><td>549</td><td><code><pre>                                SelectorKey: SelectorValue,</pre></code></td></tr><tr><td>550</td><td><code><pre>                        },</pre></code></td></tr><tr><td>551</td><td><code><pre>                },</pre></code></td></tr><tr><td>552</td><td><code><pre>        }</pre></code></td></tr><tr><td>553</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewPodFixture">func NewPodFixture</div><div class="info"><a href="#s_fn_NewPodFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>500</td><td><code><pre>func NewPodFixture(serviceName string, ingressNamespace string, containerName string, containerPort int32) *v1.Pod {</pre></code></td></tr><tr><td>501</td><td><code><pre>        return &amp;v1.Pod{</pre></code></td></tr><tr><td>502</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>503</td><td><code><pre>                        Name:      serviceName,</pre></code></td></tr><tr><td>504</td><td><code><pre>                        Namespace: ingressNamespace,</pre></code></td></tr><tr><td>505</td><td><code><pre>                        Labels: map[string]string{</pre></code></td></tr><tr><td>506</td><td><code><pre>                                SelectorKey: SelectorValue,</pre></code></td></tr><tr><td>507</td><td><code><pre>                        },</pre></code></td></tr><tr><td>508</td><td><code><pre>                },</pre></code></td></tr><tr><td>509</td><td><code><pre>                Spec: v1.PodSpec{</pre></code></td></tr><tr><td>510</td><td><code><pre>                        Containers: []v1.Container{</pre></code></td></tr><tr><td>511</td><td><code><pre>                                {</pre></code></td></tr><tr><td>512</td><td><code><pre>                                        Name:  serviceName,</pre></code></td></tr><tr><td>513</td><td><code><pre>                                        Image: &#34;image&#34;,</pre></code></td></tr><tr><td>514</td><td><code><pre>                                        Ports: []v1.ContainerPort{</pre></code></td></tr><tr><td>515</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>516</td><td><code><pre>                                                        Name:          containerName,</pre></code></td></tr><tr><td>517</td><td><code><pre>                                                        ContainerPort: containerPort,</pre></code></td></tr><tr><td>518</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>519</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>520</td><td><code><pre>                                                        Name:          ContainerHealthPortName,</pre></code></td></tr><tr><td>521</td><td><code><pre>                                                        ContainerPort: ContainerHealthPort,</pre></code></td></tr><tr><td>522</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>523</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>524</td><td><code><pre>                                        ReadinessProbe: NewProbeFixture(containerName),</pre></code></td></tr><tr><td>525</td><td><code><pre>                                        LivenessProbe:  NewProbeFixture(containerName),</pre></code></td></tr><tr><td>526</td><td><code><pre>                                },</pre></code></td></tr><tr><td>527</td><td><code><pre>                        },</pre></code></td></tr><tr><td>528</td><td><code><pre>                },</pre></code></td></tr><tr><td>529</td><td><code><pre>        }</pre></code></td></tr><tr><td>530</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngressNamespaced">func GetIngressNamespaced</div><div class="info"><a href="#s_fn_GetIngressNamespaced">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>139</td><td><code><pre>func GetIngressNamespaced() (*[]networking.Ingress, error) {</pre></code></td></tr><tr><td>140</td><td><code><pre>        ingr1, err := GetIngressV1FromFile(&#34;ingress-namespace-1.yaml&#34;)</pre></code></td></tr><tr><td>141</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>142</td><td><code><pre>                klog.Fatal(err)</pre></code></td></tr><tr><td>143</td><td><code><pre>        }</pre></code></td></tr><tr><td>144</td><td><code><pre>        ingr2, err := GetIngressV1FromFile(&#34;ingress-namespace-2.yaml&#34;)</pre></code></td></tr><tr><td>145</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>146</td><td><code><pre>                klog.Fatal(err)</pre></code></td></tr><tr><td>147</td><td><code><pre>        }</pre></code></td></tr><tr><td>148</td><td><code><pre>        return &amp;[]networking.Ingress{*ingr1, *ingr2}, nil</pre></code></td></tr><tr><td>149</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngressV1Beta1FromFile">func GetIngressV1Beta1FromFile</div><div class="info"><a href="#s_fn_GetIngressV1Beta1FromFile">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>166</td><td><code><pre>func GetIngressV1Beta1FromFile(fileName string) (*extensions.Ingress, error) {</pre></code></td></tr><tr class="miss"><td>167</td><td><code><pre>        ingr, err := ioutil.ReadFile(fileName)</pre></code></td></tr><tr class="miss"><td>168</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>169</td><td><code><pre>                fmt.Print(err)</pre></code></td></tr><tr><td>170</td><td><code><pre>        }</pre></code></td></tr><tr><td>171</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>172</td><td><code><pre>        obj, _, err := scheme.Codecs.UniversalDeserializer().Decode(ingr, nil, nil)</pre></code></td></tr><tr class="miss"><td>173</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>174</td><td><code><pre>                return nil, err</pre></code></td></tr><tr><td>175</td><td><code><pre>        }</pre></code></td></tr><tr class="miss"><td>176</td><td><code><pre>        return obj.(*extensions.Ingress), nil</pre></code></td></tr><tr><td>177</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressRuleWithPathsFixture">func NewIngressRuleWithPathsFixture</div><div class="info"><a href="#s_fn_NewIngressRuleWithPathsFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>271</td><td><code><pre>func NewIngressRuleWithPathsFixture(host string, urlPathsList []string, be networking.IngressBackend) networking.IngressRule {</pre></code></td></tr><tr class="miss"><td>272</td><td><code><pre>        ingressRule := networking.IngressRule{</pre></code></td></tr><tr><td>273</td><td><code><pre>                Host: host,</pre></code></td></tr><tr><td>274</td><td><code><pre>                IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>275</td><td><code><pre>                        HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>276</td><td><code><pre>                                Paths: []networking.HTTPIngressPath{},</pre></code></td></tr><tr><td>277</td><td><code><pre>                        },</pre></code></td></tr><tr><td>278</td><td><code><pre>                },</pre></code></td></tr><tr><td>279</td><td><code><pre>        }</pre></code></td></tr><tr><td>280</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>281</td><td><code><pre>        for _, value := range urlPathsList {</pre></code></td></tr><tr class="miss"><td>282</td><td><code><pre>                ingressRule.IngressRuleValue.HTTP.Paths = append(ingressRule.IngressRuleValue.HTTP.Paths, networking.HTTPIngressPath{</pre></code></td></tr><tr><td>283</td><td><code><pre>                        Path:    value,</pre></code></td></tr><tr><td>284</td><td><code><pre>                        Backend: be,</pre></code></td></tr><tr><td>285</td><td><code><pre>                })</pre></code></td></tr><tr><td>286</td><td><code><pre>        }</pre></code></td></tr><tr><td>287</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>288</td><td><code><pre>        return ingressRule</pre></code></td></tr><tr><td>289</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressTestWithVariousPathTypeFixture">func NewIngressTestWithVariousPathTypeFixture</div><div class="info"><a href="#s_fn_NewIngressTestWithVariousPathTypeFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>750</td><td><code><pre>func NewIngressTestWithVariousPathTypeFixture(namespace string, ingressName string) networking.Ingress {</pre></code></td></tr><tr class="miss"><td>751</td><td><code><pre>        prefixType := networking.PathTypePrefix</pre></code></td></tr><tr class="miss"><td>752</td><td><code><pre>        exactType := networking.PathTypeExact</pre></code></td></tr><tr class="miss"><td>753</td><td><code><pre>        implementationSpecificType := networking.PathTypeImplementationSpecific</pre></code></td></tr><tr class="miss"><td>754</td><td><code><pre>        return networking.Ingress{</pre></code></td></tr><tr><td>755</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>756</td><td><code><pre>                        Name:      ingressName,</pre></code></td></tr><tr><td>757</td><td><code><pre>                        Namespace: namespace,</pre></code></td></tr><tr><td>758</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>759</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>760</td><td><code><pre>                        },</pre></code></td></tr><tr><td>761</td><td><code><pre>                },</pre></code></td></tr><tr><td>762</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>763</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>764</td><td><code><pre>                                {</pre></code></td></tr><tr><td>765</td><td><code><pre>                                        Host: &#34;hello.com&#34;,</pre></code></td></tr><tr><td>766</td><td><code><pre>                                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>767</td><td><code><pre>                                                HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>768</td><td><code><pre>                                                        Paths: []networking.HTTPIngressPath{</pre></code></td></tr><tr><td>769</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>770</td><td><code><pre>                                                                        // type:prefix with *</pre></code></td></tr><tr><td>771</td><td><code><pre>                                                                        Path:     &#34;/prefix0*&#34;,</pre></code></td></tr><tr><td>772</td><td><code><pre>                                                                        PathType: &amp;prefixType,</pre></code></td></tr><tr><td>773</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>774</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>775</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>776</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>777</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>778</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>779</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>780</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>781</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>782</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>783</td><td><code><pre>                                                                        // type:prefix without *</pre></code></td></tr><tr><td>784</td><td><code><pre>                                                                        Path:     &#34;/prefix1&#34;,</pre></code></td></tr><tr><td>785</td><td><code><pre>                                                                        PathType: &amp;prefixType,</pre></code></td></tr><tr><td>786</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>787</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>788</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>789</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>790</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>791</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>792</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>793</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>794</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>795</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>796</td><td><code><pre>                                                                        // type:exact with *</pre></code></td></tr><tr><td>797</td><td><code><pre>                                                                        Path:     &#34;/exact2*&#34;,</pre></code></td></tr><tr><td>798</td><td><code><pre>                                                                        PathType: &amp;exactType,</pre></code></td></tr><tr><td>799</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>800</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>801</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>802</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>803</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>804</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>805</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>806</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>807</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>808</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>809</td><td><code><pre>                                                                        // type:exact without *</pre></code></td></tr><tr><td>810</td><td><code><pre>                                                                        Path:     &#34;/exact3&#34;,</pre></code></td></tr><tr><td>811</td><td><code><pre>                                                                        PathType: &amp;implementationSpecificType,</pre></code></td></tr><tr><td>812</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>813</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>814</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>815</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>816</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>817</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>818</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>819</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>820</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>821</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>822</td><td><code><pre>                                                                        // type:implementationSpecific with *</pre></code></td></tr><tr><td>823</td><td><code><pre>                                                                        Path:     &#34;/ims4*&#34;,</pre></code></td></tr><tr><td>824</td><td><code><pre>                                                                        PathType: &amp;implementationSpecificType,</pre></code></td></tr><tr><td>825</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>826</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>827</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>828</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>829</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>830</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>831</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>832</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>833</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>834</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>835</td><td><code><pre>                                                                        // type:implementationSpecific without *</pre></code></td></tr><tr><td>836</td><td><code><pre>                                                                        Path:     &#34;/ims5&#34;,</pre></code></td></tr><tr><td>837</td><td><code><pre>                                                                        PathType: &amp;implementationSpecificType,</pre></code></td></tr><tr><td>838</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>839</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>840</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>841</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>842</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>843</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>844</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>845</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>846</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>847</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>848</td><td><code><pre>                                                                        // type:nil with *</pre></code></td></tr><tr><td>849</td><td><code><pre>                                                                        Path:     &#34;/nil6*&#34;,</pre></code></td></tr><tr><td>850</td><td><code><pre>                                                                        PathType: nil,</pre></code></td></tr><tr><td>851</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>852</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>853</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>854</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>855</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>856</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>857</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>858</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>859</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>860</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>861</td><td><code><pre>                                                                        // type:nil without *</pre></code></td></tr><tr><td>862</td><td><code><pre>                                                                        Path:     &#34;/nil7&#34;,</pre></code></td></tr><tr><td>863</td><td><code><pre>                                                                        PathType: nil,</pre></code></td></tr><tr><td>864</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>865</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>866</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>867</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>868</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>869</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>870</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>871</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>872</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>873</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>874</td><td><code><pre>                                                                        // &#34;/&#34; path with pathType:prefix</pre></code></td></tr><tr><td>875</td><td><code><pre>                                                                        Path:     &#34;/&#34;,</pre></code></td></tr><tr><td>876</td><td><code><pre>                                                                        PathType: &amp;prefixType,</pre></code></td></tr><tr><td>877</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>878</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>879</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>880</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>881</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>882</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>883</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>884</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>885</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>886</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>887</td><td><code><pre>                                                                        // &#34;/*&#34; path with pathType:exact</pre></code></td></tr><tr><td>888</td><td><code><pre>                                                                        Path:     &#34;/*&#34;,</pre></code></td></tr><tr><td>889</td><td><code><pre>                                                                        PathType: &amp;exactType,</pre></code></td></tr><tr><td>890</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>891</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>892</td><td><code><pre>                                                                                        Name: ServiceName,</pre></code></td></tr><tr><td>893</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>894</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>895</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>896</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>897</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>898</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>899</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>900</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>901</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>902</td><td><code><pre>                                },</pre></code></td></tr><tr><td>903</td><td><code><pre>                        },</pre></code></td></tr><tr><td>904</td><td><code><pre>                },</pre></code></td></tr><tr><td>905</td><td><code><pre>        }</pre></code></td></tr><tr><td>906</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewIngressFixtureSingleSlashPath">func NewIngressFixtureSingleSlashPath</div><div class="info"><a href="#s_fn_NewIngressFixtureSingleSlashPath">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>330</td><td><code><pre>func NewIngressFixtureSingleSlashPath() *networking.Ingress {</pre></code></td></tr><tr class="miss"><td>331</td><td><code><pre>        be80 := NewIngressBackendFixture(ServiceName, 80)</pre></code></td></tr><tr class="miss"><td>332</td><td><code><pre>        be443 := NewIngressBackendFixture(ServiceName, 443)</pre></code></td></tr><tr><td>333</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>334</td><td><code><pre>        return &amp;networking.Ingress{</pre></code></td></tr><tr><td>335</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>336</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>337</td><td><code><pre>                                NewIngressRuleFixture(Host, URLPath4, *be80),</pre></code></td></tr><tr><td>338</td><td><code><pre>                                NewIngressRuleFixture(Host, URLPath5, *be443),</pre></code></td></tr><tr><td>339</td><td><code><pre>                        },</pre></code></td></tr><tr><td>340</td><td><code><pre>                        TLS: []networking.IngressTLS{</pre></code></td></tr><tr><td>341</td><td><code><pre>                                {</pre></code></td></tr><tr><td>342</td><td><code><pre>                                        Hosts: []string{</pre></code></td></tr><tr><td>343</td><td><code><pre>                                                &#34;www.contoso.com&#34;,</pre></code></td></tr><tr><td>344</td><td><code><pre>                                                &#34;ftp.contoso.com&#34;,</pre></code></td></tr><tr><td>345</td><td><code><pre>                                                Host,</pre></code></td></tr><tr><td>346</td><td><code><pre>                                                &#34;&#34;,</pre></code></td></tr><tr><td>347</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>348</td><td><code><pre>                                        SecretName: NameOfSecret,</pre></code></td></tr><tr><td>349</td><td><code><pre>                                },</pre></code></td></tr><tr><td>350</td><td><code><pre>                                {</pre></code></td></tr><tr><td>351</td><td><code><pre>                                        Hosts:      []string{},</pre></code></td></tr><tr><td>352</td><td><code><pre>                                        SecretName: NameOfSecret,</pre></code></td></tr><tr><td>353</td><td><code><pre>                                },</pre></code></td></tr><tr><td>354</td><td><code><pre>                        },</pre></code></td></tr><tr><td>355</td><td><code><pre>                },</pre></code></td></tr><tr><td>356</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>357</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>358</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>359</td><td><code><pre>                                annotations.SslRedirectKey:  &#34;true&#34;,</pre></code></td></tr><tr><td>360</td><td><code><pre>                        },</pre></code></td></tr><tr><td>361</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>362</td><td><code><pre>                        Name:      Name,</pre></code></td></tr><tr><td>363</td><td><code><pre>                },</pre></code></td></tr><tr><td>364</td><td><code><pre>        }</pre></code></td></tr><tr><td>365</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngressWithMissingServiceAndServiceWithInvalidPort">func GetIngressWithMissingServiceAndServiceWithInvalidPort</div><div class="info"><a href="#s_fn_GetIngressWithMissingServiceAndServiceWithInvalidPort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>112</td><td><code><pre>func GetIngressWithMissingServiceAndServiceWithInvalidPort() *networking.Ingress {</pre></code></td></tr><tr class="miss"><td>113</td><td><code><pre>        be70000 := NewIngressBackendFixture(&#34;--service-name--&#34;, 70000)</pre></code></td></tr><tr class="miss"><td>114</td><td><code><pre>        return &amp;networking.Ingress{</pre></code></td></tr><tr><td>115</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>116</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>117</td><td><code><pre>                                NewIngressRuleFixture(&#34;--service-name--&#34;, &#34;/otherService/*&#34;, *be70000),</pre></code></td></tr><tr><td>118</td><td><code><pre>                        },</pre></code></td></tr><tr><td>119</td><td><code><pre>                        DefaultBackend: &amp;networking.IngressBackend{</pre></code></td></tr><tr><td>120</td><td><code><pre>                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>121</td><td><code><pre>                                        Name: &#34;missing-service&#34;,</pre></code></td></tr><tr><td>122</td><td><code><pre>                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>123</td><td><code><pre>                                                Number: 8080,</pre></code></td></tr><tr><td>124</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>125</td><td><code><pre>                                },</pre></code></td></tr><tr><td>126</td><td><code><pre>                        },</pre></code></td></tr><tr><td>127</td><td><code><pre>                },</pre></code></td></tr><tr><td>128</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>129</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>130</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>131</td><td><code><pre>                        },</pre></code></td></tr><tr><td>132</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>133</td><td><code><pre>                        Name:      &#34;ingress-with-invalid-services&#34;,</pre></code></td></tr><tr><td>134</td><td><code><pre>                },</pre></code></td></tr><tr><td>135</td><td><code><pre>        }</pre></code></td></tr><tr><td>136</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewEndpointsFixtureWithSameNameMultiplePorts">func NewEndpointsFixtureWithSameNameMultiplePorts</div><div class="info"><a href="#s_fn_NewEndpointsFixtureWithSameNameMultiplePorts">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>556</td><td><code><pre>func NewEndpointsFixtureWithSameNameMultiplePorts() *v1.Endpoints {</pre></code></td></tr><tr class="miss"><td>557</td><td><code><pre>        return &amp;v1.Endpoints{</pre></code></td></tr><tr><td>558</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>559</td><td><code><pre>                        Name:      ServiceName,</pre></code></td></tr><tr><td>560</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>561</td><td><code><pre>                },</pre></code></td></tr><tr><td>562</td><td><code><pre>                Subsets: []v1.EndpointSubset{</pre></code></td></tr><tr><td>563</td><td><code><pre>                        {</pre></code></td></tr><tr><td>564</td><td><code><pre>                                // IP addresses which offer the related ports that are marked as ready. These endpoints</pre></code></td></tr><tr><td>565</td><td><code><pre>                                // should be considered safe for load balancers and clients to utilize.</pre></code></td></tr><tr><td>566</td><td><code><pre>                                // +optional</pre></code></td></tr><tr><td>567</td><td><code><pre>                                Addresses: []v1.EndpointAddress{</pre></code></td></tr><tr><td>568</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>569</td><td><code><pre>                                                IP: &#34;10.9.8.7&#34;,</pre></code></td></tr><tr><td>570</td><td><code><pre>                                                // The Hostname of this endpoint</pre></code></td></tr><tr><td>571</td><td><code><pre>                                                // +optional</pre></code></td></tr><tr><td>572</td><td><code><pre>                                                Hostname: &#34;www.contoso.com&#34;,</pre></code></td></tr><tr><td>573</td><td><code><pre>                                                // Optional: Node hosting this endpoint. This can be used to determine endpoints local to a node.</pre></code></td></tr><tr><td>574</td><td><code><pre>                                                // +optional</pre></code></td></tr><tr><td>575</td><td><code><pre>                                                NodeName: to.StringPtr(NodeName),</pre></code></td></tr><tr><td>576</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>577</td><td><code><pre>                                },</pre></code></td></tr><tr><td>578</td><td><code><pre>                                // IP addresses which offer the related ports but are not currently marked as ready</pre></code></td></tr><tr><td>579</td><td><code><pre>                                // because they have not yet finished starting, have recently failed a readiness check,</pre></code></td></tr><tr><td>580</td><td><code><pre>                                // or have recently failed a liveness check.</pre></code></td></tr><tr><td>581</td><td><code><pre>                                // +optional</pre></code></td></tr><tr><td>582</td><td><code><pre>                                NotReadyAddresses: []v1.EndpointAddress{},</pre></code></td></tr><tr><td>583</td><td><code><pre>                                // Port numbers available on the related IP addresses.</pre></code></td></tr><tr><td>584</td><td><code><pre>                                // +optional</pre></code></td></tr><tr><td>585</td><td><code><pre>                                Ports: []v1.EndpointPort{</pre></code></td></tr><tr><td>586</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>587</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>588</td><td><code><pre>                                                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>589</td><td><code><pre>                                                Port:     5000,</pre></code></td></tr><tr><td>590</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>591</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>592</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>593</td><td><code><pre>                                                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>594</td><td><code><pre>                                                Port:     80,</pre></code></td></tr><tr><td>595</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>596</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>597</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>598</td><td><code><pre>                                                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>599</td><td><code><pre>                                                Port:     81,</pre></code></td></tr><tr><td>600</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>601</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>602</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>603</td><td><code><pre>                                                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>604</td><td><code><pre>                                                Port:     4999,</pre></code></td></tr><tr><td>605</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>606</td><td><code><pre>                                        {</pre></code></td></tr><tr><td>607</td><td><code><pre>                                                Protocol: v1.ProtocolTCP,</pre></code></td></tr><tr><td>608</td><td><code><pre>                                                Name:     ServiceHTTPSPort,</pre></code></td></tr><tr><td>609</td><td><code><pre>                                                Port:     75,</pre></code></td></tr><tr><td>610</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>611</td><td><code><pre>                                },</pre></code></td></tr><tr><td>612</td><td><code><pre>                        },</pre></code></td></tr><tr><td>613</td><td><code><pre>                },</pre></code></td></tr><tr><td>614</td><td><code><pre>        }</pre></code></td></tr><tr><td>615</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewPodHTTPSFixture">func NewPodHTTPSFixture</div><div class="info"><a href="#s_fn_NewPodHTTPSFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>471</td><td><code><pre>func NewPodHTTPSFixture(serviceName string, ingressNamespace string, containerName string, containerPort int32) *v1.Pod {</pre></code></td></tr><tr class="miss"><td>472</td><td><code><pre>        return &amp;v1.Pod{</pre></code></td></tr><tr><td>473</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>474</td><td><code><pre>                        Name:      serviceName,</pre></code></td></tr><tr><td>475</td><td><code><pre>                        Namespace: ingressNamespace,</pre></code></td></tr><tr><td>476</td><td><code><pre>                        Labels: map[string]string{</pre></code></td></tr><tr><td>477</td><td><code><pre>                                SelectorKey: SelectorValue,</pre></code></td></tr><tr><td>478</td><td><code><pre>                        },</pre></code></td></tr><tr><td>479</td><td><code><pre>                },</pre></code></td></tr><tr><td>480</td><td><code><pre>                Spec: v1.PodSpec{</pre></code></td></tr><tr><td>481</td><td><code><pre>                        Containers: []v1.Container{</pre></code></td></tr><tr><td>482</td><td><code><pre>                                {</pre></code></td></tr><tr><td>483</td><td><code><pre>                                        Name:  serviceName,</pre></code></td></tr><tr><td>484</td><td><code><pre>                                        Image: &#34;image&#34;,</pre></code></td></tr><tr><td>485</td><td><code><pre>                                        Ports: []v1.ContainerPort{</pre></code></td></tr><tr><td>486</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>487</td><td><code><pre>                                                        Name:          ContainerHealthHTTPSPortName,</pre></code></td></tr><tr><td>488</td><td><code><pre>                                                        ContainerPort: ContainerHealthHTTPSPort,</pre></code></td></tr><tr><td>489</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>490</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>491</td><td><code><pre>                                        ReadinessProbe: NewHTTPSProbeFixture(containerName),</pre></code></td></tr><tr><td>492</td><td><code><pre>                                        LivenessProbe:  NewHTTPSProbeFixture(containerName),</pre></code></td></tr><tr><td>493</td><td><code><pre>                                },</pre></code></td></tr><tr><td>494</td><td><code><pre>                        },</pre></code></td></tr><tr><td>495</td><td><code><pre>                },</pre></code></td></tr><tr><td>496</td><td><code><pre>        }</pre></code></td></tr><tr><td>497</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewHTTPSProbeFixture">func NewHTTPSProbeFixture</div><div class="info"><a href="#s_fn_NewHTTPSProbeFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>453</td><td><code><pre>func NewHTTPSProbeFixture(containerName string) *v1.Probe {</pre></code></td></tr><tr class="miss"><td>454</td><td><code><pre>        return &amp;v1.Probe{</pre></code></td></tr><tr><td>455</td><td><code><pre>                TimeoutSeconds:   5,</pre></code></td></tr><tr><td>456</td><td><code><pre>                FailureThreshold: 3,</pre></code></td></tr><tr><td>457</td><td><code><pre>                PeriodSeconds:    20,</pre></code></td></tr><tr><td>458</td><td><code><pre>                Handler: v1.Handler{</pre></code></td></tr><tr><td>459</td><td><code><pre>                        HTTPGet: &amp;v1.HTTPGetAction{</pre></code></td></tr><tr><td>460</td><td><code><pre>                                Path: HealthPath,</pre></code></td></tr><tr><td>461</td><td><code><pre>                                Port: intstr.IntOrString{</pre></code></td></tr><tr><td>462</td><td><code><pre>                                        Type:   intstr.String,</pre></code></td></tr><tr><td>463</td><td><code><pre>                                        StrVal: ContainerHealthHTTPSPortName,</pre></code></td></tr><tr><td>464</td><td><code><pre>                                },</pre></code></td></tr><tr><td>465</td><td><code><pre>                        },</pre></code></td></tr><tr><td>466</td><td><code><pre>                },</pre></code></td></tr><tr><td>467</td><td><code><pre>        }</pre></code></td></tr><tr><td>468</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewRewriteRuleSetCustomResourceFixture">func NewRewriteRuleSetCustomResourceFixture</div><div class="info"><a href="#s_fn_NewRewriteRuleSetCustomResourceFixture">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>180</td><td><code><pre>func NewRewriteRuleSetCustomResourceFixture(name string) *agrewrite.AzureApplicationGatewayRewrite {</pre></code></td></tr><tr class="miss"><td>181</td><td><code><pre>        return &amp;agrewrite.AzureApplicationGatewayRewrite{</pre></code></td></tr><tr><td>182</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>183</td><td><code><pre>                        Namespace: Namespace,</pre></code></td></tr><tr><td>184</td><td><code><pre>                        Name:      name,</pre></code></td></tr><tr><td>185</td><td><code><pre>                },</pre></code></td></tr><tr><td>186</td><td><code><pre>                Spec: agrewrite.AzureApplicationGatewayRewriteSpec{</pre></code></td></tr><tr><td>187</td><td><code><pre>                        RewriteRules: []agrewrite.RewriteRule{</pre></code></td></tr><tr><td>188</td><td><code><pre>                                {</pre></code></td></tr><tr><td>189</td><td><code><pre>                                        Name:         &#34;test-rule&#34;,</pre></code></td></tr><tr><td>190</td><td><code><pre>                                        RuleSequence: 101,</pre></code></td></tr><tr><td>191</td><td><code><pre>                                        Actions: agrewrite.Actions{</pre></code></td></tr><tr><td>192</td><td><code><pre>                                                RequestHeaderConfigurations: []agrewrite.HeaderConfiguration{</pre></code></td></tr><tr><td>193</td><td><code><pre>                                                        {</pre></code></td></tr><tr><td>194</td><td><code><pre>                                                                ActionType:  &#34;set&#34;,</pre></code></td></tr><tr><td>195</td><td><code><pre>                                                                HeaderName:  &#34;aa&#34;,</pre></code></td></tr><tr><td>196</td><td><code><pre>                                                                HeaderValue: &#34;bb&#34;,</pre></code></td></tr><tr><td>197</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>198</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>199</td><td><code><pre>                                                ResponseHeaderConfigurations: []agrewrite.HeaderConfiguration{</pre></code></td></tr><tr><td>200</td><td><code><pre>                                                        {</pre></code></td></tr><tr><td>201</td><td><code><pre>                                                                ActionType:  &#34;delete&#34;,</pre></code></td></tr><tr><td>202</td><td><code><pre>                                                                HeaderName:  &#34;cc&#34;,</pre></code></td></tr><tr><td>203</td><td><code><pre>                                                                HeaderValue: &#34;dd&#34;,</pre></code></td></tr><tr><td>204</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>205</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>206</td><td><code><pre>                                                UrlConfiguration: agrewrite.UrlConfiguration{</pre></code></td></tr><tr><td>207</td><td><code><pre>                                                        ModifiedPath:        &#34;ff&#34;,</pre></code></td></tr><tr><td>208</td><td><code><pre>                                                        ModifiedQueryString: &#34;gg&#34;,</pre></code></td></tr><tr><td>209</td><td><code><pre>                                                        Reroute:             false,</pre></code></td></tr><tr><td>210</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>211</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>212</td><td><code><pre>                                        Conditions: []agrewrite.Condition{</pre></code></td></tr><tr><td>213</td><td><code><pre>                                                {</pre></code></td></tr><tr><td>214</td><td><code><pre>                                                        IgnoreCase: false,</pre></code></td></tr><tr><td>215</td><td><code><pre>                                                        Negate:     false,</pre></code></td></tr><tr><td>216</td><td><code><pre>                                                        Variable:   &#34;xx&#34;,</pre></code></td></tr><tr><td>217</td><td><code><pre>                                                        Pattern:    &#34;yy&#34;,</pre></code></td></tr><tr><td>218</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>219</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>220</td><td><code><pre>                                },</pre></code></td></tr><tr><td>221</td><td><code><pre>                        },</pre></code></td></tr><tr><td>222</td><td><code><pre>                },</pre></code></td></tr><tr><td>223</td><td><code><pre>        }</pre></code></td></tr><tr><td>224</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetVerySimpleIngress">func GetVerySimpleIngress</div><div class="info"><a href="#s_fn_GetVerySimpleIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>85</td><td><code><pre>func GetVerySimpleIngress() *networking.Ingress {</pre></code></td></tr><tr class="miss"><td>86</td><td><code><pre>        return &amp;networking.Ingress{</pre></code></td></tr><tr><td>87</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>88</td><td><code><pre>                        DefaultBackend: &amp;networking.IngressBackend{</pre></code></td></tr><tr><td>89</td><td><code><pre>                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>90</td><td><code><pre>                                        Name: &#34;websocket-service&#34;,</pre></code></td></tr><tr><td>91</td><td><code><pre>                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>92</td><td><code><pre>                                                Number: 80,</pre></code></td></tr><tr><td>93</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>94</td><td><code><pre>                                },</pre></code></td></tr><tr><td>95</td><td><code><pre>                        },</pre></code></td></tr><tr><td>96</td><td><code><pre>                },</pre></code></td></tr><tr><td>97</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>98</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>99</td><td><code><pre>                                annotations.IngressClassKey: IngressClassController,</pre></code></td></tr><tr><td>100</td><td><code><pre>                        },</pre></code></td></tr><tr><td>101</td><td><code><pre>                        Name: &#34;websocket-ingress&#34;,</pre></code></td></tr><tr><td>102</td><td><code><pre>                },</pre></code></td></tr><tr><td>103</td><td><code><pre>        }</pre></code></td></tr><tr><td>104</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngressClass">func GetIngressClass</div><div class="info"><a href="#s_fn_GetIngressClass">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures.go</code>:</p></div><table class="listing">
<tr><td>68</td><td><code><pre>func GetIngressClass() *networking.IngressClass {</pre></code></td></tr><tr class="miss"><td>69</td><td><code><pre>        return &amp;networking.IngressClass{</pre></code></td></tr><tr><td>70</td><td><code><pre>                Spec: networking.IngressClassSpec{</pre></code></td></tr><tr><td>71</td><td><code><pre>                        Controller: IngressClassController,</pre></code></td></tr><tr><td>72</td><td><code><pre>                },</pre></code></td></tr><tr><td>73</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>74</td><td><code><pre>                        Name: IngressClassResourceName,</pre></code></td></tr><tr><td>75</td><td><code><pre>                },</pre></code></td></tr><tr><td>76</td><td><code><pre>        }</pre></code></td></tr><tr><td>77</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests DONE:60.00
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures <span class="packageTotal">95.92%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_GetApplicationGatewayProbe"><td><code><a href="#fn_GetApplicationGatewayProbe">GetApplicationGatewayProbe(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/probes.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>8/8</code></td></tr>
<tr id="s_fn_GetAppGateway"><td><code><a href="#fn_GetAppGateway">GetAppGateway(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/app_gateway.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetCertificate2"><td><code><a href="#fn_GetCertificate2">GetCertificate2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetCertificate3"><td><code><a href="#fn_GetCertificate3">GetCertificate3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRootCertificate1"><td><code><a href="#fn_GetRootCertificate1">GetRootCertificate1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRootCertificate2"><td><code><a href="#fn_GetRootCertificate2">GetRootCertificate2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRootCertificate3"><td><code><a href="#fn_GetRootCertificate3">GetRootCertificate3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPublicIPConfiguration"><td><code><a href="#fn_GetPublicIPConfiguration">GetPublicIPConfiguration(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/frontend_ipconfiguration.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPrivateIPConfiguration"><td><code><a href="#fn_GetPrivateIPConfiguration">GetPrivateIPConfiguration(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/frontend_ipconfiguration.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetHTTPSettings1"><td><code><a href="#fn_GetHTTPSettings1">GetHTTPSettings1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetHTTPSettings2"><td><code><a href="#fn_GetHTTPSettings2">GetHTTPSettings2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetHTTPSettings3"><td><code><a href="#fn_GetHTTPSettings3">GetHTTPSettings3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/http_settings.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetIngress"><td><code><a href="#fn_GetIngress">GetIngress(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ingress.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetSslProfile1"><td><code><a href="#fn_GetSslProfile1">GetSslProfile1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ssl_profile.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetListenerBasic"><td><code><a href="#fn_GetListenerBasic">GetListenerBasic(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetDefaultListener"><td><code><a href="#fn_GetDefaultListener">GetDefaultListener(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetListenerPathBased1"><td><code><a href="#fn_GetListenerPathBased1">GetListenerPathBased1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetListenerPathBased2"><td><code><a href="#fn_GetListenerPathBased2">GetListenerPathBased2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetListenerUnassociated"><td><code><a href="#fn_GetListenerUnassociated">GetListenerUnassociated(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetListenerWildcard"><td><code><a href="#fn_GetListenerWildcard">GetListenerWildcard(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetURLPathMap1"><td><code><a href="#fn_GetURLPathMap1">GetURLPathMap1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPathRulePathBased1"><td><code><a href="#fn_GetPathRulePathBased1">GetPathRulePathBased1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPathRuleBasic"><td><code><a href="#fn_GetPathRuleBasic">GetPathRuleBasic(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetDefaultURLPathMap"><td><code><a href="#fn_GetDefaultURLPathMap">GetDefaultURLPathMap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetURLPathMap2"><td><code><a href="#fn_GetURLPathMap2">GetURLPathMap2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPathRulePathBased2"><td><code><a href="#fn_GetPathRulePathBased2">GetPathRulePathBased2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetURLPathMap3"><td><code><a href="#fn_GetURLPathMap3">GetURLPathMap3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPathRulePathBased3"><td><code><a href="#fn_GetPathRulePathBased3">GetPathRulePathBased3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetDefaultBackendPool"><td><code><a href="#fn_GetDefaultBackendPool">GetDefaultBackendPool(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetBackendPool1"><td><code><a href="#fn_GetBackendPool1">GetBackendPool1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetBackendPool2"><td><code><a href="#fn_GetBackendPool2">GetBackendPool2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetBackendPool3"><td><code><a href="#fn_GetBackendPool3">GetBackendPool3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetDefaultPort"><td><code><a href="#fn_GetDefaultPort">GetDefaultPort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ports.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetDefaultRoutingRule"><td><code><a href="#fn_GetDefaultRoutingRule">GetDefaultRoutingRule(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetCertificate1"><td><code><a href="#fn_GetCertificate1">GetCertificate1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRequestRoutingRulePathBased1"><td><code><a href="#fn_GetRequestRoutingRulePathBased1">GetRequestRoutingRulePathBased1(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRequestRoutingRulePathBased2"><td><code><a href="#fn_GetRequestRoutingRulePathBased2">GetRequestRoutingRulePathBased2(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRequestRoutingRulePathBased3"><td><code><a href="#fn_GetRequestRoutingRulePathBased3">GetRequestRoutingRulePathBased3(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetRequestRoutingRuleBasic"><td><code><a href="#fn_GetRequestRoutingRuleBasic">GetRequestRoutingRuleBasic(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetAzureIngressProhibitedTargets"><td><code><a href="#fn_GetAzureIngressProhibitedTargets">GetAzureIngressProhibitedTargets(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/targets.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetPort"><td><code><a href="#fn_GetPort">GetPort(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ports.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr id="s_fn_GetIngressWithProhibitedTargetConflict"><td><code><a href="#fn_GetIngressWithProhibitedTargetConflict">GetIngressWithProhibitedTargetConflict(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ingress.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/1</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures</code></td><td class="percent"><code>95.92%</code></td><td class="linecount"><code>47/49</code></td></tr>
</table>

<div class="funcname" id="fn_GetApplicationGatewayProbe">func GetApplicationGatewayProbe</div><div class="info"><a href="#s_fn_GetApplicationGatewayProbe">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/probes.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func GetApplicationGatewayProbe(host *string, path *string) n.ApplicationGatewayProbe {</pre></code></td></tr><tr><td>32</td><td><code><pre>        if host == nil {</pre></code></td></tr><tr><td>33</td><td><code><pre>                host = to.StringPtr(tests.Host)</pre></code></td></tr><tr><td>34</td><td><code><pre>        }</pre></code></td></tr><tr><td>35</td><td><code><pre>        if path == nil {</pre></code></td></tr><tr><td>36</td><td><code><pre>                path = to.StringPtr(&#34;/foo&#34;)</pre></code></td></tr><tr><td>37</td><td><code><pre>        }</pre></code></td></tr><tr><td>38</td><td><code><pre></pre></code></td></tr><tr><td>39</td><td><code><pre>        encodedHost := strings.TrimRight(base64.StdEncoding.EncodeToString([]byte(*host)), &#34;=&#34;)</pre></code></td></tr><tr><td>40</td><td><code><pre>        encodedPath := strings.TrimRight(base64.StdEncoding.EncodeToString([]byte(*path)), &#34;=&#34;)</pre></code></td></tr><tr><td>41</td><td><code><pre>        probeName := to.StringPtr(fmt.Sprintf(&#34;probe-name-%s-%s&#34;, encodedHost, encodedPath))</pre></code></td></tr><tr><td>42</td><td><code><pre></pre></code></td></tr><tr><td>43</td><td><code><pre>        return n.ApplicationGatewayProbe{</pre></code></td></tr><tr><td>44</td><td><code><pre>                ApplicationGatewayProbePropertiesFormat: &amp;n.ApplicationGatewayProbePropertiesFormat{</pre></code></td></tr><tr><td>45</td><td><code><pre>                        Protocol: n.ApplicationGatewayProtocolHTTPS,</pre></code></td></tr><tr><td>46</td><td><code><pre>                        Host:     host,</pre></code></td></tr><tr><td>47</td><td><code><pre>                        Path:     path,</pre></code></td></tr><tr><td>48</td><td><code><pre>                },</pre></code></td></tr><tr><td>49</td><td><code><pre>                Name: probeName,</pre></code></td></tr><tr><td>50</td><td><code><pre>                ID:   to.StringPtr(&#34;abcd&#34;),</pre></code></td></tr><tr><td>51</td><td><code><pre>        }</pre></code></td></tr><tr><td>52</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAppGateway">func GetAppGateway</div><div class="info"><a href="#s_fn_GetAppGateway">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/app_gateway.go</code>:</p></div><table class="listing">
<tr><td>16</td><td><code><pre>func GetAppGateway() n.ApplicationGateway {</pre></code></td></tr><tr><td>17</td><td><code><pre>        // The order of the lists below is important as we reference these by index in unit tests.</pre></code></td></tr><tr><td>18</td><td><code><pre>        return n.ApplicationGateway{</pre></code></td></tr><tr><td>19</td><td><code><pre>                ID: to.StringPtr(&#34;something&#34;),</pre></code></td></tr><tr><td>20</td><td><code><pre>                ApplicationGatewayPropertiesFormat: &amp;n.ApplicationGatewayPropertiesFormat{</pre></code></td></tr><tr><td>21</td><td><code><pre></pre></code></td></tr><tr><td>22</td><td><code><pre>                        RequestRoutingRules: &amp;[]n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>23</td><td><code><pre>                                *GetDefaultRoutingRule(),</pre></code></td></tr><tr><td>24</td><td><code><pre>                                *GetRequestRoutingRuleBasic(),</pre></code></td></tr><tr><td>25</td><td><code><pre>                                *GetRequestRoutingRulePathBased1(),</pre></code></td></tr><tr><td>26</td><td><code><pre>                                *GetRequestRoutingRulePathBased2(),</pre></code></td></tr><tr><td>27</td><td><code><pre>                                *GetRequestRoutingRulePathBased3(),</pre></code></td></tr><tr><td>28</td><td><code><pre>                        },</pre></code></td></tr><tr><td>29</td><td><code><pre>                        URLPathMaps: &amp;[]n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>30</td><td><code><pre>                                *GetDefaultURLPathMap(),</pre></code></td></tr><tr><td>31</td><td><code><pre>                                *GetURLPathMap1(),</pre></code></td></tr><tr><td>32</td><td><code><pre>                                *GetURLPathMap2(),</pre></code></td></tr><tr><td>33</td><td><code><pre>                                *GetURLPathMap3(),</pre></code></td></tr><tr><td>34</td><td><code><pre>                        },</pre></code></td></tr><tr><td>35</td><td><code><pre></pre></code></td></tr><tr><td>36</td><td><code><pre>                        HTTPListeners: &amp;[]n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>37</td><td><code><pre>                                *GetDefaultListener(),</pre></code></td></tr><tr><td>38</td><td><code><pre>                                *GetListenerBasic(),</pre></code></td></tr><tr><td>39</td><td><code><pre>                                *GetListenerPathBased1(),</pre></code></td></tr><tr><td>40</td><td><code><pre>                                *GetListenerPathBased2(),</pre></code></td></tr><tr><td>41</td><td><code><pre>                                *GetListenerUnassociated(),</pre></code></td></tr><tr><td>42</td><td><code><pre>                                *GetListenerWildcard(),</pre></code></td></tr><tr><td>43</td><td><code><pre>                        },</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr><td>45</td><td><code><pre>                        SslCertificates: &amp;[]n.ApplicationGatewaySslCertificate{</pre></code></td></tr><tr><td>46</td><td><code><pre>                                GetCertificate1(),</pre></code></td></tr><tr><td>47</td><td><code><pre>                                GetCertificate2(),</pre></code></td></tr><tr><td>48</td><td><code><pre>                                GetCertificate3(),</pre></code></td></tr><tr><td>49</td><td><code><pre>                        },</pre></code></td></tr><tr><td>50</td><td><code><pre></pre></code></td></tr><tr><td>51</td><td><code><pre>                        SslProfiles: &amp;[]n.ApplicationGatewaySslProfile{</pre></code></td></tr><tr><td>52</td><td><code><pre>                                GetSslProfile1(),</pre></code></td></tr><tr><td>53</td><td><code><pre>                        },</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr><td>55</td><td><code><pre>                        TrustedRootCertificates: &amp;[]n.ApplicationGatewayTrustedRootCertificate{</pre></code></td></tr><tr><td>56</td><td><code><pre>                                GetRootCertificate1(),</pre></code></td></tr><tr><td>57</td><td><code><pre>                                GetRootCertificate2(),</pre></code></td></tr><tr><td>58</td><td><code><pre>                                GetRootCertificate3(),</pre></code></td></tr><tr><td>59</td><td><code><pre>                        },</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>                        Probes: &amp;[]n.ApplicationGatewayProbe{</pre></code></td></tr><tr><td>62</td><td><code><pre>                                GetApplicationGatewayProbe(nil, to.StringPtr(PathFoo)), // /foo</pre></code></td></tr><tr><td>63</td><td><code><pre>                                GetApplicationGatewayProbe(nil, to.StringPtr(PathBar)), // /bar</pre></code></td></tr><tr><td>64</td><td><code><pre>                                GetApplicationGatewayProbe(to.StringPtr(tests.OtherHost), nil),</pre></code></td></tr><tr><td>65</td><td><code><pre>                        },</pre></code></td></tr><tr><td>66</td><td><code><pre></pre></code></td></tr><tr><td>67</td><td><code><pre>                        BackendHTTPSettingsCollection: &amp;[]n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>68</td><td><code><pre>                                GetHTTPSettings1(),</pre></code></td></tr><tr><td>69</td><td><code><pre>                                GetHTTPSettings2(),</pre></code></td></tr><tr><td>70</td><td><code><pre>                                GetHTTPSettings3(),</pre></code></td></tr><tr><td>71</td><td><code><pre>                        },</pre></code></td></tr><tr><td>72</td><td><code><pre></pre></code></td></tr><tr><td>73</td><td><code><pre>                        FrontendIPConfigurations: &amp;[]n.ApplicationGatewayFrontendIPConfiguration{</pre></code></td></tr><tr><td>74</td><td><code><pre>                                GetPublicIPConfiguration(),</pre></code></td></tr><tr><td>75</td><td><code><pre>                        },</pre></code></td></tr><tr><td>76</td><td><code><pre></pre></code></td></tr><tr><td>77</td><td><code><pre>                        RedirectConfigurations: &amp;[]n.ApplicationGatewayRedirectConfiguration{</pre></code></td></tr><tr><td>78</td><td><code><pre>                                {</pre></code></td></tr><tr><td>79</td><td><code><pre>                                        Name: to.StringPtr(&#34;redirect-1&#34;),</pre></code></td></tr><tr><td>80</td><td><code><pre>                                        ApplicationGatewayRedirectConfigurationPropertiesFormat: &amp;n.ApplicationGatewayRedirectConfigurationPropertiesFormat{},</pre></code></td></tr><tr><td>81</td><td><code><pre>                                },</pre></code></td></tr><tr><td>82</td><td><code><pre>                        },</pre></code></td></tr><tr><td>83</td><td><code><pre>                },</pre></code></td></tr><tr><td>84</td><td><code><pre>        }</pre></code></td></tr><tr><td>85</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetCertificate2">func GetCertificate2</div><div class="info"><a href="#s_fn_GetCertificate2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code>:</p></div><table class="listing">
<tr><td>41</td><td><code><pre>func GetCertificate2() n.ApplicationGatewaySslCertificate {</pre></code></td></tr><tr><td>42</td><td><code><pre>        return n.ApplicationGatewaySslCertificate{</pre></code></td></tr><tr><td>43</td><td><code><pre>                Name: to.StringPtr(CertificateName2),</pre></code></td></tr><tr><td>44</td><td><code><pre>        }</pre></code></td></tr><tr><td>45</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetCertificate3">func GetCertificate3</div><div class="info"><a href="#s_fn_GetCertificate3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code>:</p></div><table class="listing">
<tr><td>48</td><td><code><pre>func GetCertificate3() n.ApplicationGatewaySslCertificate {</pre></code></td></tr><tr><td>49</td><td><code><pre>        return n.ApplicationGatewaySslCertificate{</pre></code></td></tr><tr><td>50</td><td><code><pre>                Name: to.StringPtr(CertificateName3),</pre></code></td></tr><tr><td>51</td><td><code><pre>        }</pre></code></td></tr><tr><td>52</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRootCertificate1">func GetRootCertificate1</div><div class="info"><a href="#s_fn_GetRootCertificate1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code>:</p></div><table class="listing">
<tr><td>55</td><td><code><pre>func GetRootCertificate1() n.ApplicationGatewayTrustedRootCertificate {</pre></code></td></tr><tr><td>56</td><td><code><pre>        return n.ApplicationGatewayTrustedRootCertificate{</pre></code></td></tr><tr><td>57</td><td><code><pre>                Name: to.StringPtr(RootCertificateName1),</pre></code></td></tr><tr><td>58</td><td><code><pre>        }</pre></code></td></tr><tr><td>59</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRootCertificate2">func GetRootCertificate2</div><div class="info"><a href="#s_fn_GetRootCertificate2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code>:</p></div><table class="listing">
<tr><td>62</td><td><code><pre>func GetRootCertificate2() n.ApplicationGatewayTrustedRootCertificate {</pre></code></td></tr><tr><td>63</td><td><code><pre>        return n.ApplicationGatewayTrustedRootCertificate{</pre></code></td></tr><tr><td>64</td><td><code><pre>                Name: to.StringPtr(RootCertificateName2),</pre></code></td></tr><tr><td>65</td><td><code><pre>        }</pre></code></td></tr><tr><td>66</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRootCertificate3">func GetRootCertificate3</div><div class="info"><a href="#s_fn_GetRootCertificate3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code>:</p></div><table class="listing">
<tr><td>69</td><td><code><pre>func GetRootCertificate3() n.ApplicationGatewayTrustedRootCertificate {</pre></code></td></tr><tr><td>70</td><td><code><pre>        return n.ApplicationGatewayTrustedRootCertificate{</pre></code></td></tr><tr><td>71</td><td><code><pre>                Name: to.StringPtr(RootCertificateName3),</pre></code></td></tr><tr><td>72</td><td><code><pre>        }</pre></code></td></tr><tr><td>73</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPublicIPConfiguration">func GetPublicIPConfiguration</div><div class="info"><a href="#s_fn_GetPublicIPConfiguration">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/frontend_ipconfiguration.go</code>:</p></div><table class="listing">
<tr><td>23</td><td><code><pre>func GetPublicIPConfiguration() n.ApplicationGatewayFrontendIPConfiguration {</pre></code></td></tr><tr><td>24</td><td><code><pre>        return n.ApplicationGatewayFrontendIPConfiguration{</pre></code></td></tr><tr><td>25</td><td><code><pre>                Name: to.StringPtr(PublicIPName),</pre></code></td></tr><tr><td>26</td><td><code><pre>                Etag: to.StringPtr(&#34;xx2&#34;),</pre></code></td></tr><tr><td>27</td><td><code><pre>                Type: to.StringPtr(&#34;xx1&#34;),</pre></code></td></tr><tr><td>28</td><td><code><pre>                ID:   to.StringPtr(PublicIPName),</pre></code></td></tr><tr><td>29</td><td><code><pre>                ApplicationGatewayFrontendIPConfigurationPropertiesFormat: &amp;n.ApplicationGatewayFrontendIPConfigurationPropertiesFormat{</pre></code></td></tr><tr><td>30</td><td><code><pre>                        PrivateIPAddress: nil,</pre></code></td></tr><tr><td>31</td><td><code><pre>                        PublicIPAddress: &amp;n.SubResource{</pre></code></td></tr><tr><td>32</td><td><code><pre>                                ID: to.StringPtr(&#34;xyz&#34;),</pre></code></td></tr><tr><td>33</td><td><code><pre>                        },</pre></code></td></tr><tr><td>34</td><td><code><pre>                },</pre></code></td></tr><tr><td>35</td><td><code><pre>        }</pre></code></td></tr><tr><td>36</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPrivateIPConfiguration">func GetPrivateIPConfiguration</div><div class="info"><a href="#s_fn_GetPrivateIPConfiguration">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/frontend_ipconfiguration.go</code>:</p></div><table class="listing">
<tr><td>39</td><td><code><pre>func GetPrivateIPConfiguration() n.ApplicationGatewayFrontendIPConfiguration {</pre></code></td></tr><tr><td>40</td><td><code><pre>        return n.ApplicationGatewayFrontendIPConfiguration{</pre></code></td></tr><tr><td>41</td><td><code><pre>                Name: to.StringPtr(PrivateIPName),</pre></code></td></tr><tr><td>42</td><td><code><pre>                Etag: to.StringPtr(&#34;yy2&#34;),</pre></code></td></tr><tr><td>43</td><td><code><pre>                Type: to.StringPtr(&#34;yy1&#34;),</pre></code></td></tr><tr><td>44</td><td><code><pre>                ID:   to.StringPtr(PrivateIPName),</pre></code></td></tr><tr><td>45</td><td><code><pre>                ApplicationGatewayFrontendIPConfigurationPropertiesFormat: &amp;n.ApplicationGatewayFrontendIPConfigurationPropertiesFormat{</pre></code></td></tr><tr><td>46</td><td><code><pre>                        PrivateIPAddress: to.StringPtr(&#34;abc&#34;),</pre></code></td></tr><tr><td>47</td><td><code><pre>                        PublicIPAddress:  nil,</pre></code></td></tr><tr><td>48</td><td><code><pre>                },</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetHTTPSettings1">func GetHTTPSettings1</div><div class="info"><a href="#s_fn_GetHTTPSettings1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/http_settings.go</code>:</p></div><table class="listing">
<tr><td>23</td><td><code><pre>func GetHTTPSettings1() n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr><td>24</td><td><code><pre>        return n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>25</td><td><code><pre>                ApplicationGatewayBackendHTTPSettingsPropertiesFormat: &amp;n.ApplicationGatewayBackendHTTPSettingsPropertiesFormat{</pre></code></td></tr><tr><td>26</td><td><code><pre>                        Probe: &amp;n.SubResource{ID: to.StringPtr(&#34;/x/y/z/&#34; + ProbeName1)},</pre></code></td></tr><tr><td>27</td><td><code><pre>                },</pre></code></td></tr><tr><td>28</td><td><code><pre>                Name: to.StringPtr(BackendHTTPSettingsName1),</pre></code></td></tr><tr><td>29</td><td><code><pre>        }</pre></code></td></tr><tr><td>30</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetHTTPSettings2">func GetHTTPSettings2</div><div class="info"><a href="#s_fn_GetHTTPSettings2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/http_settings.go</code>:</p></div><table class="listing">
<tr><td>33</td><td><code><pre>func GetHTTPSettings2() n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr><td>34</td><td><code><pre>        return n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>35</td><td><code><pre>                ApplicationGatewayBackendHTTPSettingsPropertiesFormat: &amp;n.ApplicationGatewayBackendHTTPSettingsPropertiesFormat{</pre></code></td></tr><tr><td>36</td><td><code><pre>                        Probe: &amp;n.SubResource{ID: to.StringPtr(&#34;/x/y/z/&#34; + ProbeName2)},</pre></code></td></tr><tr><td>37</td><td><code><pre>                },</pre></code></td></tr><tr><td>38</td><td><code><pre>                Name: to.StringPtr(BackendHTTPSettingsName2),</pre></code></td></tr><tr><td>39</td><td><code><pre>        }</pre></code></td></tr><tr><td>40</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetHTTPSettings3">func GetHTTPSettings3</div><div class="info"><a href="#s_fn_GetHTTPSettings3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/http_settings.go</code>:</p></div><table class="listing">
<tr><td>43</td><td><code><pre>func GetHTTPSettings3() n.ApplicationGatewayBackendHTTPSettings {</pre></code></td></tr><tr><td>44</td><td><code><pre>        return n.ApplicationGatewayBackendHTTPSettings{</pre></code></td></tr><tr><td>45</td><td><code><pre>                ApplicationGatewayBackendHTTPSettingsPropertiesFormat: &amp;n.ApplicationGatewayBackendHTTPSettingsPropertiesFormat{</pre></code></td></tr><tr><td>46</td><td><code><pre>                        Probe: &amp;n.SubResource{ID: to.StringPtr(&#34;/x/y/z/&#34; + ProbeName3)},</pre></code></td></tr><tr><td>47</td><td><code><pre>                },</pre></code></td></tr><tr><td>48</td><td><code><pre>                Name: to.StringPtr(BackendHTTPSettingsName3),</pre></code></td></tr><tr><td>49</td><td><code><pre>        }</pre></code></td></tr><tr><td>50</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngress">func GetIngress</div><div class="info"><a href="#s_fn_GetIngress">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ingress.go</code>:</p></div><table class="listing">
<tr><td>12</td><td><code><pre>func GetIngress() *networking.Ingress {</pre></code></td></tr><tr><td>13</td><td><code><pre>        return &amp;networking.Ingress{</pre></code></td></tr><tr><td>14</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>15</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>16</td><td><code><pre>                                {</pre></code></td></tr><tr><td>17</td><td><code><pre>                                        Host: &#34;foo.baz&#34;,</pre></code></td></tr><tr><td>18</td><td><code><pre>                                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>19</td><td><code><pre>                                                HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>20</td><td><code><pre>                                                        Paths: []networking.HTTPIngressPath{</pre></code></td></tr><tr><td>21</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>22</td><td><code><pre>                                                                        Path: &#34;/&#34;,</pre></code></td></tr><tr><td>23</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>24</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>25</td><td><code><pre>                                                                                        Name: tests.ServiceName,</pre></code></td></tr><tr><td>26</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>27</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>28</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>29</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>30</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>31</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>32</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>33</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>34</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>35</td><td><code><pre>                                },</pre></code></td></tr><tr><td>36</td><td><code><pre>                        },</pre></code></td></tr><tr><td>37</td><td><code><pre>                        TLS: []networking.IngressTLS{</pre></code></td></tr><tr><td>38</td><td><code><pre>                                {</pre></code></td></tr><tr><td>39</td><td><code><pre>                                        Hosts: []string{</pre></code></td></tr><tr><td>40</td><td><code><pre>                                                &#34;www.contoso.com&#34;,</pre></code></td></tr><tr><td>41</td><td><code><pre>                                                &#34;ftp.contoso.com&#34;,</pre></code></td></tr><tr><td>42</td><td><code><pre>                                                tests.Host,</pre></code></td></tr><tr><td>43</td><td><code><pre>                                                &#34;&#34;,</pre></code></td></tr><tr><td>44</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>45</td><td><code><pre>                                        SecretName: tests.NameOfSecret,</pre></code></td></tr><tr><td>46</td><td><code><pre>                                },</pre></code></td></tr><tr><td>47</td><td><code><pre>                                {</pre></code></td></tr><tr><td>48</td><td><code><pre>                                        Hosts:      []string{},</pre></code></td></tr><tr><td>49</td><td><code><pre>                                        SecretName: tests.NameOfSecret,</pre></code></td></tr><tr><td>50</td><td><code><pre>                                },</pre></code></td></tr><tr><td>51</td><td><code><pre>                        },</pre></code></td></tr><tr><td>52</td><td><code><pre>                },</pre></code></td></tr><tr><td>53</td><td><code><pre>                ObjectMeta: metav1.ObjectMeta{</pre></code></td></tr><tr><td>54</td><td><code><pre>                        Annotations: map[string]string{</pre></code></td></tr><tr><td>55</td><td><code><pre>                                annotations.IngressClassKey: tests.IngressClassController,</pre></code></td></tr><tr><td>56</td><td><code><pre>                                annotations.SslRedirectKey:  &#34;true&#34;,</pre></code></td></tr><tr><td>57</td><td><code><pre>                        },</pre></code></td></tr><tr><td>58</td><td><code><pre>                        Namespace: tests.Namespace,</pre></code></td></tr><tr><td>59</td><td><code><pre>                        Name:      tests.Name,</pre></code></td></tr><tr><td>60</td><td><code><pre>                },</pre></code></td></tr><tr><td>61</td><td><code><pre>        }</pre></code></td></tr><tr><td>62</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetSslProfile1">func GetSslProfile1</div><div class="info"><a href="#s_fn_GetSslProfile1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ssl_profile.go</code>:</p></div><table class="listing">
<tr><td>19</td><td><code><pre>func GetSslProfile1() n.ApplicationGatewaySslProfile {</pre></code></td></tr><tr><td>20</td><td><code><pre>        return n.ApplicationGatewaySslProfile{</pre></code></td></tr><tr><td>21</td><td><code><pre>                Name: to.StringPtr(SslProfileName1),</pre></code></td></tr><tr><td>22</td><td><code><pre>        }</pre></code></td></tr><tr><td>23</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetListenerBasic">func GetListenerBasic</div><div class="info"><a href="#s_fn_GetListenerBasic">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code>:</p></div><table class="listing">
<tr><td>36</td><td><code><pre>func GetListenerBasic() *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>37</td><td><code><pre>        return &amp;n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>38</td><td><code><pre>                Name: to.StringPtr(HTTPListenerNameBasic),</pre></code></td></tr><tr><td>39</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>40</td><td><code><pre>                        FrontendIPConfiguration:     &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>41</td><td><code><pre>                        FrontendPort:                &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>42</td><td><code><pre>                        Protocol:                    n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>43</td><td><code><pre>                        HostName:                    to.StringPtr(tests.OtherHost),</pre></code></td></tr><tr><td>44</td><td><code><pre>                        SslCertificate:              &amp;n.SubResource{ID: to.StringPtr(CertificateName1)},</pre></code></td></tr><tr><td>45</td><td><code><pre>                        RequireServerNameIndication: to.BoolPtr(true),</pre></code></td></tr><tr><td>46</td><td><code><pre>                },</pre></code></td></tr><tr><td>47</td><td><code><pre>        }</pre></code></td></tr><tr><td>48</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetDefaultListener">func GetDefaultListener</div><div class="info"><a href="#s_fn_GetDefaultListener">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code>:</p></div><table class="listing">
<tr><td>51</td><td><code><pre>func GetDefaultListener() *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>52</td><td><code><pre>        return &amp;n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>53</td><td><code><pre>                Name: to.StringPtr(DefaultHTTPListenerName),</pre></code></td></tr><tr><td>54</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>55</td><td><code><pre>                        FrontendIPConfiguration: &amp;n.SubResource{ID: to.StringPtr(&#34;/x/y/z/&#34; + DefaultIPName)},</pre></code></td></tr><tr><td>56</td><td><code><pre>                        FrontendPort:            &amp;n.SubResource{ID: to.StringPtr(&#34;/x/y/z/&#34; + DefaultPortName)},</pre></code></td></tr><tr><td>57</td><td><code><pre>                        Protocol:                n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>58</td><td><code><pre>                },</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetListenerPathBased1">func GetListenerPathBased1</div><div class="info"><a href="#s_fn_GetListenerPathBased1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code>:</p></div><table class="listing">
<tr><td>63</td><td><code><pre>func GetListenerPathBased1() *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>64</td><td><code><pre>        return &amp;n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>65</td><td><code><pre>                Name: to.StringPtr(HTTPListenerPathBased1),</pre></code></td></tr><tr><td>66</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>67</td><td><code><pre>                        FrontendIPConfiguration:     &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>68</td><td><code><pre>                        FrontendPort:                &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>69</td><td><code><pre>                        Protocol:                    n.ApplicationGatewayProtocolHTTPS,</pre></code></td></tr><tr><td>70</td><td><code><pre>                        HostName:                    to.StringPtr(tests.Host),</pre></code></td></tr><tr><td>71</td><td><code><pre>                        SslCertificate:              &amp;n.SubResource{ID: to.StringPtr(CertificateName2)},</pre></code></td></tr><tr><td>72</td><td><code><pre>                        RequireServerNameIndication: to.BoolPtr(true),</pre></code></td></tr><tr><td>73</td><td><code><pre>                },</pre></code></td></tr><tr><td>74</td><td><code><pre>        }</pre></code></td></tr><tr><td>75</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetListenerPathBased2">func GetListenerPathBased2</div><div class="info"><a href="#s_fn_GetListenerPathBased2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code>:</p></div><table class="listing">
<tr><td>78</td><td><code><pre>func GetListenerPathBased2() *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>79</td><td><code><pre>        return &amp;n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>80</td><td><code><pre>                Name: to.StringPtr(HTTPListenerPathBased2),</pre></code></td></tr><tr><td>81</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>82</td><td><code><pre>                        FrontendIPConfiguration:     &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>83</td><td><code><pre>                        FrontendPort:                &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>84</td><td><code><pre>                        Protocol:                    n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>85</td><td><code><pre>                        HostName:                    to.StringPtr(tests.OtherHost),</pre></code></td></tr><tr><td>86</td><td><code><pre>                        SslCertificate:              &amp;n.SubResource{ID: to.StringPtr(CertificateName3)},</pre></code></td></tr><tr><td>87</td><td><code><pre>                        RequireServerNameIndication: to.BoolPtr(true),</pre></code></td></tr><tr><td>88</td><td><code><pre>                },</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr><td>90</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetListenerUnassociated">func GetListenerUnassociated</div><div class="info"><a href="#s_fn_GetListenerUnassociated">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code>:</p></div><table class="listing">
<tr><td>93</td><td><code><pre>func GetListenerUnassociated() *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>94</td><td><code><pre>        return &amp;n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>95</td><td><code><pre>                Name: to.StringPtr(HTTPListenerUnassociated),</pre></code></td></tr><tr><td>96</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>97</td><td><code><pre>                        FrontendIPConfiguration:     &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>98</td><td><code><pre>                        FrontendPort:                &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>99</td><td><code><pre>                        Protocol:                    n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>100</td><td><code><pre>                        HostName:                    to.StringPtr(tests.HostUnassociated),</pre></code></td></tr><tr><td>101</td><td><code><pre>                        RequireServerNameIndication: to.BoolPtr(true),</pre></code></td></tr><tr><td>102</td><td><code><pre>                },</pre></code></td></tr><tr><td>103</td><td><code><pre>        }</pre></code></td></tr><tr><td>104</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetListenerWildcard">func GetListenerWildcard</div><div class="info"><a href="#s_fn_GetListenerWildcard">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/listeners.go</code>:</p></div><table class="listing">
<tr><td>107</td><td><code><pre>func GetListenerWildcard() *n.ApplicationGatewayHTTPListener {</pre></code></td></tr><tr><td>108</td><td><code><pre>        return &amp;n.ApplicationGatewayHTTPListener{</pre></code></td></tr><tr><td>109</td><td><code><pre>                Name: to.StringPtr(HTTPListenerWildcard),</pre></code></td></tr><tr><td>110</td><td><code><pre>                ApplicationGatewayHTTPListenerPropertiesFormat: &amp;n.ApplicationGatewayHTTPListenerPropertiesFormat{</pre></code></td></tr><tr><td>111</td><td><code><pre>                        FrontendIPConfiguration:     &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>112</td><td><code><pre>                        FrontendPort:                &amp;n.SubResource{ID: to.StringPtr(&#34;&#34;)},</pre></code></td></tr><tr><td>113</td><td><code><pre>                        Protocol:                    n.ApplicationGatewayProtocolHTTP,</pre></code></td></tr><tr><td>114</td><td><code><pre>                        HostNames:                   &amp;[]string{tests.WildcardHost1, tests.WildcardHost2},</pre></code></td></tr><tr><td>115</td><td><code><pre>                        RequireServerNameIndication: to.BoolPtr(true),</pre></code></td></tr><tr><td>116</td><td><code><pre>                },</pre></code></td></tr><tr><td>117</td><td><code><pre>        }</pre></code></td></tr><tr><td>118</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetURLPathMap1">func GetURLPathMap1</div><div class="info"><a href="#s_fn_GetURLPathMap1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func GetURLPathMap1() *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>35</td><td><code><pre>        return &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>36</td><td><code><pre>                Name: to.StringPtr(URLPathMapName1),</pre></code></td></tr><tr><td>37</td><td><code><pre>                ID:   to.StringPtr(&#34;x/y/z/&#34; + URLPathMapName1),</pre></code></td></tr><tr><td>38</td><td><code><pre>                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>39</td><td><code><pre>                        // DefaultBackendAddressPool - Default backend address pool resource of URL path map.</pre></code></td></tr><tr><td>40</td><td><code><pre>                        DefaultBackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>41</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>42</td><td><code><pre>                        },</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr><td>44</td><td><code><pre>                        // DefaultBackendHTTPSettings - Default backend http settings resource of URL path map.</pre></code></td></tr><tr><td>45</td><td><code><pre>                        DefaultBackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>46</td><td><code><pre>                                ID: to.StringPtr(BackendHTTPSettingsName1),</pre></code></td></tr><tr><td>47</td><td><code><pre>                        },</pre></code></td></tr><tr><td>48</td><td><code><pre></pre></code></td></tr><tr><td>49</td><td><code><pre>                        // DefaultRewriteRuleSet - Default Rewrite rule set resource of URL path map.</pre></code></td></tr><tr><td>50</td><td><code><pre>                        DefaultRewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>51</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>52</td><td><code><pre>                        },</pre></code></td></tr><tr><td>53</td><td><code><pre></pre></code></td></tr><tr><td>54</td><td><code><pre>                        // DefaultRedirectConfiguration - Default redirect configuration resource of URL path map.</pre></code></td></tr><tr><td>55</td><td><code><pre>                        DefaultRedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>56</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>57</td><td><code><pre>                        },</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>                        // PathRules - Path rule of URL path map resource.</pre></code></td></tr><tr><td>60</td><td><code><pre>                        PathRules: &amp;[]n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>61</td><td><code><pre>                                *GetPathRulePathBased1(),</pre></code></td></tr><tr><td>62</td><td><code><pre>                                *GetPathRuleBasic(),</pre></code></td></tr><tr><td>63</td><td><code><pre>                        },</pre></code></td></tr><tr><td>64</td><td><code><pre>                },</pre></code></td></tr><tr><td>65</td><td><code><pre>        }</pre></code></td></tr><tr><td>66</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPathRulePathBased1">func GetPathRulePathBased1</div><div class="info"><a href="#s_fn_GetPathRulePathBased1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>69</td><td><code><pre>func GetPathRulePathBased1() *n.ApplicationGatewayPathRule {</pre></code></td></tr><tr><td>70</td><td><code><pre>        return &amp;n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>71</td><td><code><pre>                Name: to.StringPtr(PathRuleName + URLPathMapName1),</pre></code></td></tr><tr><td>72</td><td><code><pre>                ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>73</td><td><code><pre>                        // Paths - Path rules of URL path map.</pre></code></td></tr><tr><td>74</td><td><code><pre>                        Paths: &amp;[]string{</pre></code></td></tr><tr><td>75</td><td><code><pre>                                PathFoo,</pre></code></td></tr><tr><td>76</td><td><code><pre>                                PathBar,</pre></code></td></tr><tr><td>77</td><td><code><pre>                                PathBaz,</pre></code></td></tr><tr><td>78</td><td><code><pre>                        },</pre></code></td></tr><tr><td>79</td><td><code><pre></pre></code></td></tr><tr><td>80</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of URL path map path rule.</pre></code></td></tr><tr><td>81</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>82</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName1),</pre></code></td></tr><tr><td>83</td><td><code><pre>                        },</pre></code></td></tr><tr><td>84</td><td><code><pre></pre></code></td></tr><tr><td>85</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of URL path map path rule.</pre></code></td></tr><tr><td>86</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>87</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/BackendHTTPSettings-1&#34;),</pre></code></td></tr><tr><td>88</td><td><code><pre>                        },</pre></code></td></tr><tr><td>89</td><td><code><pre></pre></code></td></tr><tr><td>90</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of URL path map path rule.</pre></code></td></tr><tr><td>91</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>92</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>93</td><td><code><pre>                        },</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr><td>95</td><td><code><pre>                        // RewriteRuleSet - Rewrite rule set resource of URL path map path rule.</pre></code></td></tr><tr><td>96</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>97</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>98</td><td><code><pre>                        },</pre></code></td></tr><tr><td>99</td><td><code><pre>                },</pre></code></td></tr><tr><td>100</td><td><code><pre>        }</pre></code></td></tr><tr><td>101</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPathRuleBasic">func GetPathRuleBasic</div><div class="info"><a href="#s_fn_GetPathRuleBasic">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>104</td><td><code><pre>func GetPathRuleBasic() *n.ApplicationGatewayPathRule {</pre></code></td></tr><tr><td>105</td><td><code><pre>        return &amp;n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>106</td><td><code><pre>                Name: to.StringPtr(PathRuleNameBasic),</pre></code></td></tr><tr><td>107</td><td><code><pre>                ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>108</td><td><code><pre>                        // Paths - Path rules of URL path map.</pre></code></td></tr><tr><td>109</td><td><code><pre>                        Paths: nil,</pre></code></td></tr><tr><td>110</td><td><code><pre></pre></code></td></tr><tr><td>111</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of URL path map path rule.</pre></code></td></tr><tr><td>112</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>113</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName2),</pre></code></td></tr><tr><td>114</td><td><code><pre>                        },</pre></code></td></tr><tr><td>115</td><td><code><pre></pre></code></td></tr><tr><td>116</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of URL path map path rule.</pre></code></td></tr><tr><td>117</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>118</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/BackendHTTPSettings-1&#34;),</pre></code></td></tr><tr><td>119</td><td><code><pre>                        },</pre></code></td></tr><tr><td>120</td><td><code><pre></pre></code></td></tr><tr><td>121</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of URL path map path rule.</pre></code></td></tr><tr><td>122</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>123</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>124</td><td><code><pre>                        },</pre></code></td></tr><tr><td>125</td><td><code><pre></pre></code></td></tr><tr><td>126</td><td><code><pre>                        // RewriteRuleSet - Rewrite rule set resource of URL path map path rule.</pre></code></td></tr><tr><td>127</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>128</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>129</td><td><code><pre>                        },</pre></code></td></tr><tr><td>130</td><td><code><pre>                },</pre></code></td></tr><tr><td>131</td><td><code><pre>        }</pre></code></td></tr><tr><td>132</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetDefaultURLPathMap">func GetDefaultURLPathMap</div><div class="info"><a href="#s_fn_GetDefaultURLPathMap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>135</td><td><code><pre>func GetDefaultURLPathMap() *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>136</td><td><code><pre>        return &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>137</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>138</td><td><code><pre>                Name: to.StringPtr(DefaultPathMapName),</pre></code></td></tr><tr><td>139</td><td><code><pre>                ID:   to.StringPtr(&#34;x/y/z/&#34; + DefaultPathMapName),</pre></code></td></tr><tr><td>140</td><td><code><pre>                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>141</td><td><code><pre>                        DefaultBackendAddressPool:  &amp;n.SubResource{ID: to.StringPtr(&#34;/&#34; + DefaultBackendPoolName)},</pre></code></td></tr><tr><td>142</td><td><code><pre>                        DefaultBackendHTTPSettings: &amp;n.SubResource{ID: to.StringPtr(&#34;/&#34; + DefaultBackendHTTPSettingsName)},</pre></code></td></tr><tr><td>143</td><td><code><pre>                },</pre></code></td></tr><tr><td>144</td><td><code><pre>        }</pre></code></td></tr><tr><td>145</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetURLPathMap2">func GetURLPathMap2</div><div class="info"><a href="#s_fn_GetURLPathMap2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>148</td><td><code><pre>func GetURLPathMap2() *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>149</td><td><code><pre>        return &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>150</td><td><code><pre>                Name: to.StringPtr(URLPathMapName2),</pre></code></td></tr><tr><td>151</td><td><code><pre>                ID:   to.StringPtr(&#34;x/y/z/&#34; + URLPathMapName2),</pre></code></td></tr><tr><td>152</td><td><code><pre>                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>153</td><td><code><pre>                        // DefaultBackendAddressPool - Default backend address pool resource of URL path map.</pre></code></td></tr><tr><td>154</td><td><code><pre>                        DefaultBackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>155</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>156</td><td><code><pre>                        },</pre></code></td></tr><tr><td>157</td><td><code><pre></pre></code></td></tr><tr><td>158</td><td><code><pre>                        // DefaultBackendHTTPSettings - Default backend http settings resource of URL path map.</pre></code></td></tr><tr><td>159</td><td><code><pre>                        DefaultBackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>160</td><td><code><pre>                                ID: to.StringPtr(BackendHTTPSettingsName2),</pre></code></td></tr><tr><td>161</td><td><code><pre>                        },</pre></code></td></tr><tr><td>162</td><td><code><pre></pre></code></td></tr><tr><td>163</td><td><code><pre>                        // DefaultRewriteRuleSet - Default Rewrite rule set resource of URL path map.</pre></code></td></tr><tr><td>164</td><td><code><pre>                        DefaultRewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>165</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>166</td><td><code><pre>                        },</pre></code></td></tr><tr><td>167</td><td><code><pre></pre></code></td></tr><tr><td>168</td><td><code><pre>                        // DefaultRedirectConfiguration - Default redirect configuration resource of URL path map.</pre></code></td></tr><tr><td>169</td><td><code><pre>                        DefaultRedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>170</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>171</td><td><code><pre>                        },</pre></code></td></tr><tr><td>172</td><td><code><pre></pre></code></td></tr><tr><td>173</td><td><code><pre>                        // PathRules - Path rule of URL path map resource.</pre></code></td></tr><tr><td>174</td><td><code><pre>                        PathRules: &amp;[]n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>175</td><td><code><pre>                                *GetPathRulePathBased2(),</pre></code></td></tr><tr><td>176</td><td><code><pre>                        },</pre></code></td></tr><tr><td>177</td><td><code><pre>                },</pre></code></td></tr><tr><td>178</td><td><code><pre>        }</pre></code></td></tr><tr><td>179</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPathRulePathBased2">func GetPathRulePathBased2</div><div class="info"><a href="#s_fn_GetPathRulePathBased2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>182</td><td><code><pre>func GetPathRulePathBased2() *n.ApplicationGatewayPathRule {</pre></code></td></tr><tr><td>183</td><td><code><pre>        return &amp;n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>184</td><td><code><pre>                Name: to.StringPtr(PathRuleName + URLPathMapName2),</pre></code></td></tr><tr><td>185</td><td><code><pre>                ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>186</td><td><code><pre>                        // Paths - Path rules of URL path map.</pre></code></td></tr><tr><td>187</td><td><code><pre>                        Paths: &amp;[]string{</pre></code></td></tr><tr><td>188</td><td><code><pre>                                PathFox,</pre></code></td></tr><tr><td>189</td><td><code><pre>                        },</pre></code></td></tr><tr><td>190</td><td><code><pre></pre></code></td></tr><tr><td>191</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of URL path map path rule.</pre></code></td></tr><tr><td>192</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>193</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName1),</pre></code></td></tr><tr><td>194</td><td><code><pre>                        },</pre></code></td></tr><tr><td>195</td><td><code><pre></pre></code></td></tr><tr><td>196</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of URL path map path rule.</pre></code></td></tr><tr><td>197</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>198</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/BackendHTTPSettings-1&#34;),</pre></code></td></tr><tr><td>199</td><td><code><pre>                        },</pre></code></td></tr><tr><td>200</td><td><code><pre></pre></code></td></tr><tr><td>201</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of URL path map path rule.</pre></code></td></tr><tr><td>202</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>203</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>204</td><td><code><pre>                        },</pre></code></td></tr><tr><td>205</td><td><code><pre></pre></code></td></tr><tr><td>206</td><td><code><pre>                        // RewriteRuleSet - Rewrite rule set resource of URL path map path rule.</pre></code></td></tr><tr><td>207</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>208</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>209</td><td><code><pre>                        },</pre></code></td></tr><tr><td>210</td><td><code><pre>                },</pre></code></td></tr><tr><td>211</td><td><code><pre>        }</pre></code></td></tr><tr><td>212</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetURLPathMap3">func GetURLPathMap3</div><div class="info"><a href="#s_fn_GetURLPathMap3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>215</td><td><code><pre>func GetURLPathMap3() *n.ApplicationGatewayURLPathMap {</pre></code></td></tr><tr><td>216</td><td><code><pre>        return &amp;n.ApplicationGatewayURLPathMap{</pre></code></td></tr><tr><td>217</td><td><code><pre>                Name: to.StringPtr(URLPathMapName3),</pre></code></td></tr><tr><td>218</td><td><code><pre>                ID:   to.StringPtr(&#34;x/y/z/&#34; + URLPathMapName3),</pre></code></td></tr><tr><td>219</td><td><code><pre>                ApplicationGatewayURLPathMapPropertiesFormat: &amp;n.ApplicationGatewayURLPathMapPropertiesFormat{</pre></code></td></tr><tr><td>220</td><td><code><pre>                        // DefaultBackendAddressPool - Default backend address pool resource of URL path map.</pre></code></td></tr><tr><td>221</td><td><code><pre>                        DefaultBackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>222</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>223</td><td><code><pre>                        },</pre></code></td></tr><tr><td>224</td><td><code><pre></pre></code></td></tr><tr><td>225</td><td><code><pre>                        // DefaultBackendHTTPSettings - Default backend http settings resource of URL path map.</pre></code></td></tr><tr><td>226</td><td><code><pre>                        DefaultBackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>227</td><td><code><pre>                                ID: to.StringPtr(BackendHTTPSettingsName2),</pre></code></td></tr><tr><td>228</td><td><code><pre>                        },</pre></code></td></tr><tr><td>229</td><td><code><pre></pre></code></td></tr><tr><td>230</td><td><code><pre>                        // DefaultRewriteRuleSet - Default Rewrite rule set resource of URL path map.</pre></code></td></tr><tr><td>231</td><td><code><pre>                        DefaultRewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>232</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>233</td><td><code><pre>                        },</pre></code></td></tr><tr><td>234</td><td><code><pre></pre></code></td></tr><tr><td>235</td><td><code><pre>                        // DefaultRedirectConfiguration - Default redirect configuration resource of URL path map.</pre></code></td></tr><tr><td>236</td><td><code><pre>                        DefaultRedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>237</td><td><code><pre>                                ID: to.StringPtr(&#34;&#34;),</pre></code></td></tr><tr><td>238</td><td><code><pre>                        },</pre></code></td></tr><tr><td>239</td><td><code><pre></pre></code></td></tr><tr><td>240</td><td><code><pre>                        // PathRules - Path rule of URL path map resource.</pre></code></td></tr><tr><td>241</td><td><code><pre>                        PathRules: &amp;[]n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>242</td><td><code><pre>                                *GetPathRulePathBased3(),</pre></code></td></tr><tr><td>243</td><td><code><pre>                        },</pre></code></td></tr><tr><td>244</td><td><code><pre>                },</pre></code></td></tr><tr><td>245</td><td><code><pre>        }</pre></code></td></tr><tr><td>246</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPathRulePathBased3">func GetPathRulePathBased3</div><div class="info"><a href="#s_fn_GetPathRulePathBased3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/paths.go</code>:</p></div><table class="listing">
<tr><td>249</td><td><code><pre>func GetPathRulePathBased3() *n.ApplicationGatewayPathRule {</pre></code></td></tr><tr><td>250</td><td><code><pre>        return &amp;n.ApplicationGatewayPathRule{</pre></code></td></tr><tr><td>251</td><td><code><pre>                Name: to.StringPtr(PathRuleName + URLPathMapName3),</pre></code></td></tr><tr><td>252</td><td><code><pre>                ApplicationGatewayPathRulePropertiesFormat: &amp;n.ApplicationGatewayPathRulePropertiesFormat{</pre></code></td></tr><tr><td>253</td><td><code><pre>                        // Paths - Path rules of URL path map.</pre></code></td></tr><tr><td>254</td><td><code><pre>                        Paths: &amp;[]string{</pre></code></td></tr><tr><td>255</td><td><code><pre>                                PathFox,</pre></code></td></tr><tr><td>256</td><td><code><pre>                        },</pre></code></td></tr><tr><td>257</td><td><code><pre></pre></code></td></tr><tr><td>258</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of URL path map path rule.</pre></code></td></tr><tr><td>259</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>260</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName1),</pre></code></td></tr><tr><td>261</td><td><code><pre>                        },</pre></code></td></tr><tr><td>262</td><td><code><pre></pre></code></td></tr><tr><td>263</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of URL path map path rule.</pre></code></td></tr><tr><td>264</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>265</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/BackendHTTPSettings-1&#34;),</pre></code></td></tr><tr><td>266</td><td><code><pre>                        },</pre></code></td></tr><tr><td>267</td><td><code><pre></pre></code></td></tr><tr><td>268</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of URL path map path rule.</pre></code></td></tr><tr><td>269</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>270</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>271</td><td><code><pre>                        },</pre></code></td></tr><tr><td>272</td><td><code><pre></pre></code></td></tr><tr><td>273</td><td><code><pre>                        // RewriteRuleSet - Rewrite rule set resource of URL path map path rule.</pre></code></td></tr><tr><td>274</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>275</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>276</td><td><code><pre>                        },</pre></code></td></tr><tr><td>277</td><td><code><pre>                },</pre></code></td></tr><tr><td>278</td><td><code><pre>        }</pre></code></td></tr><tr><td>279</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetDefaultBackendPool">func GetDefaultBackendPool</div><div class="info"><a href="#s_fn_GetDefaultBackendPool">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code>:</p></div><table class="listing">
<tr><td>37</td><td><code><pre>func GetDefaultBackendPool() n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>38</td><td><code><pre>        return n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>39</td><td><code><pre>                Name: to.StringPtr(DefaultBackendPoolName),</pre></code></td></tr><tr><td>40</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>41</td><td><code><pre>                        BackendAddresses: &amp;[]n.ApplicationGatewayBackendAddress{</pre></code></td></tr><tr><td>42</td><td><code><pre>                                {</pre></code></td></tr><tr><td>43</td><td><code><pre>                                        IPAddress: to.StringPtr(IPAddress1),</pre></code></td></tr><tr><td>44</td><td><code><pre>                                },</pre></code></td></tr><tr><td>45</td><td><code><pre>                        },</pre></code></td></tr><tr><td>46</td><td><code><pre>                },</pre></code></td></tr><tr><td>47</td><td><code><pre>        }</pre></code></td></tr><tr><td>48</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetBackendPool1">func GetBackendPool1</div><div class="info"><a href="#s_fn_GetBackendPool1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code>:</p></div><table class="listing">
<tr><td>51</td><td><code><pre>func GetBackendPool1() n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>52</td><td><code><pre>        return n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>53</td><td><code><pre>                Name: to.StringPtr(BackendAddressPoolName1),</pre></code></td></tr><tr><td>54</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>55</td><td><code><pre>                        BackendAddresses: &amp;[]n.ApplicationGatewayBackendAddress{</pre></code></td></tr><tr><td>56</td><td><code><pre>                                {</pre></code></td></tr><tr><td>57</td><td><code><pre>                                        IPAddress: to.StringPtr(IPAddress1),</pre></code></td></tr><tr><td>58</td><td><code><pre>                                },</pre></code></td></tr><tr><td>59</td><td><code><pre>                        },</pre></code></td></tr><tr><td>60</td><td><code><pre>                },</pre></code></td></tr><tr><td>61</td><td><code><pre>        }</pre></code></td></tr><tr><td>62</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetBackendPool2">func GetBackendPool2</div><div class="info"><a href="#s_fn_GetBackendPool2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code>:</p></div><table class="listing">
<tr><td>65</td><td><code><pre>func GetBackendPool2() n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>66</td><td><code><pre>        return n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>67</td><td><code><pre>                Name: to.StringPtr(BackendAddressPoolName2),</pre></code></td></tr><tr><td>68</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>69</td><td><code><pre>                        BackendAddresses: &amp;[]n.ApplicationGatewayBackendAddress{</pre></code></td></tr><tr><td>70</td><td><code><pre>                                {</pre></code></td></tr><tr><td>71</td><td><code><pre>                                        IPAddress: to.StringPtr(IPAddress2),</pre></code></td></tr><tr><td>72</td><td><code><pre>                                },</pre></code></td></tr><tr><td>73</td><td><code><pre>                        },</pre></code></td></tr><tr><td>74</td><td><code><pre>                },</pre></code></td></tr><tr><td>75</td><td><code><pre>        }</pre></code></td></tr><tr><td>76</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetBackendPool3">func GetBackendPool3</div><div class="info"><a href="#s_fn_GetBackendPool3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/pools.go</code>:</p></div><table class="listing">
<tr><td>79</td><td><code><pre>func GetBackendPool3() n.ApplicationGatewayBackendAddressPool {</pre></code></td></tr><tr><td>80</td><td><code><pre>        return n.ApplicationGatewayBackendAddressPool{</pre></code></td></tr><tr><td>81</td><td><code><pre>                Name: to.StringPtr(BackendAddressPoolName3),</pre></code></td></tr><tr><td>82</td><td><code><pre>                ApplicationGatewayBackendAddressPoolPropertiesFormat: &amp;n.ApplicationGatewayBackendAddressPoolPropertiesFormat{</pre></code></td></tr><tr><td>83</td><td><code><pre>                        BackendAddresses: &amp;[]n.ApplicationGatewayBackendAddress{</pre></code></td></tr><tr><td>84</td><td><code><pre>                                {</pre></code></td></tr><tr><td>85</td><td><code><pre>                                        IPAddress: to.StringPtr(IPAddress3),</pre></code></td></tr><tr><td>86</td><td><code><pre>                                },</pre></code></td></tr><tr><td>87</td><td><code><pre>                        },</pre></code></td></tr><tr><td>88</td><td><code><pre>                },</pre></code></td></tr><tr><td>89</td><td><code><pre>        }</pre></code></td></tr><tr><td>90</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetDefaultPort">func GetDefaultPort</div><div class="info"><a href="#s_fn_GetDefaultPort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ports.go</code>:</p></div><table class="listing">
<tr><td>16</td><td><code><pre>func GetDefaultPort() n.ApplicationGatewayFrontendPort {</pre></code></td></tr><tr><td>17</td><td><code><pre>        return n.ApplicationGatewayFrontendPort{</pre></code></td></tr><tr><td>18</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>19</td><td><code><pre>                Name: to.StringPtr(DefaultPortName),</pre></code></td></tr><tr><td>20</td><td><code><pre>                ID:   to.StringPtr(&#34;/subscriptions/--subscription--/resourceGroups/--resource-group--/providers/Microsoft.Network/applicationGateways/--app-gw-name--/frontendPorts/fp-80&#34;),</pre></code></td></tr><tr><td>21</td><td><code><pre>                ApplicationGatewayFrontendPortPropertiesFormat: &amp;n.ApplicationGatewayFrontendPortPropertiesFormat{</pre></code></td></tr><tr><td>22</td><td><code><pre>                        Port: to.Int32Ptr(int32(80)),</pre></code></td></tr><tr><td>23</td><td><code><pre>                },</pre></code></td></tr><tr><td>24</td><td><code><pre>        }</pre></code></td></tr><tr><td>25</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetDefaultRoutingRule">func GetDefaultRoutingRule</div><div class="info"><a href="#s_fn_GetDefaultRoutingRule">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>190</td><td><code><pre>func GetDefaultRoutingRule() *n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>191</td><td><code><pre>        return &amp;n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>192</td><td><code><pre>                Name: to.StringPtr(DefaultRequestRoutingRuleName),</pre></code></td></tr><tr><td>193</td><td><code><pre>                ApplicationGatewayRequestRoutingRulePropertiesFormat: &amp;n.ApplicationGatewayRequestRoutingRulePropertiesFormat{</pre></code></td></tr><tr><td>194</td><td><code><pre>                        // RuleType - Rule type. Possible values include: &#39;Basic&#39;, &#39;PathBasedRouting&#39;</pre></code></td></tr><tr><td>195</td><td><code><pre>                        RuleType: n.ApplicationGatewayRequestRoutingRuleTypeBasic,</pre></code></td></tr><tr><td>196</td><td><code><pre></pre></code></td></tr><tr><td>197</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of the application gateway.</pre></code></td></tr><tr><td>198</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>199</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + DefaultBackendPoolName),</pre></code></td></tr><tr><td>200</td><td><code><pre>                        },</pre></code></td></tr><tr><td>201</td><td><code><pre></pre></code></td></tr><tr><td>202</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of the application gateway.</pre></code></td></tr><tr><td>203</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>204</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + DefaultBackendHTTPSettingsName),</pre></code></td></tr><tr><td>205</td><td><code><pre>                        },</pre></code></td></tr><tr><td>206</td><td><code><pre></pre></code></td></tr><tr><td>207</td><td><code><pre>                        // HTTPListener - Http listener resource of the application gateway.</pre></code></td></tr><tr><td>208</td><td><code><pre>                        HTTPListener: &amp;n.SubResource{</pre></code></td></tr><tr><td>209</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + DefaultHTTPListenerName),</pre></code></td></tr><tr><td>210</td><td><code><pre>                        },</pre></code></td></tr><tr><td>211</td><td><code><pre>                },</pre></code></td></tr><tr><td>212</td><td><code><pre>        }</pre></code></td></tr><tr><td>213</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetCertificate1">func GetCertificate1</div><div class="info"><a href="#s_fn_GetCertificate1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/certificates.go</code>:</p></div><table class="listing">
<tr><td>34</td><td><code><pre>func GetCertificate1() n.ApplicationGatewaySslCertificate {</pre></code></td></tr><tr><td>35</td><td><code><pre>        return n.ApplicationGatewaySslCertificate{</pre></code></td></tr><tr><td>36</td><td><code><pre>                Name: to.StringPtr(CertificateName1),</pre></code></td></tr><tr><td>37</td><td><code><pre>        }</pre></code></td></tr><tr><td>38</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRequestRoutingRulePathBased1">func GetRequestRoutingRulePathBased1</div><div class="info"><a href="#s_fn_GetRequestRoutingRulePathBased1">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>28</td><td><code><pre>func GetRequestRoutingRulePathBased1() *n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>29</td><td><code><pre>        return &amp;n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>30</td><td><code><pre>                Name: to.StringPtr(RequestRoutingRuleName1),</pre></code></td></tr><tr><td>31</td><td><code><pre>                ApplicationGatewayRequestRoutingRulePropertiesFormat: &amp;n.ApplicationGatewayRequestRoutingRulePropertiesFormat{</pre></code></td></tr><tr><td>32</td><td><code><pre>                        // RuleType - Rule type. Possible values include: &#39;Basic&#39;, &#39;PathBasedRouting&#39;</pre></code></td></tr><tr><td>33</td><td><code><pre>                        RuleType: n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting,</pre></code></td></tr><tr><td>34</td><td><code><pre></pre></code></td></tr><tr><td>35</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of the application gateway.</pre></code></td></tr><tr><td>36</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>37</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName1),</pre></code></td></tr><tr><td>38</td><td><code><pre>                        },</pre></code></td></tr><tr><td>39</td><td><code><pre></pre></code></td></tr><tr><td>40</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of the application gateway.</pre></code></td></tr><tr><td>41</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>42</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendHTTPSettingsName1),</pre></code></td></tr><tr><td>43</td><td><code><pre>                        },</pre></code></td></tr><tr><td>44</td><td><code><pre></pre></code></td></tr><tr><td>45</td><td><code><pre>                        // HTTPListener - Http listener resource of the application gateway.</pre></code></td></tr><tr><td>46</td><td><code><pre>                        HTTPListener: &amp;n.SubResource{</pre></code></td></tr><tr><td>47</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + HTTPListenerPathBased1),</pre></code></td></tr><tr><td>48</td><td><code><pre>                        },</pre></code></td></tr><tr><td>49</td><td><code><pre></pre></code></td></tr><tr><td>50</td><td><code><pre>                        // URLPathMap - URL path map resource of the application gateway.</pre></code></td></tr><tr><td>51</td><td><code><pre>                        URLPathMap: &amp;n.SubResource{</pre></code></td></tr><tr><td>52</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + URLPathMapName1),</pre></code></td></tr><tr><td>53</td><td><code><pre>                        },</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr><td>55</td><td><code><pre>                        // RewriteRuleSet - Rewrite Rule Set resource in Basic rule of the application gateway.</pre></code></td></tr><tr><td>56</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>57</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>58</td><td><code><pre>                        },</pre></code></td></tr><tr><td>59</td><td><code><pre></pre></code></td></tr><tr><td>60</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of the application gateway.</pre></code></td></tr><tr><td>61</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>62</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>63</td><td><code><pre>                        },</pre></code></td></tr><tr><td>64</td><td><code><pre>                },</pre></code></td></tr><tr><td>65</td><td><code><pre>        }</pre></code></td></tr><tr><td>66</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRequestRoutingRulePathBased2">func GetRequestRoutingRulePathBased2</div><div class="info"><a href="#s_fn_GetRequestRoutingRulePathBased2">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>69</td><td><code><pre>func GetRequestRoutingRulePathBased2() *n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>70</td><td><code><pre>        return &amp;n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>71</td><td><code><pre>                Name: to.StringPtr(RequestRoutingRuleName2),</pre></code></td></tr><tr><td>72</td><td><code><pre>                ApplicationGatewayRequestRoutingRulePropertiesFormat: &amp;n.ApplicationGatewayRequestRoutingRulePropertiesFormat{</pre></code></td></tr><tr><td>73</td><td><code><pre>                        // RuleType - Rule type. Possible values include: &#39;Basic&#39;, &#39;PathBasedRouting&#39;</pre></code></td></tr><tr><td>74</td><td><code><pre>                        RuleType: n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting,</pre></code></td></tr><tr><td>75</td><td><code><pre></pre></code></td></tr><tr><td>76</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of the application gateway.</pre></code></td></tr><tr><td>77</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>78</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName1),</pre></code></td></tr><tr><td>79</td><td><code><pre>                        },</pre></code></td></tr><tr><td>80</td><td><code><pre></pre></code></td></tr><tr><td>81</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of the application gateway.</pre></code></td></tr><tr><td>82</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>83</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendHTTPSettingsName1),</pre></code></td></tr><tr><td>84</td><td><code><pre>                        },</pre></code></td></tr><tr><td>85</td><td><code><pre></pre></code></td></tr><tr><td>86</td><td><code><pre>                        // HTTPListener - Http listener resource of the application gateway.</pre></code></td></tr><tr><td>87</td><td><code><pre>                        HTTPListener: &amp;n.SubResource{</pre></code></td></tr><tr><td>88</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + HTTPListenerPathBased2),</pre></code></td></tr><tr><td>89</td><td><code><pre>                        },</pre></code></td></tr><tr><td>90</td><td><code><pre></pre></code></td></tr><tr><td>91</td><td><code><pre>                        // URLPathMap - URL path map resource of the application gateway.</pre></code></td></tr><tr><td>92</td><td><code><pre>                        URLPathMap: &amp;n.SubResource{</pre></code></td></tr><tr><td>93</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + URLPathMapName2),</pre></code></td></tr><tr><td>94</td><td><code><pre>                        },</pre></code></td></tr><tr><td>95</td><td><code><pre></pre></code></td></tr><tr><td>96</td><td><code><pre>                        // RewriteRuleSet - Rewrite Rule Set resource in Basic rule of the application gateway.</pre></code></td></tr><tr><td>97</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>98</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>99</td><td><code><pre>                        },</pre></code></td></tr><tr><td>100</td><td><code><pre></pre></code></td></tr><tr><td>101</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of the application gateway.</pre></code></td></tr><tr><td>102</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>103</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>104</td><td><code><pre>                        },</pre></code></td></tr><tr><td>105</td><td><code><pre>                },</pre></code></td></tr><tr><td>106</td><td><code><pre>        }</pre></code></td></tr><tr><td>107</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRequestRoutingRulePathBased3">func GetRequestRoutingRulePathBased3</div><div class="info"><a href="#s_fn_GetRequestRoutingRulePathBased3">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>110</td><td><code><pre>func GetRequestRoutingRulePathBased3() *n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>111</td><td><code><pre>        return &amp;n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>112</td><td><code><pre>                Name: to.StringPtr(RequestRoutingRuleName3),</pre></code></td></tr><tr><td>113</td><td><code><pre>                ApplicationGatewayRequestRoutingRulePropertiesFormat: &amp;n.ApplicationGatewayRequestRoutingRulePropertiesFormat{</pre></code></td></tr><tr><td>114</td><td><code><pre>                        // RuleType - Rule type. Possible values include: &#39;Basic&#39;, &#39;PathBasedRouting&#39;</pre></code></td></tr><tr><td>115</td><td><code><pre>                        RuleType: n.ApplicationGatewayRequestRoutingRuleTypePathBasedRouting,</pre></code></td></tr><tr><td>116</td><td><code><pre></pre></code></td></tr><tr><td>117</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of the application gateway.</pre></code></td></tr><tr><td>118</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>119</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName1),</pre></code></td></tr><tr><td>120</td><td><code><pre>                        },</pre></code></td></tr><tr><td>121</td><td><code><pre></pre></code></td></tr><tr><td>122</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of the application gateway.</pre></code></td></tr><tr><td>123</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>124</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendHTTPSettingsName1),</pre></code></td></tr><tr><td>125</td><td><code><pre>                        },</pre></code></td></tr><tr><td>126</td><td><code><pre></pre></code></td></tr><tr><td>127</td><td><code><pre>                        // HTTPListener - Http listener resource of the application gateway.</pre></code></td></tr><tr><td>128</td><td><code><pre>                        HTTPListener: &amp;n.SubResource{</pre></code></td></tr><tr><td>129</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + HTTPListenerWildcard),</pre></code></td></tr><tr><td>130</td><td><code><pre>                        },</pre></code></td></tr><tr><td>131</td><td><code><pre></pre></code></td></tr><tr><td>132</td><td><code><pre>                        // URLPathMap - URL path map resource of the application gateway.</pre></code></td></tr><tr><td>133</td><td><code><pre>                        URLPathMap: &amp;n.SubResource{</pre></code></td></tr><tr><td>134</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + URLPathMapName3),</pre></code></td></tr><tr><td>135</td><td><code><pre>                        },</pre></code></td></tr><tr><td>136</td><td><code><pre></pre></code></td></tr><tr><td>137</td><td><code><pre>                        // RewriteRuleSet - Rewrite Rule Set resource in Basic rule of the application gateway.</pre></code></td></tr><tr><td>138</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>139</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-1&#34;),</pre></code></td></tr><tr><td>140</td><td><code><pre>                        },</pre></code></td></tr><tr><td>141</td><td><code><pre></pre></code></td></tr><tr><td>142</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of the application gateway.</pre></code></td></tr><tr><td>143</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>144</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-1&#34;),</pre></code></td></tr><tr><td>145</td><td><code><pre>                        },</pre></code></td></tr><tr><td>146</td><td><code><pre>                },</pre></code></td></tr><tr><td>147</td><td><code><pre>        }</pre></code></td></tr><tr><td>148</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetRequestRoutingRuleBasic">func GetRequestRoutingRuleBasic</div><div class="info"><a href="#s_fn_GetRequestRoutingRuleBasic">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/routing_rules.go</code>:</p></div><table class="listing">
<tr><td>151</td><td><code><pre>func GetRequestRoutingRuleBasic() *n.ApplicationGatewayRequestRoutingRule {</pre></code></td></tr><tr><td>152</td><td><code><pre>        return &amp;n.ApplicationGatewayRequestRoutingRule{</pre></code></td></tr><tr><td>153</td><td><code><pre>                Name: to.StringPtr(&#34;RequestRoutingRule-2&#34;),</pre></code></td></tr><tr><td>154</td><td><code><pre>                ApplicationGatewayRequestRoutingRulePropertiesFormat: &amp;n.ApplicationGatewayRequestRoutingRulePropertiesFormat{</pre></code></td></tr><tr><td>155</td><td><code><pre>                        // RuleType - Rule type. Possible values include: &#39;Basic&#39;, &#39;PathBasedRouting&#39;</pre></code></td></tr><tr><td>156</td><td><code><pre>                        RuleType: n.ApplicationGatewayRequestRoutingRuleTypeBasic,</pre></code></td></tr><tr><td>157</td><td><code><pre></pre></code></td></tr><tr><td>158</td><td><code><pre>                        // BackendAddressPool - Backend address pool resource of the application gateway.</pre></code></td></tr><tr><td>159</td><td><code><pre>                        BackendAddressPool: &amp;n.SubResource{</pre></code></td></tr><tr><td>160</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendAddressPoolName2),</pre></code></td></tr><tr><td>161</td><td><code><pre>                        },</pre></code></td></tr><tr><td>162</td><td><code><pre></pre></code></td></tr><tr><td>163</td><td><code><pre>                        // BackendHTTPSettings - Backend http settings resource of the application gateway.</pre></code></td></tr><tr><td>164</td><td><code><pre>                        BackendHTTPSettings: &amp;n.SubResource{</pre></code></td></tr><tr><td>165</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + BackendHTTPSettingsName2),</pre></code></td></tr><tr><td>166</td><td><code><pre>                        },</pre></code></td></tr><tr><td>167</td><td><code><pre></pre></code></td></tr><tr><td>168</td><td><code><pre>                        // HTTPListener - Http listener resource of the application gateway.</pre></code></td></tr><tr><td>169</td><td><code><pre>                        HTTPListener: &amp;n.SubResource{</pre></code></td></tr><tr><td>170</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/&#34; + HTTPListenerNameBasic),</pre></code></td></tr><tr><td>171</td><td><code><pre>                        },</pre></code></td></tr><tr><td>172</td><td><code><pre></pre></code></td></tr><tr><td>173</td><td><code><pre>                        // URLPathMap - URL path map resource of the application gateway.</pre></code></td></tr><tr><td>174</td><td><code><pre>                        URLPathMap: nil,</pre></code></td></tr><tr><td>175</td><td><code><pre></pre></code></td></tr><tr><td>176</td><td><code><pre>                        // RewriteRuleSet - Rewrite Rule Set resource in Basic rule of the application gateway.</pre></code></td></tr><tr><td>177</td><td><code><pre>                        RewriteRuleSet: &amp;n.SubResource{</pre></code></td></tr><tr><td>178</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RewriteRuleSet-2&#34;),</pre></code></td></tr><tr><td>179</td><td><code><pre>                        },</pre></code></td></tr><tr><td>180</td><td><code><pre></pre></code></td></tr><tr><td>181</td><td><code><pre>                        // RedirectConfiguration - Redirect configuration resource of the application gateway.</pre></code></td></tr><tr><td>182</td><td><code><pre>                        RedirectConfiguration: &amp;n.SubResource{</pre></code></td></tr><tr><td>183</td><td><code><pre>                                ID: to.StringPtr(&#34;x/y/z/RedirectConfiguration-2&#34;),</pre></code></td></tr><tr><td>184</td><td><code><pre>                        },</pre></code></td></tr><tr><td>185</td><td><code><pre>                },</pre></code></td></tr><tr><td>186</td><td><code><pre>        }</pre></code></td></tr><tr><td>187</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetAzureIngressProhibitedTargets">func GetAzureIngressProhibitedTargets</div><div class="info"><a href="#s_fn_GetAzureIngressProhibitedTargets">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/targets.go</code>:</p></div><table class="listing">
<tr><td>31</td><td><code><pre>func GetAzureIngressProhibitedTargets() []*ptv1.AzureIngressProhibitedTarget {</pre></code></td></tr><tr><td>32</td><td><code><pre>        return []*ptv1.AzureIngressProhibitedTarget{</pre></code></td></tr><tr><td>33</td><td><code><pre>                {</pre></code></td></tr><tr><td>34</td><td><code><pre>                        Spec: ptv1.AzureIngressProhibitedTargetSpec{</pre></code></td></tr><tr><td>35</td><td><code><pre>                                Hostname: tests.Host,</pre></code></td></tr><tr><td>36</td><td><code><pre>                                Paths: []string{</pre></code></td></tr><tr><td>37</td><td><code><pre>                                        PathFox,</pre></code></td></tr><tr><td>38</td><td><code><pre>                                        PathBar,</pre></code></td></tr><tr><td>39</td><td><code><pre>                                },</pre></code></td></tr><tr><td>40</td><td><code><pre>                        },</pre></code></td></tr><tr><td>41</td><td><code><pre>                },</pre></code></td></tr><tr><td>42</td><td><code><pre>                {</pre></code></td></tr><tr><td>43</td><td><code><pre>                        Spec: ptv1.AzureIngressProhibitedTargetSpec{</pre></code></td></tr><tr><td>44</td><td><code><pre>                                Hostname: tests.OtherHost,</pre></code></td></tr><tr><td>45</td><td><code><pre>                        },</pre></code></td></tr><tr><td>46</td><td><code><pre>                },</pre></code></td></tr><tr><td>47</td><td><code><pre>                {</pre></code></td></tr><tr><td>48</td><td><code><pre>                        Spec: ptv1.AzureIngressProhibitedTargetSpec{</pre></code></td></tr><tr><td>49</td><td><code><pre>                                Paths: []string{</pre></code></td></tr><tr><td>50</td><td><code><pre>                                        PathForbidden,</pre></code></td></tr><tr><td>51</td><td><code><pre>                                },</pre></code></td></tr><tr><td>52</td><td><code><pre>                        },</pre></code></td></tr><tr><td>53</td><td><code><pre>                },</pre></code></td></tr><tr><td>54</td><td><code><pre>                {</pre></code></td></tr><tr><td>55</td><td><code><pre>                        Spec: ptv1.AzureIngressProhibitedTargetSpec{</pre></code></td></tr><tr><td>56</td><td><code><pre>                                Hostname: tests.WildcardHost1,</pre></code></td></tr><tr><td>57</td><td><code><pre>                        },</pre></code></td></tr><tr><td>58</td><td><code><pre>                },</pre></code></td></tr><tr><td>59</td><td><code><pre>        }</pre></code></td></tr><tr><td>60</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetPort">func GetPort</div><div class="info"><a href="#s_fn_GetPort">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ports.go</code>:</p></div><table class="listing">
<tr><td>28</td><td><code><pre>func GetPort(portNo int32) n.ApplicationGatewayFrontendPort {</pre></code></td></tr><tr class="miss"><td>29</td><td><code><pre>        return n.ApplicationGatewayFrontendPort{</pre></code></td></tr><tr><td>30</td><td><code><pre>                Etag: to.StringPtr(&#34;*&#34;),</pre></code></td></tr><tr><td>31</td><td><code><pre>                Name: to.StringPtr(fmt.Sprintf(&#34;fp-%d&#34;, portNo)),</pre></code></td></tr><tr><td>32</td><td><code><pre>                ID:   to.StringPtr(fmt.Sprintf(&#34;/subscriptions/--subscription--/resourceGroups/--resource-group--/providers/Microsoft.Network/applicationGateways/--app-gw-name--/frontendPorts/fp-%d&#34;, portNo)),</pre></code></td></tr><tr><td>33</td><td><code><pre>                ApplicationGatewayFrontendPortPropertiesFormat: &amp;n.ApplicationGatewayFrontendPortPropertiesFormat{</pre></code></td></tr><tr><td>34</td><td><code><pre>                        Port: to.Int32Ptr(portNo),</pre></code></td></tr><tr><td>35</td><td><code><pre>                },</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr><tr><td>37</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetIngressWithProhibitedTargetConflict">func GetIngressWithProhibitedTargetConflict</div><div class="info"><a href="#s_fn_GetIngressWithProhibitedTargetConflict">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/tests/fixtures/ingress.go</code>:</p></div><table class="listing">
<tr><td>65</td><td><code><pre>func GetIngressWithProhibitedTargetConflict() *networking.Ingress {</pre></code></td></tr><tr class="miss"><td>66</td><td><code><pre>        return &amp;networking.Ingress{</pre></code></td></tr><tr><td>67</td><td><code><pre>                Spec: networking.IngressSpec{</pre></code></td></tr><tr><td>68</td><td><code><pre>                        Rules: []networking.IngressRule{</pre></code></td></tr><tr><td>69</td><td><code><pre>                                {</pre></code></td></tr><tr><td>70</td><td><code><pre>                                        // Rule with no Paths</pre></code></td></tr><tr><td>71</td><td><code><pre>                                        Host: tests.OtherHost,</pre></code></td></tr><tr><td>72</td><td><code><pre>                                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>73</td><td><code><pre>                                                HTTP: &amp;networking.HTTPIngressRuleValue{},</pre></code></td></tr><tr><td>74</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>75</td><td><code><pre>                                },</pre></code></td></tr><tr><td>76</td><td><code><pre>                                {</pre></code></td></tr><tr><td>77</td><td><code><pre>                                        // Rule with Paths</pre></code></td></tr><tr><td>78</td><td><code><pre>                                        Host: tests.Host,</pre></code></td></tr><tr><td>79</td><td><code><pre>                                        IngressRuleValue: networking.IngressRuleValue{</pre></code></td></tr><tr><td>80</td><td><code><pre>                                                HTTP: &amp;networking.HTTPIngressRuleValue{</pre></code></td></tr><tr><td>81</td><td><code><pre>                                                        Paths: []networking.HTTPIngressPath{</pre></code></td></tr><tr><td>82</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>83</td><td><code><pre>                                                                        Path: PathFoo,</pre></code></td></tr><tr><td>84</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>85</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>86</td><td><code><pre>                                                                                        Name: tests.ServiceName,</pre></code></td></tr><tr><td>87</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>88</td><td><code><pre>                                                                                                Number: 80,</pre></code></td></tr><tr><td>89</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>90</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>91</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>92</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>93</td><td><code><pre>                                                                {</pre></code></td></tr><tr><td>94</td><td><code><pre>                                                                        Path: PathFox,</pre></code></td></tr><tr><td>95</td><td><code><pre>                                                                        Backend: networking.IngressBackend{</pre></code></td></tr><tr><td>96</td><td><code><pre>                                                                                Service: &amp;networking.IngressServiceBackend{</pre></code></td></tr><tr><td>97</td><td><code><pre>                                                                                        Name: tests.ServiceName,</pre></code></td></tr><tr><td>98</td><td><code><pre>                                                                                        Port: networking.ServiceBackendPort{</pre></code></td></tr><tr><td>99</td><td><code><pre>                                                                                                Number: 443,</pre></code></td></tr><tr><td>100</td><td><code><pre>                                                                                        },</pre></code></td></tr><tr><td>101</td><td><code><pre>                                                                                },</pre></code></td></tr><tr><td>102</td><td><code><pre>                                                                        },</pre></code></td></tr><tr><td>103</td><td><code><pre>                                                                },</pre></code></td></tr><tr><td>104</td><td><code><pre>                                                        },</pre></code></td></tr><tr><td>105</td><td><code><pre>                                                },</pre></code></td></tr><tr><td>106</td><td><code><pre>                                        },</pre></code></td></tr><tr><td>107</td><td><code><pre>                                },</pre></code></td></tr><tr><td>108</td><td><code><pre>                        },</pre></code></td></tr><tr><td>109</td><td><code><pre>                },</pre></code></td></tr><tr><td>110</td><td><code><pre>        }</pre></code></td></tr><tr><td>111</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/tests/fixtures DONE:95.92
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils <span class="packageTotal">80.00%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_Retry"><td><code><a href="#fn_Retry">Retry(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/retry.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>12/12</code></td></tr>
<tr id="s_fn_RemoveDuplicateStrings"><td><code><a href="#fn_RemoveDuplicateStrings">RemoveDuplicateStrings(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>9/9</code></td></tr>
<tr id="s_fn_threadsafeMultiMap.Erase"><td><code><a href="#fn_threadsafeMultiMap.Erase">threadsafeMultiMap.Erase(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_threadsafeMultiMap.ContainsValue"><td><code><a href="#fn_threadsafeMultiMap.ContainsValue">threadsafeMultiMap.ContainsValue(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>6/6</code></td></tr>
<tr id="s_fn_threadsafeMultiMap.Insert"><td><code><a href="#fn_threadsafeMultiMap.Insert">threadsafeMultiMap.Insert(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_threadsafeMultiMap.ContainsPair"><td><code><a href="#fn_threadsafeMultiMap.ContainsPair">threadsafeMultiMap.ContainsPair(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>5/5</code></td></tr>
<tr id="s_fn_RandStringRunes"><td><code><a href="#fn_RandStringRunes">RandStringRunes(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>4/4</code></td></tr>
<tr id="s_fn_PrettyJSON"><td><code><a href="#fn_PrettyJSON">PrettyJSON(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>3/3</code></td></tr>
<tr id="s_fn_GetLastChunkOfSlashed"><td><code><a href="#fn_GetLastChunkOfSlashed">GetLastChunkOfSlashed(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>2/2</code></td></tr>
<tr id="s_fn_NewThreadsafeMultimap"><td><code><a href="#fn_NewThreadsafeMultimap">NewThreadsafeMultimap(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_GetResourceKey"><td><code><a href="#fn_GetResourceKey">GetResourceKey(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_init"><td><code><a href="#fn_init">init(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_threadsafeMultiMap.Clear"><td><code><a href="#fn_threadsafeMultiMap.Clear">threadsafeMultiMap.Clear(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>75.00%</code></td><td class="linecount"><code>3/4</code></td></tr>
<tr id="s_fn_GetHashCode"><td><code><a href="#fn_GetHashCode">GetHashCode(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>60.00%</code></td><td class="linecount"><code>3/5</code></td></tr>
<tr id="s_fn_SaveToFile"><td><code><a href="#fn_SaveToFile">SaveToFile(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code></td><td class="percent"><code>50.00%</code></td><td class="linecount"><code>6/12</code></td></tr>
<tr id="s_fn_threadsafeMultiMap.EraseValue"><td><code><a href="#fn_threadsafeMultiMap.EraseValue">threadsafeMultiMap.EraseValue(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code></td><td class="percent"><code>0.00%</code></td><td class="linecount"><code>0/8</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils</code></td><td class="percent"><code>80.00%</code></td><td class="linecount"><code>68/85</code></td></tr>
</table>

<div class="funcname" id="fn_Retry">func Retry</div><div class="info"><a href="#s_fn_Retry">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/retry.go</code>:</p></div><table class="listing">
<tr><td>19</td><td><code><pre>func Retry(totalRetryCount int, retryPause time.Duration, retriableFunction RetriableFunction) (err error) {</pre></code></td></tr><tr><td>20</td><td><code><pre>        retryCounter := 0</pre></code></td></tr><tr><td>21</td><td><code><pre>        retry := Retriable(true)</pre></code></td></tr><tr><td>22</td><td><code><pre>        for {</pre></code></td></tr><tr><td>23</td><td><code><pre>                retry, err = retriableFunction()</pre></code></td></tr><tr><td>24</td><td><code><pre>                if err == nil || !retry {</pre></code></td></tr><tr><td>25</td><td><code><pre>                        break</pre></code></td></tr><tr><td>26</td><td><code><pre>                }</pre></code></td></tr><tr><td>27</td><td><code><pre></pre></code></td></tr><tr><td>28</td><td><code><pre>                retryCounter++</pre></code></td></tr><tr><td>29</td><td><code><pre>                if totalRetryCount != -1 &amp;&amp; retryCounter &gt;= totalRetryCount {</pre></code></td></tr><tr><td>30</td><td><code><pre>                        break</pre></code></td></tr><tr><td>31</td><td><code><pre>                }</pre></code></td></tr><tr><td>32</td><td><code><pre></pre></code></td></tr><tr><td>33</td><td><code><pre>                klog.Infof(&#34;Retrying in %s&#34;, retryPause)</pre></code></td></tr><tr><td>34</td><td><code><pre>                time.Sleep(retryPause)</pre></code></td></tr><tr><td>35</td><td><code><pre>        }</pre></code></td></tr><tr><td>36</td><td><code><pre>        return</pre></code></td></tr><tr><td>37</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_RemoveDuplicateStrings">func RemoveDuplicateStrings</div><div class="info"><a href="#s_fn_RemoveDuplicateStrings">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>83</td><td><code><pre>func RemoveDuplicateStrings(list []string) []string {</pre></code></td></tr><tr><td>84</td><td><code><pre>        if list == nil {</pre></code></td></tr><tr><td>85</td><td><code><pre>                return list</pre></code></td></tr><tr><td>86</td><td><code><pre>        }</pre></code></td></tr><tr><td>87</td><td><code><pre></pre></code></td></tr><tr><td>88</td><td><code><pre>        result := []string{}</pre></code></td></tr><tr><td>89</td><td><code><pre>        // use a map to enforce uniqueness</pre></code></td></tr><tr><td>90</td><td><code><pre>        dupeChecker := make(map[string]interface{})</pre></code></td></tr><tr><td>91</td><td><code><pre>        for _, val := range list {</pre></code></td></tr><tr><td>92</td><td><code><pre>                if _, ok := dupeChecker[val]; !ok {</pre></code></td></tr><tr><td>93</td><td><code><pre>                        result = append(result, val)</pre></code></td></tr><tr><td>94</td><td><code><pre>                        dupeChecker[val] = nil</pre></code></td></tr><tr><td>95</td><td><code><pre>                }</pre></code></td></tr><tr><td>96</td><td><code><pre>        }</pre></code></td></tr><tr><td>97</td><td><code><pre></pre></code></td></tr><tr><td>98</td><td><code><pre>        return result</pre></code></td></tr><tr><td>99</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_threadsafeMultiMap.Erase">func threadsafeMultiMap.Erase</div><div class="info"><a href="#s_fn_threadsafeMultiMap.Erase">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>61</td><td><code><pre>func (m *threadsafeMultiMap) Erase(key interface{}) bool {</pre></code></td></tr><tr><td>62</td><td><code><pre>        m.Lock()</pre></code></td></tr><tr><td>63</td><td><code><pre>        defer m.Unlock()</pre></code></td></tr><tr><td>64</td><td><code><pre></pre></code></td></tr><tr><td>65</td><td><code><pre>        _, exists := m.v[key]</pre></code></td></tr><tr><td>66</td><td><code><pre>        if exists {</pre></code></td></tr><tr><td>67</td><td><code><pre>                delete(m.v, key)</pre></code></td></tr><tr><td>68</td><td><code><pre>                return true</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr><td>70</td><td><code><pre></pre></code></td></tr><tr><td>71</td><td><code><pre>        return false</pre></code></td></tr><tr><td>72</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_threadsafeMultiMap.ContainsValue">func threadsafeMultiMap.ContainsValue</div><div class="info"><a href="#s_fn_threadsafeMultiMap.ContainsValue">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>103</td><td><code><pre>func (m *threadsafeMultiMap) ContainsValue(value interface{}) bool {</pre></code></td></tr><tr><td>104</td><td><code><pre>        m.RLock()</pre></code></td></tr><tr><td>105</td><td><code><pre>        defer m.RUnlock()</pre></code></td></tr><tr><td>106</td><td><code><pre></pre></code></td></tr><tr><td>107</td><td><code><pre>        for i := range m.v {</pre></code></td></tr><tr><td>108</td><td><code><pre>                if m.v[i] != nil &amp;&amp; m.v[i].Contains(value) {</pre></code></td></tr><tr><td>109</td><td><code><pre>                        return true</pre></code></td></tr><tr><td>110</td><td><code><pre>                }</pre></code></td></tr><tr><td>111</td><td><code><pre>        }</pre></code></td></tr><tr><td>112</td><td><code><pre></pre></code></td></tr><tr><td>113</td><td><code><pre>        return false</pre></code></td></tr><tr><td>114</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_threadsafeMultiMap.Insert">func threadsafeMultiMap.Insert</div><div class="info"><a href="#s_fn_threadsafeMultiMap.Insert">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>40</td><td><code><pre>func (m *threadsafeMultiMap) Insert(key interface{}, value interface{}) {</pre></code></td></tr><tr><td>41</td><td><code><pre>        m.Lock()</pre></code></td></tr><tr><td>42</td><td><code><pre>        defer m.Unlock()</pre></code></td></tr><tr><td>43</td><td><code><pre></pre></code></td></tr><tr><td>44</td><td><code><pre>        if m.v[key] == nil {</pre></code></td></tr><tr><td>45</td><td><code><pre>                m.v[key] = mapset.NewSet()</pre></code></td></tr><tr><td>46</td><td><code><pre>        }</pre></code></td></tr><tr><td>47</td><td><code><pre>        m.v[key].Add(value)</pre></code></td></tr><tr><td>48</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_threadsafeMultiMap.ContainsPair">func threadsafeMultiMap.ContainsPair</div><div class="info"><a href="#s_fn_threadsafeMultiMap.ContainsPair">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>91</td><td><code><pre>func (m *threadsafeMultiMap) ContainsPair(key interface{}, value interface{}) bool {</pre></code></td></tr><tr><td>92</td><td><code><pre>        m.RLock()</pre></code></td></tr><tr><td>93</td><td><code><pre>        defer m.RUnlock()</pre></code></td></tr><tr><td>94</td><td><code><pre></pre></code></td></tr><tr><td>95</td><td><code><pre>        if m.v[key] != nil &amp;&amp; m.v[key].Contains(value) {</pre></code></td></tr><tr><td>96</td><td><code><pre>                return true</pre></code></td></tr><tr><td>97</td><td><code><pre>        }</pre></code></td></tr><tr><td>98</td><td><code><pre></pre></code></td></tr><tr><td>99</td><td><code><pre>        return false</pre></code></td></tr><tr><td>100</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_RandStringRunes">func RandStringRunes</div><div class="info"><a href="#s_fn_RandStringRunes">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>74</td><td><code><pre>func RandStringRunes(n int) string {</pre></code></td></tr><tr><td>75</td><td><code><pre>        b := make([]rune, n)</pre></code></td></tr><tr><td>76</td><td><code><pre>        for i := range b {</pre></code></td></tr><tr><td>77</td><td><code><pre>                b[i] = letterRunes[rand.Intn(len(letterRunes))]</pre></code></td></tr><tr><td>78</td><td><code><pre>        }</pre></code></td></tr><tr><td>79</td><td><code><pre>        return string(b)</pre></code></td></tr><tr><td>80</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_PrettyJSON">func PrettyJSON</div><div class="info"><a href="#s_fn_PrettyJSON">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>32</td><td><code><pre>func PrettyJSON(js []byte, prefix string) ([]byte, error) {</pre></code></td></tr><tr><td>33</td><td><code><pre>        var jsonObj interface{}</pre></code></td></tr><tr><td>34</td><td><code><pre>        _ = json.Unmarshal(js, &amp;jsonObj)</pre></code></td></tr><tr><td>35</td><td><code><pre>        return json.MarshalIndent(jsonObj, prefix, &#34;    &#34;)</pre></code></td></tr><tr><td>36</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetLastChunkOfSlashed">func GetLastChunkOfSlashed</div><div class="info"><a href="#s_fn_GetLastChunkOfSlashed">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>39</td><td><code><pre>func GetLastChunkOfSlashed(s string) string {</pre></code></td></tr><tr><td>40</td><td><code><pre>        split := strings.Split(s, &#34;/&#34;)</pre></code></td></tr><tr><td>41</td><td><code><pre>        return split[len(split)-1]</pre></code></td></tr><tr><td>42</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewThreadsafeMultimap">func NewThreadsafeMultimap</div><div class="info"><a href="#s_fn_NewThreadsafeMultimap">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>33</td><td><code><pre>func NewThreadsafeMultimap() ThreadsafeMultiMap {</pre></code></td></tr><tr><td>34</td><td><code><pre>        return &amp;threadsafeMultiMap{</pre></code></td></tr><tr><td>35</td><td><code><pre>                v: make(map[interface{}]mapset.Set),</pre></code></td></tr><tr><td>36</td><td><code><pre>        }</pre></code></td></tr><tr><td>37</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetResourceKey">func GetResourceKey</div><div class="info"><a href="#s_fn_GetResourceKey">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>27</td><td><code><pre>func GetResourceKey(namespace, name string) string {</pre></code></td></tr><tr><td>28</td><td><code><pre>        return fmt.Sprintf(&#34;%v/%v&#34;, namespace, name)</pre></code></td></tr><tr><td>29</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_init">func init</div><div class="info"><a href="#s_fn_init">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>20</td><td><code><pre>func init() {</pre></code></td></tr><tr><td>21</td><td><code><pre>        rand.Seed(time.Now().UnixNano())</pre></code></td></tr><tr><td>22</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_threadsafeMultiMap.Clear">func threadsafeMultiMap.Clear</div><div class="info"><a href="#s_fn_threadsafeMultiMap.Clear">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>51</td><td><code><pre>func (m *threadsafeMultiMap) Clear(key interface{}) {</pre></code></td></tr><tr><td>52</td><td><code><pre>        m.Lock()</pre></code></td></tr><tr><td>53</td><td><code><pre>        defer m.Unlock()</pre></code></td></tr><tr><td>54</td><td><code><pre></pre></code></td></tr><tr><td>55</td><td><code><pre>        if m.v[key] != nil {</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                m.v[key].Clear()</pre></code></td></tr><tr><td>57</td><td><code><pre>        }</pre></code></td></tr><tr><td>58</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_GetHashCode">func GetHashCode</div><div class="info"><a href="#s_fn_GetHashCode">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>64</td><td><code><pre>func GetHashCode(i interface{}) string {</pre></code></td></tr><tr><td>65</td><td><code><pre>        jsonBytes, err := json.Marshal(i)</pre></code></td></tr><tr><td>66</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>67</td><td><code><pre>                klog.Errorf(&#34;Failed MD5 hashing %+v&#34;, i)</pre></code></td></tr><tr class="miss"><td>68</td><td><code><pre>                return &#34;&#34;</pre></code></td></tr><tr><td>69</td><td><code><pre>        }</pre></code></td></tr><tr><td>70</td><td><code><pre>        return fmt.Sprintf(&#34;%x&#34;, md5.Sum(jsonBytes))</pre></code></td></tr><tr><td>71</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_SaveToFile">func SaveToFile</div><div class="info"><a href="#s_fn_SaveToFile">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/utils.go</code>:</p></div><table class="listing">
<tr><td>45</td><td><code><pre>func SaveToFile(fileName string, content []byte) (string, error) {</pre></code></td></tr><tr><td>46</td><td><code><pre>        tempFile, err := ioutil.TempFile(&#34;&#34;, fileName)</pre></code></td></tr><tr><td>47</td><td><code><pre>        if err != nil {</pre></code></td></tr><tr class="miss"><td>48</td><td><code><pre>                klog.Error(err)</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                return tempFile.Name(), err</pre></code></td></tr><tr><td>50</td><td><code><pre>        }</pre></code></td></tr><tr><td>51</td><td><code><pre>        if _, err := tempFile.Write(content); err != nil {</pre></code></td></tr><tr class="miss"><td>52</td><td><code><pre>                klog.Error(err)</pre></code></td></tr><tr class="miss"><td>53</td><td><code><pre>                return tempFile.Name(), err</pre></code></td></tr><tr><td>54</td><td><code><pre>        }</pre></code></td></tr><tr><td>55</td><td><code><pre>        if err := tempFile.Close(); err != nil {</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                klog.Error(err)</pre></code></td></tr><tr class="miss"><td>57</td><td><code><pre>                return tempFile.Name(), err</pre></code></td></tr><tr><td>58</td><td><code><pre>        }</pre></code></td></tr><tr><td>59</td><td><code><pre>        klog.Infof(&#34;Saved App Gateway config to %s&#34;, tempFile.Name())</pre></code></td></tr><tr><td>60</td><td><code><pre>        return tempFile.Name(), nil</pre></code></td></tr><tr><td>61</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_threadsafeMultiMap.EraseValue">func threadsafeMultiMap.EraseValue</div><div class="info"><a href="#s_fn_threadsafeMultiMap.EraseValue">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/utils/threadsafemultimap.go</code>:</p></div><table class="listing">
<tr><td>75</td><td><code><pre>func (m *threadsafeMultiMap) EraseValue(value interface{}) bool {</pre></code></td></tr><tr class="miss"><td>76</td><td><code><pre>        m.Lock()</pre></code></td></tr><tr class="miss"><td>77</td><td><code><pre>        defer m.Unlock()</pre></code></td></tr><tr><td>78</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>79</td><td><code><pre>        erased := false</pre></code></td></tr><tr class="miss"><td>80</td><td><code><pre>        for i := range m.v {</pre></code></td></tr><tr class="miss"><td>81</td><td><code><pre>                if m.v[i] != nil &amp;&amp; m.v[i].Contains(value) {</pre></code></td></tr><tr class="miss"><td>82</td><td><code><pre>                        erased = true</pre></code></td></tr><tr class="miss"><td>83</td><td><code><pre>                        m.v[i].Remove(value)</pre></code></td></tr><tr><td>84</td><td><code><pre>                }</pre></code></td></tr><tr><td>85</td><td><code><pre>        }</pre></code></td></tr><tr><td>86</td><td><code><pre></pre></code></td></tr><tr class="miss"><td>87</td><td><code><pre>        return erased</pre></code></td></tr><tr><td>88</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/utils DONE:80.00
-->

<div id="pkg_github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker" class="funcname">Package Overview: github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker <span class="packageTotal">72.41%</span></div><p>This is a coverage report created after analysis of the <code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker</code> package. It 
        has been generated with the following command:</p><pre class="cmd">gocov test github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker | gocov-html</pre>        <p>Here are the stats. Please select a function name to view its implementation and see what's left for testing.</p><table class="overview">
<tr id="s_fn_drainChan"><td><code><a href="#fn_drainChan">drainChan(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker/worker.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>7/7</code></td></tr>
<tr id="s_fn_FakeEventProcessor.ProcessEvent"><td><code><a href="#fn_FakeEventProcessor.ProcessEvent">FakeEventProcessor.ProcessEvent(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker/fake.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_FakeEventProcessor.ShouldProcess"><td><code><a href="#fn_FakeEventProcessor.ShouldProcess">FakeEventProcessor.ShouldProcess(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker/fake.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_NewFakeProcessor"><td><code><a href="#fn_NewFakeProcessor">NewFakeProcessor(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker/fake.go</code></td><td class="percent"><code>100.00%</code></td><td class="linecount"><code>1/1</code></td></tr>
<tr id="s_fn_Worker.Run"><td><code><a href="#fn_Worker.Run">Worker.Run(...)</a></code></td><td><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker/worker.go</code></td><td class="percent"><code>57.89%</code></td><td class="linecount"><code>11/19</code></td></tr>
<tr><td colspan="2"><code>github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker</code></td><td class="percent"><code>72.41%</code></td><td class="linecount"><code>21/29</code></td></tr>
</table>

<div class="funcname" id="fn_drainChan">func drainChan</div><div class="info"><a href="#s_fn_drainChan">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/worker/worker.go</code>:</p></div><table class="listing">
<tr><td>19</td><td><code><pre>func drainChan(ch chan events.Event, defaultEvent events.Event) events.Event {</pre></code></td></tr><tr><td>20</td><td><code><pre>        lastEvent := defaultEvent</pre></code></td></tr><tr><td>21</td><td><code><pre>        klog.V(9).Infof(&#34;Draining %d events from work channel&#34;, len(ch))</pre></code></td></tr><tr><td>22</td><td><code><pre>        for {</pre></code></td></tr><tr><td>23</td><td><code><pre>                select {</pre></code></td></tr><tr><td>24</td><td><code><pre>                case event := &lt;-ch:</pre></code></td></tr><tr><td>25</td><td><code><pre>                        // if there are more event in the queue</pre></code></td></tr><tr><td>26</td><td><code><pre>                        // we will skip the reconcile event as we should focus on k8s related events</pre></code></td></tr><tr><td>27</td><td><code><pre>                        if event.Type != events.PeriodicReconcile {</pre></code></td></tr><tr><td>28</td><td><code><pre>                                lastEvent = event</pre></code></td></tr><tr><td>29</td><td><code><pre>                        }</pre></code></td></tr><tr><td>30</td><td><code><pre>                default:</pre></code></td></tr><tr><td>31</td><td><code><pre>                        return lastEvent</pre></code></td></tr><tr><td>32</td><td><code><pre>                }</pre></code></td></tr><tr><td>33</td><td><code><pre>        }</pre></code></td></tr><tr><td>34</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeEventProcessor.ProcessEvent">func FakeEventProcessor.ProcessEvent</div><div class="info"><a href="#s_fn_FakeEventProcessor.ProcessEvent">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/worker/fake.go</code>:</p></div><table class="listing">
<tr><td>18</td><td><code><pre>func (fp FakeEventProcessor) ProcessEvent(event events.Event) error {</pre></code></td></tr><tr><td>19</td><td><code><pre>        return fp.processEventCallBack(event)</pre></code></td></tr><tr><td>20</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_FakeEventProcessor.ShouldProcess">func FakeEventProcessor.ShouldProcess</div><div class="info"><a href="#s_fn_FakeEventProcessor.ShouldProcess">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/worker/fake.go</code>:</p></div><table class="listing">
<tr><td>23</td><td><code><pre>func (fp FakeEventProcessor) ShouldProcess(event events.Event) (bool, *string) {</pre></code></td></tr><tr><td>24</td><td><code><pre>        return true, nil</pre></code></td></tr><tr><td>25</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_NewFakeProcessor">func NewFakeProcessor</div><div class="info"><a href="#s_fn_NewFakeProcessor">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/worker/fake.go</code>:</p></div><table class="listing">
<tr><td>28</td><td><code><pre>func NewFakeProcessor(processEvent func(event events.Event) error) FakeEventProcessor {</pre></code></td></tr><tr><td>29</td><td><code><pre>        return FakeEventProcessor{</pre></code></td></tr><tr><td>30</td><td><code><pre>                processEventCallBack: processEvent,</pre></code></td></tr><tr><td>31</td><td><code><pre>        }</pre></code></td></tr><tr><td>32</td><td><code><pre>}</pre></code></td></tr></table>

<div class="funcname" id="fn_Worker.Run">func Worker.Run</div><div class="info"><a href="#s_fn_Worker.Run">Back</a><p>In <code>/home/malpani/source/repos/application-gateway-kubernetes-ingress/pkg/worker/worker.go</code>:</p></div><table class="listing">
<tr><td>37</td><td><code><pre>func (w *Worker) Run(work chan events.Event, stopChannel chan struct{}) {</pre></code></td></tr><tr><td>38</td><td><code><pre>        lastUpdate := time.Now().Add(-1 * time.Second)</pre></code></td></tr><tr><td>39</td><td><code><pre>        klog.V(1).Infoln(&#34;Worker started&#34;)</pre></code></td></tr><tr><td>40</td><td><code><pre>        for {</pre></code></td></tr><tr><td>41</td><td><code><pre>                select {</pre></code></td></tr><tr><td>42</td><td><code><pre>                case event := &lt;-work:</pre></code></td></tr><tr><td>43</td><td><code><pre>                        if shouldProcess, reason := w.ShouldProcess(event); !shouldProcess {</pre></code></td></tr><tr class="miss"><td>44</td><td><code><pre>                                if reason != nil {</pre></code></td></tr><tr><td>45</td><td><code><pre>                                        // This log statement could potentially generate a large amount of log lines and most could be</pre></code></td></tr><tr><td>46</td><td><code><pre>                                        // innocuous - for instance: &#34;endpoint default/aad-pod-identity-mic is not used by any Ingress&#34;</pre></code></td></tr><tr class="miss"><td>47</td><td><code><pre>                                        klog.V(9).Infof(&#34;Skipping event. Reason: %s&#34;, *reason)</pre></code></td></tr><tr><td>48</td><td><code><pre>                                }</pre></code></td></tr><tr class="miss"><td>49</td><td><code><pre>                                continue</pre></code></td></tr><tr><td>50</td><td><code><pre>                        }</pre></code></td></tr><tr><td>51</td><td><code><pre></pre></code></td></tr><tr><td>52</td><td><code><pre>                        since := time.Since(lastUpdate)</pre></code></td></tr><tr><td>53</td><td><code><pre>                        if since &lt; minTimeBetweenUpdates {</pre></code></td></tr><tr class="miss"><td>54</td><td><code><pre>                                sleep := minTimeBetweenUpdates - since</pre></code></td></tr><tr class="miss"><td>55</td><td><code><pre>                                klog.V(9).Infof(&#34;[worker] It has been %+v since last update; Sleeping for %+v before next update&#34;, since, sleep)</pre></code></td></tr><tr class="miss"><td>56</td><td><code><pre>                                time.Sleep(sleep)</pre></code></td></tr><tr><td>57</td><td><code><pre>                        }</pre></code></td></tr><tr><td>58</td><td><code><pre></pre></code></td></tr><tr><td>59</td><td><code><pre>                        _ = drainChan(work, event)</pre></code></td></tr><tr><td>60</td><td><code><pre></pre></code></td></tr><tr><td>61</td><td><code><pre>                        if err := w.ProcessEvent(event); err != nil {</pre></code></td></tr><tr class="miss"><td>62</td><td><code><pre>                                klog.Error(&#34;Error processing event.&#34;, err)</pre></code></td></tr><tr class="miss"><td>63</td><td><code><pre>                                time.Sleep(sleepOnErrorSeconds * time.Second)</pre></code></td></tr><tr><td>64</td><td><code><pre>                        }</pre></code></td></tr><tr><td>65</td><td><code><pre></pre></code></td></tr><tr><td>66</td><td><code><pre>                        lastUpdate = time.Now()</pre></code></td></tr><tr><td>67</td><td><code><pre>                case &lt;-stopChannel:</pre></code></td></tr><tr><td>68</td><td><code><pre>                        break</pre></code></td></tr><tr><td>69</td><td><code><pre>                }</pre></code></td></tr><tr><td>70</td><td><code><pre>        }</pre></code></td></tr><tr><td>71</td><td><code><pre>}</pre></code></td></tr></table>

<!-- Can be parsed by external script
PACKAGE:github.com/Azure/application-gateway-kubernetes-ingress/pkg/worker DONE:72.41
-->

<div id="summaryWrapper"><div class="package">Report Total</div>
<div id="totalcov">61.43%</div>
</div>
    </body>
